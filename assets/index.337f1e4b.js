const PS=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}};PS();function FS(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const BS=()=>{},US=Object.assign,jS=Object.prototype.hasOwnProperty,Zd=(t,e)=>jS.call(t,e),Cr=Array.isArray,Ph=t=>Z3(t)==="[object Map]",HS=t=>typeof t=="function",VS=t=>typeof t=="string",Mp=t=>typeof t=="symbol",Jd=t=>t!==null&&typeof t=="object",qS=Object.prototype.toString,Z3=t=>qS.call(t),$S=t=>Z3(t).slice(8,-1),xp=t=>VS(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,J3=(t,e)=>!Object.is(t,e),zS=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})};let Ti;class KS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Ti&&(this.parent=Ti,this.index=(Ti.scopes||(Ti.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Ti;try{return Ti=this,e()}finally{Ti=n}}}on(){Ti=this}off(){Ti=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function GS(t,e=Ti){e&&e.active&&e.effects.push(t)}const Op=t=>{const e=new Set(t);return e.w=0,e.n=0,e},ew=t=>(t.w&Fr)>0,tw=t=>(t.n&Fr)>0,WS=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Fr},YS=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const i=e[s];ew(i)&&!tw(i)?i.delete(t):e[n++]=i,i.w&=~Fr,i.n&=~Fr}e.length=n}},H1=new WeakMap;let Ql=0,Fr=1;const V1=30;let li;const Lo=Symbol(""),q1=Symbol("");class Np{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,GS(this,s)}run(){if(!this.active)return this.fn();let e=li,n=Ir;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=li,li=this,Ir=!0,Fr=1<<++Ql,Ql<=V1?WS(this):Qv(this),this.fn()}finally{Ql<=V1&&YS(this),Fr=1<<--Ql,li=this.parent,Ir=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){li===this?this.deferStop=!0:this.active&&(Qv(this),this.onStop&&this.onStop(),this.active=!1)}}function Qv(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Ir=!0;const nw=[];function pl(){nw.push(Ir),Ir=!1}function gl(){const t=nw.pop();Ir=t===void 0?!0:t}function Bs(t,e,n){if(Ir&&li){let s=H1.get(t);s||H1.set(t,s=new Map);let i=s.get(n);i||s.set(n,i=Op()),sw(i)}}function sw(t,e){let n=!1;Ql<=V1?tw(t)||(t.n|=Fr,n=!ew(t)):n=!t.has(li),n&&(t.add(li),li.deps.push(t))}function nr(t,e,n,s,i,r){const o=H1.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&Cr(t))o.forEach((l,c)=>{(c==="length"||c>=s)&&a.push(l)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":Cr(t)?xp(n)&&a.push(o.get("length")):(a.push(o.get(Lo)),Ph(t)&&a.push(o.get(q1)));break;case"delete":Cr(t)||(a.push(o.get(Lo)),Ph(t)&&a.push(o.get(q1)));break;case"set":Ph(t)&&a.push(o.get(Lo));break}if(a.length===1)a[0]&&$1(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);$1(Op(l))}}function $1(t,e){const n=Cr(t)?t:[...t];for(const s of n)s.computed&&Zv(s);for(const s of n)s.computed||Zv(s)}function Zv(t,e){(t!==li||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const XS=FS("__proto__,__v_isRef,__isVue"),iw=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Mp)),QS=Lp(),ZS=Lp(!1,!0),JS=Lp(!0),Jv=e6();function e6(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=Ut(this);for(let r=0,o=this.length;r<o;r++)Bs(s,"get",r+"");const i=s[e](...n);return i===-1||i===!1?s[e](...n.map(Ut)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){pl();const s=Ut(this)[e].apply(this,n);return gl(),s}}),t}function Lp(t=!1,e=!1){return function(s,i,r){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&r===(t?e?g6:cw:e?lw:aw).get(s))return s;const o=Cr(s);if(!t&&o&&Zd(Jv,i))return Reflect.get(Jv,i,r);const a=Reflect.get(s,i,r);return(Mp(i)?iw.has(i):XS(i))||(t||Bs(s,"get",i),e)?a:ss(a)?o&&xp(i)?a:a.value:Jd(a)?t?uw(a):Fp(a):a}}const t6=rw(),n6=rw(!0);function rw(t=!1){return function(n,s,i,r){let o=n[s];if(Rc(o)&&ss(o)&&!ss(i))return!1;if(!t&&!Rc(i)&&(z1(i)||(i=Ut(i),o=Ut(o)),!Cr(n)&&ss(o)&&!ss(i)))return o.value=i,!0;const a=Cr(n)&&xp(s)?Number(s)<n.length:Zd(n,s),l=Reflect.set(n,s,i,r);return n===Ut(r)&&(a?J3(i,o)&&nr(n,"set",s,i):nr(n,"add",s,i)),l}}function s6(t,e){const n=Zd(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&nr(t,"delete",e,void 0),s}function i6(t,e){const n=Reflect.has(t,e);return(!Mp(e)||!iw.has(e))&&Bs(t,"has",e),n}function r6(t){return Bs(t,"iterate",Cr(t)?"length":Lo),Reflect.ownKeys(t)}const ow={get:QS,set:t6,deleteProperty:s6,has:i6,ownKeys:r6},o6={get:JS,set(t,e){return!0},deleteProperty(t,e){return!0}},a6=US({},ow,{get:ZS,set:n6}),Dp=t=>t,ef=t=>Reflect.getPrototypeOf(t);function nh(t,e,n=!1,s=!1){t=t.__v_raw;const i=Ut(t),r=Ut(e);n||(e!==r&&Bs(i,"get",e),Bs(i,"get",r));const{has:o}=ef(i),a=s?Dp:n?jp:Up;if(o.call(i,e))return a(t.get(e));if(o.call(i,r))return a(t.get(r));t!==i&&t.get(e)}function sh(t,e=!1){const n=this.__v_raw,s=Ut(n),i=Ut(t);return e||(t!==i&&Bs(s,"has",t),Bs(s,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function ih(t,e=!1){return t=t.__v_raw,!e&&Bs(Ut(t),"iterate",Lo),Reflect.get(t,"size",t)}function e2(t){t=Ut(t);const e=Ut(this);return ef(e).has.call(e,t)||(e.add(t),nr(e,"add",t,t)),this}function t2(t,e){e=Ut(e);const n=Ut(this),{has:s,get:i}=ef(n);let r=s.call(n,t);r||(t=Ut(t),r=s.call(n,t));const o=i.call(n,t);return n.set(t,e),r?J3(e,o)&&nr(n,"set",t,e):nr(n,"add",t,e),this}function n2(t){const e=Ut(this),{has:n,get:s}=ef(e);let i=n.call(e,t);i||(t=Ut(t),i=n.call(e,t)),s&&s.call(e,t);const r=e.delete(t);return i&&nr(e,"delete",t,void 0),r}function s2(){const t=Ut(this),e=t.size!==0,n=t.clear();return e&&nr(t,"clear",void 0,void 0),n}function rh(t,e){return function(s,i){const r=this,o=r.__v_raw,a=Ut(o),l=e?Dp:t?jp:Up;return!t&&Bs(a,"iterate",Lo),o.forEach((c,d)=>s.call(i,l(c),l(d),r))}}function oh(t,e,n){return function(...s){const i=this.__v_raw,r=Ut(i),o=Ph(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=i[t](...s),d=n?Dp:e?jp:Up;return!e&&Bs(r,"iterate",l?q1:Lo),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[d(u[0]),d(u[1])]:d(u),done:f}},[Symbol.iterator](){return this}}}}function fr(t){return function(...e){return t==="delete"?!1:this}}function l6(){const t={get(r){return nh(this,r)},get size(){return ih(this)},has:sh,add:e2,set:t2,delete:n2,clear:s2,forEach:rh(!1,!1)},e={get(r){return nh(this,r,!1,!0)},get size(){return ih(this)},has:sh,add:e2,set:t2,delete:n2,clear:s2,forEach:rh(!1,!0)},n={get(r){return nh(this,r,!0)},get size(){return ih(this,!0)},has(r){return sh.call(this,r,!0)},add:fr("add"),set:fr("set"),delete:fr("delete"),clear:fr("clear"),forEach:rh(!0,!1)},s={get(r){return nh(this,r,!0,!0)},get size(){return ih(this,!0)},has(r){return sh.call(this,r,!0)},add:fr("add"),set:fr("set"),delete:fr("delete"),clear:fr("clear"),forEach:rh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=oh(r,!1,!1),n[r]=oh(r,!0,!1),e[r]=oh(r,!1,!0),s[r]=oh(r,!0,!0)}),[t,n,e,s]}const[c6,u6,h6,d6]=l6();function Pp(t,e){const n=e?t?d6:h6:t?u6:c6;return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(Zd(n,i)&&i in s?n:s,i,r)}const f6={get:Pp(!1,!1)},m6={get:Pp(!1,!0)},p6={get:Pp(!0,!1)},aw=new WeakMap,lw=new WeakMap,cw=new WeakMap,g6=new WeakMap;function _6(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function v6(t){return t.__v_skip||!Object.isExtensible(t)?0:_6($S(t))}function Fp(t){return Rc(t)?t:Bp(t,!1,ow,f6,aw)}function y6(t){return Bp(t,!1,a6,m6,lw)}function uw(t){return Bp(t,!0,o6,p6,cw)}function Bp(t,e,n,s,i){if(!Jd(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const o=v6(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return i.set(t,a),a}function La(t){return Rc(t)?La(t.__v_raw):!!(t&&t.__v_isReactive)}function Rc(t){return!!(t&&t.__v_isReadonly)}function z1(t){return!!(t&&t.__v_isShallow)}function hw(t){return La(t)||Rc(t)}function Ut(t){const e=t&&t.__v_raw;return e?Ut(e):t}function dw(t){return zS(t,"__v_skip",!0),t}const Up=t=>Jd(t)?Fp(t):t,jp=t=>Jd(t)?uw(t):t;function b6(t){Ir&&li&&(t=Ut(t),sw(t.dep||(t.dep=Op())))}function w6(t,e){t=Ut(t),t.dep&&$1(t.dep)}function ss(t){return!!(t&&t.__v_isRef===!0)}function E6(t){return ss(t)?t.value:t}const T6={get:(t,e,n)=>E6(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return ss(i)&&!ss(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function fw(t){return La(t)?t:new Proxy(t,T6)}class S6{constructor(e,n,s,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Np(e,()=>{this._dirty||(this._dirty=!0,w6(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=s}get value(){const e=Ut(this);return b6(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function A6(t,e,n=!1){let s,i;const r=HS(t);return r?(s=t,i=BS):(s=t.get,i=t.set),new S6(s,i,r||!i,n)}function R6(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}function Hp(t){if(It(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=js(s)?k6(s):Hp(s);if(i)for(const r in i)e[r]=i[r]}return e}else{if(js(t))return t;if(as(t))return t}}const C6=/;(?![^(]*\))/g,I6=/:(.+)/;function k6(t){const e={};return t.split(C6).forEach(n=>{if(n){const s=n.split(I6);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Ka(t){let e="";if(js(t))e=t;else if(It(t))for(let n=0;n<t.length;n++){const s=Ka(t[n]);s&&(e+=s+" ")}else if(as(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const mw=t=>js(t)?t:t==null?"":It(t)||as(t)&&(t.toString===bw||!wt(t.toString))?JSON.stringify(t,pw,2):String(t),pw=(t,e)=>e&&e.__v_isRef?pw(t,e.value):_w(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i])=>(n[`${s} =>`]=i,n),{})}:vw(e)?{[`Set(${e.size})`]:[...e.values()]}:as(e)&&!It(e)&&!ww(e)?String(e):e,Gt={},Da=[],Li=()=>{},M6=()=>!1,x6=/^on[^a-z]/,Vp=t=>x6.test(t),gw=t=>t.startsWith("onUpdate:"),Us=Object.assign,qp=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},O6=Object.prototype.hasOwnProperty,Ot=(t,e)=>O6.call(t,e),It=Array.isArray,_w=t=>$p(t)==="[object Map]",vw=t=>$p(t)==="[object Set]",wt=t=>typeof t=="function",js=t=>typeof t=="string",as=t=>t!==null&&typeof t=="object",yw=t=>as(t)&&wt(t.then)&&wt(t.catch),bw=Object.prototype.toString,$p=t=>bw.call(t),ww=t=>$p(t)==="[object Object]",Fh=R6(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),tf=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},N6=/-(\w)/g,Pi=tf(t=>t.replace(N6,(e,n)=>n?n.toUpperCase():"")),L6=/\B([A-Z])/g,nf=tf(t=>t.replace(L6,"-$1").toLowerCase()),zp=tf(t=>t.charAt(0).toUpperCase()+t.slice(1)),Um=tf(t=>t?`on${zp(t)}`:""),i2=(t,e)=>!Object.is(t,e),jm=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},K1=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},D6=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let r2;const P6=()=>r2||(r2=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function kr(t,e,n,s){let i;try{i=s?t(...s):t()}catch(r){sf(r,e,n)}return i}function ei(t,e,n,s){if(wt(t)){const r=kr(t,e,n,s);return r&&yw(r)&&r.catch(o=>{sf(o,e,n)}),r}const i=[];for(let r=0;r<t.length;r++)i.push(ei(t[r],e,n,s));return i}function sf(t,e,n,s=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const o=e.proxy,a=n;for(;r;){const c=r.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,o,a)===!1)return}r=r.parent}const l=e.appContext.config.errorHandler;if(l){kr(l,null,10,[t,o,a]);return}}F6(t,n,i,s)}function F6(t,e,n,s=!0){console.error(t)}let Jh=!1,G1=!1;const Ms=[];let Vi=0;const cc=[];let Zl=null,Aa=0;const uc=[];let wr=null,Ra=0;const Ew=Promise.resolve();let Kp=null,W1=null;function B6(t){const e=Kp||Ew;return t?e.then(this?t.bind(this):t):e}function U6(t){let e=Vi+1,n=Ms.length;for(;e<n;){const s=e+n>>>1;Cc(Ms[s])<t?e=s+1:n=s}return e}function Tw(t){(!Ms.length||!Ms.includes(t,Jh&&t.allowRecurse?Vi+1:Vi))&&t!==W1&&(t.id==null?Ms.push(t):Ms.splice(U6(t.id),0,t),Sw())}function Sw(){!Jh&&!G1&&(G1=!0,Kp=Ew.then(Cw))}function j6(t){const e=Ms.indexOf(t);e>Vi&&Ms.splice(e,1)}function Aw(t,e,n,s){It(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),Sw()}function H6(t){Aw(t,Zl,cc,Aa)}function V6(t){Aw(t,wr,uc,Ra)}function rf(t,e=null){if(cc.length){for(W1=e,Zl=[...new Set(cc)],cc.length=0,Aa=0;Aa<Zl.length;Aa++)Zl[Aa]();Zl=null,Aa=0,W1=null,rf(t,e)}}function Rw(t){if(rf(),uc.length){const e=[...new Set(uc)];if(uc.length=0,wr){wr.push(...e);return}for(wr=e,wr.sort((n,s)=>Cc(n)-Cc(s)),Ra=0;Ra<wr.length;Ra++)wr[Ra]();wr=null,Ra=0}}const Cc=t=>t.id==null?1/0:t.id;function Cw(t){G1=!1,Jh=!0,rf(t),Ms.sort((n,s)=>Cc(n)-Cc(s));const e=Li;try{for(Vi=0;Vi<Ms.length;Vi++){const n=Ms[Vi];n&&n.active!==!1&&kr(n,null,14)}}finally{Vi=0,Ms.length=0,Rw(),Jh=!1,Kp=null,(Ms.length||cc.length||uc.length)&&Cw(t)}}function q6(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Gt;let i=n;const r=e.startsWith("update:"),o=r&&e.slice(7);if(o&&o in s){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:f}=s[d]||Gt;f&&(i=n.map(m=>m.trim())),u&&(i=n.map(D6))}let a,l=s[a=Um(e)]||s[a=Um(Pi(e))];!l&&r&&(l=s[a=Um(nf(e))]),l&&ei(l,t,6,i);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ei(c,t,6,i)}}function Iw(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},a=!1;if(!wt(t)){const l=c=>{const d=Iw(c,e,!0);d&&(a=!0,Us(o,d))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(s.set(t,null),null):(It(r)?r.forEach(l=>o[l]=null):Us(o,r),s.set(t,o),o)}function of(t,e){return!t||!Vp(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ot(t,e[0].toLowerCase()+e.slice(1))||Ot(t,nf(e))||Ot(t,e))}let Zs=null,af=null;function ed(t){const e=Zs;return Zs=t,af=t&&t.type.__scopeId||null,e}function $6(t){af=t}function z6(){af=null}function K6(t,e=Zs,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&g2(-1);const r=ed(e),o=t(...i);return ed(r),s._d&&g2(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function Hm(t){const{type:e,vnode:n,proxy:s,withProxy:i,props:r,propsOptions:[o],slots:a,attrs:l,emit:c,render:d,renderCache:u,data:f,setupState:m,ctx:h,inheritAttrs:M}=t;let k,L;const p=ed(t);try{if(n.shapeFlag&4){const D=i||s;k=Ri(d.call(D,D,u,r,m,f,h)),L=l}else{const D=e;k=Ri(D.length>1?D(r,{attrs:l,slots:a,emit:c}):D(r,null)),L=e.props?l:G6(l)}}catch(D){hc.length=0,sf(D,t,1),k=Ns(mi)}let I=k;if(L&&M!==!1){const D=Object.keys(L),{shapeFlag:x}=I;D.length&&x&7&&(o&&D.some(gw)&&(L=W6(L,o)),I=Br(I,L))}return n.dirs&&(I=Br(I),I.dirs=I.dirs?I.dirs.concat(n.dirs):n.dirs),n.transition&&(I.transition=n.transition),k=I,ed(p),k}const G6=t=>{let e;for(const n in t)(n==="class"||n==="style"||Vp(n))&&((e||(e={}))[n]=t[n]);return e},W6=(t,e)=>{const n={};for(const s in t)(!gw(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function Y6(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?o2(s,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let u=0;u<d.length;u++){const f=d[u];if(o[f]!==s[f]&&!of(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?o2(s,o,c):!0:!!o;return!1}function o2(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!of(n,r))return!0}return!1}function X6({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const Q6=t=>t.__isSuspense;function Z6(t,e){e&&e.pendingBranch?It(t)?e.effects.push(...t):e.effects.push(t):V6(t)}function J6(t,e){if(kn){let n=kn.provides;const s=kn.parent&&kn.parent.provides;s===n&&(n=kn.provides=Object.create(s)),n[t]=e}}function Vm(t,e,n=!1){const s=kn||Zs;if(s){const i=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&wt(e)?e.call(s.proxy):e}}const a2={};function qm(t,e,n){return kw(t,e,n)}function kw(t,e,{immediate:n,deep:s,flush:i,onTrack:r,onTrigger:o}=Gt){const a=kn;let l,c=!1,d=!1;if(ss(t)?(l=()=>t.value,c=z1(t)):La(t)?(l=()=>t,s=!0):It(t)?(d=!0,c=t.some(L=>La(L)||z1(L)),l=()=>t.map(L=>{if(ss(L))return L.value;if(La(L))return Ao(L);if(wt(L))return kr(L,a,2)})):wt(t)?e?l=()=>kr(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),ei(t,a,3,[f])}:l=Li,e&&s){const L=l;l=()=>Ao(L())}let u,f=L=>{u=k.onStop=()=>{kr(L,a,4)}};if(kc)return f=Li,e?n&&ei(e,a,3,[l(),d?[]:void 0,f]):l(),Li;let m=d?[]:a2;const h=()=>{if(!!k.active)if(e){const L=k.run();(s||c||(d?L.some((p,I)=>i2(p,m[I])):i2(L,m)))&&(u&&u(),ei(e,a,3,[L,m===a2?void 0:m,f]),m=L)}else k.run()};h.allowRecurse=!!e;let M;i==="sync"?M=h:i==="post"?M=()=>ps(h,a&&a.suspense):M=()=>H6(h);const k=new Np(l,M);return e?n?h():m=k.run():i==="post"?ps(k.run.bind(k),a&&a.suspense):k.run(),()=>{k.stop(),a&&a.scope&&qp(a.scope.effects,k)}}function eA(t,e,n){const s=this.proxy,i=js(t)?t.includes(".")?Mw(s,t):()=>s[t]:t.bind(s,s);let r;wt(e)?r=e:(r=e.handler,n=e);const o=kn;Ga(this);const a=kw(i,r.bind(s),n);return o?Ga(o):Do(),a}function Mw(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}function Ao(t,e){if(!as(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),ss(t))Ao(t.value,e);else if(It(t))for(let n=0;n<t.length;n++)Ao(t[n],e);else if(vw(t)||_w(t))t.forEach(n=>{Ao(n,e)});else if(ww(t))for(const n in t)Ao(t[n],e);return t}function tA(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Lw(()=>{t.isMounted=!0}),Dw(()=>{t.isUnmounting=!0}),t}const zs=[Function,Array],nA={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:zs,onEnter:zs,onAfterEnter:zs,onEnterCancelled:zs,onBeforeLeave:zs,onLeave:zs,onAfterLeave:zs,onLeaveCancelled:zs,onBeforeAppear:zs,onAppear:zs,onAfterAppear:zs,onAppearCancelled:zs},setup(t,{slots:e}){const n=VA(),s=tA();let i;return()=>{const r=e.default&&Ow(e.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const M of r)if(M.type!==mi){o=M;break}}const a=Ut(t),{mode:l}=a;if(s.isLeaving)return $m(o);const c=l2(o);if(!c)return $m(o);const d=Y1(c,a,s,n);X1(c,d);const u=n.subTree,f=u&&l2(u);let m=!1;const{getTransitionKey:h}=c.type;if(h){const M=h();i===void 0?i=M:M!==i&&(i=M,m=!0)}if(f&&f.type!==mi&&(!vo(c,f)||m)){const M=Y1(f,a,s,n);if(X1(f,M),l==="out-in")return s.isLeaving=!0,M.afterLeave=()=>{s.isLeaving=!1,n.update()},$m(o);l==="in-out"&&c.type!==mi&&(M.delayLeave=(k,L,p)=>{const I=xw(s,f);I[String(f.key)]=f,k._leaveCb=()=>{L(),k._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=p})}return o}}},sA=nA;function xw(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function Y1(t,e,n,s){const{appear:i,mode:r,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:f,onAfterLeave:m,onLeaveCancelled:h,onBeforeAppear:M,onAppear:k,onAfterAppear:L,onAppearCancelled:p}=e,I=String(t.key),D=xw(n,t),x=(A,T)=>{A&&ei(A,s,9,T)},B=(A,T)=>{const v=T[1];x(A,T),It(A)?A.every(w=>w.length<=1)&&v():A.length<=1&&v()},_={mode:r,persisted:o,beforeEnter(A){let T=a;if(!n.isMounted)if(i)T=M||a;else return;A._leaveCb&&A._leaveCb(!0);const v=D[I];v&&vo(t,v)&&v.el._leaveCb&&v.el._leaveCb(),x(T,[A])},enter(A){let T=l,v=c,w=d;if(!n.isMounted)if(i)T=k||l,v=L||c,w=p||d;else return;let b=!1;const y=A._enterCb=R=>{b||(b=!0,R?x(w,[A]):x(v,[A]),_.delayedLeave&&_.delayedLeave(),A._enterCb=void 0)};T?B(T,[A,y]):y()},leave(A,T){const v=String(t.key);if(A._enterCb&&A._enterCb(!0),n.isUnmounting)return T();x(u,[A]);let w=!1;const b=A._leaveCb=y=>{w||(w=!0,T(),y?x(h,[A]):x(m,[A]),A._leaveCb=void 0,D[v]===t&&delete D[v])};D[v]=t,f?B(f,[A,b]):b()},clone(A){return Y1(A,e,n,s)}};return _}function $m(t){if(lf(t))return t=Br(t),t.children=null,t}function l2(t){return lf(t)?t.children?t.children[0]:void 0:t}function X1(t,e){t.shapeFlag&6&&t.component?X1(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Ow(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===Xs?(o.patchFlag&128&&i++,s=s.concat(Ow(o.children,e,a))):(e||o.type!==mi)&&s.push(a!=null?Br(o,{key:a}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}const Bh=t=>!!t.type.__asyncLoader,lf=t=>t.type.__isKeepAlive;function iA(t,e){Nw(t,"a",e)}function rA(t,e){Nw(t,"da",e)}function Nw(t,e,n=kn){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(cf(e,s,n),n){let i=n.parent;for(;i&&i.parent;)lf(i.parent.vnode)&&oA(s,e,n,i),i=i.parent}}function oA(t,e,n,s){const i=cf(e,t,s,!0);Pw(()=>{qp(s[e],i)},n)}function cf(t,e,n=kn,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;pl(),Ga(n);const a=ei(e,n,t,o);return Do(),gl(),a});return s?i.unshift(r):i.push(r),r}}const cr=t=>(e,n=kn)=>(!kc||t==="sp")&&cf(t,e,n),aA=cr("bm"),Lw=cr("m"),lA=cr("bu"),cA=cr("u"),Dw=cr("bum"),Pw=cr("um"),uA=cr("sp"),hA=cr("rtg"),dA=cr("rtc");function fA(t,e=kn){cf("ec",t,e)}function Uh(t,e){const n=Zs;if(n===null)return t;const s=hf(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[o,a,l,c=Gt]=e[r];wt(o)&&(o={mounted:o,updated:o}),o.deep&&Ao(a),i.push({dir:o,instance:s,value:a,oldValue:void 0,arg:l,modifiers:c})}return t}function eo(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(pl(),ei(l,n,8,[t.el,a,t,e]),gl())}}const Fw="components";function mA(t,e){return gA(Fw,t,!0,e)||t}const pA=Symbol();function gA(t,e,n=!0,s=!1){const i=Zs||kn;if(i){const r=i.type;if(t===Fw){const a=GA(r,!1);if(a&&(a===e||a===Pi(e)||a===zp(Pi(e))))return r}const o=c2(i[t]||r[t],e)||c2(i.appContext[t],e);return!o&&s?r:o}}function c2(t,e){return t&&(t[e]||t[Pi(e)]||t[zp(Pi(e))])}function Bw(t,e,n,s){let i;const r=n&&n[s];if(It(t)||js(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,r&&r[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,r&&r[o])}else if(as(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,r&&r[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];i[a]=e(t[c],c,a,r&&r[a])}}else i=[];return n&&(n[s]=i),i}const Q1=t=>t?Qw(t)?hf(t)||t.proxy:Q1(t.parent):null,td=Us(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Q1(t.parent),$root:t=>Q1(t.root),$emit:t=>t.emit,$options:t=>jw(t),$forceUpdate:t=>t.f||(t.f=()=>Tw(t.update)),$nextTick:t=>t.n||(t.n=B6.bind(t.proxy)),$watch:t=>eA.bind(t)}),_A={get({_:t},e){const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(s!==Gt&&Ot(s,e))return o[e]=1,s[e];if(i!==Gt&&Ot(i,e))return o[e]=2,i[e];if((c=t.propsOptions[0])&&Ot(c,e))return o[e]=3,r[e];if(n!==Gt&&Ot(n,e))return o[e]=4,n[e];Z1&&(o[e]=0)}}const d=td[e];let u,f;if(d)return e==="$attrs"&&Bs(t,"get",e),d(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==Gt&&Ot(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,Ot(f,e))return f[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return i!==Gt&&Ot(i,e)?(i[e]=n,!0):s!==Gt&&Ot(s,e)?(s[e]=n,!0):Ot(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},o){let a;return!!n[o]||t!==Gt&&Ot(t,o)||e!==Gt&&Ot(e,o)||(a=r[0])&&Ot(a,o)||Ot(s,o)||Ot(td,o)||Ot(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ot(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Z1=!0;function vA(t){const e=jw(t),n=t.proxy,s=t.ctx;Z1=!1,e.beforeCreate&&u2(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:u,mounted:f,beforeUpdate:m,updated:h,activated:M,deactivated:k,beforeDestroy:L,beforeUnmount:p,destroyed:I,unmounted:D,render:x,renderTracked:B,renderTriggered:_,errorCaptured:A,serverPrefetch:T,expose:v,inheritAttrs:w,components:b,directives:y,filters:R}=e;if(c&&yA(c,s,null,t.appContext.config.unwrapInjectedRef),o)for(const W in o){const j=o[W];wt(j)&&(s[W]=j.bind(n))}if(i){const W=i.call(n,n);as(W)&&(t.data=Fp(W))}if(Z1=!0,r)for(const W in r){const j=r[W],z=wt(j)?j.bind(n,n):wt(j.get)?j.get.bind(n,n):Li,g=!wt(j)&&wt(j.set)?j.set.bind(n):Li,C=YA({get:z,set:g});Object.defineProperty(s,W,{enumerable:!0,configurable:!0,get:()=>C.value,set:te=>C.value=te})}if(a)for(const W in a)Uw(a[W],s,n,W);if(l){const W=wt(l)?l.call(n):l;Reflect.ownKeys(W).forEach(j=>{J6(j,W[j])})}d&&u2(d,t,"c");function U(W,j){It(j)?j.forEach(z=>W(z.bind(n))):j&&W(j.bind(n))}if(U(aA,u),U(Lw,f),U(lA,m),U(cA,h),U(iA,M),U(rA,k),U(fA,A),U(dA,B),U(hA,_),U(Dw,p),U(Pw,D),U(uA,T),It(v))if(v.length){const W=t.exposed||(t.exposed={});v.forEach(j=>{Object.defineProperty(W,j,{get:()=>n[j],set:z=>n[j]=z})})}else t.exposed||(t.exposed={});x&&t.render===Li&&(t.render=x),w!=null&&(t.inheritAttrs=w),b&&(t.components=b),y&&(t.directives=y)}function yA(t,e,n=Li,s=!1){It(t)&&(t=J1(t));for(const i in t){const r=t[i];let o;as(r)?"default"in r?o=Vm(r.from||i,r.default,!0):o=Vm(r.from||i):o=Vm(r),ss(o)&&s?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function u2(t,e,n){ei(It(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function Uw(t,e,n,s){const i=s.includes(".")?Mw(n,s):()=>n[s];if(js(t)){const r=e[t];wt(r)&&qm(i,r)}else if(wt(t))qm(i,t.bind(n));else if(as(t))if(It(t))t.forEach(r=>Uw(r,e,n,s));else{const r=wt(t.handler)?t.handler.bind(n):e[t.handler];wt(r)&&qm(i,r,t)}}function jw(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!i.length&&!n&&!s?l=e:(l={},i.length&&i.forEach(c=>nd(l,c,o,!0)),nd(l,e,o)),r.set(e,l),l}function nd(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&nd(t,r,n,!0),i&&i.forEach(o=>nd(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=bA[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const bA={data:h2,props:fo,emits:fo,methods:fo,computed:fo,beforeCreate:Jn,created:Jn,beforeMount:Jn,mounted:Jn,beforeUpdate:Jn,updated:Jn,beforeDestroy:Jn,beforeUnmount:Jn,destroyed:Jn,unmounted:Jn,activated:Jn,deactivated:Jn,errorCaptured:Jn,serverPrefetch:Jn,components:fo,directives:fo,watch:EA,provide:h2,inject:wA};function h2(t,e){return e?t?function(){return Us(wt(t)?t.call(this,this):t,wt(e)?e.call(this,this):e)}:e:t}function wA(t,e){return fo(J1(t),J1(e))}function J1(t){if(It(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Jn(t,e){return t?[...new Set([].concat(t,e))]:e}function fo(t,e){return t?Us(Us(Object.create(null),t),e):e}function EA(t,e){if(!t)return e;if(!e)return t;const n=Us(Object.create(null),t);for(const s in e)n[s]=Jn(t[s],e[s]);return n}function TA(t,e,n,s=!1){const i={},r={};K1(r,uf,1),t.propsDefaults=Object.create(null),Hw(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:y6(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function SA(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,a=Ut(i),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let u=0;u<d.length;u++){let f=d[u];if(of(t.emitsOptions,f))continue;const m=e[f];if(l)if(Ot(r,f))m!==r[f]&&(r[f]=m,c=!0);else{const h=Pi(f);i[h]=e0(l,a,h,m,t,!1)}else m!==r[f]&&(r[f]=m,c=!0)}}}else{Hw(t,e,i,r)&&(c=!0);let d;for(const u in a)(!e||!Ot(e,u)&&((d=nf(u))===u||!Ot(e,d)))&&(l?n&&(n[u]!==void 0||n[d]!==void 0)&&(i[u]=e0(l,a,u,void 0,t,!0)):delete i[u]);if(r!==a)for(const u in r)(!e||!Ot(e,u)&&!0)&&(delete r[u],c=!0)}c&&nr(t,"set","$attrs")}function Hw(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Fh(l))continue;const c=e[l];let d;i&&Ot(i,d=Pi(l))?!r||!r.includes(d)?n[d]=c:(a||(a={}))[d]=c:of(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Ut(n),c=a||Gt;for(let d=0;d<r.length;d++){const u=r[d];n[u]=e0(i,l,u,c[u],t,!Ot(c,u))}}return o}function e0(t,e,n,s,i,r){const o=t[n];if(o!=null){const a=Ot(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&wt(l)){const{propsDefaults:c}=i;n in c?s=c[n]:(Ga(i),s=c[n]=l.call(null,e),Do())}else s=l}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===nf(n))&&(s=!0))}return s}function Vw(t,e,n=!1){const s=e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},a=[];let l=!1;if(!wt(t)){const d=u=>{l=!0;const[f,m]=Vw(u,e,!0);Us(o,f),m&&a.push(...m)};!n&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!r&&!l)return s.set(t,Da),Da;if(It(r))for(let d=0;d<r.length;d++){const u=Pi(r[d]);d2(u)&&(o[u]=Gt)}else if(r)for(const d in r){const u=Pi(d);if(d2(u)){const f=r[d],m=o[u]=It(f)||wt(f)?{type:f}:f;if(m){const h=p2(Boolean,m.type),M=p2(String,m.type);m[0]=h>-1,m[1]=M<0||h<M,(h>-1||Ot(m,"default"))&&a.push(u)}}}const c=[o,a];return s.set(t,c),c}function d2(t){return t[0]!=="$"}function f2(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function m2(t,e){return f2(t)===f2(e)}function p2(t,e){return It(e)?e.findIndex(n=>m2(n,t)):wt(e)&&m2(e,t)?0:-1}const qw=t=>t[0]==="_"||t==="$stable",Gp=t=>It(t)?t.map(Ri):[Ri(t)],AA=(t,e,n)=>{if(e._n)return e;const s=K6((...i)=>Gp(e(...i)),n);return s._c=!1,s},$w=(t,e,n)=>{const s=t._ctx;for(const i in t){if(qw(i))continue;const r=t[i];if(wt(r))e[i]=AA(i,r,s);else if(r!=null){const o=Gp(r);e[i]=()=>o}}},zw=(t,e)=>{const n=Gp(e);t.slots.default=()=>n},RA=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Ut(e),K1(e,"_",n)):$w(e,t.slots={})}else t.slots={},e&&zw(t,e);K1(t.slots,uf,1)},CA=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=Gt;if(s.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(Us(i,e),!n&&a===1&&delete i._):(r=!e.$stable,$w(e,i)),o=e}else e&&(zw(t,e),o={default:1});if(r)for(const a in i)!qw(a)&&!(a in o)&&delete i[a]};function Kw(){return{app:null,config:{isNativeTag:M6,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let IA=0;function kA(t,e){return function(s,i=null){wt(s)||(s=Object.assign({},s)),i!=null&&!as(i)&&(i=null);const r=Kw(),o=new Set;let a=!1;const l=r.app={_uid:IA++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:QA,get config(){return r.config},set config(c){},use(c,...d){return o.has(c)||(c&&wt(c.install)?(o.add(c),c.install(l,...d)):wt(c)&&(o.add(c),c(l,...d))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,d){return d?(r.components[c]=d,l):r.components[c]},directive(c,d){return d?(r.directives[c]=d,l):r.directives[c]},mount(c,d,u){if(!a){const f=Ns(s,i);return f.appContext=r,d&&e?e(f,c):t(f,c,u),a=!0,l._container=c,c.__vue_app__=l,hf(f.component)||f.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,d){return r.provides[c]=d,l}};return l}}function t0(t,e,n,s,i=!1){if(It(t)){t.forEach((f,m)=>t0(f,e&&(It(e)?e[m]:e),n,s,i));return}if(Bh(s)&&!i)return;const r=s.shapeFlag&4?hf(s.component)||s.component.proxy:s.el,o=i?null:r,{i:a,r:l}=t,c=e&&e.r,d=a.refs===Gt?a.refs={}:a.refs,u=a.setupState;if(c!=null&&c!==l&&(js(c)?(d[c]=null,Ot(u,c)&&(u[c]=null)):ss(c)&&(c.value=null)),wt(l))kr(l,a,12,[o,d]);else{const f=js(l),m=ss(l);if(f||m){const h=()=>{if(t.f){const M=f?d[l]:l.value;i?It(M)&&qp(M,r):It(M)?M.includes(r)||M.push(r):f?(d[l]=[r],Ot(u,l)&&(u[l]=d[l])):(l.value=[r],t.k&&(d[t.k]=l.value))}else f?(d[l]=o,Ot(u,l)&&(u[l]=o)):m&&(l.value=o,t.k&&(d[t.k]=o))};o?(h.id=-1,ps(h,n)):h()}}}const ps=Z6;function MA(t){return xA(t)}function xA(t,e){const n=P6();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:f,setScopeId:m=Li,cloneNode:h,insertStaticContent:M}=t,k=(E,O,V,$=null,K=null,ne=null,le=!1,Q=null,ie=!!O.dynamicChildren)=>{if(E===O)return;E&&!vo(E,O)&&($=ze(E),se(E,K,ne,!0),E=null),O.patchFlag===-2&&(ie=!1,O.dynamicChildren=null);const{type:X,ref:ve,shapeFlag:de}=O;switch(X){case Wp:L(E,O,V,$);break;case mi:p(E,O,V,$);break;case zm:E==null&&I(O,V,$,le);break;case Xs:y(E,O,V,$,K,ne,le,Q,ie);break;default:de&1?B(E,O,V,$,K,ne,le,Q,ie):de&6?R(E,O,V,$,K,ne,le,Q,ie):(de&64||de&128)&&X.process(E,O,V,$,K,ne,le,Q,ie,we)}ve!=null&&K&&t0(ve,E&&E.ref,ne,O||E,!O)},L=(E,O,V,$)=>{if(E==null)s(O.el=a(O.children),V,$);else{const K=O.el=E.el;O.children!==E.children&&c(K,O.children)}},p=(E,O,V,$)=>{E==null?s(O.el=l(O.children||""),V,$):O.el=E.el},I=(E,O,V,$)=>{[E.el,E.anchor]=M(E.children,O,V,$,E.el,E.anchor)},D=({el:E,anchor:O},V,$)=>{let K;for(;E&&E!==O;)K=f(E),s(E,V,$),E=K;s(O,V,$)},x=({el:E,anchor:O})=>{let V;for(;E&&E!==O;)V=f(E),i(E),E=V;i(O)},B=(E,O,V,$,K,ne,le,Q,ie)=>{le=le||O.type==="svg",E==null?_(O,V,$,K,ne,le,Q,ie):v(E,O,K,ne,le,Q,ie)},_=(E,O,V,$,K,ne,le,Q)=>{let ie,X;const{type:ve,props:de,shapeFlag:ye,transition:Ie,patchFlag:De,dirs:ce}=E;if(E.el&&h!==void 0&&De===-1)ie=E.el=h(E.el);else{if(ie=E.el=o(E.type,ne,de&&de.is,de),ye&8?d(ie,E.children):ye&16&&T(E.children,ie,null,$,K,ne&&ve!=="foreignObject",le,Q),ce&&eo(E,null,$,"created"),de){for(const Z in de)Z!=="value"&&!Fh(Z)&&r(ie,Z,null,de[Z],ne,E.children,$,K,be);"value"in de&&r(ie,"value",null,de.value),(X=de.onVnodeBeforeMount)&&yi(X,$,E)}A(ie,E,E.scopeId,le,$)}ce&&eo(E,null,$,"beforeMount");const _e=(!K||K&&!K.pendingBranch)&&Ie&&!Ie.persisted;_e&&Ie.beforeEnter(ie),s(ie,O,V),((X=de&&de.onVnodeMounted)||_e||ce)&&ps(()=>{X&&yi(X,$,E),_e&&Ie.enter(ie),ce&&eo(E,null,$,"mounted")},K)},A=(E,O,V,$,K)=>{if(V&&m(E,V),$)for(let ne=0;ne<$.length;ne++)m(E,$[ne]);if(K){let ne=K.subTree;if(O===ne){const le=K.vnode;A(E,le,le.scopeId,le.slotScopeIds,K.parent)}}},T=(E,O,V,$,K,ne,le,Q,ie=0)=>{for(let X=ie;X<E.length;X++){const ve=E[X]=Q?Sr(E[X]):Ri(E[X]);k(null,ve,O,V,$,K,ne,le,Q)}},v=(E,O,V,$,K,ne,le)=>{const Q=O.el=E.el;let{patchFlag:ie,dynamicChildren:X,dirs:ve}=O;ie|=E.patchFlag&16;const de=E.props||Gt,ye=O.props||Gt;let Ie;V&&to(V,!1),(Ie=ye.onVnodeBeforeUpdate)&&yi(Ie,V,O,E),ve&&eo(O,E,V,"beforeUpdate"),V&&to(V,!0);const De=K&&O.type!=="foreignObject";if(X?w(E.dynamicChildren,X,Q,V,$,De,ne):le||z(E,O,Q,null,V,$,De,ne,!1),ie>0){if(ie&16)b(Q,O,de,ye,V,$,K);else if(ie&2&&de.class!==ye.class&&r(Q,"class",null,ye.class,K),ie&4&&r(Q,"style",de.style,ye.style,K),ie&8){const ce=O.dynamicProps;for(let _e=0;_e<ce.length;_e++){const Z=ce[_e],Me=de[Z],N=ye[Z];(N!==Me||Z==="value")&&r(Q,Z,Me,N,K,E.children,V,$,be)}}ie&1&&E.children!==O.children&&d(Q,O.children)}else!le&&X==null&&b(Q,O,de,ye,V,$,K);((Ie=ye.onVnodeUpdated)||ve)&&ps(()=>{Ie&&yi(Ie,V,O,E),ve&&eo(O,E,V,"updated")},$)},w=(E,O,V,$,K,ne,le)=>{for(let Q=0;Q<O.length;Q++){const ie=E[Q],X=O[Q],ve=ie.el&&(ie.type===Xs||!vo(ie,X)||ie.shapeFlag&70)?u(ie.el):V;k(ie,X,ve,null,$,K,ne,le,!0)}},b=(E,O,V,$,K,ne,le)=>{if(V!==$){for(const Q in $){if(Fh(Q))continue;const ie=$[Q],X=V[Q];ie!==X&&Q!=="value"&&r(E,Q,X,ie,le,O.children,K,ne,be)}if(V!==Gt)for(const Q in V)!Fh(Q)&&!(Q in $)&&r(E,Q,V[Q],null,le,O.children,K,ne,be);"value"in $&&r(E,"value",V.value,$.value)}},y=(E,O,V,$,K,ne,le,Q,ie)=>{const X=O.el=E?E.el:a(""),ve=O.anchor=E?E.anchor:a("");let{patchFlag:de,dynamicChildren:ye,slotScopeIds:Ie}=O;Ie&&(Q=Q?Q.concat(Ie):Ie),E==null?(s(X,V,$),s(ve,V,$),T(O.children,V,ve,K,ne,le,Q,ie)):de>0&&de&64&&ye&&E.dynamicChildren?(w(E.dynamicChildren,ye,V,K,ne,le,Q),(O.key!=null||K&&O===K.subTree)&&Gw(E,O,!0)):z(E,O,V,ve,K,ne,le,Q,ie)},R=(E,O,V,$,K,ne,le,Q,ie)=>{O.slotScopeIds=Q,E==null?O.shapeFlag&512?K.ctx.activate(O,V,$,le,ie):S(O,V,$,K,ne,le,ie):U(E,O,ie)},S=(E,O,V,$,K,ne,le)=>{const Q=E.component=HA(E,$,K);if(lf(E)&&(Q.ctx.renderer=we),qA(Q),Q.asyncDep){if(K&&K.registerDep(Q,W),!E.el){const ie=Q.subTree=Ns(mi);p(null,ie,O,V)}return}W(Q,E,O,V,K,ne,le)},U=(E,O,V)=>{const $=O.component=E.component;if(Y6(E,O,V))if($.asyncDep&&!$.asyncResolved){j($,O,V);return}else $.next=O,j6($.update),$.update();else O.el=E.el,$.vnode=O},W=(E,O,V,$,K,ne,le)=>{const Q=()=>{if(E.isMounted){let{next:ve,bu:de,u:ye,parent:Ie,vnode:De}=E,ce=ve,_e;to(E,!1),ve?(ve.el=De.el,j(E,ve,le)):ve=De,de&&jm(de),(_e=ve.props&&ve.props.onVnodeBeforeUpdate)&&yi(_e,Ie,ve,De),to(E,!0);const Z=Hm(E),Me=E.subTree;E.subTree=Z,k(Me,Z,u(Me.el),ze(Me),E,K,ne),ve.el=Z.el,ce===null&&X6(E,Z.el),ye&&ps(ye,K),(_e=ve.props&&ve.props.onVnodeUpdated)&&ps(()=>yi(_e,Ie,ve,De),K)}else{let ve;const{el:de,props:ye}=O,{bm:Ie,m:De,parent:ce}=E,_e=Bh(O);if(to(E,!1),Ie&&jm(Ie),!_e&&(ve=ye&&ye.onVnodeBeforeMount)&&yi(ve,ce,O),to(E,!0),de&&mt){const Z=()=>{E.subTree=Hm(E),mt(de,E.subTree,E,K,null)};_e?O.type.__asyncLoader().then(()=>!E.isUnmounted&&Z()):Z()}else{const Z=E.subTree=Hm(E);k(null,Z,V,$,E,K,ne),O.el=Z.el}if(De&&ps(De,K),!_e&&(ve=ye&&ye.onVnodeMounted)){const Z=O;ps(()=>yi(ve,ce,Z),K)}(O.shapeFlag&256||ce&&Bh(ce.vnode)&&ce.vnode.shapeFlag&256)&&E.a&&ps(E.a,K),E.isMounted=!0,O=V=$=null}},ie=E.effect=new Np(Q,()=>Tw(X),E.scope),X=E.update=()=>ie.run();X.id=E.uid,to(E,!0),X()},j=(E,O,V)=>{O.component=E;const $=E.vnode.props;E.vnode=O,E.next=null,SA(E,O.props,$,V),CA(E,O.children,V),pl(),rf(void 0,E.update),gl()},z=(E,O,V,$,K,ne,le,Q,ie=!1)=>{const X=E&&E.children,ve=E?E.shapeFlag:0,de=O.children,{patchFlag:ye,shapeFlag:Ie}=O;if(ye>0){if(ye&128){C(X,de,V,$,K,ne,le,Q,ie);return}else if(ye&256){g(X,de,V,$,K,ne,le,Q,ie);return}}Ie&8?(ve&16&&be(X,K,ne),de!==X&&d(V,de)):ve&16?Ie&16?C(X,de,V,$,K,ne,le,Q,ie):be(X,K,ne,!0):(ve&8&&d(V,""),Ie&16&&T(de,V,$,K,ne,le,Q,ie))},g=(E,O,V,$,K,ne,le,Q,ie)=>{E=E||Da,O=O||Da;const X=E.length,ve=O.length,de=Math.min(X,ve);let ye;for(ye=0;ye<de;ye++){const Ie=O[ye]=ie?Sr(O[ye]):Ri(O[ye]);k(E[ye],Ie,V,null,K,ne,le,Q,ie)}X>ve?be(E,K,ne,!0,!1,de):T(O,V,$,K,ne,le,Q,ie,de)},C=(E,O,V,$,K,ne,le,Q,ie)=>{let X=0;const ve=O.length;let de=E.length-1,ye=ve-1;for(;X<=de&&X<=ye;){const Ie=E[X],De=O[X]=ie?Sr(O[X]):Ri(O[X]);if(vo(Ie,De))k(Ie,De,V,null,K,ne,le,Q,ie);else break;X++}for(;X<=de&&X<=ye;){const Ie=E[de],De=O[ye]=ie?Sr(O[ye]):Ri(O[ye]);if(vo(Ie,De))k(Ie,De,V,null,K,ne,le,Q,ie);else break;de--,ye--}if(X>de){if(X<=ye){const Ie=ye+1,De=Ie<ve?O[Ie].el:$;for(;X<=ye;)k(null,O[X]=ie?Sr(O[X]):Ri(O[X]),V,De,K,ne,le,Q,ie),X++}}else if(X>ye)for(;X<=de;)se(E[X],K,ne,!0),X++;else{const Ie=X,De=X,ce=new Map;for(X=De;X<=ye;X++){const Y=O[X]=ie?Sr(O[X]):Ri(O[X]);Y.key!=null&&ce.set(Y.key,X)}let _e,Z=0;const Me=ye-De+1;let N=!1,F=0;const q=new Array(Me);for(X=0;X<Me;X++)q[X]=0;for(X=Ie;X<=de;X++){const Y=E[X];if(Z>=Me){se(Y,K,ne,!0);continue}let H;if(Y.key!=null)H=ce.get(Y.key);else for(_e=De;_e<=ye;_e++)if(q[_e-De]===0&&vo(Y,O[_e])){H=_e;break}H===void 0?se(Y,K,ne,!0):(q[H-De]=X+1,H>=F?F=H:N=!0,k(Y,O[H],V,null,K,ne,le,Q,ie),Z++)}const G=N?OA(q):Da;for(_e=G.length-1,X=Me-1;X>=0;X--){const Y=De+X,H=O[Y],ee=Y+1<ve?O[Y+1].el:$;q[X]===0?k(null,H,V,ee,K,ne,le,Q,ie):N&&(_e<0||X!==G[_e]?te(H,V,ee,2):_e--)}}},te=(E,O,V,$,K=null)=>{const{el:ne,type:le,transition:Q,children:ie,shapeFlag:X}=E;if(X&6){te(E.component.subTree,O,V,$);return}if(X&128){E.suspense.move(O,V,$);return}if(X&64){le.move(E,O,V,we);return}if(le===Xs){s(ne,O,V);for(let de=0;de<ie.length;de++)te(ie[de],O,V,$);s(E.anchor,O,V);return}if(le===zm){D(E,O,V);return}if($!==2&&X&1&&Q)if($===0)Q.beforeEnter(ne),s(ne,O,V),ps(()=>Q.enter(ne),K);else{const{leave:de,delayLeave:ye,afterLeave:Ie}=Q,De=()=>s(ne,O,V),ce=()=>{de(ne,()=>{De(),Ie&&Ie()})};ye?ye(ne,De,ce):ce()}else s(ne,O,V)},se=(E,O,V,$=!1,K=!1)=>{const{type:ne,props:le,ref:Q,children:ie,dynamicChildren:X,shapeFlag:ve,patchFlag:de,dirs:ye}=E;if(Q!=null&&t0(Q,null,V,E,!0),ve&256){O.ctx.deactivate(E);return}const Ie=ve&1&&ye,De=!Bh(E);let ce;if(De&&(ce=le&&le.onVnodeBeforeUnmount)&&yi(ce,O,E),ve&6)Oe(E.component,V,$);else{if(ve&128){E.suspense.unmount(V,$);return}Ie&&eo(E,null,O,"beforeUnmount"),ve&64?E.type.remove(E,O,V,K,we,$):X&&(ne!==Xs||de>0&&de&64)?be(X,O,V,!1,!0):(ne===Xs&&de&384||!K&&ve&16)&&be(ie,O,V),$&&Te(E)}(De&&(ce=le&&le.onVnodeUnmounted)||Ie)&&ps(()=>{ce&&yi(ce,O,E),Ie&&eo(E,null,O,"unmounted")},V)},Te=E=>{const{type:O,el:V,anchor:$,transition:K}=E;if(O===Xs){ke(V,$);return}if(O===zm){x(E);return}const ne=()=>{i(V),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(E.shapeFlag&1&&K&&!K.persisted){const{leave:le,delayLeave:Q}=K,ie=()=>le(V,ne);Q?Q(E.el,ne,ie):ie()}else ne()},ke=(E,O)=>{let V;for(;E!==O;)V=f(E),i(E),E=V;i(O)},Oe=(E,O,V)=>{const{bum:$,scope:K,update:ne,subTree:le,um:Q}=E;$&&jm($),K.stop(),ne&&(ne.active=!1,se(le,E,O,V)),Q&&ps(Q,O),ps(()=>{E.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},be=(E,O,V,$=!1,K=!1,ne=0)=>{for(let le=ne;le<E.length;le++)se(E[le],O,V,$,K)},ze=E=>E.shapeFlag&6?ze(E.component.subTree):E.shapeFlag&128?E.suspense.next():f(E.anchor||E.el),Be=(E,O,V)=>{E==null?O._vnode&&se(O._vnode,null,null,!0):k(O._vnode||null,E,O,null,null,null,V),Rw(),O._vnode=E},we={p:k,um:se,m:te,r:Te,mt:S,mc:T,pc:z,pbc:w,n:ze,o:t};let Xe,mt;return e&&([Xe,mt]=e(we)),{render:Be,hydrate:Xe,createApp:kA(Be,Xe)}}function to({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Gw(t,e,n=!1){const s=t.children,i=e.children;if(It(s)&&It(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Sr(i[r]),a.el=o.el),n||Gw(o,a))}}function OA(t){const e=t.slice(),n=[0];let s,i,r,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(i=n[n.length-1],t[i]<c){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}const NA=t=>t.__isTeleport,Xs=Symbol(void 0),Wp=Symbol(void 0),mi=Symbol(void 0),zm=Symbol(void 0),hc=[];let hi=null;function ys(t=!1){hc.push(hi=t?null:[])}function LA(){hc.pop(),hi=hc[hc.length-1]||null}let Ic=1;function g2(t){Ic+=t}function Ww(t){return t.dynamicChildren=Ic>0?hi||Da:null,LA(),Ic>0&&hi&&hi.push(t),t}function Qs(t,e,n,s,i,r){return Ww(Sn(t,e,n,s,i,r,!0))}function Yw(t,e,n,s,i){return Ww(Ns(t,e,n,s,i,!0))}function n0(t){return t?t.__v_isVNode===!0:!1}function vo(t,e){return t.type===e.type&&t.key===e.key}const uf="__vInternal",Xw=({key:t})=>t!=null?t:null,jh=({ref:t,ref_key:e,ref_for:n})=>t!=null?js(t)||ss(t)||wt(t)?{i:Zs,r:t,k:e,f:!!n}:t:null;function Sn(t,e=null,n=null,s=0,i=null,r=t===Xs?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Xw(e),ref:e&&jh(e),scopeId:af,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null};return a?(Yp(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=js(n)?8:16),Ic>0&&!o&&hi&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&hi.push(l),l}const Ns=DA;function DA(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===pA)&&(t=mi),n0(t)){const a=Br(t,e,!0);return n&&Yp(a,n),Ic>0&&!r&&hi&&(a.shapeFlag&6?hi[hi.indexOf(t)]=a:hi.push(a)),a.patchFlag|=-2,a}if(WA(t)&&(t=t.__vccOpts),e){e=PA(e);let{class:a,style:l}=e;a&&!js(a)&&(e.class=Ka(a)),as(l)&&(hw(l)&&!It(l)&&(l=Us({},l)),e.style=Hp(l))}const o=js(t)?1:Q6(t)?128:NA(t)?64:as(t)?4:wt(t)?2:0;return Sn(t,e,n,s,i,o,r,!0)}function PA(t){return t?hw(t)||uf in t?Us({},t):t:null}function Br(t,e,n=!1){const{props:s,ref:i,patchFlag:r,children:o}=t,a=e?BA(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Xw(a),ref:e&&e.ref?n&&i?It(i)?i.concat(jh(e)):[i,jh(e)]:jh(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Xs?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Br(t.ssContent),ssFallback:t.ssFallback&&Br(t.ssFallback),el:t.el,anchor:t.anchor}}function FA(t=" ",e=0){return Ns(Wp,null,t,e)}function Ro(t="",e=!1){return e?(ys(),Yw(mi,null,t)):Ns(mi,null,t)}function Ri(t){return t==null||typeof t=="boolean"?Ns(mi):It(t)?Ns(Xs,null,t.slice()):typeof t=="object"?Sr(t):Ns(Wp,null,String(t))}function Sr(t){return t.el===null||t.memo?t:Br(t)}function Yp(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(It(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Yp(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(uf in e)?e._ctx=Zs:i===3&&Zs&&(Zs.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else wt(e)?(e={default:e,_ctx:Zs},n=32):(e=String(e),s&64?(n=16,e=[FA(e)]):n=8);t.children=e,t.shapeFlag|=n}function BA(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=Ka([e.class,s.class]));else if(i==="style")e.style=Hp([e.style,s.style]);else if(Vp(i)){const r=e[i],o=s[i];o&&r!==o&&!(It(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function yi(t,e,n,s=null){ei(t,e,7,[n,s])}const UA=Kw();let jA=0;function HA(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||UA,r={uid:jA++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new KS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Vw(s,i),emitsOptions:Iw(s,i),emit:null,emitted:null,propsDefaults:Gt,inheritAttrs:s.inheritAttrs,ctx:Gt,data:Gt,props:Gt,attrs:Gt,slots:Gt,refs:Gt,setupState:Gt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=q6.bind(null,r),t.ce&&t.ce(r),r}let kn=null;const VA=()=>kn||Zs,Ga=t=>{kn=t,t.scope.on()},Do=()=>{kn&&kn.scope.off(),kn=null};function Qw(t){return t.vnode.shapeFlag&4}let kc=!1;function qA(t,e=!1){kc=e;const{props:n,children:s}=t.vnode,i=Qw(t);TA(t,n,i,e),RA(t,s);const r=i?$A(t,e):void 0;return kc=!1,r}function $A(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=dw(new Proxy(t.ctx,_A));const{setup:s}=n;if(s){const i=t.setupContext=s.length>1?KA(t):null;Ga(t),pl();const r=kr(s,t,0,[t.props,i]);if(gl(),Do(),yw(r)){if(r.then(Do,Do),e)return r.then(o=>{_2(t,o,e)}).catch(o=>{sf(o,t,0)});t.asyncDep=r}else _2(t,r,e)}else Zw(t,e)}function _2(t,e,n){wt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:as(e)&&(t.setupState=fw(e)),Zw(t,n)}let v2;function Zw(t,e,n){const s=t.type;if(!t.render){if(!e&&v2&&!s.render){const i=s.template;if(i){const{isCustomElement:r,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=s,c=Us(Us({isCustomElement:r,delimiters:a},o),l);s.render=v2(i,c)}}t.render=s.render||Li}Ga(t),pl(),vA(t),gl(),Do()}function zA(t){return new Proxy(t.attrs,{get(e,n){return Bs(t,"get","$attrs"),e[n]}})}function KA(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=zA(t))},slots:t.slots,emit:t.emit,expose:e}}function hf(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(fw(dw(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in td)return td[n](t)}}))}function GA(t,e=!0){return wt(t)?t.displayName||t.name:t.name||e&&t.__name}function WA(t){return wt(t)&&"__vccOpts"in t}const YA=(t,e)=>A6(t,e,kc);function XA(t,e,n){const s=arguments.length;return s===2?as(e)&&!It(e)?n0(e)?Ns(t,null,[e]):Ns(t,e):Ns(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&n0(n)&&(n=[n]),Ns(t,e,n))}const QA="3.2.37";function ZA(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const JA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",eR=ZA(JA);function Jw(t){return!!t||t===""}function tR(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=df(t[s],e[s]);return n}function df(t,e){if(t===e)return!0;let n=y2(t),s=y2(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=b2(t),s=b2(e),n||s)return t===e;if(n=Vo(t),s=Vo(e),n||s)return n&&s?tR(t,e):!1;if(n=w2(t),s=w2(e),n||s){if(!n||!s)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!df(t[o],e[o]))return!1}}return String(t)===String(e)}function nR(t,e){return t.findIndex(n=>df(n,e))}const sR=/^on[^a-z]/,iR=t=>sR.test(t),rR=t=>t.startsWith("onUpdate:"),e4=Object.assign,Vo=Array.isArray,t4=t=>s4(t)==="[object Set]",y2=t=>s4(t)==="[object Date]",n4=t=>typeof t=="function",sd=t=>typeof t=="string",b2=t=>typeof t=="symbol",w2=t=>t!==null&&typeof t=="object",oR=Object.prototype.toString,s4=t=>oR.call(t),i4=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},aR=/\B([A-Z])/g,r4=i4(t=>t.replace(aR,"-$1").toLowerCase()),lR=i4(t=>t.charAt(0).toUpperCase()+t.slice(1)),cR=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},s0=t=>{const e=parseFloat(t);return isNaN(e)?t:e},uR="http://www.w3.org/2000/svg",yo=typeof document!="undefined"?document:null,E2=yo&&yo.createElement("template"),hR={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e?yo.createElementNS(uR,t):yo.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>yo.createTextNode(t),createComment:t=>yo.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>yo.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{E2.innerHTML=s?`<svg>${t}</svg>`:t;const a=E2.content;if(s){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function dR(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function fR(t,e,n){const s=t.style,i=sd(n);if(n&&!i){for(const r in n)i0(s,r,n[r]);if(e&&!sd(e))for(const r in e)n[r]==null&&i0(s,r,"")}else{const r=s.display;i?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=r)}}const T2=/\s*!important$/;function i0(t,e,n){if(Vo(n))n.forEach(s=>i0(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=mR(t,e);T2.test(n)?t.setProperty(r4(s),n.replace(T2,""),"important"):t[s]=n}}const S2=["Webkit","Moz","ms"],Km={};function mR(t,e){const n=Km[e];if(n)return n;let s=Pi(e);if(s!=="filter"&&s in t)return Km[e]=s;s=lR(s);for(let i=0;i<S2.length;i++){const r=S2[i]+s;if(r in t)return Km[e]=r}return e}const A2="http://www.w3.org/1999/xlink";function pR(t,e,n,s,i){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(A2,e.slice(6,e.length)):t.setAttributeNS(A2,e,n);else{const r=eR(e);n==null||r&&!Jw(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function gR(t,e,n,s,i,r,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,i,r),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n==null?"":n;(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=Jw(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[o4,_R]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let r0=0;const vR=Promise.resolve(),yR=()=>{r0=0},bR=()=>r0||(vR.then(yR),r0=o4());function bo(t,e,n,s){t.addEventListener(e,n,s)}function wR(t,e,n,s){t.removeEventListener(e,n,s)}function ER(t,e,n,s,i=null){const r=t._vei||(t._vei={}),o=r[e];if(s&&o)o.value=s;else{const[a,l]=TR(e);if(s){const c=r[e]=SR(s,i);bo(t,a,c,l)}else o&&(wR(t,a,o,l),r[e]=void 0)}}const R2=/(?:Once|Passive|Capture)$/;function TR(t){let e;if(R2.test(t)){e={};let n;for(;n=t.match(R2);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r4(t.slice(2)),e]}function SR(t,e){const n=s=>{const i=s.timeStamp||o4();(_R||i>=n.attached-1)&&ei(AR(s,n.value),e,5,[s])};return n.value=t,n.attached=bR(),n}function AR(t,e){if(Vo(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const C2=/^on[a-z]/,RR=(t,e,n,s,i=!1,r,o,a,l)=>{e==="class"?dR(t,s,i):e==="style"?fR(t,n,s):iR(e)?rR(e)||ER(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):CR(t,e,s,i))?gR(t,e,s,r,o,a,l):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),pR(t,e,s,i))};function CR(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&C2.test(e)&&n4(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||C2.test(e)&&sd(n)?!1:e in t}const IR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};sA.props;const id=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Vo(e)?n=>cR(e,n):e};function kR(t){t.target.composing=!0}function I2(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const k2={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t._assign=id(i);const r=s||i.props&&i.props.type==="number";bo(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=s0(a)),t._assign(a)}),n&&bo(t,"change",()=>{t.value=t.value.trim()}),e||(bo(t,"compositionstart",kR),bo(t,"compositionend",I2),bo(t,"change",I2))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:i}},r){if(t._assign=id(r),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(i||t.type==="number")&&s0(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},a4={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const i=t4(e);bo(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?s0(rd(o)):rd(o));t._assign(t.multiple?i?new Set(r):r:r[0])}),t._assign=id(s)},mounted(t,{value:e}){M2(t,e)},beforeUpdate(t,e,n){t._assign=id(n)},updated(t,{value:e}){M2(t,e)}};function M2(t,e){const n=t.multiple;if(!(n&&!Vo(e)&&!t4(e))){for(let s=0,i=t.options.length;s<i;s++){const r=t.options[s],o=rd(r);if(n)Vo(e)?r.selected=nR(e,o)>-1:r.selected=e.has(o);else if(df(rd(r),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function rd(t){return"_value"in t?t._value:t.value}const MR=["ctrl","shift","alt","meta"],xR={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>MR.some(n=>t[`${n}Key`]&&!e.includes(n))},Gm=(t,e)=>(n,...s)=>{for(let i=0;i<e.length;i++){const r=xR[e[i]];if(r&&r(n,e))return}return t(n,...s)},OR=e4({patchProp:RR},hR);let x2;function NR(){return x2||(x2=MA(OR))}const LR=(...t)=>{const e=NR().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=DR(s);if(!i)return;const r=e._component;!n4(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.innerHTML="";const o=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function DR(t){return sd(t)?document.querySelector(t):t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue=function(t,e){if(!t)throw _l(e)},_l=function(t){return new Error("Firebase Database ("+l4.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},PR=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Xp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=r>>2,u=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),s.push(n[d],n[u],n[f],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c4(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const u=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||a==null||c==null||u==null)throw Error();const f=r<<2|a>>4;if(s.push(f),c!==64){const m=a<<4&240|c>>2;if(s.push(m),u!==64){const h=c<<6&192|u;s.push(h)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},FR=function(t){const e=c4(t);return Xp.encodeByteArray(e,!0)},O2=function(t){try{return Xp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(t){return u4(void 0,t)}function u4(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!UR(n)||(t[n]=u4(t[n],e[n]));return t}function UR(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qp(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ff())}function jR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function h4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HR(){return ff().indexOf("Electron/")>=0}function VR(){const t=ff();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qR(){return ff().indexOf("MSAppHost/")>=0}function d4(){return l4.NODE_ADMIN===!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="FirebaseError";class mf extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=$R,Object.setPrototypeOf(this,mf.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f4.prototype.create)}}class f4{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?zR(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new mf(i,a,s)}}function zR(t,e){return t.replace(KR,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const KR=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(t){return JSON.parse(t)}function Mn(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=Mc(O2(r[0])||""),n=Mc(O2(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},GR=function(t){const e=m4(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},WR=function(t){const e=m4(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Wa(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function o0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function od(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function a0(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(N2(r)&&N2(o)){if(!a0(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function N2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let u=0;u<16;u++)s[u]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let u=0;u<16;u++)s[u]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let u=16;u<80;u++){const f=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=(f<<1|f>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,d;for(let u=0;u<80;u++){u<40?u<20?(c=a^r&(o^a),d=1518500249):(c=r^o^a,d=1859775393):u<60?(c=r&o|a&(r|o),d=2400959708):(c=r^o^a,d=3395469782);const f=(i<<5|i>>>27)+c+l+d+s[u]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=f}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function Ya(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,Ue(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},pf=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t){return t&&t._delegate?t._delegate:t}class vl{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new qi;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eC(e))try{this.getOrInitializeService({instanceIdentifier:mo})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mo){return this.instances.has(e)}getOptions(e=mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:JR(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=mo){return this.component?this.component.multipleInstances?e:mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JR(t){return t===mo?void 0:t}function eC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ZR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kt||(kt={}));const nC={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},sC=kt.INFO,iC={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},rC=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=iC[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zp{constructor(e){this.name=e,this._logLevel=sC,this._logHandler=rC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aC(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function aC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const l0="@firebase/app",L2="0.7.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp=new Zp("@firebase/app"),lC="@firebase/app-compat",cC="@firebase/analytics-compat",uC="@firebase/analytics",hC="@firebase/app-check-compat",dC="@firebase/app-check",fC="@firebase/auth",mC="@firebase/auth-compat",pC="@firebase/database",gC="@firebase/database-compat",_C="@firebase/functions",vC="@firebase/functions-compat",yC="@firebase/installations",bC="@firebase/installations-compat",wC="@firebase/messaging",EC="@firebase/messaging-compat",TC="@firebase/performance",SC="@firebase/performance-compat",AC="@firebase/remote-config",RC="@firebase/remote-config-compat",CC="@firebase/storage",IC="@firebase/storage-compat",kC="@firebase/firestore",MC="@firebase/firestore-compat",xC="firebase",OC="9.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4="[DEFAULT]",NC={[l0]:"fire-core",[lC]:"fire-core-compat",[uC]:"fire-analytics",[cC]:"fire-analytics-compat",[dC]:"fire-app-check",[hC]:"fire-app-check-compat",[fC]:"fire-auth",[mC]:"fire-auth-compat",[pC]:"fire-rtdb",[gC]:"fire-rtdb-compat",[_C]:"fire-fn",[vC]:"fire-fn-compat",[yC]:"fire-iid",[bC]:"fire-iid-compat",[wC]:"fire-fcm",[EC]:"fire-fcm-compat",[TC]:"fire-perf",[SC]:"fire-perf-compat",[AC]:"fire-rc",[RC]:"fire-rc-compat",[CC]:"fire-gcs",[IC]:"fire-gcs-compat",[kC]:"fire-fst",[MC]:"fire-fst-compat","fire-js":"fire-js",[xC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad=new Map,c0=new Map;function LC(t,e){try{t.container.addComponent(e)}catch(n){Jp.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mu(t){const e=t.name;if(c0.has(e))return Jp.debug(`There were multiple attempts to register component ${e}.`),!1;c0.set(e,t);for(const n of ad.values())LC(n,t);return!0}function eg(t,e){return t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function."},ld=new f4("app","Firebase",DC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new vl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ld.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg=OC;function FC(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:p4,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw ld.create("bad-app-name",{appName:String(s)});const i=ad.get(s);if(i){if(a0(t,i.options)&&a0(n,i.config))return i;throw ld.create("duplicate-app",{appName:s})}const r=new tC(s);for(const a of c0.values())r.addComponent(a);const o=new PC(t,n,r);return ad.set(s,o),o}function ng(t=p4){const e=ad.get(t);if(!e)throw ld.create("no-app",{appName:t});return e}function Di(t,e,n){var s;let i=(s=NC[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jp.warn(a.join(" "));return}mu(new vl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){mu(new vl("platform-logger",e=>new oC(e),"PRIVATE")),Di(l0,L2,t),Di(l0,L2,"esm2017"),Di("fire-js","")}BC("");var UC="firebase",jC="9.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Di(UC,jC,"app");const D2="@firebase/database",P2="0.12.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g4="";function HC(t){g4=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Mn(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Mc(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Ui(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new VC(e)}}catch{}return new qC},Co=_4("localStorage"),u0=_4("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new Zp("@firebase/database"),$C=function(){let t=1;return function(){return t++}}(),v4=function(t){const e=QR(t),n=new XR;n.update(e);const s=n.digest();return Xp.encodeByteArray(s)},pu=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=pu.apply(null,s):typeof s=="object"?e+=Mn(s):e+=s,e+=" "}return e};let Po=null,F2=!0;const zC=function(t,e){Ue(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Pa.logLevel=kt.VERBOSE,Po=Pa.log.bind(Pa),e&&u0.set("logging_enabled",!0)):typeof t=="function"?Po=t:(Po=null,u0.remove("logging_enabled"))},Ln=function(...t){if(F2===!0&&(F2=!1,Po===null&&u0.get("logging_enabled")===!0&&zC(!0)),Po){const e=pu.apply(null,t);Po(e)}},gu=function(t){return function(...e){Ln(t,...e)}},h0=function(...t){const e="FIREBASE INTERNAL ERROR: "+pu(...t);Pa.error(e)},qo=function(...t){const e=`FIREBASE FATAL ERROR: ${pu(...t)}`;throw Pa.error(e),new Error(e)},Ss=function(...t){const e="FIREBASE WARNING: "+pu(...t);Pa.warn(e)},KC=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ss("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},gf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},GC=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Xa="[MIN_NAME]",$o="[MAX_NAME]",aa=function(t,e){if(t===e)return 0;if(t===Xa||e===$o)return-1;if(e===Xa||t===$o)return 1;{const n=B2(t),s=B2(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},WC=function(t,e){return t===e?0:t<e?-1:1},Ul=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Mn(e))},sg=function(t){if(typeof t!="object"||t===null)return Mn(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=Mn(e[s]),n+=":",n+=sg(t[e[s]]);return n+="}",n},y4=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Gn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const b4=function(t){Ue(!gf(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,a,l;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const d=c.join("");let u="";for(l=0;l<64;l+=8){let f=parseInt(d.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),u=u+f}return u.toLowerCase()},YC=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},XC=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function QC(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const ZC=new RegExp("^-?(0*)\\d{1,10}$"),JC=-2147483648,e7=2147483647,B2=function(t){if(ZC.test(t)){const e=Number(t);if(e>=JC&&e<=e7)return e}return null},yl=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ss("Exception was thrown by user callback.",n),e},Math.floor(0))}},t7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},dc=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ss(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s7{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ln("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ss(e)}}class d0{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}d0.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="5",w4="v",E4="s",T4="r",S4="f",A4=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,R4="ls",i7="p",f0="ac",C4="websocket",I4="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e,n,s,i,r=!1,o="",a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Co.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Co.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function o7(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function k4(t,e,n){Ue(typeof e=="string","typeof type must == string"),Ue(typeof n=="object","typeof params must == object");let s;if(e===C4)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===I4)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);o7(t)&&(n.ns=t.namespace);const i=[];return Gn(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a7{constructor(){this.counters_={}}incrementCounter(e,n=1){Ui(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return BR(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm={},Ym={};function rg(t){const e=t.toString();return Wm[e]||(Wm[e]=new a7),Wm[e]}function l7(t,e){const n=t.toString();return Ym[n]||(Ym[n]=e()),Ym[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c7{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&yl(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="start",u7="close",h7="pLPCommand",d7="pRTLPCB",M4="id",x4="pw",O4="ser",f7="cb",m7="seg",p7="ts",g7="d",_7="dframe",N4=1870,L4=30,v7=N4-L4,y7=25e3,b7=3e4;class ka{constructor(e,n,s,i,r,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=gu(e),this.stats_=rg(n),this.urlFn=l=>(this.appCheckToken&&(l[f0]=this.appCheckToken),k4(n,I4,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new c7(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(b7)),GC(()=>{if(this.isClosed_)return;this.scriptTagHolder=new og((...r)=>{const[o,a,l,c,d]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===U2)this.id=a,this.password=l;else if(o===u7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[U2]="t",s[O4]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[f7]=this.scriptTagHolder.uniqueCallbackIdentifier),s[w4]=ig,this.transportSessionId&&(s[E4]=this.transportSessionId),this.lastSessionId&&(s[R4]=this.lastSessionId),this.applicationId&&(s[i7]=this.applicationId),this.appCheckToken&&(s[f0]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&A4.test(location.hostname)&&(s[T4]=S4);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ka.forceAllow_=!0}static forceDisallow(){ka.forceDisallow_=!0}static isAvailable(){return ka.forceAllow_?!0:!ka.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!YC()&&!XC()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Mn(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=FR(n),i=y4(s,v7);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[_7]="t",s[M4]=e,s[x4]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Mn(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class og{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$C(),window[h7+this.uniqueCallbackIdentifier]=e,window[d7+this.uniqueCallbackIdentifier]=n,this.myIFrame=og.createIFrame_();let r="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;r='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ln("frame writing exception"),a.stack&&Ln(a.stack),Ln(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ln("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[M4]=this.myID,e[x4]=this.myPW,e[O4]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+L4+s.length<=N4;){const o=this.pendingSegs.shift();s=s+"&"+m7+i+"="+o.seg+"&"+p7+i+"="+o.ts+"&"+g7+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(y7)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Ln("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=16384,E7=45e3;let cd=null;typeof MozWebSocket!="undefined"?cd=MozWebSocket:typeof WebSocket!="undefined"&&(cd=WebSocket);class ci{constructor(e,n,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=gu(this.connId),this.stats_=rg(n),this.connURL=ci.connectionURL_(n,o,a,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i){const r={};return r[w4]=ig,typeof location!="undefined"&&location.hostname&&A4.test(location.hostname)&&(r[T4]=S4),n&&(r[E4]=n),s&&(r[R4]=s),i&&(r[f0]=i),k4(e,C4,r)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Co.set("previous_websocket_failure",!0);try{if(!d4()){const s={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new cd(this.connURL,[],s)}}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){ci.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&cd!==null&&!ci.forceDisallow_}static previouslyFailed(){return Co.isInMemoryStorage||Co.get("previous_websocket_failure")===!0}markConnectionHealthy(){Co.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Mc(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Ue(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=Mn(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=y4(n,w7);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(E7))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ci.responsesRequiredToBeHealthy=2;ci.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ka,ci]}initTransports_(e){const n=ci&&ci.isAvailable();let s=n&&!ci.previouslyFailed();if(e.webSocketOnly&&(n||Ss("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[ci];else{const i=this.transports_=[];for(const r of ag.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=6e4,S7=5e3,A7=10*1024,R7=100*1024,Xm="t",j2="d",C7="s",H2="r",I7="e",V2="o",q2="a",$2="n",z2="p",k7="h";class M7{constructor(e,n,s,i,r,o,a,l,c,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=gu("c:"+this.id+":"),this.transportManager_=new ag(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=dc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>R7?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>A7?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Xm in e){const n=e[Xm];n===q2?this.upgradeIfSecondaryHealthy_():n===H2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===V2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Ul("t",e),s=Ul("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:z2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:q2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:$2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Ul("t",e),s=Ul("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Ul(Xm,e);if(j2 in e){const s=e[j2];if(n===k7)this.onHandshake_(s);else if(n===$2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===C7?this.onConnectionShutdown_(s):n===H2?this.onReset_(s):n===I7?h0("Server Error: "+s):n===V2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):h0("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),ig!==s&&Ss("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),dc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(T7))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):dc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(S7))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:z2,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Co.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e){this.allowedEvents_=e,this.listeners_={},Ue(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){Ue(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud extends P4{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Qp()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ud}getInitialEvent(e){return Ue(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=32,G2=768;class jt{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function xt(){return new jt("")}function _t(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ur(t){return t.pieces_.length-t.pieceNum_}function Wt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new jt(t.pieces_,e)}function lg(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function x7(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function xc(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function F4(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new jt(e,0)}function pn(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof jt)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new jt(n,0)}function vt(t){return t.pieceNum_>=t.pieces_.length}function Es(t,e){const n=_t(t),s=_t(e);if(n===null)return e;if(n===s)return Es(Wt(t),Wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function O7(t,e){const n=xc(t,0),s=xc(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=aa(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function cg(t,e){if(Ur(t)!==Ur(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Js(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Ur(t)>Ur(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class N7{constructor(e,n){this.errorPrefix_=n,this.parts_=xc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=pf(this.parts_[s]);B4(this)}}function L7(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=pf(e),B4(t)}function D7(t){const e=t.parts_.pop();t.byteLength_-=pf(e),t.parts_.length>0&&(t.byteLength_-=1)}function B4(t){if(t.byteLength_>G2)throw new Error(t.errorPrefix_+"has a key path longer than "+G2+" bytes ("+t.byteLength_+").");if(t.parts_.length>K2)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+K2+") or object contains a cycle "+po(t))}function po(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug extends P4{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new ug}getInitialEvent(e){return Ue(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=1e3,P7=60*5*1e3,F7=3*1e3,W2=30*1e3,B7=1.3,U7=3e4,j7="server_kill",Y2=3;class Yi extends D4{constructor(e,n,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Yi.nextPersistentConnectionId_++,this.log_=gu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=jl,this.maxReconnectDelay_=P7,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!d4())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ug.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ud.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(Mn(r)),Ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new qi,s={p:e._path.toString(),q:e._queryObject},i={action:"g",request:s,onComplete:o=>{const a=o.d;o.s==="ok"?(this.onDataUpdate_(s.p,a,!1,null),n.resolve(a)):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const o=this.outstandingGets_[r];o===void 0||i!==o||(delete this.outstandingGets_[r],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),this.log_("get "+r+" timed out on connection"),n.reject(new Error("Client is offline.")))},F7),this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),Ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ue(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;Yi.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Ui(e,"w")){const s=Wa(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ss(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||WR(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=W2)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=GR(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Mn(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):h0("Unrecognized action received from server: "+Mn(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=jl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=jl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>U7&&(this.reconnectDelay_=jl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*B7)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Yi.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(u){Ue(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:l,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?Ln("getToken() completed but was canceled"):(Ln("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=f&&f.token,a=new M7(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Ss(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(j7)},r))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&Ss(u),l())}}}interrupt(e){Ln("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ln("Resuming connection for reason: "+e),delete this.interruptReasons_[e],o0(this.interruptReasons_)&&(this.reconnectDelay_=jl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>sg(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new jt(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){Ln("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Y2&&(this.reconnectDelay_=W2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ln("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Y2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+g4.replace(/\./g,"-")]=1,Qp()?e["framework.cordova"]=1:h4()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ud.getInstance().currentlyOnline();return o0(this.interruptReasons_)&&e}}Yi.nextPersistentConnectionId_=0;Yi.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new yt(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new yt(Xa,e),i=new yt(Xa,n);return this.compare(s,i)!==0}minPost(){return yt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ah;class U4 extends _f{static get __EMPTY_NODE(){return ah}static set __EMPTY_NODE(e){ah=e}compare(e,n){return aa(e.name,n.name)}isDefinedOn(e){throw _l("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return yt.MIN}maxPost(){return new yt($o,ah)}makePost(e,n){return Ue(typeof e=="string","KeyIndex indexValue must always be a string."),new yt(e,ah)}toString(){return".key"}}const Fa=new U4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class In{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s!=null?s:In.RED,this.left=i!=null?i:Ts.EMPTY_NODE,this.right=r!=null?r:Ts.EMPTY_NODE}copy(e,n,s,i,r){return new In(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,i!=null?i:this.left,r!=null?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ts.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Ts.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,In.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,In.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}In.RED=!0;In.BLACK=!1;class H7{copy(e,n,s,i,r){return this}insert(e,n,s){return new In(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ts{constructor(e,n=Ts.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ts(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,In.BLACK,null,null))}remove(e){return new Ts(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,In.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new lh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new lh(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new lh(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new lh(this.root_,null,this.comparator_,!0,e)}}Ts.EMPTY_NODE=new H7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V7(t,e){return aa(t.name,e.name)}function hg(t,e){return aa(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m0;function q7(t){m0=t}const j4=function(t){return typeof t=="number"?"number:"+b4(t):"string:"+t},H4=function(t){if(t.isLeafNode()){const e=t.val();Ue(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ui(e,".sv"),"Priority must be a string or number.")}else Ue(t===m0||t.isEmpty(),"priority of unexpected type.");Ue(t===m0||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X2;class Rn{constructor(e,n=Rn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Ue(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),H4(this.priorityNode_)}static set __childrenNodeConstructor(e){X2=e}static get __childrenNodeConstructor(){return X2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Rn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return vt(e)?this:_t(e)===".priority"?this.priorityNode_:Rn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Rn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=_t(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(Ue(s!==".priority"||Ur(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,Rn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+j4(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=b4(this.value_):e+=this.value_,this.lazyHash_=v4(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rn.__childrenNodeConstructor?-1:(Ue(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=Rn.VALUE_TYPE_ORDER.indexOf(n),r=Rn.VALUE_TYPE_ORDER.indexOf(s);return Ue(i>=0,"Unknown leaf type: "+n),Ue(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Rn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V4,q4;function $7(t){V4=t}function z7(t){q4=t}class K7 extends _f{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?aa(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return yt.MIN}maxPost(){return new yt($o,new Rn("[PRIORITY-POST]",q4))}makePost(e,n){const s=V4(e);return new yt(n,new Rn("[PRIORITY-POST]",s))}toString(){return".priority"}}const cn=new K7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G7=Math.log(2);class W7{constructor(e){const n=r=>parseInt(Math.log(r)/G7,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const hd=function(t,e,n,s){t.sort(e);const i=function(l,c){const d=c-l;let u,f;if(d===0)return null;if(d===1)return u=t[l],f=n?n(u):u,new In(f,u.node,In.BLACK,null,null);{const m=parseInt(d/2,10)+l,h=i(l,m),M=i(m+1,c);return u=t[m],f=n?n(u):u,new In(f,u.node,In.BLACK,h,M)}},r=function(l){let c=null,d=null,u=t.length;const f=function(h,M){const k=u-h,L=u;u-=h;const p=i(k+1,L),I=t[k],D=n?n(I):I;m(new In(D,I.node,M,null,p))},m=function(h){c?(c.left=h,c=h):(d=h,c=h)};for(let h=0;h<l.count;++h){const M=l.nextBitIsOne(),k=Math.pow(2,l.count-(h+1));M?f(k,In.BLACK):(f(k,In.BLACK),f(k,In.RED))}return d},o=new W7(t.length),a=r(o);return new Ts(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qm;const va={};class zi{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return Ue(va&&cn,"ChildrenNode.ts has not been loaded"),Qm=Qm||new zi({".priority":va},{".priority":cn}),Qm}get(e){const n=Wa(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ts?n:null}hasIndex(e){return Ui(this.indexSet_,e.toString())}addIndex(e,n){Ue(e!==Fa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(yt.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=hd(s,e.getCompare()):a=va;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new zi(d,c)}addToIndexes(e,n){const s=od(this.indexes_,(i,r)=>{const o=Wa(this.indexSet_,r);if(Ue(o,"Missing index implementation for "+r),i===va)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(yt.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),hd(a,o.getCompare())}else return va;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new yt(e.name,a))),l.insert(e,e.node)}});return new zi(s,this.indexSet_)}removeFromIndexes(e,n){const s=od(this.indexes_,i=>{if(i===va)return i;{const r=n.get(e.name);return r?i.remove(new yt(e.name,r)):i}});return new zi(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hl;class it{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&H4(this.priorityNode_),this.children_.isEmpty()&&Ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Hl||(Hl=new it(new Ts(hg),null,zi.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Hl}updatePriority(e){return this.children_.isEmpty()?this:new it(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Hl:n}}getChild(e){const n=_t(e);return n===null?this:this.getImmediateChild(n).getChild(Wt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(Ue(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new yt(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?Hl:this.priorityNode_;return new it(i,o,r)}}updateChild(e,n){const s=_t(e);if(s===null)return n;{Ue(_t(e)!==".priority"||Ur(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Wt(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(cn,(o,a)=>{n[o]=a.val(e),s++,r&&it.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+j4(this.getPriority().val())+":"),this.forEachChild(cn,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":v4(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new yt(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new yt(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new yt(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,yt.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,yt.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===_u?-1:0}withIndex(e){if(e===Fa||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new it(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Fa||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(cn),i=n.getIterator(cn);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Fa?null:this.indexMap_.get(e.toString())}}it.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Y7 extends it{constructor(){super(new Ts(hg),it.EMPTY_NODE,zi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return it.EMPTY_NODE}isEmpty(){return!1}}const _u=new Y7;Object.defineProperties(yt,{MIN:{value:new yt(Xa,it.EMPTY_NODE)},MAX:{value:new yt($o,_u)}});U4.__EMPTY_NODE=it.EMPTY_NODE;Rn.__childrenNodeConstructor=it;q7(_u);z7(_u);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7=!0;function En(t,e=null){if(t===null)return it.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Ue(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Rn(n,En(e))}if(!(t instanceof Array)&&X7){const n=[];let s=!1;if(Gn(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=En(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new yt(o,l)))}}),n.length===0)return it.EMPTY_NODE;const r=hd(n,V7,o=>o.name,hg);if(s){const o=hd(n,cn.getCompare());return new it(r,En(e),new zi({".priority":o},{".priority":cn}))}else return new it(r,En(e),zi.Default)}else{let n=it.EMPTY_NODE;return Gn(t,(s,i)=>{if(Ui(t,s)&&s.substring(0,1)!=="."){const r=En(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(En(e))}}$7(En);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7 extends _f{constructor(e){super(),this.indexPath_=e,Ue(!vt(e)&&_t(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?aa(e.name,n.name):r}makePost(e,n){const s=En(e),i=it.EMPTY_NODE.updateChild(this.indexPath_,s);return new yt(n,i)}maxPost(){const e=it.EMPTY_NODE.updateChild(this.indexPath_,_u);return new yt($o,e)}toString(){return xc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7 extends _f{compare(e,n){const s=e.node.compareTo(n.node);return s===0?aa(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return yt.MIN}maxPost(){return yt.MAX}makePost(e,n){const s=En(e);return new yt(n,s)}toString(){return".value"}}const J7=new Z7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(t){return{type:"value",snapshotNode:t}}function Qa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Oc(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Nc(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function eI(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){Ue(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Oc(n,a)):Ue(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Qa(n,s)):o.trackChildChange(Nc(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(cn,(i,r)=>{n.hasChild(i)||s.trackChildChange(Oc(i,r))}),n.isLeafNode()||n.forEachChild(cn,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(Nc(i,r,o))}else s.trackChildChange(Qa(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?it.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e){this.indexedFilter_=new dg(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Lc.getStartPost_(e),this.endPost_=Lc.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,s,i,r,o){return this.matches(new yt(n,s))||(s=it.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=it.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(it.EMPTY_NODE);const r=this;return n.forEachChild(cn,(o,a)=>{r.matches(new yt(o,a))||(i=i.updateImmediateChild(o,it.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e){this.rangedFilter_=new Lc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new yt(n,s))||(s=it.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=it.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=it.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();let l;if(this.reverse_?l=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:l=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,l)i=i.updateImmediateChild(a.name,a.node),o++;else break}}else{i=n.withIndex(this.index_),i=i.updatePriority(it.EMPTY_NODE);let r,o,a,l;if(this.reverse_){l=i.getReverseIterator(this.index_),r=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const u=this.index_.getCompare();a=(f,m)=>u(m,f)}else l=i.getIterator(this.index_),r=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let c=0,d=!1;for(;l.hasNext();){const u=l.getNext();!d&&a(r,u)<=0&&(d=!0),d&&c<this.limit_&&a(u,o)<=0?c++:i=i.updateImmediateChild(u.name,it.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const u=this.index_.getCompare();o=(f,m)=>u(m,f)}else o=this.index_.getCompare();const a=e;Ue(a.numChildren()===this.limit_,"");const l=new yt(n,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(n)){const u=a.getImmediateChild(n);let f=i.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=i.getChildAfterChild(this.index_,f,this.reverse_);const m=f==null?1:o(f,l);if(d&&!s.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(Nc(n,s,u)),a.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(Oc(n,u));const M=a.updateImmediateChild(n,it.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(r!=null&&r.trackChildChange(Qa(f.name,f.node)),M.updateImmediateChild(f.name,f.node)):M}}else return s.isEmpty()?e:d&&o(c,l)>=0?(r!=null&&(r.trackChildChange(Oc(c.name,c.node)),r.trackChildChange(Qa(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(c.name,it.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=cn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Xa}hasEnd(){return this.endSet_}getIndexEndValue(){return Ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$o}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===cn}copy(){const e=new fg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function nI(t){return t.loadsAllData()?new dg(t.getIndex()):t.hasLimit()?new tI(t):new Lc(t)}function Q2(t){const e={};if(t.isDefault())return e;let n;return t.index_===cn?n="$priority":t.index_===J7?n="$value":t.index_===Fa?n="$key":(Ue(t.index_ instanceof Q7,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Mn(n),t.startSet_&&(e.startAt=Mn(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+Mn(t.indexStartName_))),t.endSet_&&(e.endAt=Mn(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+Mn(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Z2(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==cn&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd extends D4{constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=gu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(Ue(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=dd.getListenId_(e,s),a={};this.listens_[o]=a;const l=Q2(e._queryParams);this.restRequest_(r+".json",l,(c,d)=>{let u=d;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(r,u,!1,s),Wa(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",i(f,null)}})}unlisten(e,n){const s=dd.getListenId_(e,n);delete this.listens_[s]}get(e){const n=Q2(e._queryParams),s=e._path.toString(),i=new qi;return this.restRequest_(s+".json",n,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+YR(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Mc(a.responseText)}catch{Ss("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&Ss("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(){this.rootNode_=it.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(){return{value:null,children:new Map}}function bl(t,e,n){if(vt(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=_t(e);t.children.has(s)||t.children.set(s,fd());const i=t.children.get(s);e=Wt(e),bl(i,e,n)}}function p0(t,e){if(vt(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(cn,(s,i)=>{bl(t,new jt(s),i)}),p0(t,e)}}else if(t.children.size>0){const n=_t(e);return e=Wt(e),t.children.has(n)&&p0(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function g0(t,e,n){t.value!==null?n(e,t.value):iI(t,(s,i)=>{const r=new jt(e.toString()+"/"+s);g0(i,r,n)})}function iI(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Gn(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2=10*1e3,oI=30*1e3,aI=5*60*1e3;class lI{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new rI(e);const s=J2+(oI-J2)*Math.random();dc(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Gn(e,(i,r)=>{r>0&&Ui(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),dc(this.reportStats_.bind(this),Math.floor(Math.random()*2*aI))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var di;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(di||(di={}));function z4(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function mg(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function pg(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=di.ACK_USER_WRITE,this.source=z4()}operationForChild(e){if(vt(this.path)){if(this.affectedTree.value!=null)return Ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new jt(e));return new md(xt(),n,this.revert)}}else return Ue(_t(this.path)===e,"operationForChild called for unrelated child."),new md(Wt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n){this.source=e,this.path=n,this.type=di.LISTEN_COMPLETE}operationForChild(e){return vt(this.path)?new Dc(this.source,xt()):new Dc(this.source,Wt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=di.OVERWRITE}operationForChild(e){return vt(this.path)?new zo(this.source,xt(),this.snap.getImmediateChild(e)):new zo(this.source,Wt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=di.MERGE}operationForChild(e){if(vt(this.path)){const n=this.children.subtree(new jt(e));return n.isEmpty()?null:n.value?new zo(this.source,xt(),n.value):new Pc(this.source,xt(),n)}else return Ue(_t(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Pc(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(vt(e))return this.isFullyInitialized()&&!this.filtered_;const n=_t(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function uI(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(eI(o.childName,o.snapshotNode))}),Vl(t,i,"child_removed",e,s,n),Vl(t,i,"child_added",e,s,n),Vl(t,i,"child_moved",r,s,n),Vl(t,i,"child_changed",e,s,n),Vl(t,i,"value",e,s,n),i}function Vl(t,e,n,s,i,r){const o=s.filter(a=>a.type===n);o.sort((a,l)=>dI(t,a,l)),o.forEach(a=>{const l=hI(t,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function hI(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function dI(t,e,n){if(e.childName==null||n.childName==null)throw _l("Should only compare child_ events.");const s=new yt(e.childName,e.snapshotNode),i=new yt(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t,e){return{eventCache:t,serverCache:e}}function fc(t,e,n,s){return vf(new Ko(e,n,s),t.serverCache)}function K4(t,e,n,s){return vf(t.eventCache,new Ko(e,n,s))}function _0(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Go(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zm;const fI=()=>(Zm||(Zm=new Ts(WC)),Zm);class tn{constructor(e,n=fI()){this.value=e,this.children=n}static fromObject(e){let n=new tn(null);return Gn(e,(s,i)=>{n=n.set(new jt(s),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:xt(),value:this.value};if(vt(e))return null;{const s=_t(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(Wt(e),n);return r!=null?{path:pn(new jt(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(vt(e))return this;{const n=_t(e),s=this.children.get(n);return s!==null?s.subtree(Wt(e)):new tn(null)}}set(e,n){if(vt(e))return new tn(n,this.children);{const s=_t(e),r=(this.children.get(s)||new tn(null)).set(Wt(e),n),o=this.children.insert(s,r);return new tn(this.value,o)}}remove(e){if(vt(e))return this.children.isEmpty()?new tn(null):new tn(null,this.children);{const n=_t(e),s=this.children.get(n);if(s){const i=s.remove(Wt(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new tn(null):new tn(this.value,r)}else return this}}get(e){if(vt(e))return this.value;{const n=_t(e),s=this.children.get(n);return s?s.get(Wt(e)):null}}setTree(e,n){if(vt(e))return n;{const s=_t(e),r=(this.children.get(s)||new tn(null)).setTree(Wt(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new tn(this.value,o)}}fold(e){return this.fold_(xt(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(pn(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,xt(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(vt(e))return null;{const r=_t(e),o=this.children.get(r);return o?o.findOnPath_(Wt(e),pn(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,xt(),n)}foreachOnPath_(e,n,s){if(vt(e))return this;{this.value&&s(n,this.value);const i=_t(e),r=this.children.get(i);return r?r.foreachOnPath_(Wt(e),pn(n,i),s):new tn(null)}}foreach(e){this.foreach_(xt(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(pn(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.writeTree_=e}static empty(){return new pi(new tn(null))}}function mc(t,e,n){if(vt(e))return new pi(new tn(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=Es(i,e);return r=r.updateChild(o,n),new pi(t.writeTree_.set(i,r))}else{const i=new tn(n),r=t.writeTree_.setTree(e,i);return new pi(r)}}}function ey(t,e,n){let s=t;return Gn(n,(i,r)=>{s=mc(s,pn(e,i),r)}),s}function ty(t,e){if(vt(e))return pi.empty();{const n=t.writeTree_.setTree(e,new tn(null));return new pi(n)}}function v0(t,e){return la(t,e)!=null}function la(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Es(n.path,e)):null}function ny(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(cn,(s,i)=>{e.push(new yt(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new yt(s,i.value))}),e}function Mr(t,e){if(vt(e))return t;{const n=la(t,e);return n!=null?new pi(new tn(n)):new pi(t.writeTree_.subtree(e))}}function y0(t){return t.writeTree_.isEmpty()}function Za(t,e){return G4(xt(),t.writeTree_,e)}function G4(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(Ue(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=G4(pn(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(pn(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t,e){return Q4(e,t)}function mI(t,e,n,s,i){Ue(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=mc(t.visibleWrites,e,n)),t.lastWriteId=s}function pI(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function gI(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);Ue(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&_I(a,s.path)?i=!1:Js(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return vI(t),!0;if(s.snap)t.visibleWrites=ty(t.visibleWrites,s.path);else{const a=s.children;Gn(a,l=>{t.visibleWrites=ty(t.visibleWrites,pn(s.path,l))})}return!0}else return!1}function _I(t,e){if(t.snap)return Js(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Js(pn(t.path,n),e))return!0;return!1}function vI(t){t.visibleWrites=W4(t.allWrites,yI,xt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function yI(t){return t.visible}function W4(t,e,n){let s=pi.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let a;if(r.snap)Js(n,o)?(a=Es(n,o),s=mc(s,a,r.snap)):Js(o,n)&&(a=Es(o,n),s=mc(s,xt(),r.snap.getChild(a)));else if(r.children){if(Js(n,o))a=Es(n,o),s=ey(s,a,r.children);else if(Js(o,n))if(a=Es(o,n),vt(a))s=ey(s,xt(),r.children);else{const l=Wa(r.children,_t(a));if(l){const c=l.getChild(Wt(a));s=mc(s,xt(),c)}}}else throw _l("WriteRecord should have .snap or .children")}}return s}function Y4(t,e,n,s,i){if(!s&&!i){const r=la(t.visibleWrites,e);if(r!=null)return r;{const o=Mr(t.visibleWrites,e);if(y0(o))return n;if(n==null&&!v0(o,xt()))return null;{const a=n||it.EMPTY_NODE;return Za(o,a)}}}else{const r=Mr(t.visibleWrites,e);if(!i&&y0(r))return n;if(!i&&n==null&&!v0(r,xt()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(Js(c.path,e)||Js(e,c.path))},a=W4(t.allWrites,o,e),l=n||it.EMPTY_NODE;return Za(a,l)}}}function bI(t,e,n){let s=it.EMPTY_NODE;const i=la(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(cn,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=Mr(t.visibleWrites,e);return n.forEachChild(cn,(o,a)=>{const l=Za(Mr(r,new jt(o)),a);s=s.updateImmediateChild(o,l)}),ny(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Mr(t.visibleWrites,e);return ny(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function wI(t,e,n,s,i){Ue(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=pn(e,n);if(v0(t.visibleWrites,r))return null;{const o=Mr(t.visibleWrites,r);return y0(o)?i.getChild(n):Za(o,i.getChild(n))}}function EI(t,e,n,s){const i=pn(e,n),r=la(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=Mr(t.visibleWrites,i);return Za(o,s.getNode().getImmediateChild(n))}else return null}function TI(t,e){return la(t.visibleWrites,e)}function SI(t,e,n,s,i,r,o){let a;const l=Mr(t.visibleWrites,e),c=la(l,xt());if(c!=null)a=c;else if(n!=null)a=Za(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],u=o.getCompare(),f=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let m=f.getNext();for(;m&&d.length<i;)u(m,s)!==0&&d.push(m),m=f.getNext();return d}else return[]}function AI(){return{visibleWrites:pi.empty(),allWrites:[],lastWriteId:-1}}function pd(t,e,n,s){return Y4(t.writeTree,t.treePath,e,n,s)}function _g(t,e){return bI(t.writeTree,t.treePath,e)}function sy(t,e,n,s){return wI(t.writeTree,t.treePath,e,n,s)}function gd(t,e){return TI(t.writeTree,pn(t.treePath,e))}function RI(t,e,n,s,i,r){return SI(t.writeTree,t.treePath,e,n,s,i,r)}function vg(t,e,n){return EI(t.writeTree,t.treePath,e,n)}function X4(t,e){return Q4(pn(t.treePath,e),t.writeTree)}function Q4(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;Ue(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Ue(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Nc(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Oc(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Qa(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Nc(s,e.snapshotNode,i.oldSnap));else throw _l("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Z4=new II;class yg{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Ko(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return vg(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Go(this.viewCache_),r=RI(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t){return{filter:t}}function MI(t,e){Ue(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Ue(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function xI(t,e,n,s,i){const r=new CI;let o,a;if(n.type===di.OVERWRITE){const c=n;c.source.fromUser?o=b0(t,e,c.path,c.snap,s,i,r):(Ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!vt(c.path),o=_d(t,e,c.path,c.snap,s,i,a,r))}else if(n.type===di.MERGE){const c=n;c.source.fromUser?o=NI(t,e,c.path,c.children,s,i,r):(Ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=w0(t,e,c.path,c.children,s,i,a,r))}else if(n.type===di.ACK_USER_WRITE){const c=n;c.revert?o=PI(t,e,c.path,s,i,r):o=LI(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===di.LISTEN_COMPLETE)o=DI(t,e,n.path,s,r);else throw _l("Unknown operation type: "+n.type);const l=r.getChanges();return OI(e,o,l),{viewCache:o,changes:l}}function OI(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=_0(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push($4(_0(e)))}}function J4(t,e,n,s,i,r){const o=e.eventCache;if(gd(s,n)!=null)return e;{let a,l;if(vt(n))if(Ue(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Go(e),d=c instanceof it?c:it.EMPTY_NODE,u=_g(s,d);a=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const c=pd(s,Go(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=_t(n);if(c===".priority"){Ue(Ur(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const u=sy(s,n,d,l);u!=null?a=t.filter.updatePriority(d,u):a=o.getNode()}else{const d=Wt(n);let u;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const f=sy(s,n,o.getNode(),l);f!=null?u=o.getNode().getImmediateChild(c).updateChild(d,f):u=o.getNode().getImmediateChild(c)}else u=vg(s,c,e.serverCache);u!=null?a=t.filter.updateChild(o.getNode(),c,u,d,i,r):a=o.getNode()}}return fc(e,a,o.isFullyInitialized()||vt(n),t.filter.filtersNodes())}}function _d(t,e,n,s,i,r,o,a){const l=e.serverCache;let c;const d=o?t.filter:t.filter.getIndexedFilter();if(vt(n))c=d.updateFullNode(l.getNode(),s,null);else if(d.filtersNodes()&&!l.isFiltered()){const m=l.getNode().updateChild(n,s);c=d.updateFullNode(l.getNode(),m,null)}else{const m=_t(n);if(!l.isCompleteForPath(n)&&Ur(n)>1)return e;const h=Wt(n),k=l.getNode().getImmediateChild(m).updateChild(h,s);m===".priority"?c=d.updatePriority(l.getNode(),k):c=d.updateChild(l.getNode(),m,k,h,Z4,null)}const u=K4(e,c,l.isFullyInitialized()||vt(n),d.filtersNodes()),f=new yg(i,u,r);return J4(t,u,n,i,f,a)}function b0(t,e,n,s,i,r,o){const a=e.eventCache;let l,c;const d=new yg(i,e,r);if(vt(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=fc(e,c,!0,t.filter.filtersNodes());else{const u=_t(n);if(u===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),l=fc(e,c,a.isFullyInitialized(),a.isFiltered());else{const f=Wt(n),m=a.getNode().getImmediateChild(u);let h;if(vt(f))h=s;else{const M=d.getCompleteChild(u);M!=null?lg(f)===".priority"&&M.getChild(F4(f)).isEmpty()?h=M:h=M.updateChild(f,s):h=it.EMPTY_NODE}if(m.equals(h))l=e;else{const M=t.filter.updateChild(a.getNode(),u,h,f,d,o);l=fc(e,M,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function iy(t,e){return t.eventCache.isCompleteForChild(e)}function NI(t,e,n,s,i,r,o){let a=e;return s.foreach((l,c)=>{const d=pn(n,l);iy(e,_t(d))&&(a=b0(t,a,d,c,i,r,o))}),s.foreach((l,c)=>{const d=pn(n,l);iy(e,_t(d))||(a=b0(t,a,d,c,i,r,o))}),a}function ry(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function w0(t,e,n,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;vt(n)?c=s:c=new tn(null).setTree(n,s);const d=e.serverCache.getNode();return c.children.inorderTraversal((u,f)=>{if(d.hasChild(u)){const m=e.serverCache.getNode().getImmediateChild(u),h=ry(t,m,f);l=_d(t,l,new jt(u),h,i,r,o,a)}}),c.children.inorderTraversal((u,f)=>{const m=!e.serverCache.isCompleteForChild(u)&&f.value===void 0;if(!d.hasChild(u)&&!m){const h=e.serverCache.getNode().getImmediateChild(u),M=ry(t,h,f);l=_d(t,l,new jt(u),M,i,r,o,a)}}),l}function LI(t,e,n,s,i,r,o){if(gd(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(vt(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return _d(t,e,n,l.getNode().getChild(n),i,r,a,o);if(vt(n)){let c=new tn(null);return l.getNode().forEachChild(Fa,(d,u)=>{c=c.set(new jt(d),u)}),w0(t,e,n,c,i,r,a,o)}else return e}else{let c=new tn(null);return s.foreach((d,u)=>{const f=pn(n,d);l.isCompleteForPath(f)&&(c=c.set(d,l.getNode().getChild(f)))}),w0(t,e,n,c,i,r,a,o)}}function DI(t,e,n,s,i){const r=e.serverCache,o=K4(e,r.getNode(),r.isFullyInitialized()||vt(n),r.isFiltered());return J4(t,o,n,s,Z4,i)}function PI(t,e,n,s,i,r){let o;if(gd(s,n)!=null)return e;{const a=new yg(s,e,i),l=e.eventCache.getNode();let c;if(vt(n)||_t(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=pd(s,Go(e));else{const u=e.serverCache.getNode();Ue(u instanceof it,"serverChildren would be complete if leaf node"),d=_g(s,u)}d=d,c=t.filter.updateFullNode(l,d,r)}else{const d=_t(n);let u=vg(s,d,e.serverCache);u==null&&e.serverCache.isCompleteForChild(d)&&(u=l.getImmediateChild(d)),u!=null?c=t.filter.updateChild(l,d,u,Wt(n),a,r):e.eventCache.getNode().hasChild(d)?c=t.filter.updateChild(l,d,it.EMPTY_NODE,Wt(n),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=pd(s,Go(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||gd(s,xt())!=null,fc(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new dg(s.getIndex()),r=nI(s);this.processor_=kI(r);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(it.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(it.EMPTY_NODE,a.getNode(),null),d=new Ko(l,o.isFullyInitialized(),i.filtersNodes()),u=new Ko(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=vf(u,d),this.eventGenerator_=new cI(this.query_)}get query(){return this.query_}}function BI(t){return t.viewCache_.serverCache.getNode()}function UI(t,e){const n=Go(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!vt(e)&&!n.getImmediateChild(_t(e)).isEmpty())?n.getChild(e):null}function oy(t){return t.eventRegistrations_.length===0}function jI(t,e){t.eventRegistrations_.push(e)}function ay(t,e,n){const s=[];if(n){Ue(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function ly(t,e,n,s){e.type===di.MERGE&&e.source.queryId!==null&&(Ue(Go(t.viewCache_),"We should always have a full cache before handling merges"),Ue(_0(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=xI(t.processor_,i,e,n,s);return MI(t.processor_,r.viewCache),Ue(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,e5(t,r.changes,r.viewCache.eventCache.getNode(),null)}function HI(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(cn,(r,o)=>{s.push(Qa(r,o))}),n.isFullyInitialized()&&s.push($4(n.getNode())),e5(t,s,n.getNode(),e)}function e5(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return uI(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vd;class VI{constructor(){this.views=new Map}}function qI(t){Ue(!vd,"__referenceConstructor has already been defined"),vd=t}function $I(){return Ue(vd,"Reference.ts has not been loaded"),vd}function zI(t){return t.views.size===0}function bg(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return Ue(r!=null,"SyncTree gave us an op for an invalid query."),ly(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(ly(o,e,n,s));return r}}function KI(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let a=pd(n,i?s:null),l=!1;a?l=!0:s instanceof it?(a=_g(n,s),l=!1):(a=it.EMPTY_NODE,l=!1);const c=vf(new Ko(a,l,!1),new Ko(s,i,!1));return new FI(e,c)}return o}function GI(t,e,n,s,i,r){const o=KI(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),jI(o,n),HI(o,n)}function WI(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const a=jr(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(ay(c,n,s)),oy(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(ay(l,n,s)),oy(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!jr(t)&&r.push(new($I())(e._repo,e._path)),{removed:r,events:o}}function t5(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ba(t,e){let n=null;for(const s of t.views.values())n=n||UI(s,e);return n}function n5(t,e){if(e._queryParams.loadsAllData())return yf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function s5(t,e){return n5(t,e)!=null}function jr(t){return yf(t)!=null}function yf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yd;function YI(t){Ue(!yd,"__referenceConstructor has already been defined"),yd=t}function XI(){return Ue(yd,"Reference.ts has not been loaded"),yd}let QI=1;class cy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new tn(null),this.pendingWriteTree_=AI(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function i5(t,e,n,s,i){return mI(t.pendingWriteTree_,e,n,s,i),i?vu(t,new zo(z4(),e,n)):[]}function Io(t,e,n=!1){const s=pI(t.pendingWriteTree_,e);if(gI(t.pendingWriteTree_,e)){let r=new tn(null);return s.snap!=null?r=r.set(xt(),!0):Gn(s.children,o=>{r=r.set(new jt(o),!0)}),vu(t,new md(s.path,r,n))}else return[]}function bf(t,e,n){return vu(t,new zo(mg(),e,n))}function ZI(t,e,n){const s=tn.fromObject(n);return vu(t,new Pc(mg(),e,s))}function JI(t,e){return vu(t,new Dc(mg(),e))}function ek(t,e,n){const s=Eg(t,n);if(s){const i=Tg(s),r=i.path,o=i.queryId,a=Es(r,e),l=new Dc(pg(o),a);return Sg(t,r,l)}else return[]}function E0(t,e,n,s){const i=e._path,r=t.syncPointTree_.get(i);let o=[];if(r&&(e._queryIdentifier==="default"||s5(r,e))){const a=WI(r,e,n,s);zI(r)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const l=a.removed;o=a.events;const c=l.findIndex(u=>u._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(i,(u,f)=>jr(f));if(c&&!d){const u=t.syncPointTree_.subtree(i);if(!u.isEmpty()){const f=sk(u);for(let m=0;m<f.length;++m){const h=f[m],M=h.query,k=a5(t,h);t.listenProvider_.startListening(pc(M),bd(t,M),k.hashFn,k.onComplete)}}}!d&&l.length>0&&!s&&(c?t.listenProvider_.stopListening(pc(e),null):l.forEach(u=>{const f=t.queryToTagMap.get(wf(u));t.listenProvider_.stopListening(pc(u),f)})),ik(t,l)}return o}function tk(t,e,n,s){const i=Eg(t,s);if(i!=null){const r=Tg(i),o=r.path,a=r.queryId,l=Es(o,e),c=new zo(pg(a),l,n);return Sg(t,o,c)}else return[]}function nk(t,e,n,s){const i=Eg(t,s);if(i){const r=Tg(i),o=r.path,a=r.queryId,l=Es(o,e),c=tn.fromObject(n),d=new Pc(pg(a),l,c);return Sg(t,o,d)}else return[]}function uy(t,e,n){const s=e._path;let i=null,r=!1;t.syncPointTree_.foreachOnPath(s,(u,f)=>{const m=Es(u,s);i=i||Ba(f,m),r=r||jr(f)});let o=t.syncPointTree_.get(s);o?(r=r||jr(o),i=i||Ba(o,xt())):(o=new VI,t.syncPointTree_=t.syncPointTree_.set(s,o));let a;i!=null?a=!0:(a=!1,i=it.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((f,m)=>{const h=Ba(m,xt());h&&(i=i.updateImmediateChild(f,h))}));const l=s5(o,e);if(!l&&!e._queryParams.loadsAllData()){const u=wf(e);Ue(!t.queryToTagMap.has(u),"View does not exist, but we have a tag");const f=rk();t.queryToTagMap.set(u,f),t.tagToQueryMap.set(f,u)}const c=gg(t.pendingWriteTree_,s);let d=GI(o,e,n,c,i,a);if(!l&&!r){const u=n5(o,e);d=d.concat(ok(t,e,u))}return d}function wg(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Es(o,e),c=Ba(a,l);if(c)return c});return Y4(i,e,r,n,!0)}function vu(t,e){return r5(e,t.syncPointTree_,null,gg(t.pendingWriteTree_,xt()))}function r5(t,e,n,s){if(vt(t.path))return o5(t,e,n,s);{const i=e.get(xt());n==null&&i!=null&&(n=Ba(i,xt()));let r=[];const o=_t(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,d=X4(s,o);r=r.concat(r5(a,l,c,d))}return i&&(r=r.concat(bg(i,t,s,n))),r}}function o5(t,e,n,s){const i=e.get(xt());n==null&&i!=null&&(n=Ba(i,xt()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=X4(s,o),d=t.operationForChild(o);d&&(r=r.concat(o5(d,a,l,c)))}),i&&(r=r.concat(bg(i,t,s,n))),r}function a5(t,e){const n=e.query,s=bd(t,n);return{hashFn:()=>(BI(e)||it.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?ek(t,n._path,s):JI(t,n._path);{const r=QC(i,n);return E0(t,n,null,r)}}}}function bd(t,e){const n=wf(e);return t.queryToTagMap.get(n)}function wf(t){return t._path.toString()+"$"+t._queryIdentifier}function Eg(t,e){return t.tagToQueryMap.get(e)}function Tg(t){const e=t.indexOf("$");return Ue(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new jt(t.substr(0,e))}}function Sg(t,e,n){const s=t.syncPointTree_.get(e);Ue(s,"Missing sync point for query tag that we're tracking");const i=gg(t.pendingWriteTree_,e);return bg(s,n,i,null)}function sk(t){return t.fold((e,n,s)=>{if(n&&jr(n))return[yf(n)];{let i=[];return n&&(i=t5(n)),Gn(s,(r,o)=>{i=i.concat(o)}),i}})}function pc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(XI())(t._repo,t._path):t}function ik(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=wf(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function rk(){return QI++}function ok(t,e,n){const s=e._path,i=bd(t,e),r=a5(t,n),o=t.listenProvider_.startListening(pc(e),i,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(s);if(i)Ue(!jr(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,d,u)=>{if(!vt(c)&&d&&jr(d))return[yf(d).query];{let f=[];return d&&(f=f.concat(t5(d).map(m=>m.query))),Gn(u,(m,h)=>{f=f.concat(h)}),f}});for(let c=0;c<l.length;++c){const d=l[c];t.listenProvider_.stopListening(pc(d),bd(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ag(n)}node(){return this.node_}}class Rg{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=pn(this.path_,e);return new Rg(this.syncTree_,n)}node(){return wg(this.syncTree_,this.path_)}}const ak=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},hy=function(t,e,n){if(!t||typeof t!="object")return t;if(Ue(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return lk(t[".sv"],e,n);if(typeof t[".sv"]=="object")return ck(t[".sv"],e);Ue(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},lk=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Ue(!1,"Unexpected server value: "+t)}},ck=function(t,e,n){t.hasOwnProperty("increment")||Ue(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&Ue(!1,"Unexpected increment value: "+s);const i=e.node();if(Ue(i!==null&&typeof i!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},uk=function(t,e,n,s){return Cg(e,new Rg(n,t),s)},l5=function(t,e,n){return Cg(t,new Ag(e),n)};function Cg(t,e,n){const s=t.getPriority().val(),i=hy(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,a=hy(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Rn(a,En(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new Rn(i))),o.forEachChild(cn,(a,l)=>{const c=Cg(l,e.getImmediateChild(a),n);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function kg(t,e){let n=e instanceof jt?e:new jt(e),s=t,i=_t(n);for(;i!==null;){const r=Wa(s.node.children,i)||{children:{},childCount:0};s=new Ig(i,s,r),n=Wt(n),i=_t(n)}return s}function wl(t){return t.node.value}function c5(t,e){t.node.value=e,T0(t)}function u5(t){return t.node.childCount>0}function hk(t){return wl(t)===void 0&&!u5(t)}function Ef(t,e){Gn(t.node.children,(n,s)=>{e(new Ig(n,t,s))})}function h5(t,e,n,s){n&&!s&&e(t),Ef(t,i=>{h5(i,e,!0,s)}),n&&s&&e(t)}function dk(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function yu(t){return new jt(t.parent===null?t.name:yu(t.parent)+"/"+t.name)}function T0(t){t.parent!==null&&fk(t.parent,t.name,t)}function fk(t,e,n){const s=hk(n),i=Ui(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,T0(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,T0(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=/[\[\].#$\/\u0000-\u001F\u007F]/,pk=/[\[\].#$\u0000-\u001F\u007F]/,Jm=10*1024*1024,Mg=function(t){return typeof t=="string"&&t.length!==0&&!mk.test(t)},d5=function(t){return typeof t=="string"&&t.length!==0&&!pk.test(t)},gk=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),d5(t)},f5=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!gf(t)||t&&typeof t=="object"&&Ui(t,".sv")},S0=function(t,e,n,s){s&&e===void 0||Tf(Ya(t,"value"),e,n)},Tf=function(t,e,n){const s=n instanceof jt?new N7(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+po(s));if(typeof e=="function")throw new Error(t+"contains a function "+po(s)+" with contents = "+e.toString());if(gf(e))throw new Error(t+"contains "+e.toString()+" "+po(s));if(typeof e=="string"&&e.length>Jm/3&&pf(e)>Jm)throw new Error(t+"contains a string greater than "+Jm+" utf8 bytes "+po(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Gn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!Mg(o)))throw new Error(t+" contains an invalid key ("+o+") "+po(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);L7(s,o),Tf(t,a,s),D7(s)}),i&&r)throw new Error(t+' contains ".value" child '+po(s)+" in addition to actual children.")}},_k=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=xc(s);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!Mg(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(O7);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&Js(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},vk=function(t,e,n,s){if(s&&e===void 0)return;const i=Ya(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];Gn(e,(o,a)=>{const l=new jt(o);if(Tf(i,a,pn(n,l)),lg(l)===".priority"&&!f5(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),_k(i,r)},yk=function(t,e,n){if(!(n&&e===void 0)){if(gf(e))throw new Error(Ya(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!f5(e))throw new Error(Ya(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},m5=function(t,e,n,s){if(!(s&&n===void 0)&&!d5(n))throw new Error(Ya(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},bk=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),m5(t,e,n,s)},Jl=function(t,e){if(_t(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},wk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!gk(n))throw new Error(Ya(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function xg(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!cg(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function p5(t,e,n){xg(t,n),g5(t,s=>cg(s,e))}function sr(t,e,n){xg(t,n),g5(t,s=>Js(s,e)||Js(e,s))}function g5(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(Tk(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Tk(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Po&&Ln("event: "+n.toString()),yl(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk="repo_interrupt",Ak=25;class Rk{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ek,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fd(),this.transactionQueueTree_=new Ig,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Ck(t,e,n){if(t.stats_=rg(t.repoInfo_),t.forceRestClient_||t7())t.server_=new dd(t.repoInfo_,(s,i,r,o)=>{dy(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>fy(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Mn(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Yi(t.repoInfo_,e,(s,i,r,o)=>{dy(t,s,i,r,o)},s=>{fy(t,s)},s=>{kk(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=l7(t.repoInfo_,()=>new lI(t.stats_,t.server_)),t.infoData_=new sI,t.infoSyncTree_=new cy({startListening:(s,i,r,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=bf(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ng(t,"connected",!1),t.serverSyncTree_=new cy({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);sr(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function Ik(t){const n=t.infoData_.getNode(new jt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Og(t){return ak({timestamp:Ik(t)})}function dy(t,e,n,s,i){t.dataUpdateCount++;const r=new jt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const l=od(n,c=>En(c));o=nk(t.serverSyncTree_,r,l,i)}else{const l=En(n);o=tk(t.serverSyncTree_,r,l,i)}else if(s){const l=od(n,c=>En(c));o=ZI(t.serverSyncTree_,r,l)}else{const l=En(n);o=bf(t.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=Sf(t,r)),sr(t.eventQueue_,a,o)}function fy(t,e){Ng(t,"connected",e),e===!1&&xk(t)}function kk(t,e){Gn(e,(n,s)=>{Ng(t,n,s)})}function Ng(t,e,n){const s=new jt("/.info/"+e),i=En(n);t.infoData_.updateSnapshot(s,i);const r=bf(t.infoSyncTree_,s,i);sr(t.eventQueue_,s,r)}function _5(t){return t.nextWriteId_++}function Mk(t,e,n,s,i){Lg(t,"set",{path:e.toString(),value:n,priority:s});const r=Og(t),o=En(n,s),a=wg(t.serverSyncTree_,e),l=l5(o,a,r),c=_5(t),d=i5(t.serverSyncTree_,e,l,c,!0);xg(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(f,m)=>{const h=f==="ok";h||Ss("set at "+e+" failed: "+f);const M=Io(t.serverSyncTree_,c,!h);sr(t.eventQueue_,e,M),Ja(t,i,f,m)});const u=E5(t,e);Sf(t,u),sr(t.eventQueue_,u,[])}function xk(t){Lg(t,"onDisconnectEvents");const e=Og(t),n=fd();g0(t.onDisconnect_,xt(),(i,r)=>{const o=uk(i,r,t.serverSyncTree_,e);bl(n,i,o)});let s=[];g0(n,xt(),(i,r)=>{s=s.concat(bf(t.serverSyncTree_,i,r));const o=E5(t,i);Sf(t,o)}),t.onDisconnect_=fd(),sr(t.eventQueue_,xt(),s)}function Ok(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&p0(t.onDisconnect_,e),Ja(t,n,s,i)})}function my(t,e,n,s){const i=En(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,o)=>{r==="ok"&&bl(t.onDisconnect_,e,i),Ja(t,s,r,o)})}function Nk(t,e,n,s,i){const r=En(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(o,a)=>{o==="ok"&&bl(t.onDisconnect_,e,r),Ja(t,i,o,a)})}function Lk(t,e,n,s){if(o0(n)){Ln("onDisconnect().update() called with empty data.  Don't do anything."),Ja(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&Gn(n,(o,a)=>{const l=En(a);bl(t.onDisconnect_,pn(e,o),l)}),Ja(t,s,i,r)})}function Dk(t,e,n){let s;_t(e._path)===".info"?s=uy(t.infoSyncTree_,e,n):s=uy(t.serverSyncTree_,e,n),p5(t.eventQueue_,e._path,s)}function py(t,e,n){let s;_t(e._path)===".info"?s=E0(t.infoSyncTree_,e,n):s=E0(t.serverSyncTree_,e,n),p5(t.eventQueue_,e._path,s)}function Pk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Sk)}function Lg(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ln(n,...e)}function Ja(t,e,n,s){e&&yl(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function v5(t,e,n){return wg(t.serverSyncTree_,e,n)||it.EMPTY_NODE}function Dg(t,e=t.transactionQueueTree_){if(e||Af(t,e),wl(e)){const n=b5(t,e);Ue(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Fk(t,yu(e),n)}else u5(e)&&Ef(e,n=>{Dg(t,n)})}function Fk(t,e,n){const s=n.map(c=>c.currentWriteId),i=v5(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const d=n[c];Ue(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const u=Es(e,d.path);r=r.updateChild(u,d.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Lg(t,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){const u=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(Io(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&u.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();Af(t,kg(t.transactionQueueTree_,e)),Dg(t,t.transactionQueueTree_),sr(t.eventQueue_,e,d);for(let f=0;f<u.length;f++)yl(u[f])}else{if(c==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{Ss("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=c}Sf(t,e)}},o)}function Sf(t,e){const n=y5(t,e),s=yu(n),i=b5(t,n);return Bk(t,i,s),s}function Bk(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Es(n,l.path);let d=!1,u;if(Ue(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,u=l.abortReason,i=i.concat(Io(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Ak)d=!0,u="maxretry",i=i.concat(Io(t.serverSyncTree_,l.currentWriteId,!0));else{const f=v5(t,l.path,o);l.currentInputSnapshot=f;const m=e[a].update(f.val());if(m!==void 0){Tf("transaction failed: Data returned ",m,l.path);let h=En(m);typeof m=="object"&&m!=null&&Ui(m,".priority")||(h=h.updatePriority(f.getPriority()));const k=l.currentWriteId,L=Og(t),p=l5(h,f,L);l.currentOutputSnapshotRaw=h,l.currentOutputSnapshotResolved=p,l.currentWriteId=_5(t),o.splice(o.indexOf(k),1),i=i.concat(i5(t.serverSyncTree_,l.path,p,l.currentWriteId,l.applyLocally)),i=i.concat(Io(t.serverSyncTree_,k,!0))}else d=!0,u="nodata",i=i.concat(Io(t.serverSyncTree_,l.currentWriteId,!0))}sr(t.eventQueue_,n,i),i=[],d&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(u==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(u),!1,null))))}Af(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)yl(s[a]);Dg(t,t.transactionQueueTree_)}function y5(t,e){let n,s=t.transactionQueueTree_;for(n=_t(e);n!==null&&wl(s)===void 0;)s=kg(s,n),e=Wt(e),n=_t(e);return s}function b5(t,e){const n=[];return w5(t,e,n),n.sort((s,i)=>s.order-i.order),n}function w5(t,e,n){const s=wl(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);Ef(e,i=>{w5(t,i,n)})}function Af(t,e){const n=wl(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,c5(e,n.length>0?n:void 0)}Ef(e,s=>{Af(t,s)})}function E5(t,e){const n=yu(y5(t,e)),s=kg(t.transactionQueueTree_,e);return dk(s,i=>{e1(t,i)}),e1(t,s),h5(s,i=>{e1(t,i)}),n}function e1(t,e){const n=wl(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(Ue(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(Ue(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Io(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?c5(e,void 0):n.length=r+1,sr(t.eventQueue_,yu(e),i);for(let o=0;o<s.length;o++)yl(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function jk(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ss(`Invalid query segment '${n}' in query '${t}'`)}return e}const gy=function(t,e){const n=Hk(t),s=n.namespace;n.domain==="firebase.com"&&qo(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&qo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||KC();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new r7(n.host,n.secure,s,e,i,"",s!==n.subdomain),path:new jt(n.pathString)}},Hk=function(t){let e="",n="",s="",i="",r="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let d=t.indexOf("/");d===-1&&(d=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(d,u)),d<u&&(i=Uk(t.substring(d,u)));const f=jk(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const m=e.slice(0,c);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const h=e.indexOf(".");s=e.substring(0,h).toLowerCase(),n=e.substring(h+1),r=s}"ns"in f&&(r=f.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Mn(this.snapshot.exportVal())}}class S5{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return Ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new qi;return Ok(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Jl("OnDisconnect.remove",this._path);const e=new qi;return my(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Jl("OnDisconnect.set",this._path),S0("OnDisconnect.set",e,this._path,!1);const n=new qi;return my(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Jl("OnDisconnect.setWithPriority",this._path),S0("OnDisconnect.setWithPriority",e,this._path,!1),yk("OnDisconnect.setWithPriority",n,!1);const s=new qi;return Nk(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){Jl("OnDisconnect.update",this._path),vk("OnDisconnect.update",e,this._path,!1);const n=new qi;return Lk(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return vt(this._path)?null:lg(this._path)}get ref(){return new ur(this._repo,this._path)}get _queryIdentifier(){const e=Z2(this._queryParams),n=sg(e);return n==="{}"?"default":n}get _queryObject(){return Z2(this._queryParams)}isEqual(e){if(e=_n(e),!(e instanceof Pg))return!1;const n=this._repo===e._repo,s=cg(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+x7(this._path)}}class ur extends Pg{constructor(e,n){super(e,n,new fg,!1)}get parent(){const e=F4(this._path);return e===null?null:new ur(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Fc{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new jt(e),s=wd(this.ref,e);return new Fc(this._node.getChild(n),s,cn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Fc(i,wd(this.ref,s),cn)))}hasChild(e){const n=new jt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function A5(t,e){return t=_n(t),t._checkNotDeleted("ref"),e!==void 0?wd(t._root,e):t._root}function wd(t,e){return t=_n(t),_t(t._path)===null?bk("child","path",e,!1):m5("child","path",e,!1),new ur(t._repo,pn(t._path,e))}function $k(t){return t=_n(t),new qk(t._repo,t._path)}function zk(t,e){t=_n(t),Jl("set",t._path),S0("set",e,t._path,!1);const n=new qi;return Mk(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}class Fg{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new T5("value",this,new Fc(e.snapshotNode,new ur(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new S5(this,e,n):null}matches(e){return e instanceof Fg?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Bg{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new S5(this,e,n):null}createEvent(e,n){Ue(e.childName!=null,"Child events should have a childName.");const s=wd(new ur(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new T5(e.type,this,new Fc(e.snapshotNode,s,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Bg?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Kk(t,e,n,s,i){let r;if(typeof s=="object"&&(r=void 0,i=s),typeof s=="function"&&(r=s),i&&i.onlyOnce){const l=n,c=(d,u)=>{py(t._repo,t,a),l(d,u)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new Vk(n,r||void 0),a=e==="value"?new Fg(o):new Bg(e,o);return Dk(t._repo,t,a),()=>py(t._repo,t,a)}function R5(t,e,n,s){return Kk(t,"value",e,n,s)}qI(ur);YI(ur);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk="FIREBASE_DATABASE_EMULATOR_HOST",A0={};let Wk=!1;function Yk(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||qo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ln("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=gy(r,i),a=o.repoInfo,l,c;typeof process!="undefined"&&(c=process.env[Gk]),c?(l=!0,r=`http://${c}?ns=${a.namespace}`,o=gy(r,i),a=o.repoInfo):l=!o.repoInfo.secure;const d=i&&l?new d0(d0.OWNER):new s7(t.name,t.options,e);wk("Invalid Firebase Database URL",o),vt(o.path)||qo("Database URL must point to the root of a Firebase Database (not including a child path).");const u=Qk(a,t,d,new n7(t.name,n));return new Zk(u,t)}function Xk(t,e){const n=A0[e];(!n||n[t.key]!==t)&&qo(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Pk(t),delete n[t.key]}function Qk(t,e,n,s){let i=A0[e.name];i||(i={},A0[e.name]=i);let r=i[t.toURLString()];return r&&qo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Rk(t,Wk,n,s),i[t.toURLString()]=r,r}class Zk{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ck(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ur(this._repo,xt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Xk(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&qo("Cannot call "+e+" on a deleted database.")}}function Jk(t=ng(),e){return eg(t,"database").getImmediate({identifier:e})}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(t){HC(tg),mu(new vl("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Yk(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),Di(D2,P2,t),Di(D2,P2,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM={".sv":"timestamp"};function _y(){return tM}Yi.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Yi.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};eM();var nM=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ge,Ug=Ug||{},at=nM||self;function Ed(){}function R0(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function bu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function sM(t){return Object.prototype.hasOwnProperty.call(t,t1)&&t[t1]||(t[t1]=++iM)}var t1="closure_uid_"+(1e9*Math.random()>>>0),iM=0;function rM(t,e,n){return t.call.apply(t.bind,arguments)}function oM(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,s),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Dn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Dn=rM:Dn=oM,Dn.apply(null,arguments)}function ch(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Bn(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,i,r){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(s,o)}}function Kr(){this.s=this.s,this.o=this.o}var aM=0;Kr.prototype.s=!1;Kr.prototype.na=function(){!this.s&&(this.s=!0,this.M(),aM!=0)&&sM(this)};Kr.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const C5=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I5=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,i=typeof t=="string"?t.split(""):t;for(let r=0;r<s;r++)r in i&&e.call(n,i[r],r,t)};function lM(t){e:{var e=JM;const n=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<n;i++)if(i in s&&e.call(void 0,s[i],i,t)){e=i;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function vy(t){return Array.prototype.concat.apply([],arguments)}function jg(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function Td(t){return/^[\s\xa0]*$/.test(t)}var yy=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ts(t,e){return t.indexOf(e)!=-1}function n1(t,e){return t<e?-1:t>e?1:0}var ns;e:{var by=at.navigator;if(by){var wy=by.userAgent;if(wy){ns=wy;break e}}ns=""}function Hg(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function k5(t){const e={};for(const n in t)e[n]=t[n];return e}var Ey="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M5(t,e){let n,s;for(let i=1;i<arguments.length;i++){s=arguments[i];for(n in s)t[n]=s[n];for(let r=0;r<Ey.length;r++)n=Ey[r],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function Vg(t){return Vg[" "](t),t}Vg[" "]=Ed;function cM(t){var e=dM;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var uM=ts(ns,"Opera"),el=ts(ns,"Trident")||ts(ns,"MSIE"),x5=ts(ns,"Edge"),C0=x5||el,O5=ts(ns,"Gecko")&&!(ts(ns.toLowerCase(),"webkit")&&!ts(ns,"Edge"))&&!(ts(ns,"Trident")||ts(ns,"MSIE"))&&!ts(ns,"Edge"),hM=ts(ns.toLowerCase(),"webkit")&&!ts(ns,"Edge");function N5(){var t=at.document;return t?t.documentMode:void 0}var Sd;e:{var s1="",i1=function(){var t=ns;if(O5)return/rv:([^\);]+)(\)|;)/.exec(t);if(x5)return/Edge\/([\d\.]+)/.exec(t);if(el)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(hM)return/WebKit\/(\S+)/.exec(t);if(uM)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(i1&&(s1=i1?i1[1]:""),el){var r1=N5();if(r1!=null&&r1>parseFloat(s1)){Sd=String(r1);break e}}Sd=s1}var dM={};function fM(){return cM(function(){let t=0;const e=yy(String(Sd)).split("."),n=yy("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var i=e[o]||"",r=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i[0].length==0&&r[0].length==0)break;t=n1(i[1].length==0?0:parseInt(i[1],10),r[1].length==0?0:parseInt(r[1],10))||n1(i[2].length==0,r[2].length==0)||n1(i[2],r[2]),i=i[3],r=r[3]}while(t==0)}return 0<=t})}var I0;if(at.document&&el){var Ty=N5();I0=Ty||parseInt(Sd,10)||void 0}else I0=void 0;var mM=I0,pM=function(){if(!at.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{at.addEventListener("test",Ed,e),at.removeEventListener("test",Ed,e)}catch{}return t}();function zn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}zn.prototype.h=function(){this.defaultPrevented=!0};function Bc(t,e){if(zn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(O5){e:{try{Vg(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:gM[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bc.Z.h.call(this)}}Bn(Bc,zn);var gM={2:"touch",3:"pen",4:"mouse"};Bc.prototype.h=function(){Bc.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var wu="closure_listenable_"+(1e6*Math.random()|0),_M=0;function vM(t,e,n,s,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=i,this.key=++_M,this.ca=this.fa=!1}function Rf(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Cf(t){this.src=t,this.g={},this.h=0}Cf.prototype.add=function(t,e,n,s,i){var r=t.toString();t=this.g[r],t||(t=this.g[r]=[],this.h++);var o=M0(t,e,s,i);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new vM(e,this.src,r,!!s,i),e.fa=n,t.push(e)),e};function k0(t,e){var n=e.type;if(n in t.g){var s=t.g[n],i=C5(s,e),r;(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(Rf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function M0(t,e,n,s){for(var i=0;i<t.length;++i){var r=t[i];if(!r.ca&&r.listener==e&&r.capture==!!n&&r.ia==s)return i}return-1}var qg="closure_lm_"+(1e6*Math.random()|0),o1={};function L5(t,e,n,s,i){if(s&&s.once)return P5(t,e,n,s,i);if(Array.isArray(e)){for(var r=0;r<e.length;r++)L5(t,e[r],n,s,i);return null}return n=Kg(n),t&&t[wu]?t.N(e,n,bu(s)?!!s.capture:!!s,i):D5(t,e,n,!1,s,i)}function D5(t,e,n,s,i,r){if(!e)throw Error("Invalid event type");var o=bu(i)?!!i.capture:!!i,a=zg(t);if(a||(t[qg]=a=new Cf(t)),n=a.add(e,n,s,o,r),n.proxy)return n;if(s=yM(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)pM||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),s,i);else if(t.attachEvent)t.attachEvent(B5(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function yM(){function t(n){return e.call(t.src,t.listener,n)}var e=bM;return t}function P5(t,e,n,s,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)P5(t,e[r],n,s,i);return null}return n=Kg(n),t&&t[wu]?t.O(e,n,bu(s)?!!s.capture:!!s,i):D5(t,e,n,!0,s,i)}function F5(t,e,n,s,i){if(Array.isArray(e))for(var r=0;r<e.length;r++)F5(t,e[r],n,s,i);else s=bu(s)?!!s.capture:!!s,n=Kg(n),t&&t[wu]?(t=t.i,e=String(e).toString(),e in t.g&&(r=t.g[e],n=M0(r,n,s,i),-1<n&&(Rf(r[n]),Array.prototype.splice.call(r,n,1),r.length==0&&(delete t.g[e],t.h--)))):t&&(t=zg(t))&&(e=t.g[e.toString()],t=-1,e&&(t=M0(e,n,s,i)),(n=-1<t?e[t]:null)&&$g(n))}function $g(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[wu])k0(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(B5(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=zg(e))?(k0(n,t),n.h==0&&(n.src=null,e[qg]=null)):Rf(t)}}}function B5(t){return t in o1?o1[t]:o1[t]="on"+t}function bM(t,e){if(t.ca)t=!0;else{e=new Bc(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&$g(t),t=n.call(s,e)}return t}function zg(t){return t=t[qg],t instanceof Cf?t:null}var a1="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kg(t){return typeof t=="function"?t:(t[a1]||(t[a1]=function(e){return t.handleEvent(e)}),t[a1])}function On(){Kr.call(this),this.i=new Cf(this),this.P=this,this.I=null}Bn(On,Kr);On.prototype[wu]=!0;On.prototype.removeEventListener=function(t,e,n,s){F5(this,t,e,n,s)};function Pn(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new zn(e,t);else if(e instanceof zn)e.target=e.target||t;else{var i=e;e=new zn(s,t),M5(e,i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];i=uh(o,s,!0,e)&&i}if(o=e.g=t,i=uh(o,s,!0,e)&&i,i=uh(o,s,!1,e)&&i,n)for(r=0;r<n.length;r++)o=e.g=n[r],i=uh(o,s,!1,e)&&i}On.prototype.M=function(){if(On.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Rf(n[s]);delete t.g[e],t.h--}}this.I=null};On.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};On.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function uh(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&k0(t.i,o),i=a.call(l,s)!==!1&&i}}return i&&!s.defaultPrevented}var Gg=at.JSON.stringify;function wM(){var t=j5;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class EM{constructor(){this.h=this.g=null}add(e,n){const s=U5.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var U5=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new TM,t=>t.reset());class TM{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function SM(t){at.setTimeout(()=>{throw t},0)}function Wg(t,e){x0||AM(),O0||(x0(),O0=!0),j5.add(t,e)}var x0;function AM(){var t=at.Promise.resolve(void 0);x0=function(){t.then(RM)}}var O0=!1,j5=new EM;function RM(){for(var t;t=wM();){try{t.h.call(t.g)}catch(n){SM(n)}var e=U5;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}O0=!1}function If(t,e){On.call(this),this.h=t||1,this.g=e||at,this.j=Dn(this.kb,this),this.l=Date.now()}Bn(If,On);Ge=If.prototype;Ge.da=!1;Ge.S=null;Ge.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Pn(this,"tick"),this.da&&(Yg(this),this.start()))}};Ge.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Yg(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}Ge.M=function(){If.Z.M.call(this),Yg(this),delete this.g};function Xg(t,e,n){if(typeof t=="function")n&&(t=Dn(t,n));else if(t&&typeof t.handleEvent=="function")t=Dn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:at.setTimeout(t,e||0)}function H5(t){t.g=Xg(()=>{t.g=null,t.i&&(t.i=!1,H5(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class CM extends Kr{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:H5(this)}M(){super.M(),this.g&&(at.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Uc(t){Kr.call(this),this.h=t,this.g={}}Bn(Uc,Kr);var Sy=[];function V5(t,e,n,s){Array.isArray(n)||(n&&(Sy[0]=n.toString()),n=Sy);for(var i=0;i<n.length;i++){var r=L5(e,n[i],s||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function q5(t){Hg(t.g,function(e,n){this.g.hasOwnProperty(n)&&$g(e)},t),t.g={}}Uc.prototype.M=function(){Uc.Z.M.call(this),q5(this)};Uc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function kf(){this.g=!0}kf.prototype.Aa=function(){this.g=!1};function IM(t,e,n,s,i,r){t.info(function(){if(t.g)if(r)for(var o="",a=r.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");o=2<=u.length&&u[1]=="type"?o+(d+"="+c+"&"):o+(d+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+s+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function kM(t,e,n,s,i,r,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+i+"]: "+e+`
`+n+`
`+r+" "+o})}function Ma(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+xM(t,n)+(s?" "+s:"")})}function MM(t,e){t.info(function(){return"TIMEOUT: "+e})}kf.prototype.info=function(){};function xM(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var i=s[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if(r!="noop"&&r!="stop"&&r!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Gg(n)}catch{return e}}var ca={},Ay=null;function Mf(){return Ay=Ay||new On}ca.Ma="serverreachability";function $5(t){zn.call(this,ca.Ma,t)}Bn($5,zn);function jc(t){const e=Mf();Pn(e,new $5(e))}ca.STAT_EVENT="statevent";function z5(t,e){zn.call(this,ca.STAT_EVENT,t),this.stat=e}Bn(z5,zn);function is(t){const e=Mf();Pn(e,new z5(e,t))}ca.Na="timingevent";function K5(t,e){zn.call(this,ca.Na,t),this.size=e}Bn(K5,zn);function Eu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return at.setTimeout(function(){t()},e)}var xf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},G5={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Qg(){}Qg.prototype.h=null;function Ry(t){return t.h||(t.h=t.i())}function W5(){}var Tu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Zg(){zn.call(this,"d")}Bn(Zg,zn);function Jg(){zn.call(this,"c")}Bn(Jg,zn);var N0;function Of(){}Bn(Of,Qg);Of.prototype.g=function(){return new XMLHttpRequest};Of.prototype.i=function(){return{}};N0=new Of;function Su(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new Uc(this),this.P=OM,t=C0?125:void 0,this.W=new If(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Y5}function Y5(){this.i=null,this.g="",this.h=!1}var OM=45e3,L0={},Ad={};Ge=Su.prototype;Ge.setTimeout=function(t){this.P=t};function D0(t,e,n){t.K=1,t.v=Lf(ir(e)),t.s=n,t.U=!0,X5(t,null)}function X5(t,e){t.F=Date.now(),Au(t),t.A=ir(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),sE(n.h,"t",s),t.C=0,n=t.l.H,t.h=new Y5,t.g=TE(t.l,n?e:null,!t.s),0<t.O&&(t.L=new CM(Dn(t.Ia,t,t.g),t.O)),V5(t.V,t.g,"readystatechange",t.gb),e=t.H?k5(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),jc(),IM(t.j,t.u,t.A,t.m,t.X,t.s)}Ge.gb=function(t){t=t.target;const e=this.L;e&&Ki(t)==3?e.l():this.Ia(t)};Ge.Ia=function(t){try{if(t==this.g)e:{const d=Ki(this.g);var e=this.g.Da();const u=this.g.ba();if(!(3>d)&&(d!=3||C0||this.g&&(this.h.h||this.g.ga()||My(this.g)))){this.I||d!=4||e==7||(e==8||0>=u?jc(3):jc(2)),Nf(this);var n=this.g.ba();this.N=n;t:if(Q5(this)){var s=My(this.g);t="";var i=s.length,r=Ki(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){ko(this),gc(this);var o="";break t}this.h.i=new at.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:r&&e==i-1});s.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,kM(this.j,this.u,this.A,this.m,this.X,d,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Td(a)){var c=a;break t}}c=null}if(n=c)Ma(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,P0(this,n);else{this.i=!1,this.o=3,is(12),ko(this),gc(this);break e}}this.U?(Z5(this,d,o),C0&&this.i&&d==3&&(V5(this.V,this.W,"tick",this.fb),this.W.start())):(Ma(this.j,this.m,o,null),P0(this,o)),d==4&&ko(this),this.i&&!this.I&&(d==4?yE(this.l,this):(this.i=!1,Au(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,is(12)):(this.o=0,is(13)),ko(this),gc(this)}}}catch{}finally{}};function Q5(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function Z5(t,e,n){let s=!0,i;for(;!t.I&&t.C<n.length;)if(i=NM(t,n),i==Ad){e==4&&(t.o=4,is(14),s=!1),Ma(t.j,t.m,null,"[Incomplete Response]");break}else if(i==L0){t.o=4,is(15),Ma(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else Ma(t.j,t.m,i,null),P0(t,i);Q5(t)&&i!=Ad&&i!=L0&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,is(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),l_(e),e.L=!0,is(11))):(Ma(t.j,t.m,n,"[Invalid Chunked Response]"),ko(t),gc(t))}Ge.fb=function(){if(this.g){var t=Ki(this.g),e=this.g.ga();this.C<e.length&&(Nf(this),Z5(this,t,e),this.i&&t!=4&&Au(this))}};function NM(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?Ad:(n=Number(e.substring(n,s)),isNaN(n)?L0:(s+=1,s+n>e.length?Ad:(e=e.substr(s,n),t.C=s+n,e)))}Ge.cancel=function(){this.I=!0,ko(this)};function Au(t){t.Y=Date.now()+t.P,J5(t,t.P)}function J5(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Eu(Dn(t.eb,t),e)}function Nf(t){t.B&&(at.clearTimeout(t.B),t.B=null)}Ge.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(MM(this.j,this.A),this.K!=2&&(jc(),is(17)),ko(this),this.o=2,gc(this)):J5(this,this.Y-t)};function gc(t){t.l.G==0||t.I||yE(t.l,t)}function ko(t){Nf(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Yg(t.W),q5(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function P0(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||F0(n.i,t))){if(n.I=t.N,!t.J&&F0(n.i,t)&&n.G==3){try{var s=n.Ca.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var i=s;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)kd(n),Ff(n);else break e;a_(n),is(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&n.A==0&&!n.v&&(n.v=Eu(Dn(n.ab,n),6e3));if(1>=oE(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Mo(n,11)}else if((t.J||n.g==t)&&kd(n),!Td(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const d=c[3];d!=null&&(n.ma=d,n.h.info("VER="+n.ma));const u=c[4];u!=null&&(n.za=u,n.h.info("SVER="+n.za));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(s=1.5*f,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const m=t.g;if(m){const h=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var r=s.i;!r.g&&(ts(h,"spdy")||ts(h,"quic")||ts(h,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(n_(r,r.h),r.h=null))}if(s.D){const M=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(s.sa=M,ln(s.F,s.D,M))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),s=n;var o=t;if(s.oa=EE(s,s.H?s.la:null,s.W),o.J){aE(s.i,o);var a=o,l=s.K;l&&a.setTimeout(l),a.B&&(Nf(a),Au(a)),s.g=o}else _E(s);0<n.l.length&&Bf(n)}else c[0]!="stop"&&c[0]!="close"||Mo(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Mo(n,7):o_(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}jc(4)}catch{}}function LM(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(R0(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function e_(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(R0(t)||typeof t=="string")I5(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(R0(t)||typeof t=="string"){n=[];for(var s=t.length,i=0;i<s;i++)n.push(i)}else for(i in n=[],s=0,t)n[s++]=i;s=LM(t),i=s.length;for(var r=0;r<i;r++)e.call(void 0,s[r],n&&n[r],t)}}function El(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof El)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}Ge=El.prototype;Ge.R=function(){t_(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};Ge.T=function(){return t_(this),this.g.concat()};function t_(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];Wo(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)s=t.g[e],Wo(i,s)||(t.g[n++]=s,i[s]=1),e++;t.g.length=n}}Ge.get=function(t,e){return Wo(this.h,t)?this.h[t]:e};Ge.set=function(t,e){Wo(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};Ge.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var i=n[s],r=this.get(i);t.call(e,r,i,this)}};function Wo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var eE=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function DM(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),i=null;if(0<=s){var r=t[n].substring(0,s);i=t[n].substring(s+1)}else r=t[n];e(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Yo(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Yo){this.g=e!==void 0?e:t.g,Rd(this,t.j),this.s=t.s,Cd(this,t.i),Id(this,t.m),this.l=t.l,e=t.h;var n=new Hc;n.i=e.i,e.g&&(n.g=new El(e.g),n.h=e.h),Cy(this,n),this.o=t.o}else t&&(n=String(t).match(eE))?(this.g=!!e,Rd(this,n[1]||"",!0),this.s=_c(n[2]||""),Cd(this,n[3]||"",!0),Id(this,n[4]),this.l=_c(n[5]||"",!0),Cy(this,n[6]||"",!0),this.o=_c(n[7]||"")):(this.g=!!e,this.h=new Hc(null,this.g))}Yo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ec(e,Iy,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(ec(e,Iy,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(ec(n,n.charAt(0)=="/"?jM:UM,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ec(n,VM)),t.join("")};function ir(t){return new Yo(t)}function Rd(t,e,n){t.j=n?_c(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Cd(t,e,n){t.i=n?_c(e,!0):e}function Id(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Cy(t,e,n){e instanceof Hc?(t.h=e,qM(t.h,t.g)):(n||(e=ec(e,HM)),t.h=new Hc(e,t.g))}function ln(t,e,n){t.h.set(e,n)}function Lf(t){return ln(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function PM(t){return t instanceof Yo?ir(t):new Yo(t,void 0)}function FM(t,e,n,s){var i=new Yo(null,void 0);return t&&Rd(i,t),e&&Cd(i,e),n&&Id(i,n),s&&(i.l=s),i}function _c(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ec(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,BM),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function BM(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Iy=/[#\/\?@]/g,UM=/[#\?:]/g,jM=/[#\?]/g,HM=/[#\?@]/g,VM=/#/g;function Hc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Gr(t){t.g||(t.g=new El,t.h=0,t.i&&DM(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}Ge=Hc.prototype;Ge.add=function(t,e){Gr(this),this.i=null,t=Tl(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function tE(t,e){Gr(t),e=Tl(t,e),Wo(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,Wo(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&t_(t)))}function nE(t,e){return Gr(t),e=Tl(t,e),Wo(t.g.h,e)}Ge.forEach=function(t,e){Gr(this),this.g.forEach(function(n,s){I5(n,function(i){t.call(e,i,s,this)},this)},this)};Ge.T=function(){Gr(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var i=t[s],r=0;r<i.length;r++)n.push(e[s]);return n};Ge.R=function(t){Gr(this);var e=[];if(typeof t=="string")nE(this,t)&&(e=vy(e,this.g.get(Tl(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=vy(e,t[n])}return e};Ge.set=function(t,e){return Gr(this),this.i=null,t=Tl(this,t),nE(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};Ge.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function sE(t,e,n){tE(t,e),0<n.length&&(t.i=null,t.g.set(Tl(t,e),jg(n)),t.h+=n.length)}Ge.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],i=encodeURIComponent(String(s));s=this.R(s);for(var r=0;r<s.length;r++){var o=i;s[r]!==""&&(o+="="+encodeURIComponent(String(s[r]))),t.push(o)}}return this.i=t.join("&")};function Tl(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function qM(t,e){e&&!t.j&&(Gr(t),t.i=null,t.g.forEach(function(n,s){var i=s.toLowerCase();s!=i&&(tE(this,s),sE(this,i,n))},t)),t.j=e}var $M=class{constructor(t,e){this.h=t,this.g=e}};function iE(t){this.l=t||zM,at.PerformanceNavigationTiming?(t=at.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(at.g&&at.g.Ea&&at.g.Ea()&&at.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var zM=10;function rE(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function oE(t){return t.h?1:t.g?t.g.size:0}function F0(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function n_(t,e){t.g?t.g.add(e):t.h=e}function aE(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}iE.prototype.cancel=function(){if(this.i=lE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function lE(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return jg(t.i)}function s_(){}s_.prototype.stringify=function(t){return at.JSON.stringify(t,void 0)};s_.prototype.parse=function(t){return at.JSON.parse(t,void 0)};function KM(){this.g=new s_}function GM(t,e,n){const s=n||"";try{e_(t,function(i,r){let o=i;bu(i)&&(o=Gg(i)),e.push(s+r+"="+encodeURIComponent(o))})}catch(i){throw e.push(s+"type="+encodeURIComponent("_badmap")),i}}function WM(t,e){const n=new kf;if(at.Image){const s=new Image;s.onload=ch(hh,n,s,"TestLoadImage: loaded",!0,e),s.onerror=ch(hh,n,s,"TestLoadImage: error",!1,e),s.onabort=ch(hh,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=ch(hh,n,s,"TestLoadImage: timeout",!1,e),at.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function hh(t,e,n,s,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(s)}catch{}}function Ru(t){this.l=t.$b||null,this.j=t.ib||!1}Bn(Ru,Qg);Ru.prototype.g=function(){return new Df(this.l,this.j)};Ru.prototype.i=function(t){return function(){return t}}({});function Df(t,e){On.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=i_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Bn(Df,On);var i_=0;Ge=Df.prototype;Ge.open=function(t,e){if(this.readyState!=i_)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Vc(this)};Ge.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||at).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};Ge.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cu(this)),this.readyState=i_};Ge.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Vc(this)),this.g&&(this.readyState=3,Vc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof at.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;cE(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function cE(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}Ge.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Cu(this):Vc(this),this.readyState==3&&cE(this)}};Ge.Ua=function(t){this.g&&(this.response=this.responseText=t,Cu(this))};Ge.Ta=function(t){this.g&&(this.response=t,Cu(this))};Ge.ha=function(){this.g&&Cu(this)};function Cu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Vc(t)}Ge.setRequestHeader=function(t,e){this.v.append(t,e)};Ge.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};Ge.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Vc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Df.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var YM=at.JSON.parse;function Tn(t){On.call(this),this.headers=new El,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=uE,this.K=this.L=!1}Bn(Tn,On);var uE="",XM=/^https?$/i,QM=["POST","PUT"];Ge=Tn.prototype;Ge.ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():N0.g(),this.C=this.u?Ry(this.u):Ry(N0),this.g.onreadystatechange=Dn(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(r){ky(this,r);return}t=n||"";const i=new El(this.headers);s&&e_(s,function(r,o){i.set(o,r)}),s=lM(i.T()),n=at.FormData&&t instanceof at.FormData,!(0<=C5(QM,e))||s||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(r,o){this.g.setRequestHeader(o,r)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{fE(this),0<this.B&&((this.K=ZM(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Dn(this.pa,this)):this.A=Xg(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(r){ky(this,r)}};function ZM(t){return el&&fM()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function JM(t){return t.toLowerCase()=="content-type"}Ge.pa=function(){typeof Ug!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Pn(this,"timeout"),this.abort(8))};function ky(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,hE(t),Pf(t)}function hE(t){t.D||(t.D=!0,Pn(t,"complete"),Pn(t,"error"))}Ge.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Pn(this,"complete"),Pn(this,"abort"),Pf(this))};Ge.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pf(this,!0)),Tn.Z.M.call(this)};Ge.Fa=function(){this.s||(this.F||this.v||this.l?dE(this):this.cb())};Ge.cb=function(){dE(this)};function dE(t){if(t.h&&typeof Ug!="undefined"&&(!t.C[1]||Ki(t)!=4||t.ba()!=2)){if(t.v&&Ki(t)==4)Xg(t.Fa,0,t);else if(Pn(t,"readystatechange"),Ki(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var i=String(t.H).match(eE)[1]||null;if(!i&&at.self&&at.self.location){var r=at.self.location.protocol;i=r.substr(0,r.length-1)}s=!XM.test(i?i.toLowerCase():"")}n=s}if(n)Pn(t,"complete"),Pn(t,"success");else{t.m=6;try{var o=2<Ki(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",hE(t)}}finally{Pf(t)}}}}function Pf(t,e){if(t.g){fE(t);const n=t.g,s=t.C[0]?Ed:null;t.g=null,t.C=null,e||Pn(t,"ready");try{n.onreadystatechange=s}catch{}}}function fE(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(at.clearTimeout(t.A),t.A=null)}function Ki(t){return t.g?t.g.readyState:0}Ge.ba=function(){try{return 2<Ki(this)?this.g.status:-1}catch{return-1}};Ge.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};Ge.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),YM(e)}};function My(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case uE:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}Ge.Da=function(){return this.m};Ge.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function ex(t){let e="";return Hg(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function r_(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=ex(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ln(t,e,n))}function ql(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function mE(t){this.za=0,this.l=[],this.h=new kf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ql("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ql("baseRetryDelayMs",5e3,t),this.$a=ql("retryDelaySeedMs",1e4,t),this.Ya=ql("forwardChannelMaxRetries",2,t),this.ra=ql("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new iE(t&&t.concurrentRequestLimit),this.Ca=new KM,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}Ge=mE.prototype;Ge.ma=8;Ge.G=1;function o_(t){if(pE(t),t.G==3){var e=t.V++,n=ir(t.F);ln(n,"SID",t.J),ln(n,"RID",e),ln(n,"TYPE","terminate"),Iu(t,n),e=new Su(t,t.h,e,void 0),e.K=2,e.v=Lf(ir(n)),n=!1,at.navigator&&at.navigator.sendBeacon&&(n=at.navigator.sendBeacon(e.v.toString(),"")),!n&&at.Image&&(new Image().src=e.v,n=!0),n||(e.g=TE(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Au(e)}wE(t)}Ge.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function Ff(t){t.g&&(l_(t),t.g.cancel(),t.g=null)}function pE(t){Ff(t),t.u&&(at.clearTimeout(t.u),t.u=null),kd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&at.clearTimeout(t.m),t.m=null)}function l1(t,e){t.l.push(new $M(t.Za++,e)),t.G==3&&Bf(t)}function Bf(t){rE(t.i)||t.m||(t.m=!0,Wg(t.Ha,t),t.C=0)}function tx(t,e){return oE(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Eu(Dn(t.Ha,t,e),bE(t,t.C)),t.C++,!0)}Ge.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const i=new Su(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?(r=k5(r),M5(r,this.P)):r=this.P),this.o===null&&(i.H=r),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var s=this.l[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=gE(this,i,e),n=ir(this.F),ln(n,"RID",t),ln(n,"CVER",22),this.D&&ln(n,"X-HTTP-Session-Id",this.D),Iu(this,n),this.o&&r&&r_(n,this.o,r),n_(this.i,i),this.Ra&&ln(n,"TYPE","init"),this.ja?(ln(n,"$req",e),ln(n,"SID","null"),i.$=!0,D0(i,n,null)):D0(i,n,e),this.G=2}}else this.G==3&&(t?xy(this,t):this.l.length==0||rE(this.i)||xy(this))};function xy(t,e){var n;e?n=e.m:n=t.V++;const s=ir(t.F);ln(s,"SID",t.J),ln(s,"RID",n),ln(s,"AID",t.U),Iu(t,s),t.o&&t.s&&r_(s,t.o,t.s),n=new Su(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=gE(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),n_(t.i,n),D0(n,s,e)}function Iu(t,e){t.j&&e_({},function(n,s){ln(e,s,n)})}function gE(t,e,n){n=Math.min(t.l.length,n);var s=t.j?Dn(t.j.Oa,t.j,t):null;e:{var i=t.l;let r=-1;for(;;){const o=["count="+n];r==-1?0<n?(r=i[0].h,o.push("ofs="+r)):r=0:o.push("ofs="+r);let a=!0;for(let l=0;l<n;l++){let c=i[l].h;const d=i[l].g;if(c-=r,0>c)r=Math.max(0,i[l].h-100),a=!1;else try{GM(d,o,"req"+c+"_")}catch{s&&s(d)}}if(a){s=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,s}function _E(t){t.g||t.u||(t.Y=1,Wg(t.Ga,t),t.A=0)}function a_(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Eu(Dn(t.Ga,t),bE(t,t.A)),t.A++,!0)}Ge.Ga=function(){if(this.u=null,vE(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Eu(Dn(this.bb,this),t)}};Ge.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,is(10),Ff(this),vE(this))};function l_(t){t.B!=null&&(at.clearTimeout(t.B),t.B=null)}function vE(t){t.g=new Su(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=ir(t.oa);ln(e,"RID","rpc"),ln(e,"SID",t.J),ln(e,"CI",t.N?"0":"1"),ln(e,"AID",t.U),Iu(t,e),ln(e,"TYPE","xmlhttp"),t.o&&t.s&&r_(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Lf(ir(e)),n.s=null,n.U=!0,X5(n,t)}Ge.ab=function(){this.v!=null&&(this.v=null,Ff(this),a_(this),is(19))};function kd(t){t.v!=null&&(at.clearTimeout(t.v),t.v=null)}function yE(t,e){var n=null;if(t.g==e){kd(t),l_(t),t.g=null;var s=2}else if(F0(t.i,e))n=e.D,aE(t.i,e),s=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;s=Mf(),Pn(s,new K5(s,n)),Bf(t)}else _E(t);else if(i=e.o,i==3||i==0&&0<t.I||!(s==1&&tx(t,e)||s==2&&a_(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Mo(t,5);break;case 4:Mo(t,10);break;case 3:Mo(t,6);break;default:Mo(t,2)}}}function bE(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Mo(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var s=Dn(t.jb,t);n||(n=new Yo("//www.google.com/images/cleardot.gif"),at.location&&at.location.protocol=="http"||Rd(n,"https"),Lf(n)),WM(n.toString(),s)}else is(2);t.G=0,t.j&&t.j.va(e),wE(t),pE(t)}Ge.jb=function(t){t?(this.h.info("Successfully pinged google.com"),is(2)):(this.h.info("Failed to ping google.com"),is(1))};function wE(t){t.G=0,t.I=-1,t.j&&((lE(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,jg(t.l),t.l.length=0),t.j.ua())}function EE(t,e,n){let s=PM(n);if(s.i!="")e&&Cd(s,e+"."+s.i),Id(s,s.m);else{const i=at.location;s=FM(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Hg(t.aa,function(i,r){ln(s,r,i)}),e=t.D,n=t.sa,e&&n&&ln(s,e,n),ln(s,"VER",t.ma),Iu(t,s),s}function TE(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Tn(new Ru({ib:!0})):new Tn(t.qa),e.L=t.H,e}function SE(){}Ge=SE.prototype;Ge.xa=function(){};Ge.wa=function(){};Ge.va=function(){};Ge.ua=function(){};Ge.Oa=function(){};function Md(){if(el&&!(10<=Number(mM)))throw Error("Environmental error: no available transport.")}Md.prototype.g=function(t,e){return new Hs(t,e)};function Hs(t,e){On.call(this),this.g=new mE(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Td(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Td(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Sl(this)}Bn(Hs,On);Hs.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Wg(Dn(t.hb,t,e))),is(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=EE(t,null,t.W),Bf(t)};Hs.prototype.close=function(){o_(this.g)};Hs.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,l1(this.g,e)}else this.v?(e={},e.__data__=Gg(t),l1(this.g,e)):l1(this.g,t)};Hs.prototype.M=function(){this.g.j=null,delete this.j,o_(this.g),delete this.g,Hs.Z.M.call(this)};function AE(t){Zg.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Bn(AE,Zg);function RE(){Jg.call(this),this.status=1}Bn(RE,Jg);function Sl(t){this.g=t}Bn(Sl,SE);Sl.prototype.xa=function(){Pn(this.g,"a")};Sl.prototype.wa=function(t){Pn(this.g,new AE(t))};Sl.prototype.va=function(t){Pn(this.g,new RE)};Sl.prototype.ua=function(){Pn(this.g,"b")};Md.prototype.createWebChannel=Md.prototype.g;Hs.prototype.send=Hs.prototype.u;Hs.prototype.open=Hs.prototype.m;Hs.prototype.close=Hs.prototype.close;xf.NO_ERROR=0;xf.TIMEOUT=8;xf.HTTP_ERROR=6;G5.COMPLETE="complete";W5.EventType=Tu;Tu.OPEN="a";Tu.CLOSE="b";Tu.ERROR="c";Tu.MESSAGE="d";On.prototype.listen=On.prototype.N;Tn.prototype.listenOnce=Tn.prototype.O;Tn.prototype.getLastError=Tn.prototype.La;Tn.prototype.getLastErrorCode=Tn.prototype.Da;Tn.prototype.getStatus=Tn.prototype.ba;Tn.prototype.getResponseJson=Tn.prototype.Qa;Tn.prototype.getResponseText=Tn.prototype.ga;Tn.prototype.send=Tn.prototype.ea;var nx=function(){return new Md},sx=function(){return Mf()},c1=xf,ix=G5,rx=ca,Oy={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ox=Ru,dh=W5,ax=Tn;const Ny="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_s.UNAUTHENTICATED=new _s(null),_s.GOOGLE_CREDENTIALS=new _s("google-credentials-uid"),_s.FIRST_PARTY=new _s("first-party-uid"),_s.MOCK_USER=new _s("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Al="9.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=new Zp("@firebase/firestore");function Ly(){return Xo.logLevel}function tt(t,...e){if(Xo.logLevel<=kt.DEBUG){const n=e.map(c_);Xo.debug(`Firestore (${Al}): ${t}`,...n)}}function Hr(t,...e){if(Xo.logLevel<=kt.ERROR){const n=e.map(c_);Xo.error(`Firestore (${Al}): ${t}`,...n)}}function Dy(t,...e){if(Xo.logLevel<=kt.WARN){const n=e.map(c_);Xo.warn(`Firestore (${Al}): ${t}`,...n)}}function c_(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t="Unexpected state"){const e=`FIRESTORE (${Al}) INTERNAL ASSERTION FAILED: `+t;throw Hr(e),new Error(e)}function Jt(t,e){t||dt()}function ft(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends Error{constructor(e,n){super(n),this.code=e,this.message=n,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,n){this.user=n,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class cx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(_s.UNAUTHENTICATED))}shutdown(){}}class ux{constructor(e){this.t=e,this.currentUser=_s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const i=l=>this.i!==s?(s=this.i,n(l)):Promise.resolve();let r=new Xi;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Xi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{tt("FirebaseCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(tt("FirebaseCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Xi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(tt("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Jt(typeof s.accessToken=="string"),new lx(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Jt(e===null||typeof e=="string"),new _s(e)}}class hx{constructor(e,n,s){this.h=e,this.l=n,this.m=s,this.type="FirstParty",this.user=_s.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.l},n=this.h.auth.getAuthHeaderValueForFirstParty([]);return n&&(e.Authorization=n),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}}class dx{constructor(e,n,s){this.h=e,this.l=n,this.m=s}getToken(){return Promise.resolve(new hx(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(_s.FIRST_PARTY))}shutdown(){}invalidateToken(){}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.g(s),this.p=s=>n.writeSequenceNumber(s))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.p&&this.p(e),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fx(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */u_.T=-1;class CE{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const i=fx(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<n&&(s+=e.charAt(i[r]%e.length))}return s}}function Ft(t,e){return t<e?-1:t>e?1:0}function tl(t,e,n){return t.length===e.length&&t.every((s,i)=>n(s,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ps.fromMillis(Date.now())}static fromDate(e){return Ps.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Ps(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ft(this.nanoseconds,e.nanoseconds):Ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Lt(e)}static min(){return new Lt(new Ps(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ua(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function IE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n,s){n===void 0?n=0:n>e.length&&dt(),s===void 0?s=e.length-n:s>e.length-n&&dt(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return qc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qc?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let i=0;i<s;i++){const r=e.get(i),o=n.get(i);if(r<o)return-1;if(r>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class nn extends qc{construct(e,n,s){return new nn(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(i=>i.length>0))}return new nn(n)}static emptyPath(){return new nn([])}}const mx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ws extends qc{construct(e,n,s){return new ws(e,n,s)}static isValidIdentifier(e){return mx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ws.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ws(["__name__"])}static fromServerFormat(e){const n=[];let s="",i=0;const r=()=>{if(s.length===0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new qe(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new qe(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new qe(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ws(n)}static emptyPath(){return new ws([])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e){this.fields=e,e.sort(ws.comparator)}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return tl(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new Wn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let r=0;r<s.length;++r)i+=String.fromCharCode(s[r]);return i}(e);return new Wn(n)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wn.EMPTY_BYTE_STRING=new Wn("");const px=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vr(t){if(Jt(!!t),typeof t=="string"){let e=0;const n=px.exec(t);if(Jt(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:wn(t.seconds),nanos:wn(t.nanos)}}function wn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function nl(t){return typeof t=="string"?Wn.fromBase64String(t):Wn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function kE(t){const e=t.mapValue.fields.__previous_value__;return h_(e)?kE(e):e}function zc(t){const e=Vr(t.mapValue.fields.__local_write_time__.timestampValue);return new Ps(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t){return t==null}function xd(t){return t===0&&1/t==-1/0}function gx(t){return typeof t=="number"&&Number.isInteger(t)&&!xd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.path=e}static fromPath(e){return new nt(nn.fromString(e))}static fromName(e){return new nt(nn.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return e!==null&&nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return nn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new nn(e.slice()))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?h_(t)?4:10:dt()}function Fi(t,e){const n=Qo(t);if(n!==Qo(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zc(t).isEqual(zc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const r=Vr(s.timestampValue),o=Vr(i.timestampValue);return r.seconds===o.seconds&&r.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return nl(s.bytesValue).isEqual(nl(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return wn(s.geoPointValue.latitude)===wn(i.geoPointValue.latitude)&&wn(s.geoPointValue.longitude)===wn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return wn(s.integerValue)===wn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const r=wn(s.doubleValue),o=wn(i.doubleValue);return r===o?xd(r)===xd(o):isNaN(r)&&isNaN(o)}return!1}(t,e);case 9:return tl(t.arrayValue.values||[],e.arrayValue.values||[],Fi);case 10:return function(s,i){const r=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Py(r)!==Py(o))return!1;for(const a in r)if(r.hasOwnProperty(a)&&(o[a]===void 0||!Fi(r[a],o[a])))return!1;return!0}(t,e);default:return dt()}}function Kc(t,e){return(t.values||[]).find(n=>Fi(n,e))!==void 0}function sl(t,e){const n=Qo(t),s=Qo(e);if(n!==s)return Ft(n,s);switch(n){case 0:return 0;case 1:return Ft(t.booleanValue,e.booleanValue);case 2:return function(i,r){const o=wn(i.integerValue||i.doubleValue),a=wn(r.integerValue||r.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Fy(t.timestampValue,e.timestampValue);case 4:return Fy(zc(t),zc(e));case 5:return Ft(t.stringValue,e.stringValue);case 6:return function(i,r){const o=nl(i),a=nl(r);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(i,r){const o=i.split("/"),a=r.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=Ft(o[l],a[l]);if(c!==0)return c}return Ft(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,r){const o=Ft(wn(i.latitude),wn(r.latitude));return o!==0?o:Ft(wn(i.longitude),wn(r.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,r){const o=i.values||[],a=r.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=sl(o[l],a[l]);if(c)return c}return Ft(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,r){const o=i.fields||{},a=Object.keys(o),l=r.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let d=0;d<a.length&&d<c.length;++d){const u=Ft(a[d],c[d]);if(u!==0)return u;const f=sl(o[a[d]],l[c[d]]);if(f!==0)return f}return Ft(a.length,c.length)}(t.mapValue,e.mapValue);default:throw dt()}}function Fy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ft(t,e);const n=Vr(t),s=Vr(e),i=Ft(n.seconds,s.seconds);return i!==0?i:Ft(n.nanos,s.nanos)}function d_(t){return B0(t)}function B0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const i=Vr(s);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?nl(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,nt.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let i="[",r=!0;for(const o of s.values||[])r?r=!1:i+=",",i+=B0(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(s){const i=Object.keys(s.fields||{}).sort();let r="{",o=!0;for(const a of i)o?o=!1:r+=",",r+=`${a}:${B0(s.fields[a])}`;return r+"}"}(t.mapValue):dt();var e,n}function Od(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function U0(t){return!!t&&"integerValue"in t}function f_(t){return!!t&&"arrayValue"in t}function By(t){return!!t&&"nullValue"in t}function Uy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hh(t){return!!t&&"mapValue"in t}function vc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ua(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=vc(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vc(t.arrayValue.values[n]);return e}return Object.assign({},t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.value=e}static empty(){return new xs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Hh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vc(n)}setAll(e){let n=ws.emptyPath(),s={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,s,i),s={},i=[],n=a.popLast()}o?s[a.lastSegment()]=vc(o):i.push(a.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,s,i)}delete(e){const n=this.field(e.popLast());Hh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=n.mapValue.fields[e.get(s)];Hh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,s){ua(n,(i,r)=>e[i]=r);for(const i of s)delete e[i]}clone(){return new xs(vc(this.value))}}function ME(t){const e=[];return ua(t.fields,(n,s)=>{const i=new ws([n]);if(Hh(s)){const r=ME(s.mapValue).fields;if(r.length===0)e.push(i);else for(const o of r)e.push(i.child(o))}else e.push(i)}),new $c(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n,s,i,r){this.key=e,this.documentType=n,this.version=s,this.data=i,this.documentState=r}static newInvalidDocument(e){return new qn(e,0,Lt.min(),xs.empty(),0)}static newFoundDocument(e,n,s){return new qn(e,1,n,s,0)}static newNoDocument(e,n){return new qn(e,2,n,xs.empty(),0)}static newUnknownDocument(e,n){return new qn(e,3,n,xs.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new qn(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,n=null,s=[],i=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.A=null}}function jy(t,e=null,n=[],s=[],i=null,r=null,o=null){return new _x(t,e,n,s,i,r,o)}function m_(t){const e=ft(t);if(e.A===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>yx(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Rl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Nd(e.startAt)),e.endAt&&(n+="|ub:",n+=Nd(e.endAt)),e.A=n}return e.A}function vx(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${d_(s.value)}`;var s}).join(", ")}]`),Rl(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: "+Nd(t.startAt)),t.endAt&&(e+=", endAt: "+Nd(t.endAt)),`Target(${e})`}function p_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!Cx(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],s=e.filters[i],n.op!==s.op||!n.field.isEqual(s.field)||!Fi(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vy(t.startAt,e.startAt)&&Vy(t.endAt,e.endAt)}function j0(t){return nt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class rs extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.R(e,n,s):new bx(e,n,s):n==="array-contains"?new Tx(e,s):n==="in"?new Sx(e,s):n==="not-in"?new Ax(e,s):n==="array-contains-any"?new Rx(e,s):new rs(e,n,s)}static R(e,n,s){return n==="in"?new wx(e,s):new Ex(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.P(sl(n,this.value)):n!==null&&Qo(this.value)===Qo(n)&&this.P(sl(n,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}function yx(t){return t.field.canonicalString()+t.op.toString()+d_(t.value)}class bx extends rs{constructor(e,n,s){super(e,n,s),this.key=nt.fromName(s.referenceValue)}matches(e){const n=nt.comparator(e.key,this.key);return this.P(n)}}class wx extends rs{constructor(e,n){super(e,"in",n),this.keys=xE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Ex extends rs{constructor(e,n){super(e,"not-in",n),this.keys=xE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xE(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>nt.fromName(s.referenceValue))}class Tx extends rs{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return f_(n)&&Kc(n.arrayValue,this.value)}}class Sx extends rs{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Kc(this.value.arrayValue,n)}}class Ax extends rs{constructor(e,n){super(e,"not-in",n)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Kc(this.value.arrayValue,n)}}class Rx extends rs{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!f_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Kc(this.value.arrayValue,s))}}class Gc{constructor(e,n){this.position=e,this.before=n}}function Nd(t){return`${t.before?"b":"a"}:${t.position.map(e=>d_(e)).join(",")}`}class Ua{constructor(e,n="asc"){this.field=e,this.dir=n}}function Cx(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Hy(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(r.field.isKeyField()?s=nt.comparator(nt.fromName(o.referenceValue),n.key):s=sl(o,n.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return t.before?s<=0:s<0}function Vy(t,e){if(t===null)return e===null;if(e===null||t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,n=null,s=[],i=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.V=null,this.S=null,this.startAt,this.endAt}}function Ix(t,e,n,s,i,r,o,a){return new Wr(t,e,n,s,i,r,o,a)}function Uf(t){return new Wr(t)}function Vh(t){return!Rl(t.limit)&&t.limitType==="F"}function Ld(t){return!Rl(t.limit)&&t.limitType==="L"}function g_(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function __(t){for(const e of t.filters)if(e.v())return e.field;return null}function v_(t){return t.collectionGroup!==null}function il(t){const e=ft(t);if(e.V===null){e.V=[];const n=__(e),s=g_(e);if(n!==null&&s===null)n.isKeyField()||e.V.push(new Ua(n)),e.V.push(new Ua(ws.keyField(),"asc"));else{let i=!1;for(const r of e.explicitOrderBy)e.V.push(r),r.field.isKeyField()&&(i=!0);if(!i){const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new Ua(ws.keyField(),r))}}}return e.V}function Zo(t){const e=ft(t);if(!e.S)if(e.limitType==="F")e.S=jy(e.path,e.collectionGroup,il(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const r of il(e)){const o=r.dir==="desc"?"asc":"desc";n.push(new Ua(r.field,o))}const s=e.endAt?new Gc(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Gc(e.startAt.position,!e.startAt.before):null;e.S=jy(e.path,e.collectionGroup,n,e.filters,e.limit,s,i)}return e.S}function OE(t,e,n){return new Wr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function jf(t,e){return p_(Zo(t),Zo(e))&&t.limitType===e.limitType}function NE(t){return`${m_(Zo(t))}|lt:${t.limitType}`}function H0(t){return`Query(target=${vx(Zo(t))}; limitType=${t.limitType})`}function Hf(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):nt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of n.explicitOrderBy)if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!Hy(n.startAt,il(n),s)||n.endAt&&Hy(n.endAt,il(n),s))}(t,e)}function LE(t){return(e,n)=>{let s=!1;for(const i of il(t)){const r=kx(i,e,n);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function kx(t,e,n){const s=t.field.isKeyField()?nt.comparator(e.key,n.key):function(i,r,o){const a=r.data.field(i),l=o.data.field(i);return a!==null&&l!==null?sl(a,l):dt()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t,e){if(t.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xd(e)?"-0":e}}function PE(t){return{integerValue:""+t}}function Mx(t,e){return gx(e)?PE(e):DE(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(){this._=void 0}}function xx(t,e,n){return t instanceof Dd?function(s,i){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&(r.fields.__previous_value__=i),{mapValue:r}}(n,e):t instanceof rl?BE(t,e):t instanceof ol?UE(t,e):function(s,i){const r=FE(s,i),o=qy(r)+qy(s.C);return U0(r)&&U0(s.C)?PE(o):DE(s.N,o)}(t,e)}function Ox(t,e,n){return t instanceof rl?BE(t,e):t instanceof ol?UE(t,e):n}function FE(t,e){return t instanceof Pd?U0(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class Dd extends Vf{}class rl extends Vf{constructor(e){super(),this.elements=e}}function BE(t,e){const n=jE(e);for(const s of t.elements)n.some(i=>Fi(i,s))||n.push(s);return{arrayValue:{values:n}}}class ol extends Vf{constructor(e){super(),this.elements=e}}function UE(t,e){let n=jE(e);for(const s of t.elements)n=n.filter(i=>!Fi(i,s));return{arrayValue:{values:n}}}class Pd extends Vf{constructor(e,n){super(),this.N=e,this.C=n}}function qy(t){return wn(t.integerValue||t.doubleValue)}function jE(t){return f_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n){this.field=e,this.transform=n}}function Nx(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof rl&&s instanceof rl||n instanceof ol&&s instanceof ol?tl(n.elements,s.elements,Fi):n instanceof Pd&&s instanceof Pd?Fi(n.C,s.C):n instanceof Dd&&s instanceof Dd}(t.transform,e.transform)}class Lx{constructor(e,n){this.version=e,this.transformResults=n}}class Qi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Qi}static exists(e){return new Qi(void 0,e)}static updateTime(e){return new Qi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qf{}function Dx(t,e,n){t instanceof $f?function(s,i,r){const o=s.value.clone(),a=Ky(s.fieldTransforms,i,r.transformResults);o.setAll(a),i.convertToFoundDocument(r.version,o).setHasCommittedMutations()}(t,e,n):t instanceof ha?function(s,i,r){if(!qh(s.precondition,i))return void i.convertToUnknownDocument(r.version);const o=Ky(s.fieldTransforms,i,r.transformResults),a=i.data;a.setAll(VE(s)),a.setAll(o),i.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(t,e,n):function(s,i,r){i.convertToNoDocument(r.version).setHasCommittedMutations()}(0,e,n)}function V0(t,e,n){t instanceof $f?function(s,i,r){if(!qh(s.precondition,i))return;const o=s.value.clone(),a=Gy(s.fieldTransforms,r,i);o.setAll(a),i.convertToFoundDocument(zy(i),o).setHasLocalMutations()}(t,e,n):t instanceof ha?function(s,i,r){if(!qh(s.precondition,i))return;const o=Gy(s.fieldTransforms,r,i),a=i.data;a.setAll(VE(s)),a.setAll(o),i.convertToFoundDocument(zy(i),a).setHasLocalMutations()}(t,e,n):function(s,i){qh(s.precondition,i)&&i.convertToNoDocument(Lt.min())}(t,e)}function Px(t,e){let n=null;for(const s of t.fieldTransforms){const i=e.data.field(s.field),r=FE(s.transform,i||null);r!=null&&(n==null&&(n=xs.empty()),n.set(s.field,r))}return n||null}function $y(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&tl(n,s,(i,r)=>Nx(i,r))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function zy(t){return t.isFoundDocument()?t.version:Lt.min()}class $f extends qf{constructor(e,n,s,i=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=i,this.type=0}}class ha extends qf{constructor(e,n,s,i,r=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}}function VE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function Ky(t,e,n){const s=new Map;Jt(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,Ox(o,a,n[i]))}return s}function Gy(t,e,n){const s=new Map;for(const i of t){const r=i.transform,o=n.data.field(i.field);s.set(i.field,xx(r,o,e))}return s}class qE extends qf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}}class Fx extends qf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bn,Tt;function Ux(t){switch(t){default:return dt();case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0}}function $E(t){if(t===void 0)return Hr("GRPC error has no .code"),Ee.UNKNOWN;switch(t){case bn.OK:return Ee.OK;case bn.CANCELLED:return Ee.CANCELLED;case bn.UNKNOWN:return Ee.UNKNOWN;case bn.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case bn.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case bn.INTERNAL:return Ee.INTERNAL;case bn.UNAVAILABLE:return Ee.UNAVAILABLE;case bn.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case bn.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case bn.NOT_FOUND:return Ee.NOT_FOUND;case bn.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case bn.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case bn.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case bn.ABORTED:return Ee.ABORTED;case bn.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case bn.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case bn.DATA_LOSS:return Ee.DATA_LOSS;default:return dt()}}(Tt=bn||(bn={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n){this.comparator=e,this.root=n||Nn.EMPTY}insert(e,n){return new Yn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Yn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return n+s.left.size;i<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fh(this.root,e,this.comparator,!1)}getReverseIterator(){return new fh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fh(this.root,e,this.comparator,!0)}}class fh{constructor(e,n,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=n?s(e.key,n):1,i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s!=null?s:Nn.RED,this.left=i!=null?i:Nn.EMPTY,this.right=r!=null?r:Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,i,r){return new Nn(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,i!=null?i:this.left,r!=null?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Nn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const e=this.left.check();if(e!==this.right.check())throw dt();return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(t,e,n,s,i){return this}insert(t,e,n){return new Nn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.comparator=e,this.data=new Yn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Wy(this.data.getIterator())}getIteratorFrom(e){return new Wy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Fn(this.comparator);return n.data=e,n}}class Wy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=new Yn(nt.comparator);function Jo(){return jx}const Hx=new Yn(nt.comparator);function q0(){return Hx}const Vx=new Yn(nt.comparator);function qx(){return Vx}const $x=new Fn(nt.comparator);function sn(...t){let e=$x;for(const n of t)e=e.add(n);return e}const zx=new Fn(Ft);function zE(){return zx}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,n,s,i,r){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,ku.createSynthesizedTargetChangeForCurrentChange(e,n)),new zf(Lt.min(),s,zE(),Jo(),sn())}}class ku{constructor(e,n,s,i,r){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,n){return new ku(Wn.EMPTY_BYTE_STRING,n,sn(),sn(),sn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n,s,i){this.k=e,this.removedTargetIds=n,this.key=s,this.$=i}}class KE{constructor(e,n){this.targetId=e,this.O=n}}class GE{constructor(e,n,s=Wn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=i}}class Yy{constructor(){this.F=0,this.M=Qy(),this.L=Wn.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return this.F!==0}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=sn(),n=sn(),s=sn();return this.M.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:s=s.add(i);break;default:dt()}}),new ku(this.L,this.B,e,n,s)}G(){this.U=!1,this.M=Qy()}H(e,n){this.U=!0,this.M=this.M.insert(e,n)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class Kx{constructor(e){this.tt=e,this.et=new Map,this.nt=Jo(),this.st=Xy(),this.it=new Fn(Ft)}rt(e){for(const n of e.k)e.$&&e.$.isFoundDocument()?this.ot(n,e.$):this.ct(n,e.key,e.$);for(const n of e.removedTargetIds)this.ct(n,e.key,e.$)}at(e){this.forEachTarget(e,n=>{const s=this.ut(n);switch(e.state){case 0:this.ht(n)&&s.j(e.resumeToken);break;case 1:s.X(),s.q||s.G(),s.j(e.resumeToken);break;case 2:s.X(),s.q||this.removeTarget(n);break;case 3:this.ht(n)&&(s.Z(),s.j(e.resumeToken));break;case 4:this.ht(n)&&(this.lt(n),s.j(e.resumeToken));break;default:dt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.et.forEach((s,i)=>{this.ht(i)&&n(i)})}ft(e){const n=e.targetId,s=e.O.count,i=this.dt(n);if(i){const r=i.target;if(j0(r))if(s===0){const o=new nt(r.path);this.ct(n,o,qn.newNoDocument(o,Lt.min()))}else Jt(s===1);else this.wt(n)!==s&&(this.lt(n),this.it=this.it.add(n))}}_t(e){const n=new Map;this.et.forEach((r,o)=>{const a=this.dt(o);if(a){if(r.current&&j0(a.target)){const l=new nt(a.target.path);this.nt.get(l)!==null||this.gt(o,l)||this.ct(o,l,qn.newNoDocument(l,e))}r.K&&(n.set(o,r.W()),r.G())}});let s=sn();this.st.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.dt(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(s=s.add(r))});const i=new zf(e,n,this.it,this.nt,s);return this.nt=Jo(),this.st=Xy(),this.it=new Fn(Ft),i}ot(e,n){if(!this.ht(e))return;const s=this.gt(e,n.key)?2:0;this.ut(e).H(n.key,s),this.nt=this.nt.insert(n.key,n),this.st=this.st.insert(n.key,this.yt(n.key).add(e))}ct(e,n,s){if(!this.ht(e))return;const i=this.ut(e);this.gt(e,n)?i.H(n,1):i.J(n),this.st=this.st.insert(n,this.yt(n).delete(e)),s&&(this.nt=this.nt.insert(n,s))}removeTarget(e){this.et.delete(e)}wt(e){const n=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let n=this.et.get(e);return n||(n=new Yy,this.et.set(e,n)),n}yt(e){let n=this.st.get(e);return n||(n=new Fn(Ft),this.st=this.st.insert(e,n)),n}ht(e){const n=this.dt(e)!==null;return n||tt("WatchChangeAggregator","Detected inactive target",e),n}dt(e){const n=this.et.get(e);return n&&n.q?null:this.tt.Tt(e)}lt(e){this.et.set(e,new Yy),this.tt.getRemoteKeysForTarget(e).forEach(n=>{this.ct(e,n,null)})}gt(e,n){return this.tt.getRemoteKeysForTarget(e).has(n)}}function Xy(){return new Yn(nt.comparator)}function Qy(){return new Yn(nt.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Wx=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class Yx{constructor(e,n){this.databaseId=e,this.D=n}}function Fd(t,e){return t.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function WE(t,e){return t.D?e.toBase64():e.toUint8Array()}function Xx(t,e){return Fd(t,e.toTimestamp())}function Zi(t){return Jt(!!t),Lt.fromTimestamp(function(e){const n=Vr(e);return new Ps(n.seconds,n.nanos)}(t))}function y_(t,e){return function(n){return new nn(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function YE(t){const e=nn.fromString(t);return Jt(ZE(e)),e}function $0(t,e){return y_(t.databaseId,e.path)}function u1(t,e){const n=YE(e);if(n.get(1)!==t.databaseId.projectId)throw new qe(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new qe(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new nt(XE(n))}function z0(t,e){return y_(t.databaseId,e)}function Qx(t){const e=YE(t);return e.length===4?nn.emptyPath():XE(e)}function K0(t){return new nn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XE(t){return Jt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Zy(t,e,n){return{name:$0(t,e),fields:n.value.mapValue.fields}}function Zx(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(l,c){return l.D?(Jt(c===void 0||typeof c=="string"),Wn.fromBase64String(c||"")):(Jt(c===void 0||c instanceof Uint8Array),Wn.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?Ee.UNKNOWN:$E(l.code);return new qe(c,l.message||"")}(o);n=new GE(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=u1(t,s.document.name),r=Zi(s.document.updateTime),o=new xs({mapValue:{fields:s.document.fields}}),a=qn.newFoundDocument(i,r,o),l=s.targetIds||[],c=s.removedTargetIds||[];n=new $h(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=u1(t,s.document),r=s.readTime?Zi(s.readTime):Lt.min(),o=qn.newNoDocument(i,r),a=s.removedTargetIds||[];n=new $h([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=u1(t,s.document),r=s.removedTargetIds||[];n=new $h([],r,i,null)}else{if(!("filter"in e))return dt();{e.filter;const s=e.filter;s.targetId;const i=s.count||0,r=new Bx(i),o=s.targetId;n=new KE(o,r)}}return n}function Jx(t,e){let n;if(e instanceof $f)n={update:Zy(t,e.key,e.value)};else if(e instanceof qE)n={delete:$0(t,e.key)};else if(e instanceof ha)n={update:Zy(t,e.key,e.data),updateMask:cO(e.fieldMask)};else{if(!(e instanceof Fx))return dt();n={verify:$0(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,r){const o=r.transform;if(o instanceof Dd)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof rl)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ol)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Pd)return{fieldPath:r.field.canonicalString(),increment:o.C};throw dt()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Xx(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:dt()}(t,e.precondition)),n}function eO(t,e){return t&&t.length>0?(Jt(e!==void 0),t.map(n=>function(s,i){let r=s.updateTime?Zi(s.updateTime):Zi(i);return r.isEqual(Lt.min())&&(r=Zi(i)),new Lx(r,s.transformResults||[])}(n,e))):[]}function tO(t,e){return{documents:[z0(t,e.path)]}}function nO(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=z0(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=z0(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const i=function(a){if(a.length===0)return;const l=a.map(c=>function(d){if(d.op==="=="){if(Uy(d.value))return{unaryFilter:{field:ya(d.field),op:"IS_NAN"}};if(By(d.value))return{unaryFilter:{field:ya(d.field),op:"IS_NULL"}}}else if(d.op==="!="){if(Uy(d.value))return{unaryFilter:{field:ya(d.field),op:"IS_NOT_NAN"}};if(By(d.value))return{unaryFilter:{field:ya(d.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ya(d.field),op:oO(d.op),value:d.value}}}(c));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);i&&(n.structuredQuery.where=i);const r=function(a){if(a.length!==0)return a.map(l=>function(c){return{field:ya(c.field),direction:rO(c.dir)}}(l))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(a,l){return a.D||Rl(l)?l:{value:l}}(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Jy(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Jy(e.endAt)),n}function sO(t){let e=Qx(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){Jt(s===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let r=[];n.where&&(r=QE(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(d=>function(u){return new Ua(xa(u.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(u.direction))}(d)));let a=null;n.limit&&(a=function(d){let u;return u=typeof d=="object"?d.value:d,Rl(u)?null:u}(n.limit));let l=null;n.startAt&&(l=eb(n.startAt));let c=null;return n.endAt&&(c=eb(n.endAt)),Ix(e,i,o,r,a,"F",l,c)}function iO(t,e){const n=function(s,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return dt()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function QE(t){return t?t.unaryFilter!==void 0?[lO(t)]:t.fieldFilter!==void 0?[aO(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>QE(e)).reduce((e,n)=>e.concat(n)):dt():[]}function Jy(t){return{before:t.before,values:t.position}}function eb(t){const e=!!t.before,n=t.values||[];return new Gc(n,e)}function rO(t){return Gx[t]}function oO(t){return Wx[t]}function ya(t){return{fieldPath:t.canonicalString()}}function xa(t){return ws.fromServerFormat(t.fieldPath)}function aO(t){return rs.create(xa(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(t.fieldFilter.op),t.fieldFilter.value)}function lO(t){switch(t.unaryFilter.op){case"IS_NAN":const e=xa(t.unaryFilter.field);return rs.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=xa(t.unaryFilter.field);return rs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xa(t.unaryFilter.field);return rs.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=xa(t.unaryFilter.field);return rs.create(i,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}function cO(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ZE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}const uO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ke((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(n,r).next(s,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Ke?n:Ke.resolve(n)}catch(n){return Ke.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Ke.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Ke.reject(n)}static resolve(e){return new Ke((n,s)=>{n(e)})}static reject(e){return new Ke((n,s)=>{s(e)})}static waitFor(e){return new Ke((n,s)=>{let i=0,r=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&n()},l=>s(l))}),o=!0,r===i&&n()})}static or(e){let n=Ke.resolve(!1);for(const s of e)n=n.next(i=>i?Ke.resolve(i):s());return n}static forEach(e,n){const s=[];return e.forEach((i,r)=>{s.push(n.call(this,i,r))}),this.waitFor(s)}}function Mu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,n,s,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&Dx(r,e,s[i])}}applyToLocalView(e){for(const n of this.baseMutations)n.key.isEqual(e.key)&&V0(n,e,this.localWriteTime);for(const n of this.mutations)n.key.isEqual(e.key)&&V0(n,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(n=>{const s=e.get(n.key),i=s;this.applyToLocalView(i),s.isValidDocument()||i.convertToNoDocument(Lt.min())})}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),sn())}isEqual(e){return this.batchId===e.batchId&&tl(this.mutations,e.mutations,(n,s)=>$y(n,s))&&tl(this.baseMutations,e.baseMutations,(n,s)=>$y(n,s))}}class b_{constructor(e,n,s,i){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=i}static from(e,n,s){Jt(e.mutations.length===s.length);let i=qx();const r=e.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new b_(e,n,s,i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n,s,i,r=Lt.min(),o=Lt.min(),a=Wn.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Fo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.Wt=e}}function mO(t){const e=sO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?OE(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.Gt=new gO}addToCollectionParentIndex(e,n){return this.Gt.add(n),Ke.resolve()}getCollectionParents(e,n){return Ke.resolve(this.Gt.getEntries(n))}}class gO{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n]||new Fn(nn.comparator),r=!i.has(s);return this.index[n]=i.add(s),r}has(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n];return i&&i.has(s)}getEntries(e){return(this.index[e]||new Fn(nn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new al(0)}static ie(){return new al(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xu(t){if(t.code!==Ee.FAILED_PRECONDITION||t.message!==uO)throw t;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={}}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),i=this.inner[s];if(i!==void 0){for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,n]);i.push([e,n])}else this.inner[s]=[[e,n]]}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[n]:s.splice(i,1),!0;return!1}forEach(e){ua(this.inner,(n,s)=>{for(const[i,r]of s)e(i,r)})}isEmpty(){return IE(this.inner)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(){this.changes=new Ou(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}getReadTime(e){const n=this.changes.get(e);return n?n.readTime:Lt.min()}addEntry(e,n){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:n})}removeEntry(e,n=null){this.assertNotApplied(),this.changes.set(e,{document:qn.newInvalidDocument(e),readTime:n})}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?Ke.resolve(s.document):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n,s){this.He=e,this.In=n,this.Ht=s}An(e,n){return this.In.getAllMutationBatchesAffectingDocumentKey(e,n).next(s=>this.Rn(e,n,s))}Rn(e,n,s){return this.He.getEntry(e,n).next(i=>{for(const r of s)r.applyToLocalView(i);return i})}bn(e,n){e.forEach((s,i)=>{for(const r of n)r.applyToLocalView(i)})}Pn(e,n){return this.He.getEntries(e,n).next(s=>this.vn(e,s).next(()=>s))}vn(e,n){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,n).next(s=>this.bn(n,s))}getDocumentsMatchingQuery(e,n,s){return function(i){return nt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.Vn(e,n.path):v_(n)?this.Sn(e,n,s):this.Dn(e,n,s)}Vn(e,n){return this.An(e,new nt(n)).next(s=>{let i=q0();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}Sn(e,n,s){const i=n.collectionGroup;let r=q0();return this.Ht.getCollectionParents(e,i).next(o=>Ke.forEach(o,a=>{const l=function(c,d){return new Wr(d,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(i));return this.Dn(e,l,s).next(c=>{c.forEach((d,u)=>{r=r.insert(d,u)})})}).next(()=>r))}Dn(e,n,s){let i,r;return this.He.getDocumentsMatchingQuery(e,n,s).next(o=>(i=o,this.In.getAllMutationBatchesAffectingQuery(e,n))).next(o=>(r=o,this.Cn(e,r,i).next(a=>{i=a;for(const l of r)for(const c of l.mutations){const d=c.key;let u=i.get(d);u==null&&(u=qn.newInvalidDocument(d),i=i.insert(d,u)),V0(c,u,l.localWriteTime),u.isFoundDocument()||(i=i.remove(d))}}))).next(()=>(i.forEach((o,a)=>{Hf(n,a)||(i=i.remove(o))}),i))}Cn(e,n,s){let i=sn();for(const o of n)for(const a of o.mutations)a instanceof ha&&s.get(a.key)===null&&(i=i.add(a.key));let r=s;return this.He.getEntries(e,i).next(o=>(o.forEach((a,l)=>{l.isFoundDocument()&&(r=r.insert(a,l))}),r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,n,s,i){this.targetId=e,this.fromCache=n,this.Nn=s,this.xn=i}static kn(e,n){let s=sn(),i=sn();for(const r of n.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new w_(e,n.fromCache,s,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{$n(e){this.On=e}getDocumentsMatchingQuery(e,n,s,i){return function(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}(n)||s.isEqual(Lt.min())?this.Fn(e,n):this.On.Pn(e,i).next(r=>{const o=this.Mn(n,r);return(Vh(n)||Ld(n))&&this.Ln(n.limitType,o,i,s)?this.Fn(e,n):(Ly()<=kt.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),H0(n)),this.On.getDocumentsMatchingQuery(e,n,s).next(a=>(o.forEach(l=>{a=a.insert(l.key,l)}),a)))})}Mn(e,n){let s=new Fn(LE(e));return n.forEach((i,r)=>{Hf(e,r)&&(s=s.add(r))}),s}Ln(e,n,s,i){if(s.size!==n.size)return!0;const r=e==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Fn(e,n){return Ly()<=kt.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",H0(n)),this.On.getDocumentsMatchingQuery(e,n,Lt.min())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,n,s,i){this.persistence=e,this.Bn=n,this.N=i,this.Un=new Yn(Ft),this.qn=new Ou(r=>m_(r),p_),this.Kn=Lt.min(),this.In=e.getMutationQueue(s),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new JE(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Un))}}function bO(t,e,n,s){return new yO(t,e,n,s)}async function e9(t,e){const n=ft(t);let s=n.In,i=n.Qn;const r=await n.persistence.runTransaction("Handle user change","readonly",o=>{let a;return n.In.getAllMutationBatches(o).next(l=>(a=l,s=n.persistence.getMutationQueue(e),i=new JE(n.jn,s,n.persistence.getIndexManager()),s.getAllMutationBatches(o))).next(l=>{const c=[],d=[];let u=sn();for(const f of a){c.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}for(const f of l){d.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}return i.Pn(o,u).next(f=>({Wn:f,removedBatchIds:c,addedBatchIds:d}))})});return n.In=s,n.Qn=i,n.Bn.$n(n.Qn),r}function wO(t,e){const n=ft(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),r=n.jn.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const d=l.batch,u=d.keys();let f=Ke.resolve();return u.forEach(m=>{f=f.next(()=>c.getEntry(a,m)).next(h=>{const M=l.docVersions.get(m);Jt(M!==null),h.version.compareTo(M)<0&&(d.applyToRemoteDocument(h,l),h.isValidDocument()&&c.addEntry(h,l.commitVersion))})}),f.next(()=>o.In.removeMutationBatch(a,d))}(n,s,e,r).next(()=>r.apply(s)).next(()=>n.In.performConsistencyCheck(s)).next(()=>n.Qn.Pn(s,i))})}function t9(t){const e=ft(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.ze.getLastRemoteSnapshotVersion(n))}function EO(t,e){const n=ft(t),s=e.snapshotVersion;let i=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.jn.newChangeBuffer({trackRemovals:!0});i=n.Un;const a=[];e.targetChanges.forEach((c,d)=>{const u=i.get(d);if(!u)return;a.push(n.ze.removeMatchingKeys(r,c.removedDocuments,d).next(()=>n.ze.addMatchingKeys(r,c.addedDocuments,d)));const f=c.resumeToken;if(f.approximateByteSize()>0){const m=u.withResumeToken(f,s).withSequenceNumber(r.currentSequenceNumber);i=i.insert(d,m),function(h,M,k){return Jt(M.resumeToken.approximateByteSize()>0),h.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(u,m,c)&&a.push(n.ze.updateTargetData(r,m))}});let l=Jo();if(e.documentUpdates.forEach((c,d)=>{e.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(r,c))}),a.push(TO(r,o,e.documentUpdates,s,void 0).next(c=>{l=c})),!s.isEqual(Lt.min())){const c=n.ze.getLastRemoteSnapshotVersion(r).next(d=>n.ze.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(c)}return Ke.waitFor(a).next(()=>o.apply(r)).next(()=>n.Qn.vn(r,l)).next(()=>l)}).then(r=>(n.Un=i,r))}function TO(t,e,n,s,i){let r=sn();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=Jo();return n.forEach((l,c)=>{const d=o.get(l),u=(i==null?void 0:i.get(l))||s;c.isNoDocument()&&c.version.isEqual(Lt.min())?(e.removeEntry(l,u),a=a.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c,u),a=a.insert(l,c)):tt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),a})}function SO(t,e){const n=ft(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.In.getNextMutationBatchAfterBatchId(s,e)))}function AO(t,e){const n=ft(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return n.ze.getTargetData(s,e).next(r=>r?(i=r,Ke.resolve(i)):n.ze.allocateTargetId(s).next(o=>(i=new Fo(e,o,0,s.currentSequenceNumber),n.ze.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=n.Un.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Un=n.Un.insert(s.targetId,s),n.qn.set(e,s.targetId)),s})}async function G0(t,e,n){const s=ft(t),i=s.Un.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Mu(o))throw o;tt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.Un=s.Un.remove(e),s.qn.delete(i.target)}function tb(t,e,n){const s=ft(t);let i=Lt.min(),r=sn();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const d=ft(a),u=d.qn.get(c);return u!==void 0?Ke.resolve(d.Un.get(u)):d.ze.getTargetData(l,c)}(s,o,Zo(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.ze.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>s.Bn.getDocumentsMatchingQuery(o,e,n?i:Lt.min(),n?r:sn())).next(a=>({documents:a,Gn:r})))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,n){return Ke.resolve(this.Yn.get(n))}saveBundleMetadata(e,n){var s;return this.Yn.set(n.id,{id:(s=n).id,version:s.version,createTime:Zi(s.createTime)}),Ke.resolve()}getNamedQuery(e,n){return Ke.resolve(this.Xn.get(n))}saveNamedQuery(e,n){return this.Xn.set(n.name,function(s){return{name:s.name,query:mO(s.bundledQuery),readTime:Zi(s.readTime)}}(n)),Ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(){this.Zn=new Fn(Cn.ts),this.es=new Fn(Cn.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const s=new Cn(e,n);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.rs(new Cn(e,n))}os(e,n){e.forEach(s=>this.removeReference(s,n))}cs(e){const n=new nt(new nn([])),s=new Cn(n,e),i=new Cn(n,e+1),r=[];return this.es.forEachInRange([s,i],o=>{this.rs(o),r.push(o.key)}),r}us(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new nt(new nn([])),s=new Cn(n,e),i=new Cn(n,e+1);let r=sn();return this.es.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(e){const n=new Cn(e,0),s=this.Zn.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Cn{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return nt.comparator(e.key,n.key)||Ft(e.ls,n.ls)}static ns(e,n){return Ft(e.ls,n.ls)||nt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e,n){this.Ht=e,this.referenceDelegate=n,this.In=[],this.fs=1,this.ds=new Fn(Cn.ts)}checkEmpty(e){return Ke.resolve(this.In.length===0)}addMutationBatch(e,n,s,i){const r=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const o=new dO(r,n,s,i);this.In.push(o);for(const a of i)this.ds=this.ds.add(new Cn(a.key,r)),this.Ht.addToCollectionParentIndex(e,a.key.path.popLast());return Ke.resolve(o)}lookupMutationBatch(e,n){return Ke.resolve(this.ws(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,i=this._s(s),r=i<0?0:i;return Ke.resolve(this.In.length>r?this.In[r]:null)}getHighestUnacknowledgedBatchId(){return Ke.resolve(this.In.length===0?-1:this.fs-1)}getAllMutationBatches(e){return Ke.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Cn(n,0),i=new Cn(n,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([s,i],o=>{const a=this.ws(o.ls);r.push(a)}),Ke.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Fn(Ft);return n.forEach(i=>{const r=new Cn(i,0),o=new Cn(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([r,o],a=>{s=s.add(a.ls)})}),Ke.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,i=s.length+1;let r=s;nt.isDocumentKey(r)||(r=r.child(""));const o=new Cn(new nt(r),0);let a=new Fn(Ft);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.ls)),!0)},o),Ke.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(s=>{const i=this.ws(s);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Jt(this.ys(n.batchId,"removed")===0),this.In.shift();let s=this.ds;return Ke.forEach(n.mutations,i=>{const r=new Cn(i.key,n.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=s})}te(e){}containsKey(e,n){const s=new Cn(n,0),i=this.ds.firstAfterOrEqual(s);return Ke.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.In.length,Ke.resolve()}ys(e,n){return this._s(e)}_s(e){return this.In.length===0?0:e-this.In[0].batchId}ws(e){const n=this._s(e);return n<0||n>=this.In.length?null:this.In[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,n){this.Ht=e,this.ps=n,this.docs=new Yn(nt.comparator),this.size=0}addEntry(e,n,s){const i=n.key,r=this.docs.get(i),o=r?r.size:0,a=this.ps(n);return this.docs=this.docs.insert(i,{document:n.clone(),size:a,readTime:s}),this.size+=a-o,this.Ht.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return Ke.resolve(s?s.document.clone():qn.newInvalidDocument(n))}getEntries(e,n){let s=Jo();return n.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.clone():qn.newInvalidDocument(i))}),Ke.resolve(s)}getDocumentsMatchingQuery(e,n,s){let i=Jo();const r=new nt(n.path.child("")),o=this.docs.getIteratorFrom(r);for(;o.hasNext();){const{key:a,value:{document:l,readTime:c}}=o.getNext();if(!n.path.isPrefixOf(a.path))break;c.compareTo(s)<=0||Hf(n,l)&&(i=i.insert(l.key,l.clone()))}return Ke.resolve(i)}Ts(e,n){return Ke.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new kO(this)}getSize(e){return Ke.resolve(this.size)}}class kO extends _O{constructor(e){super(),this.Se=e}applyChanges(e){const n=[];return this.changes.forEach((s,i)=>{i.document.isValidDocument()?n.push(this.Se.addEntry(e,i.document,this.getReadTime(s))):this.Se.removeEntry(s)}),Ke.waitFor(n)}getFromCache(e,n){return this.Se.getEntry(e,n)}getAllFromCache(e,n){return this.Se.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e){this.persistence=e,this.Es=new Ou(n=>m_(n),p_),this.lastRemoteSnapshotVersion=Lt.min(),this.highestTargetId=0,this.Is=0,this.As=new E_,this.targetCount=0,this.Rs=al.se()}forEachTarget(e,n){return this.Es.forEach((s,i)=>n(i)),Ke.resolve()}getLastRemoteSnapshotVersion(e){return Ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ke.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),Ke.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Is&&(this.Is=n),Ke.resolve()}ce(e){this.Es.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new al(n),this.highestTargetId=n),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,n){return this.ce(n),this.targetCount+=1,Ke.resolve()}updateTargetData(e,n){return this.ce(n),Ke.resolve()}removeTargetData(e,n){return this.Es.delete(n.target),this.As.cs(n.targetId),this.targetCount-=1,Ke.resolve()}removeTargets(e,n,s){let i=0;const r=[];return this.Es.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Es.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Ke.waitFor(r).next(()=>i)}getTargetCount(e){return Ke.resolve(this.targetCount)}getTargetData(e,n){const s=this.Es.get(n)||null;return Ke.resolve(s)}addMatchingKeys(e,n,s){return this.As.ss(n,s),Ke.resolve()}removeMatchingKeys(e,n,s){this.As.os(n,s);const i=this.persistence.referenceDelegate,r=[];return i&&n.forEach(o=>{r.push(i.markPotentiallyOrphaned(e,o))}),Ke.waitFor(r)}removeMatchingKeysForTargetId(e,n){return this.As.cs(n),Ke.resolve()}getMatchingKeysForTargetId(e,n){const s=this.As.hs(n);return Ke.resolve(s)}containsKey(e,n){return Ke.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,n){this.bs={},this.Le=new u_(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new MO(this),this.Ht=new pO,this.He=function(s,i){return new IO(s,i)}(this.Ht,s=>this.referenceDelegate.Ps(s)),this.N=new fO(n),this.Je=new RO(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let n=this.bs[e.toKey()];return n||(n=new CO(this.Ht,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,n,s){tt("MemoryPersistence","Starting transaction:",e);const i=new OO(this.Le.next());return this.referenceDelegate.vs(),s(i).next(r=>this.referenceDelegate.Vs(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}Ss(e,n){return Ke.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,n)))}}class OO extends hO{constructor(e){super(),this.currentSequenceNumber=e}}class T_{constructor(e){this.persistence=e,this.Ds=new E_,this.Cs=null}static Ns(e){return new T_(e)}get xs(){if(this.Cs)return this.Cs;throw dt()}addReference(e,n,s){return this.Ds.addReference(s,n),this.xs.delete(s.toString()),Ke.resolve()}removeReference(e,n,s){return this.Ds.removeReference(s,n),this.xs.add(s.toString()),Ke.resolve()}markPotentiallyOrphaned(e,n){return this.xs.add(n.toString()),Ke.resolve()}removeTarget(e,n){this.Ds.cs(n.targetId).forEach(i=>this.xs.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(r=>this.xs.add(r.toString()))}).next(()=>s.removeTargetData(e,n))}vs(){this.Cs=new Set}Vs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ke.forEach(this.xs,s=>{const i=nt.fromPath(s);return this.ks(e,i).next(r=>{r||n.removeEntry(i)})}).next(()=>(this.Cs=null,n.apply(e)))}updateLimboDocument(e,n){return this.ks(e,n).next(s=>{s?this.xs.delete(n.toString()):this.xs.add(n.toString())})}Ps(e){return 0}ks(e,n){return Ke.or([()=>Ke.resolve(this.Ds.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ss(e,n)])}}class nb{constructor(){this.activeTargetIds=zE()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NO{constructor(){this.yi=new nb,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,n,s){this.pi[e]=n}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new nb,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{Ti(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(){this.Ei=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ti(e){this.bi.push(e)}shutdown(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ai)}Ii(){tt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.bi)e(0)}Ri(){tt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.bi)e(1)}static bt(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.Fi=n+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,n,s,i){const r=this.Bi(e,n);tt("RestConnection","Sending: ",r,s);const o={};return this.Ui(o,i),this.qi(e,r,o,s).then(a=>(tt("RestConnection","Received: ",a),a),a=>{throw Dy("RestConnection",`${e} failed with error: `,a,"url: ",r,"request:",s),a})}Ki(e,n,s,i){return this.Li(e,n,s,i)}Ui(e,n){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+Al,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n)for(const s in n.authHeaders)n.authHeaders.hasOwnProperty(s)&&(e[s]=n.authHeaders[s])}Bi(e,n){const s=DO[e];return`${this.Fi}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,n,s,i){return new Promise((r,o)=>{const a=new ax;a.listenOnce(ix.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case c1.NO_ERROR:const c=a.getResponseJson();tt("Connection","XHR received:",JSON.stringify(c)),r(c);break;case c1.TIMEOUT:tt("Connection",'RPC "'+e+'" timed out'),o(new qe(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case c1.HTTP_ERROR:const d=a.getStatus();if(tt("Connection",'RPC "'+e+'" failed with status:',d,"response text:",a.getResponseText()),d>0){const u=a.getResponseJson().error;if(u&&u.status&&u.message){const f=function(m){const h=m.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(h)>=0?h:Ee.UNKNOWN}(u.status);o(new qe(f,u.message))}else o(new qe(Ee.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new qe(Ee.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{tt("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(i);a.send(n,"POST",l,s,15)})}ji(e,n){const s=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=nx(),r=sx(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ox({})),this.Ui(o.initMessageHeaders,n),Qp()||h4()||HR()||VR()||qR()||jR()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=s.join("");tt("Connection","Creating WebChannel: "+a,o);const l=i.createWebChannel(a,o);let c=!1,d=!1;const u=new PO({vi:m=>{d?tt("Connection","Not sending because WebChannel is closed:",m):(c||(tt("Connection","Opening WebChannel transport."),l.open(),c=!0),tt("Connection","WebChannel sending:",m),l.send(m))},Vi:()=>l.close()}),f=(m,h,M)=>{m.listen(h,k=>{try{M(k)}catch(L){setTimeout(()=>{throw L},0)}})};return f(l,dh.EventType.OPEN,()=>{d||tt("Connection","WebChannel transport opened.")}),f(l,dh.EventType.CLOSE,()=>{d||(d=!0,tt("Connection","WebChannel transport closed"),u.$i())}),f(l,dh.EventType.ERROR,m=>{d||(d=!0,Dy("Connection","WebChannel transport errored:",m),u.$i(new qe(Ee.UNAVAILABLE,"The operation could not be completed")))}),f(l,dh.EventType.MESSAGE,m=>{var h;if(!d){const M=m.data[0];Jt(!!M);const k=M,L=k.error||((h=k[0])===null||h===void 0?void 0:h.error);if(L){tt("Connection","WebChannel received error:",L);const p=L.status;let I=function(x){const B=bn[x];if(B!==void 0)return $E(B)}(p),D=L.message;I===void 0&&(I=Ee.INTERNAL,D="Unknown error status: "+p+" with message "+L.message),d=!0,u.$i(new qe(I,D)),l.close()}else tt("Connection","WebChannel received:",M),u.Oi(M)}}),f(r,rx.STAT_EVENT,m=>{m.stat===Oy.PROXY?tt("Connection","Detected buffering proxy"):m.stat===Oy.NOPROXY&&tt("Connection","Detected no buffering proxy")}),setTimeout(()=>{u.ki()},0),u}}function h1(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(t){return new Yx(t,!0)}class n9{constructor(e,n,s=1e3,i=1.5,r=6e4){this.Oe=e,this.timerId=n,this.Qi=s,this.Wi=i,this.Gi=r,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();const n=Math.floor(this.zi+this.Zi()),s=Math.max(0,Date.now()-this.Ji),i=Math.max(0,n-s);i>0&&tt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.zi} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,i,()=>(this.Ji=Date.now(),e())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){this.Hi!==null&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){this.Hi!==null&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e,n,s,i,r,o,a){this.Oe=e,this.er=s,this.nr=i,this.sr=r,this.credentialsProvider=o,this.listener=a,this.state=0,this.ir=0,this.rr=null,this.cr=null,this.stream=null,this.ar=new n9(e,n)}ur(){return this.state===1||this.state===5||this.hr()}hr(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.lr()}async stop(){this.ur()&&await this.close(0)}dr(){this.state=0,this.ar.reset()}wr(){this.hr()&&this.rr===null&&(this.rr=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this._r()))}mr(e){this.gr(),this.stream.send(e)}async _r(){if(this.hr())return this.close(0)}gr(){this.rr&&(this.rr.cancel(),this.rr=null)}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}async close(e,n){this.gr(),this.yr(),this.ar.cancel(),this.ir++,e!==4?this.ar.reset():n&&n.code===Ee.RESOURCE_EXHAUSTED?(Hr(n.toString()),Hr("Using maximum backoff delay to prevent overloading the backend."),this.ar.Yi()):n&&n.code===Ee.UNAUTHENTICATED&&this.state!==3&&this.credentialsProvider.invalidateToken(),this.stream!==null&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ci(n)}pr(){}auth(){this.state=1;const e=this.Tr(this.ir),n=this.ir;this.credentialsProvider.getToken().then(s=>{this.ir===n&&this.Er(s)},s=>{e(()=>{const i=new qe(Ee.UNKNOWN,"Fetching auth token failed: "+s.message);return this.Ir(i)})})}Er(e){const n=this.Tr(this.ir);this.stream=this.Ar(e),this.stream.Si(()=>{n(()=>(this.state=2,this.cr=this.Oe.enqueueAfterDelay(this.nr,1e4,()=>(this.hr()&&(this.state=3),Promise.resolve())),this.listener.Si()))}),this.stream.Ci(s=>{n(()=>this.Ir(s))}),this.stream.onMessage(s=>{n(()=>this.onMessage(s))})}lr(){this.state=5,this.ar.Xi(async()=>{this.state=0,this.start()})}Ir(e){return tt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Tr(e){return n=>{this.Oe.enqueueAndForget(()=>this.ir===e?n():(tt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class BO extends s9{constructor(e,n,s,i,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r),this.N=i}Ar(e){return this.sr.ji("Listen",e)}onMessage(e){this.ar.reset();const n=Zx(this.N,e),s=function(i){if(!("targetChange"in i))return Lt.min();const r=i.targetChange;return r.targetIds&&r.targetIds.length?Lt.min():r.readTime?Zi(r.readTime):Lt.min()}(e);return this.listener.Rr(n,s)}br(e){const n={};n.database=K0(this.N),n.addTarget=function(i,r){let o;const a=r.target;return o=j0(a)?{documents:tO(i,a)}:{query:nO(i,a)},o.targetId=r.targetId,r.resumeToken.approximateByteSize()>0?o.resumeToken=WE(i,r.resumeToken):r.snapshotVersion.compareTo(Lt.min())>0&&(o.readTime=Fd(i,r.snapshotVersion.toTimestamp())),o}(this.N,e);const s=iO(this.N,e);s&&(n.labels=s),this.mr(n)}Pr(e){const n={};n.database=K0(this.N),n.removeTarget=e,this.mr(n)}}class UO extends s9{constructor(e,n,s,i,r){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r),this.N=i,this.vr=!1}get Vr(){return this.vr}start(){this.vr=!1,this.lastStreamToken=void 0,super.start()}pr(){this.vr&&this.Sr([])}Ar(e){return this.sr.ji("Write",e)}onMessage(e){if(Jt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.vr){this.ar.reset();const n=eO(e.writeResults,e.commitTime),s=Zi(e.commitTime);return this.listener.Dr(s,n)}return Jt(!e.writeResults||e.writeResults.length===0),this.vr=!0,this.listener.Cr()}Nr(){const e={};e.database=K0(this.N),this.mr(e)}Sr(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Jx(this.N,s))};this.mr(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO extends class{}{constructor(e,n,s){super(),this.credentials=e,this.sr=n,this.N=s,this.kr=!1}$r(){if(this.kr)throw new qe(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,n,s){return this.$r(),this.credentials.getToken().then(i=>this.sr.Li(e,n,s,i)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ee.UNAUTHENTICATED&&this.credentials.invalidateToken(),i):new qe(Ee.UNKNOWN,i.toString())})}Ki(e,n,s){return this.$r(),this.credentials.getToken().then(i=>this.sr.Ki(e,n,s,i)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ee.UNAUTHENTICATED&&this.credentials.invalidateToken(),i):new qe(Ee.UNKNOWN,i.toString())})}terminate(){this.kr=!0}}class HO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.Or=0,this.Fr=null,this.Mr=!0}Lr(){this.Or===0&&(this.Br("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.Fr=null,this.Ur("Backend didn't respond within 10 seconds."),this.Br("Offline"),Promise.resolve())))}qr(e){this.state==="Online"?this.Br("Unknown"):(this.Or++,this.Or>=1&&(this.Kr(),this.Ur(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Br("Offline")))}set(e){this.Kr(),this.Or=0,e==="Online"&&(this.Mr=!1),this.Br(e)}Br(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Ur(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Mr?(Hr(n),this.Mr=!1):tt("OnlineStateTracker",n)}Kr(){this.Fr!==null&&(this.Fr.cancel(),this.Fr=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,n,s,i,r){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.jr=[],this.Qr=new Map,this.Wr=new Set,this.Gr=[],this.zr=r,this.zr.Ti(o=>{s.enqueueAndForget(async()=>{da(this)&&(tt("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=ft(a);l.Wr.add(4),await Nu(l),l.Hr.set("Unknown"),l.Wr.delete(4),await Gf(l)}(this))})}),this.Hr=new HO(s,i)}}async function Gf(t){if(da(t))for(const e of t.Gr)await e(!0)}async function Nu(t){for(const e of t.Gr)await e(!1)}function i9(t,e){const n=ft(t);n.Qr.has(e.targetId)||(n.Qr.set(e.targetId,e),R_(n)?A_(n):Cl(n).hr()&&S_(n,e))}function r9(t,e){const n=ft(t),s=Cl(n);n.Qr.delete(e),s.hr()&&o9(n,e),n.Qr.size===0&&(s.hr()?s.wr():da(n)&&n.Hr.set("Unknown"))}function S_(t,e){t.Jr.Y(e.targetId),Cl(t).br(e)}function o9(t,e){t.Jr.Y(e),Cl(t).Pr(e)}function A_(t){t.Jr=new Kx({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Tt:e=>t.Qr.get(e)||null}),Cl(t).start(),t.Hr.Lr()}function R_(t){return da(t)&&!Cl(t).ur()&&t.Qr.size>0}function da(t){return ft(t).Wr.size===0}function a9(t){t.Jr=void 0}async function qO(t){t.Qr.forEach((e,n)=>{S_(t,e)})}async function $O(t,e){a9(t),R_(t)?(t.Hr.qr(e),A_(t)):t.Hr.set("Unknown")}async function zO(t,e,n){if(t.Hr.set("Online"),e instanceof GE&&e.state===2&&e.cause)try{await async function(s,i){const r=i.cause;for(const o of i.targetIds)s.Qr.has(o)&&(await s.remoteSyncer.rejectListen(o,r),s.Qr.delete(o),s.Jr.removeTarget(o))}(t,e)}catch(s){tt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Bd(t,s)}else if(e instanceof $h?t.Jr.rt(e):e instanceof KE?t.Jr.ft(e):t.Jr.at(e),!n.isEqual(Lt.min()))try{const s=await t9(t.localStore);n.compareTo(s)>=0&&await function(i,r){const o=i.Jr._t(r);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=i.Qr.get(l);c&&i.Qr.set(l,c.withResumeToken(a.resumeToken,r))}}),o.targetMismatches.forEach(a=>{const l=i.Qr.get(a);if(!l)return;i.Qr.set(a,l.withResumeToken(Wn.EMPTY_BYTE_STRING,l.snapshotVersion)),o9(i,a);const c=new Fo(l.target,a,1,l.sequenceNumber);S_(i,c)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){tt("RemoteStore","Failed to raise snapshot:",s),await Bd(t,s)}}async function Bd(t,e,n){if(!Mu(e))throw e;t.Wr.add(1),await Nu(t),t.Hr.set("Offline"),n||(n=()=>t9(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{tt("RemoteStore","Retrying IndexedDB access"),await n(),t.Wr.delete(1),await Gf(t)})}function l9(t,e){return e().catch(n=>Bd(t,n,e))}async function Wf(t){const e=ft(t),n=qr(e);let s=e.jr.length>0?e.jr[e.jr.length-1].batchId:-1;for(;KO(e);)try{const i=await SO(e.localStore,s);if(i===null){e.jr.length===0&&n.wr();break}s=i.batchId,GO(e,i)}catch(i){await Bd(e,i)}c9(e)&&u9(e)}function KO(t){return da(t)&&t.jr.length<10}function GO(t,e){t.jr.push(e);const n=qr(t);n.hr()&&n.Vr&&n.Sr(e.mutations)}function c9(t){return da(t)&&!qr(t).ur()&&t.jr.length>0}function u9(t){qr(t).start()}async function WO(t){qr(t).Nr()}async function YO(t){const e=qr(t);for(const n of t.jr)e.Sr(n.mutations)}async function XO(t,e,n){const s=t.jr.shift(),i=b_.from(s,e,n);await l9(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Wf(t)}async function QO(t,e){e&&qr(t).Vr&&await async function(n,s){if(i=s.code,Ux(i)&&i!==Ee.ABORTED){const r=n.jr.shift();qr(n).dr(),await l9(n,()=>n.remoteSyncer.rejectFailedWrite(r.batchId,s)),await Wf(n)}var i}(t,e),c9(t)&&u9(t)}async function ZO(t,e){const n=ft(t);e?(n.Wr.delete(2),await Gf(n)):e||(n.Wr.add(2),await Nu(n),n.Hr.set("Unknown"))}function Cl(t){return t.Yr||(t.Yr=function(e,n,s){const i=ft(e);return i.$r(),new BO(n,i.sr,i.credentials,i.N,s)}(t.datastore,t.asyncQueue,{Si:qO.bind(null,t),Ci:$O.bind(null,t),Rr:zO.bind(null,t)}),t.Gr.push(async e=>{e?(t.Yr.dr(),R_(t)?A_(t):t.Hr.set("Unknown")):(await t.Yr.stop(),a9(t))})),t.Yr}function qr(t){return t.Xr||(t.Xr=function(e,n,s){const i=ft(e);return i.$r(),new UO(n,i.sr,i.credentials,i.N,s)}(t.datastore,t.asyncQueue,{Si:WO.bind(null,t),Ci:QO.bind(null,t),Cr:YO.bind(null,t),Dr:XO.bind(null,t)}),t.Gr.push(async e=>{e?(t.Xr.dr(),await Wf(t)):(await t.Xr.stop(),t.jr.length>0&&(tt("RemoteStore",`Stopping write stream with ${t.jr.length} pending writes`),t.jr=[]))})),t.Xr}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,n,s,i,r){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,i,r){const o=Date.now()+s,a=new C_(e,n,o,i,r);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function I_(t,e){if(Hr("AsyncQueue",`${e}: ${t}`),Mu(t))return new qe(Ee.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.comparator=e?(n,s)=>e(n,s)||nt.comparator(n.key,s.key):(n,s)=>nt.comparator(n.key,s.key),this.keyedMap=q0(),this.sortedSet=new Yn(this.comparator)}static emptySet(e){return new ja(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ja)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new ja;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(){this.Zr=new Yn(nt.comparator)}track(e){const n=e.doc.key,s=this.Zr.get(n);s?e.type!==0&&s.type===3?this.Zr=this.Zr.insert(n,e):e.type===3&&s.type!==1?this.Zr=this.Zr.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Zr=this.Zr.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Zr=this.Zr.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Zr=this.Zr.remove(n):e.type===1&&s.type===2?this.Zr=this.Zr.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Zr=this.Zr.insert(n,{type:2,doc:e.doc}):dt():this.Zr=this.Zr.insert(n,e)}eo(){const e=[];return this.Zr.inorderTraversal((n,s)=>{e.push(s)}),e}}class ll{constructor(e,n,s,i,r,o,a,l){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,s,i){const r=[];return n.forEach(o=>{r.push({type:0,doc:o})}),new ll(e,n,ja.emptySet(n),r,s,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==s[i].type||!n[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(){this.no=void 0,this.listeners=[]}}class eN{constructor(){this.queries=new Ou(e=>NE(e),jf),this.onlineState="Unknown",this.so=new Set}}async function k_(t,e){const n=ft(t),s=e.query;let i=!1,r=n.queries.get(s);if(r||(i=!0,r=new JO),i)try{r.no=await n.onListen(s)}catch(o){const a=I_(o,`Initialization of query '${H0(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,r),r.listeners.push(e),e.io(n.onlineState),r.no&&e.ro(r.no)&&x_(n)}async function M_(t,e){const n=ft(t),s=e.query;let i=!1;const r=n.queries.get(s);if(r){const o=r.listeners.indexOf(e);o>=0&&(r.listeners.splice(o,1),i=r.listeners.length===0)}if(i)return n.queries.delete(s),n.onUnlisten(s)}function tN(t,e){const n=ft(t);let s=!1;for(const i of e){const r=i.query,o=n.queries.get(r);if(o){for(const a of o.listeners)a.ro(i)&&(s=!0);o.no=i}}s&&x_(n)}function nN(t,e,n){const s=ft(t),i=s.queries.get(e);if(i)for(const r of i.listeners)r.onError(n);s.queries.delete(e)}function x_(t){t.so.forEach(e=>{e.next()})}class O_{constructor(e,n,s){this.query=e,this.oo=n,this.co=!1,this.ao=null,this.onlineState="Unknown",this.options=s||{}}ro(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new ll(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.co?this.uo(e)&&(this.oo.next(e),n=!0):this.ho(e,this.onlineState)&&(this.lo(e),n=!0),this.ao=e,n}onError(e){this.oo.error(e)}io(e){this.onlineState=e;let n=!1;return this.ao&&!this.co&&this.ho(this.ao,e)&&(this.lo(this.ao),n=!0),n}ho(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.fo||!s)&&(!e.docs.isEmpty()||n==="Offline")}uo(e){if(e.docChanges.length>0)return!0;const n=this.ao&&this.ao.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}lo(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.co=!0,this.oo.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e){this.key=e}}class d9{constructor(e){this.key=e}}class sN{constructor(e,n){this.query=e,this.po=n,this.To=null,this.current=!1,this.Eo=sn(),this.mutatedKeys=sn(),this.Io=LE(e),this.Ao=new ja(this.Io)}get Ro(){return this.po}bo(e,n){const s=n?n.Po:new ib,i=n?n.Ao:this.Ao;let r=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=Vh(this.query)&&i.size===this.query.limit?i.last():null,c=Ld(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,u)=>{const f=i.get(d),m=Hf(this.query,u)?u:null,h=!!f&&this.mutatedKeys.has(f.key),M=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let k=!1;f&&m?f.data.isEqual(m.data)?h!==M&&(s.track({type:3,doc:m}),k=!0):this.vo(f,m)||(s.track({type:2,doc:m}),k=!0,(l&&this.Io(m,l)>0||c&&this.Io(m,c)<0)&&(a=!0)):!f&&m?(s.track({type:0,doc:m}),k=!0):f&&!m&&(s.track({type:1,doc:f}),k=!0,(l||c)&&(a=!0)),k&&(m?(o=o.add(m),r=M?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),Vh(this.query)||Ld(this.query))for(;o.size>this.query.limit;){const d=Vh(this.query)?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),s.track({type:1,doc:d})}return{Ao:o,Po:s,Ln:a,mutatedKeys:r}}vo(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const i=this.Ao;this.Ao=e.Ao,this.mutatedKeys=e.mutatedKeys;const r=e.Po.eo();r.sort((c,d)=>function(u,f){const m=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return m(u)-m(f)}(c.type,d.type)||this.Io(c.doc,d.doc)),this.Vo(s);const o=n?this.So():[],a=this.Eo.size===0&&this.current?1:0,l=a!==this.To;return this.To=a,r.length!==0||l?{snapshot:new ll(this.query,e.Ao,i,r,e.mutatedKeys,a===0,l,!1),Do:o}:{Do:o}}io(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ao:this.Ao,Po:new ib,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{Do:[]}}Co(e){return!this.po.has(e)&&!!this.Ao.has(e)&&!this.Ao.get(e).hasLocalMutations}Vo(e){e&&(e.addedDocuments.forEach(n=>this.po=this.po.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.po=this.po.delete(n)),this.current=e.current)}So(){if(!this.current)return[];const e=this.Eo;this.Eo=sn(),this.Ao.forEach(s=>{this.Co(s.key)&&(this.Eo=this.Eo.add(s.key))});const n=[];return e.forEach(s=>{this.Eo.has(s)||n.push(new d9(s))}),this.Eo.forEach(s=>{e.has(s)||n.push(new h9(s))}),n}No(e){this.po=e.Gn,this.Eo=sn();const n=this.bo(e.documents);return this.applyChanges(n,!0)}xo(){return ll.fromInitialDocuments(this.query,this.Ao,this.mutatedKeys,this.To===0)}}class iN{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class rN{constructor(e){this.key=e,this.ko=!1}}class oN{constructor(e,n,s,i,r,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.$o={},this.Oo=new Ou(a=>NE(a),jf),this.Fo=new Map,this.Mo=new Set,this.Lo=new Yn(nt.comparator),this.Bo=new Map,this.Uo=new E_,this.qo={},this.Ko=new Map,this.jo=al.ie(),this.onlineState="Unknown",this.Qo=void 0}get isPrimaryClient(){return this.Qo===!0}}async function aN(t,e){const n=_N(t);let s,i;const r=n.Oo.get(e);if(r)s=r.targetId,n.sharedClientState.addLocalQueryTarget(s),i=r.view.xo();else{const o=await AO(n.localStore,Zo(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,i=await lN(n,e,s,a==="current"),n.isPrimaryClient&&i9(n.remoteStore,o)}return i}async function lN(t,e,n,s){t.Wo=(d,u,f)=>async function(m,h,M,k){let L=h.view.bo(M);L.Ln&&(L=await tb(m.localStore,h.query,!1).then(({documents:D})=>h.view.bo(D,L)));const p=k&&k.targetChanges.get(h.targetId),I=h.view.applyChanges(L,m.isPrimaryClient,p);return ob(m,h.targetId,I.Do),I.snapshot}(t,d,u,f);const i=await tb(t.localStore,e,!0),r=new sN(e,i.Gn),o=r.bo(i.documents),a=ku.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),l=r.applyChanges(o,t.isPrimaryClient,a);ob(t,n,l.Do);const c=new iN(e,n,r);return t.Oo.set(e,c),t.Fo.has(n)?t.Fo.get(n).push(e):t.Fo.set(n,[e]),l.snapshot}async function cN(t,e){const n=ft(t),s=n.Oo.get(e),i=n.Fo.get(s.targetId);if(i.length>1)return n.Fo.set(s.targetId,i.filter(r=>!jf(r,e))),void n.Oo.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await G0(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r9(n.remoteStore,s.targetId),W0(n,s.targetId)}).catch(xu)):(W0(n,s.targetId),await G0(n.localStore,s.targetId,!0))}async function uN(t,e,n){const s=vN(t);try{const i=await function(r,o){const a=ft(r),l=Ps.now(),c=o.reduce((u,f)=>u.add(f.key),sn());let d;return a.persistence.runTransaction("Locally write mutations","readwrite",u=>a.Qn.Pn(u,c).next(f=>{d=f;const m=[];for(const h of o){const M=Px(h,d.get(h.key));M!=null&&m.push(new ha(h.key,M,ME(M.value.mapValue),Qi.exists(!0)))}return a.In.addMutationBatch(u,l,m,o)})).then(u=>(u.applyToLocalDocumentSet(d),{batchId:u.batchId,changes:d}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(r,o,a){let l=r.qo[r.currentUser.toKey()];l||(l=new Yn(Ft)),l=l.insert(o,a),r.qo[r.currentUser.toKey()]=l}(s,i.batchId,n),await Lu(s,i.changes),await Wf(s.remoteStore)}catch(i){const r=I_(i,"Failed to persist write");n.reject(r)}}async function f9(t,e){const n=ft(t);try{const s=await EO(n.localStore,e);e.targetChanges.forEach((i,r)=>{const o=n.Bo.get(r);o&&(Jt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ko=!0:i.modifiedDocuments.size>0?Jt(o.ko):i.removedDocuments.size>0&&(Jt(o.ko),o.ko=!1))}),await Lu(n,s,e)}catch(s){await xu(s)}}function rb(t,e,n){const s=ft(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const i=[];s.Oo.forEach((r,o)=>{const a=o.view.io(e);a.snapshot&&i.push(a.snapshot)}),function(r,o){const a=ft(r);a.onlineState=o;let l=!1;a.queries.forEach((c,d)=>{for(const u of d.listeners)u.io(o)&&(l=!0)}),l&&x_(a)}(s.eventManager,e),i.length&&s.$o.Rr(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function hN(t,e,n){const s=ft(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.Bo.get(e),r=i&&i.key;if(r){let o=new Yn(nt.comparator);o=o.insert(r,qn.newNoDocument(r,Lt.min()));const a=sn().add(r),l=new zf(Lt.min(),new Map,new Fn(Ft),o,a);await f9(s,l),s.Lo=s.Lo.remove(r),s.Bo.delete(e),N_(s)}else await G0(s.localStore,e,!1).then(()=>W0(s,e,n)).catch(xu)}async function dN(t,e){const n=ft(t),s=e.batch.batchId;try{const i=await wO(n.localStore,e);p9(n,s,null),m9(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Lu(n,i)}catch(i){await xu(i)}}async function fN(t,e,n){const s=ft(t);try{const i=await function(r,o){const a=ft(r);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.In.lookupMutationBatch(l,o).next(d=>(Jt(d!==null),c=d.keys(),a.In.removeMutationBatch(l,d))).next(()=>a.In.performConsistencyCheck(l)).next(()=>a.Qn.Pn(l,c))})}(s.localStore,e);p9(s,e,n),m9(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Lu(s,i)}catch(i){await xu(i)}}function m9(t,e){(t.Ko.get(e)||[]).forEach(n=>{n.resolve()}),t.Ko.delete(e)}function p9(t,e,n){const s=ft(t);let i=s.qo[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(n?r.reject(n):r.resolve(),i=i.remove(e)),s.qo[s.currentUser.toKey()]=i}}function W0(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Fo.get(e))t.Oo.delete(s),n&&t.$o.Go(s,n);t.Fo.delete(e),t.isPrimaryClient&&t.Uo.cs(e).forEach(s=>{t.Uo.containsKey(s)||g9(t,s)})}function g9(t,e){t.Mo.delete(e.path.canonicalString());const n=t.Lo.get(e);n!==null&&(r9(t.remoteStore,n),t.Lo=t.Lo.remove(e),t.Bo.delete(n),N_(t))}function ob(t,e,n){for(const s of n)s instanceof h9?(t.Uo.addReference(s.key,e),mN(t,s)):s instanceof d9?(tt("SyncEngine","Document no longer in limbo: "+s.key),t.Uo.removeReference(s.key,e),t.Uo.containsKey(s.key)||g9(t,s.key)):dt()}function mN(t,e){const n=e.key,s=n.path.canonicalString();t.Lo.get(n)||t.Mo.has(s)||(tt("SyncEngine","New document in limbo: "+n),t.Mo.add(s),N_(t))}function N_(t){for(;t.Mo.size>0&&t.Lo.size<t.maxConcurrentLimboResolutions;){const e=t.Mo.values().next().value;t.Mo.delete(e);const n=new nt(nn.fromString(e)),s=t.jo.next();t.Bo.set(s,new rN(n)),t.Lo=t.Lo.insert(n,s),i9(t.remoteStore,new Fo(Zo(Uf(n.path)),s,2,u_.T))}}async function Lu(t,e,n){const s=ft(t),i=[],r=[],o=[];s.Oo.isEmpty()||(s.Oo.forEach((a,l)=>{o.push(s.Wo(l,e,n).then(c=>{if(c){s.isPrimaryClient&&s.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),i.push(c);const d=w_.kn(l.targetId,c);r.push(d)}}))}),await Promise.all(o),s.$o.Rr(i),await async function(a,l){const c=ft(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>Ke.forEach(l,u=>Ke.forEach(u.Nn,f=>c.persistence.referenceDelegate.addReference(d,u.targetId,f)).next(()=>Ke.forEach(u.xn,f=>c.persistence.referenceDelegate.removeReference(d,u.targetId,f)))))}catch(d){if(!Mu(d))throw d;tt("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const u=d.targetId;if(!d.fromCache){const f=c.Un.get(u),m=f.snapshotVersion,h=f.withLastLimboFreeSnapshotVersion(m);c.Un=c.Un.insert(u,h)}}}(s.localStore,r))}async function pN(t,e){const n=ft(t);if(!n.currentUser.isEqual(e)){tt("SyncEngine","User change. New user:",e.toKey());const s=await e9(n.localStore,e);n.currentUser=e,function(i,r){i.Ko.forEach(o=>{o.forEach(a=>{a.reject(new qe(Ee.CANCELLED,r))})}),i.Ko.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Lu(n,s.Wn)}}function gN(t,e){const n=ft(t),s=n.Bo.get(e);if(s&&s.ko)return sn().add(s.key);{let i=sn();const r=n.Fo.get(e);if(!r)return i;for(const o of r){const a=n.Oo.get(o);i=i.unionWith(a.view.Ro)}return i}}function _N(t){const e=ft(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=f9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hN.bind(null,e),e.$o.Rr=tN.bind(null,e.eventManager),e.$o.Go=nN.bind(null,e.eventManager),e}function vN(t){const e=ft(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fN.bind(null,e),e}class yN{constructor(){this.synchronizeTabs=!1}async initialize(e){this.N=Kf(e.databaseInfo.databaseId),this.sharedClientState=this.Ho(e),this.persistence=this.Jo(e),await this.persistence.start(),this.gcScheduler=this.Yo(e),this.localStore=this.Xo(e)}Yo(e){return null}Xo(e){return bO(this.persistence,new vO,e.initialUser,this.N)}Jo(e){return new xO(T_.Ns,this.N)}Ho(e){return new NO}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class bN{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>rb(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=pN.bind(null,this.syncEngine),await ZO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new eN}createDatastore(e){const n=Kf(e.databaseInfo.databaseId),s=(i=e.databaseInfo,new FO(i));var i;return function(r,o,a){return new jO(r,o,a)}(e.credentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,i=e.asyncQueue,r=a=>rb(this.syncEngine,a,0),o=sb.bt()?new sb:new LO,new VO(n,s,i,r,o);var n,s,i,r,o}createSyncEngine(e,n){return function(s,i,r,o,a,l,c){const d=new oN(s,i,r,o,a,l);return c&&(d.Qo=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=ft(e);tt("RemoteStore","RemoteStore shutting down."),n.Wr.add(5),await Nu(n),n.zr.shutdown(),n.Hr.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.tc(this.observer.next,e)}error(e){this.observer.error?this.tc(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}ec(){this.muted=!0}tc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,n,s){this.credentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=_s.UNAUTHENTICATED,this.clientId=CE.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(n,async i=>{tt("FirestoreClient","Received user=",i.uid),await this.credentialListener(i),this.user=i})}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new qe(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),e.resolve()}catch(n){const s=I_(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function EN(t,e){t.asyncQueue.verifyOperationInProgress(),tt("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async i=>{s.isEqual(i)||(await e9(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function TN(t,e){t.asyncQueue.verifyOperationInProgress();const n=await SN(t);tt("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(i=>async function(r,o){const a=ft(r);a.asyncQueue.verifyOperationInProgress(),tt("RemoteStore","RemoteStore received new credentials");const l=da(a);a.Wr.add(3),await Nu(a),l&&a.Hr.set("Unknown"),await a.remoteSyncer.handleCredentialChange(o),a.Wr.delete(3),await Gf(a)}(e.remoteStore,i)),t.onlineComponents=e}async function SN(t){return t.offlineComponents||(tt("FirestoreClient","Using default OfflineComponentProvider"),await EN(t,new yN)),t.offlineComponents}async function _9(t){return t.onlineComponents||(tt("FirestoreClient","Using default OnlineComponentProvider"),await TN(t,new bN)),t.onlineComponents}function AN(t){return _9(t).then(e=>e.syncEngine)}async function Ud(t){const e=await _9(t),n=e.eventManager;return n.onListen=aN.bind(null,e.syncEngine),n.onUnlisten=cN.bind(null,e.syncEngine),n}function RN(t,e,n={}){const s=new Xi;return t.asyncQueue.enqueueAndForget(async()=>function(i,r,o,a,l){const c=new L_({next:u=>{r.enqueueAndForget(()=>M_(i,d));const f=u.docs.has(o);!f&&u.fromCache?l.reject(new qe(Ee.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&u.fromCache&&a&&a.source==="server"?l.reject(new qe(Ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(u)},error:u=>l.reject(u)}),d=new O_(Uf(o.path),c,{includeMetadataChanges:!0,fo:!0});return k_(i,d)}(await Ud(t),t.asyncQueue,e,n,s)),s.promise}function CN(t,e,n={}){const s=new Xi;return t.asyncQueue.enqueueAndForget(async()=>function(i,r,o,a,l){const c=new L_({next:u=>{r.enqueueAndForget(()=>M_(i,d)),u.fromCache&&a.source==="server"?l.reject(new qe(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(u)},error:u=>l.reject(u)}),d=new O_(o,c,{includeMetadataChanges:!0,fo:!0});return k_(i,d)}(await Ud(t),t.asyncQueue,e,n,s)),s.promise}class IN{constructor(e,n,s,i,r,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Wc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v9(t,e,n){if(!n)throw new qe(Ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function kN(t,e,n,s){if(e===!0&&s===!0)throw new qe(Ee.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lb(t){if(!nt.isDocumentKey(t))throw new qe(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cb(t){if(nt.isDocumentKey(t))throw new qe(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Yf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dt()}function Fs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qe(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Yf(t);throw new qe(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function MN(t,e){if(e<=0)throw new qe(Ee.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new qe(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,kN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e,n){this._credentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ub({}),this._settingsFrozen=!1,e instanceof Wc?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new qe(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(s.options.projectId)}(e))}get app(){if(!this._app)throw new qe(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new qe(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ub(e),e.credentials!==void 0&&(this._credentials=function(n){if(!n)return new cx;switch(n.type){case"gapi":const s=n.client;return Jt(!(typeof s!="object"||s===null||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new dx(s,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new qe(Ee.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=ab.get(e);n&&(tt("ComponentProvider","Removing Datastore"),ab.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Kn(this.firestore,e,this._key)}}class ji{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ji(this.firestore,e,this._query)}}class xr extends ji{constructor(e,n,s){super(e,n,Uf(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Kn(this.firestore,null,new nt(e))}withConverter(e){return new xr(this.firestore,e,this._path)}}function P_(t,e,...n){if(t=_n(t),v9("collection","path",e),t instanceof D_){const s=nn.fromString(e,...n);return cb(s),new xr(t,null,s)}{if(!(t instanceof Kn||t instanceof xr))throw new qe(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(nn.fromString(e,...n));return cb(s),new xr(t.firestore,null,s)}}function Il(t,e,...n){if(t=_n(t),arguments.length===1&&(e=CE.I()),v9("doc","path",e),t instanceof D_){const s=nn.fromString(e,...n);return lb(s),new Kn(t,null,new nt(s))}{if(!(t instanceof Kn||t instanceof xr))throw new qe(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(nn.fromString(e,...n));return lb(s),new Kn(t.firestore,t instanceof xr?t.converter:null,new nt(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(){this._c=Promise.resolve(),this.mc=[],this.gc=!1,this.yc=[],this.Tc=null,this.Ec=!1,this.Ic=!1,this.Ac=[],this.ar=new n9(this,"async_queue_retry"),this.Rc=()=>{const n=h1();n&&tt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.ar.tr()};const e=h1();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Rc)}get isShuttingDown(){return this.gc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.bc(),this.Pc(e)}enterRestrictedMode(e){if(!this.gc){this.gc=!0,this.Ic=e||!1;const n=h1();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Rc)}}enqueue(e){if(this.bc(),this.gc)return new Promise(()=>{});const n=new Xi;return this.Pc(()=>this.gc&&this.Ic?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.mc.push(e),this.vc()))}async vc(){if(this.mc.length!==0){try{await this.mc[0](),this.mc.shift(),this.ar.reset()}catch(e){if(!Mu(e))throw e;tt("AsyncQueue","Operation failed with retryable error: "+e)}this.mc.length>0&&this.ar.Xi(()=>this.vc())}}Pc(e){const n=this._c.then(()=>(this.Ec=!0,e().catch(s=>{this.Tc=s,this.Ec=!1;const i=function(r){let o=r.message||"";return r.stack&&(o=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),o}(s);throw Hr("INTERNAL UNHANDLED ERROR: ",i),s}).then(s=>(this.Ec=!1,s))));return this._c=n,n}enqueueAfterDelay(e,n,s){this.bc(),this.Ac.indexOf(e)>-1&&(n=0);const i=C_.createAndSchedule(this,e,n,s,r=>this.Vc(r));return this.yc.push(i),i}bc(){this.Tc&&dt()}verifyOperationInProgress(){}async Sc(){let e;do e=this._c,await e;while(e!==this._c)}Dc(e){for(const n of this.yc)if(n.timerId===e)return!0;return!1}Cc(e){return this.Sc().then(()=>{this.yc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.yc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Sc()})}Nc(e){this.Ac.push(e)}Vc(e){const n=this.yc.indexOf(e);this.yc.splice(n,1)}}function hb(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class rr extends D_{constructor(e,n){super(e,n),this.type="firestore",this._queue=new xN,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||y9(this),this._firestoreClient.terminate()}}function ON(t=ng()){return eg(t,"firestore").getImmediate()}function Xf(t){return t._firestoreClient||y9(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function y9(t){var e;const n=t._freezeSettings(),s=function(i,r,o,a){return new IN(i,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new wN(t._credentials,t._queue,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new qe(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ws(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cl(Wn.fromBase64String(e))}catch(n){throw new qe(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cl(Wn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new qe(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new qe(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ft(this._lat,e._lat)||Ft(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=/^__.*__$/;class LN{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new ha(e,this.data,this.fieldMask,n,this.fieldTransforms):new $f(e,this.data,n,this.fieldTransforms)}}class b9{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new ha(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function w9(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class Zf{constructor(e,n,s,i,r,o){this.settings=e,this.databaseId=n,this.N=s,this.ignoreUndefinedProperties=i,r===void 0&&this.xc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get kc(){return this.settings.kc}$c(e){return new Zf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Oc(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.$c({path:s,Fc:!1});return i.Mc(e),i}Lc(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.$c({path:s,Fc:!1});return i.xc(),i}Bc(e){return this.$c({path:void 0,Fc:!0})}Uc(e){return jd(e,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Kc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Mc(this.path.get(e))}Mc(e){if(e.length===0)throw this.Uc("Document fields must not be empty");if(w9(this.kc)&&NN.test(e))throw this.Uc('Document fields cannot begin and end with "__"')}}class DN{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.N=s||Kf(e)}jc(e,n,s,i=!1){return new Zf({kc:e,methodName:n,Kc:s,path:ws.emptyPath(),Fc:!1,qc:i},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function Pu(t){const e=t._freezeSettings(),n=Kf(t._databaseId);return new DN(t._databaseId,!!e.ignoreUndefinedProperties,n)}function E9(t,e,n,s,i,r={}){const o=t.jc(r.merge||r.mergeFields?2:0,e,n,i);B_("Data must be an object, but it was:",o,s);const a=A9(s,o);let l,c;if(r.merge)l=new $c(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const u of r.mergeFields){const f=Y0(e,u,n);if(!o.contains(f))throw new qe(Ee.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);C9(d,f)||d.push(f)}l=new $c(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new LN(new xs(a),l,c)}class Fu extends Du{_toFieldTransform(e){if(e.kc!==2)throw e.kc===1?e.Uc(`${this._methodName}() can only appear at the top level of your update data`):e.Uc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fu}}function T9(t,e,n){return new Zf({kc:3,Kc:e.settings.Kc,methodName:t._methodName,Fc:n},e.databaseId,e.N,e.ignoreUndefinedProperties)}class PN extends Du{constructor(e,n){super(e),this.Qc=n}_toFieldTransform(e){const n=T9(this,e,!0),s=this.Qc.map(r=>fa(r,n)),i=new rl(s);return new HE(e.path,i)}isEqual(e){return this===e}}class FN extends Du{constructor(e,n){super(e),this.Qc=n}_toFieldTransform(e){const n=T9(this,e,!0),s=this.Qc.map(r=>fa(r,n)),i=new ol(s);return new HE(e.path,i)}isEqual(e){return this===e}}function BN(t,e,n,s){const i=t.jc(1,e,n);B_("Data must be an object, but it was:",i,s);const r=[],o=xs.empty();ua(s,(l,c)=>{const d=U_(e,l,n);c=_n(c);const u=i.Lc(d);if(c instanceof Fu)r.push(d);else{const f=fa(c,u);f!=null&&(r.push(d),o.set(d,f))}});const a=new $c(r);return new b9(o,a,i.fieldTransforms)}function UN(t,e,n,s,i,r){const o=t.jc(1,e,n),a=[Y0(e,s,n)],l=[i];if(r.length%2!=0)throw new qe(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(Y0(e,r[f])),l.push(r[f+1]);const c=[],d=xs.empty();for(let f=a.length-1;f>=0;--f)if(!C9(c,a[f])){const m=a[f];let h=l[f];h=_n(h);const M=o.Lc(m);if(h instanceof Fu)c.push(m);else{const k=fa(h,M);k!=null&&(c.push(m),d.set(m,k))}}const u=new $c(c);return new b9(d,u,o.fieldTransforms)}function S9(t,e,n,s=!1){return fa(n,t.jc(s?4:3,e))}function fa(t,e){if(R9(t=_n(t)))return B_("Unsupported field value:",e,t),A9(t,e);if(t instanceof Du)return function(n,s){if(!w9(s.kc))throw s.Uc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Uc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&e.kc!==4)throw e.Uc("Nested arrays are not supported");return function(n,s){const i=[];let r=0;for(const o of n){let a=fa(o,s.Bc(r));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),r++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=_n(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Mx(s.N,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Ps.fromDate(n);return{timestampValue:Fd(s.N,i)}}if(n instanceof Ps){const i=new Ps(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Fd(s.N,i)}}if(n instanceof F_)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof cl)return{bytesValue:WE(s.N,n._byteString)};if(n instanceof Kn){const i=s.databaseId,r=n.firestore._databaseId;if(!r.isEqual(i))throw s.Uc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:y_(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.Uc(`Unsupported field value: ${Yf(n)}`)}(t,e)}function A9(t,e){const n={};return IE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ua(t,(s,i)=>{const r=fa(i,e.Oc(s));r!=null&&(n[s]=r)}),{mapValue:{fields:n}}}function R9(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ps||t instanceof F_||t instanceof cl||t instanceof Kn||t instanceof Du)}function B_(t,e,n){if(!R9(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=Yf(n);throw s==="an object"?e.Uc(t+" a custom object"):e.Uc(t+" "+s)}}function Y0(t,e,n){if((e=_n(e))instanceof Qf)return e._internalPath;if(typeof e=="string")return U_(t,e);throw jd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const jN=new RegExp("[~\\*/\\[\\]]");function U_(t,e,n){if(e.search(jN)>=0)throw jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qf(...e.split("."))._internalPath}catch{throw jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function jd(t,e,n,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${s}`),o&&(l+=` in document ${i}`),l+=")"),new qe(Ee.INVALID_ARGUMENT,a+t+l)}function C9(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,n,s,i,r){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Jf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class HN extends j_{data(){return super.data()}}function Jf(t,e){return typeof e=="string"?U_(t,e):e instanceof Qf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class I9 extends j_{constructor(e,n,s,i,r,o){super(e,n,s,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new zh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Jf("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class zh extends I9{data(e={}){return super.data(e)}}class k9{constructor(e,n,s,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new tc(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new zh(this._firestore,this._userDataWriter,s.key,s,new tc(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new qe(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let r=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new zh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new tc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:r++}))}{let r=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const a=new zh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new tc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,c=-1;return o.type!==0&&(l=r.indexOf(o.doc.key),r=r.delete(o.doc.key)),o.type!==1&&(r=r.add(o.doc),c=r.indexOf(o.doc.key)),{type:VN(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function VN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M9(t){if(Ld(t)&&t.explicitOrderBy.length===0)throw new qe(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bu{}function Ls(t,...e){for(const n of e)t=n._apply(t);return t}class qN extends Bu{constructor(e,n,s){super(),this.Gc=e,this.zc=n,this.Hc=s,this.type="where"}_apply(e){const n=Pu(e.firestore),s=function(i,r,o,a,l,c,d){let u;if(l.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new qe(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on FieldPath.documentId().`);if(c==="in"||c==="not-in"){pb(d,c);const m=[];for(const h of d)m.push(mb(a,i,h));u={arrayValue:{values:m}}}else u=mb(a,i,d)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||pb(d,c),u=S9(o,r,d,c==="in"||c==="not-in");const f=rs.create(l,c,u);return function(m,h){if(h.v()){const k=__(m);if(k!==null&&!k.isEqual(h.field))throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${k.toString()}' and '${h.field.toString()}'`);const L=g_(m);L!==null&&L9(m,h.field,L)}const M=function(k,L){for(const p of k.filters)if(L.indexOf(p.op)>=0)return p.op;return null}(m,function(k){switch(k){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(h.op));if(M!==null)throw M===h.op?new qe(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${h.op.toString()}' filter.`):new qe(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${h.op.toString()}' filters with '${M.toString()}' filters.`)}(i,f),f}(e._query,"where",n,e.firestore._databaseId,this.Gc,this.zc,this.Hc);return new ji(e.firestore,e.converter,function(i,r){const o=i.filters.concat([r]);return new Wr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),o,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,s))}}function X0(t,e,n){const s=e,i=Jf("where",t);return new qN(i,s,n)}class $N extends Bu{constructor(e,n){super(),this.Gc=e,this.Jc=n,this.type="orderBy"}_apply(e){const n=function(s,i,r){if(s.startAt!==null)throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ua(i,r);return function(a,l){if(g_(a)===null){const c=__(a);c!==null&&L9(a,c,l.field)}}(s,o),o}(e._query,this.Gc,this.Jc);return new ji(e.firestore,e.converter,function(s,i){const r=s.explicitOrderBy.concat([i]);return new Wr(s.path,s.collectionGroup,r,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Gi(t,e="asc"){const n=e,s=Jf("orderBy",t);return new $N(s,n)}class zN extends Bu{constructor(e,n,s){super(),this.type=e,this.Yc=n,this.Xc=s}_apply(e){return new ji(e.firestore,e.converter,OE(e._query,this.Yc,this.Xc))}}function Yc(t){return MN("limit",t),new zN("limit",t,"F")}class x9 extends Bu{constructor(e,n,s){super(),this.type=e,this.Zc=n,this.ta=s}_apply(e){const n=N9(e,this.type,this.Zc,this.ta);return new ji(e.firestore,e.converter,function(s,i){return new Wr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function db(...t){return new x9("startAt",t,!0)}function O9(...t){return new x9("startAfter",t,!1)}class KN extends Bu{constructor(e,n,s){super(),this.type=e,this.Zc=n,this.ta=s}_apply(e){const n=N9(e,this.type,this.Zc,this.ta);return new ji(e.firestore,e.converter,function(s,i){return new Wr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function fb(...t){return new KN("endAt",t,!1)}function N9(t,e,n,s){if(n[0]=_n(n[0]),n[0]instanceof j_)return function(i,r,o,a,l){if(!a)throw new qe(Ee.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const c=[];for(const d of il(i))if(d.field.isKeyField())c.push(Od(r,a.key));else{const u=a.data.field(d.field);if(h_(u))throw new qe(Ee.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(u===null){const f=d.field.canonicalString();throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}c.push(u)}return new Gc(c,l)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const i=Pu(t.firestore);return function(r,o,a,l,c,d){const u=r.explicitOrderBy;if(c.length>u.length)throw new qe(Ee.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let m=0;m<c.length;m++){const h=c[m];if(u[m].field.isKeyField()){if(typeof h!="string")throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof h}`);if(!v_(r)&&h.indexOf("/")!==-1)throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${l}() must be a plain document ID, but '${h}' contains a slash.`);const M=r.path.child(nn.fromString(h));if(!nt.isDocumentKey(M))throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${l}() must result in a valid document path, but '${M}' is not because it contains an odd number of segments.`);const k=new nt(M);f.push(Od(o,k))}else{const M=S9(a,l,h);f.push(M)}}return new Gc(f,d)}(t._query,t.firestore._databaseId,i,e,n,s)}}function mb(t,e,n){if(typeof(n=_n(n))=="string"){if(n==="")throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!v_(e)&&n.indexOf("/")!==-1)throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(nn.fromString(n));if(!nt.isDocumentKey(s))throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Od(t,new nt(s))}if(n instanceof Kn)return Od(t,n._key);throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yf(n)}.`)}function pb(t,e){if(!Array.isArray(t)||t.length===0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new qe(Ee.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function L9(t,e,n){if(!n.isEqual(e))throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{convertValue(e,n="none"){switch(Qo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(nl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw dt()}}convertObject(e,n){const s={};return ua(e.fields,(i,r)=>{s[i]=this.convertValue(r,n)}),s}convertGeoPoint(e){return new F_(wn(e.latitude),wn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=kE(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(zc(e));default:return null}}convertTimestamp(e){const n=Vr(e);return new Ps(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=nn.fromString(e);Jt(ZE(s));const i=new Wc(s.get(1),s.get(3)),r=new nt(s.popFirst(5));return i.isEqual(n)||Hr(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D9(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(t){t=Fs(t,Kn);const e=Fs(t.firestore,rr);return RN(Xf(e),t._key).then(n=>P9(e,t,n))}class H_ extends GN{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Kn(this.firestore,null,n)}}function YN(t){t=Fs(t,ji);const e=Fs(t.firestore,rr),n=Xf(e),s=new H_(e);return M9(t._query),CN(n,t._query).then(i=>new k9(e,s,t,i))}function XN(t,e,n){t=Fs(t,Kn);const s=Fs(t.firestore,rr),i=D9(t.converter,e,n);return em(s,[E9(Pu(s),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Qi.none())])}function QN(t,e,n,...s){t=Fs(t,Kn);const i=Fs(t.firestore,rr),r=Pu(i);let o;return o=typeof(e=_n(e))=="string"||e instanceof Qf?UN(r,"updateDoc",t._key,e,n,s):BN(r,"updateDoc",t._key,e),em(i,[o.toMutation(t._key,Qi.exists(!0))])}function ZN(t){return em(Fs(t.firestore,rr),[new qE(t._key,Qi.none())])}function JN(t,e){const n=Fs(t.firestore,rr),s=Il(t),i=D9(t.converter,e);return em(n,[E9(Pu(t.firestore),"addDoc",s._key,i,t.converter!==null,{}).toMutation(s._key,Qi.exists(!1))]).then(()=>s)}function eL(t,...e){var n,s,i;t=_n(t);let r={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||hb(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges};if(hb(e[o])){const u=e[o];e[o]=(n=u.next)===null||n===void 0?void 0:n.bind(u),e[o+1]=(s=u.error)===null||s===void 0?void 0:s.bind(u),e[o+2]=(i=u.complete)===null||i===void 0?void 0:i.bind(u)}let l,c,d;if(t instanceof Kn)c=Fs(t.firestore,rr),d=Uf(t._key.path),l={next:u=>{e[o]&&e[o](P9(c,t,u))},error:e[o+1],complete:e[o+2]};else{const u=Fs(t,ji);c=Fs(u.firestore,rr),d=u._query;const f=new H_(c);l={next:m=>{e[o]&&e[o](new k9(c,f,u,m))},error:e[o+1],complete:e[o+2]},M9(t._query)}return function(u,f,m,h){const M=new L_(h),k=new O_(f,M,m);return u.asyncQueue.enqueueAndForget(async()=>k_(await Ud(u),k)),()=>{M.ec(),u.asyncQueue.enqueueAndForget(async()=>M_(await Ud(u),k))}}(Xf(c),d,a,l)}function em(t,e){return function(n,s){const i=new Xi;return n.asyncQueue.enqueueAndForget(async()=>uN(await AN(n),s,i)),i.promise}(Xf(t),e)}function P9(t,e,n){const s=n.docs.get(e._key),i=new H_(t);return new I9(t,i,e._key,s,new tc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return new Fu("deleteField")}function V_(...t){return new PN("arrayUnion",t)}function q_(...t){return new FN("arrayRemove",t)}(function(t,e=!0){(function(n){Al=n})(tg),mu(new vl("firestore",(n,{options:s})=>{const i=n.getProvider("app").getImmediate(),r=new rr(i,new ux(n.getProvider("auth-internal")));return s=Object.assign({useFetchStreams:e},s),r._setSettings(s),r},"PUBLIC")),Di(Ny,"3.3.0",t),Di(Ny,"3.3.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F9="firebasestorage.googleapis.com",B9="storageBucket",nL=2*60*1e3,sL=10*60*1e3;class fn extends mf{constructor(e,n){super(d1(e),`Firebase Storage: ${n} (${d1(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,fn.prototype)}_codeEquals(e){return d1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function d1(t){return"storage/"+t}function $_(){const t="An unknown error occurred, please check the error payload for server response.";return new fn("unknown",t)}function iL(t){return new fn("object-not-found","Object '"+t+"' does not exist.")}function rL(t){return new fn("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function oL(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new fn("unauthenticated",t)}function aL(){return new fn("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function lL(t){return new fn("unauthorized","User does not have permission to access '"+t+"'.")}function cL(){return new fn("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function U9(){return new fn("canceled","User canceled the upload/download.")}function uL(t){return new fn("invalid-url","Invalid URL '"+t+"'.")}function hL(t){return new fn("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function dL(){return new fn("no-default-bucket","No default bucket found. Did you set the '"+B9+"' property when initializing the app?")}function j9(){return new fn("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function fL(){return new fn("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function mL(){return new fn("no-download-url","The given file does not have any download URLs.")}function Q0(t){return new fn("invalid-argument",t)}function H9(){return new fn("app-deleted","The Firebase app was deleted.")}function pL(t){return new fn("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function yc(t,e){return new fn("invalid-format","String does not match format '"+t+"': "+e)}function mh(t){throw new fn("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Ds.makeFromUrl(e,n)}catch{return new Ds(e,"")}if(s.path==="")return s;throw hL(e)}static makeFromUrl(e,n){let s=null;const i="([A-Za-z0-9.\\-_]+)";function r(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(D){D.path_=decodeURIComponent(D.path)}const d="v[A-Za-z0-9_]+",u=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${u}/${d}/b/${i}/o${f}`,"i"),h={bucket:1,path:3},M=n===F9?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",L=new RegExp(`^https?://${M}/${i}/${k}`,"i"),I=[{regex:a,indices:l,postModify:r},{regex:m,indices:h,postModify:c},{regex:L,indices:{bucket:1,path:2},postModify:c}];for(let D=0;D<I.length;D++){const x=I[D],B=x.regex.exec(e);if(B){const _=B[x.indices.bucket];let A=B[x.indices.path];A||(A=""),s=new Ds(_,A),x.postModify(s);break}}if(s==null)throw uL(e);return s}}class gL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _L(t,e,n){let s=1,i=null,r=!1,o=0;function a(){return o===2}let l=!1;function c(...h){l||(l=!0,e.apply(null,h))}function d(h){i=setTimeout(()=>{i=null,t(u,a())},h)}function u(h,...M){if(l)return;if(h){c.call(null,h,...M);return}if(a()||r){c.call(null,h,...M);return}s<64&&(s*=2);let L;o===1?(o=2,L=0):L=(s+Math.random())*1e3,d(L)}let f=!1;function m(h){f||(f=!0,!l&&(i!==null?(h||(o=2),clearTimeout(i),d(0)):h||(o=1)))}return d(0),setTimeout(()=>{r=!0,m(!0)},n),m}function vL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(t){return t!==void 0}function bL(t){return typeof t=="function"}function wL(t){return typeof t=="object"&&!Array.isArray(t)}function tm(t){return typeof t=="string"||t instanceof String}function gb(t){return z_()&&t instanceof Blob}function z_(){return typeof Blob!="undefined"}function _b(t,e,n,s){if(s<e)throw Q0(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw Q0(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function V9(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const i=e(s)+"="+e(t[s]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Bo||(Bo={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,n,s,i,r,o,a,l,c,d,u){this.url_=e,this.method_=n,this.headers_=s,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,m)=>{this.resolve_=f,this.reject_=m,this.start_()})}start_(){const e=(s,i)=>{if(i){s(!1,new ph(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===Bo.NO_ERROR,l=r.getStatus();if(!a||this.isRetryStatusCode_(l)){const d=r.getErrorCode()===Bo.ABORT;s(!1,new ph(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new ph(c,r))})},n=(s,i)=>{const r=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponseText());yL(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=$_();l.serverResponse=a.getResponseText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?H9():U9();o(l)}else{const l=cL();o(l)}};this.canceled_?n(!1,new ph(!1,null,!0)):this.backoffId_=_L(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,r=this.additionalRetryCodes_.indexOf(e)!==-1;return n||i||r}}class ph{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function TL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function SL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function AL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function CL(t,e,n,s,i,r){const o=V9(t.urlParams),a=t.url+o,l=Object.assign({},t.headers);return AL(l,e),TL(l,n),SL(l,r),RL(l,s),new EL(a,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function kL(...t){const e=IL();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(z_())return new Blob(t);throw new fn("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function ML(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class f1{constructor(e,n){this.data=e,this.contentType=n||null}}function OL(t,e){switch(t){case Mi.RAW:return new f1(q9(e));case Mi.BASE64:case Mi.BASE64URL:return new f1($9(t,e));case Mi.DATA_URL:return new f1(LL(e),DL(e))}throw $_()}function q9(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const r=s,o=t.charCodeAt(++n);s=65536|(r&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function NL(t){let e;try{e=decodeURIComponent(t)}catch{throw yc(Mi.DATA_URL,"Malformed data URL.")}return q9(e)}function $9(t,e){switch(t){case Mi.BASE64:{const i=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(i||r)throw yc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Mi.BASE64URL:{const i=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(i||r)throw yc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=xL(e)}catch{throw yc(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);return s}class z9{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw yc(Mi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=PL(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function LL(t){const e=new z9(t);return e.base64?$9(Mi.BASE64,e.rest):NL(e.rest)}function DL(t){return new z9(t).contentType}function PL(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n){let s=0,i="";gb(e)?(this.data_=e,s=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(gb(this.data_)){const s=this.data_,i=ML(s,e,n);return i===null?null:new Rr(i)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Rr(s,!0)}}static getBlob(...e){if(z_()){const n=e.map(s=>s instanceof Rr?s.data_:s);return new Rr(kL.apply(null,n))}else{const n=e.map(o=>tm(o)?OL(Mi.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const i=new Uint8Array(s);let r=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[r++]=o[a]}),new Rr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K9(t){let e;try{e=JSON.parse(t)}catch{return null}return wL(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function BL(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function G9(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t,e){return e}class Zn{constructor(e,n,s,i){this.server=e,this.local=n||e,this.writable=!!s,this.xform=i||UL}}let gh=null;function jL(t){return!tm(t)||t.length<2?t:G9(t)}function W9(){if(gh)return gh;const t=[];t.push(new Zn("bucket")),t.push(new Zn("generation")),t.push(new Zn("metageneration")),t.push(new Zn("name","fullPath",!0));function e(r,o){return jL(o)}const n=new Zn("name");n.xform=e,t.push(n);function s(r,o){return o!==void 0?Number(o):o}const i=new Zn("size");return i.xform=s,t.push(i),t.push(new Zn("timeCreated")),t.push(new Zn("updated")),t.push(new Zn("md5Hash",null,!0)),t.push(new Zn("cacheControl",null,!0)),t.push(new Zn("contentDisposition",null,!0)),t.push(new Zn("contentEncoding",null,!0)),t.push(new Zn("contentLanguage",null,!0)),t.push(new Zn("contentType",null,!0)),t.push(new Zn("metadata","customMetadata",!0)),gh=t,gh}function HL(t,e){function n(){const s=t.bucket,i=t.fullPath,r=new Ds(s,i);return e._makeStorageReference(r)}Object.defineProperty(t,"ref",{get:n})}function VL(t,e,n){const s={};s.type="file";const i=n.length;for(let r=0;r<i;r++){const o=n[r];s[o.local]=o.xform(s,e[o.server])}return HL(s,t),s}function Y9(t,e,n){const s=K9(e);return s===null?null:VL(t,s,n)}function qL(t,e,n,s){const i=K9(e);if(i===null||!tm(i.downloadTokens))return null;const r=i.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(c=>{const d=t.bucket,u=t.fullPath,f="/b/"+o(d)+"/o/"+o(u),m=kl(f,n,s),h=V9({alt:"media",token:c});return m+h})[0]}function X9(t,e){const n={},s=e.length;for(let i=0;i<s;i++){const r=e[i];r.writable&&(n[r.server]=t[r.local])}return JSON.stringify(n)}class ma{constructor(e,n,s,i){this.url=e,this.method=n,this.handler=s,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t){if(!t)throw $_()}function K_(t,e){function n(s,i){const r=Y9(t,i,e);return Ji(r!==null),r}return n}function $L(t,e){function n(s,i){const r=Y9(t,i,e);return Ji(r!==null),qL(r,i,t.host,t._protocol)}return n}function Uu(t){function e(n,s){let i;return n.getStatus()===401?n.getResponseText().includes("Firebase App Check token is invalid")?i=aL():i=oL():n.getStatus()===402?i=rL(t.bucket):n.getStatus()===403?i=lL(t.path):i=s,i.serverResponse=s.serverResponse,i}return e}function G_(t){const e=Uu(t);function n(s,i){let r=e(s,i);return s.getStatus()===404&&(r=iL(t.path)),r.serverResponse=i.serverResponse,r}return n}function zL(t,e,n){const s=e.fullServerUrl(),i=kl(s,t.host,t._protocol),r="GET",o=t.maxOperationRetryTime,a=new ma(i,r,K_(t,n),o);return a.errorHandler=G_(e),a}function KL(t,e,n){const s=e.fullServerUrl(),i=kl(s,t.host,t._protocol),r="GET",o=t.maxOperationRetryTime,a=new ma(i,r,$L(t,n),o);return a.errorHandler=G_(e),a}function GL(t,e){const n=e.fullServerUrl(),s=kl(n,t.host,t._protocol),i="DELETE",r=t.maxOperationRetryTime;function o(l,c){}const a=new ma(s,i,o,r);return a.successCodes=[200,204],a.errorHandler=G_(e),a}function WL(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Q9(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=WL(null,e)),s}function YL(t,e,n,s,i){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let I="";for(let D=0;D<2;D++)I=I+Math.random().toString().slice(2);return I}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Q9(e,s,i),d=X9(c,n),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",m=Rr.getBlob(u,s,f);if(m===null)throw j9();const h={name:c.fullPath},M=kl(r,t.host,t._protocol),k="POST",L=t.maxUploadRetryTime,p=new ma(M,k,K_(t,n),L);return p.urlParams=h,p.headers=o,p.body=m.uploadData(),p.errorHandler=Uu(e),p}class Hd{constructor(e,n,s,i){this.current=e,this.total=n,this.finalized=!!s,this.metadata=i||null}}function W_(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Ji(!1)}return Ji(!!n&&(e||["active"]).indexOf(n)!==-1),n}function XL(t,e,n,s,i){const r=e.bucketOnlyServerUrl(),o=Q9(e,s,i),a={name:o.fullPath},l=kl(r,t.host,t._protocol),c="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},u=X9(o,n),f=t.maxUploadRetryTime;function m(M){W_(M);let k;try{k=M.getResponseHeader("X-Goog-Upload-URL")}catch{Ji(!1)}return Ji(tm(k)),k}const h=new ma(l,c,m,f);return h.urlParams=a,h.headers=d,h.body=u,h.errorHandler=Uu(e),h}function QL(t,e,n,s){const i={"X-Goog-Upload-Command":"query"};function r(c){const d=W_(c,["active","final"]);let u=null;try{u=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ji(!1)}u||Ji(!1);const f=Number(u);return Ji(!isNaN(f)),new Hd(f,s.size(),d==="final")}const o="POST",a=t.maxUploadRetryTime,l=new ma(n,o,r,a);return l.headers=i,l.errorHandler=Uu(e),l}const vb=256*1024;function ZL(t,e,n,s,i,r,o,a){const l=new Hd(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=s.size()),s.size()!==l.total)throw fL();const c=l.total-l.current;let d=c;i>0&&(d=Math.min(d,i));const u=l.current,f=u+d,h={"X-Goog-Upload-Command":d===c?"upload, finalize":"upload","X-Goog-Upload-Offset":`${l.current}`},M=s.slice(u,f);if(M===null)throw j9();function k(D,x){const B=W_(D,["active","final"]),_=l.current+d,A=s.size();let T;return B==="final"?T=K_(e,r)(D,x):T=null,new Hd(_,A,B==="final",T)}const L="POST",p=e.maxUploadRetryTime,I=new ma(n,L,k,p);return I.headers=h,I.body=M.uploadData(),I.progressCallback=a||null,I.errorHandler=Uu(t),I}const vs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function m1(t){switch(t){case"running":case"pausing":case"canceling":return vs.RUNNING;case"paused":return vs.PAUSED;case"success":return vs.SUCCESS;case"canceled":return vs.CANCELED;case"error":return vs.ERROR;default:return vs.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,n,s){if(bL(e)||n!=null||s!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=s!=null?s:void 0;else{const r=e;this.next=r.next,this.error=r.error,this.complete=r.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class eD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Bo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Bo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Bo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,i){if(this.sent_)throw mh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponseText(){if(!this.sent_)throw mh("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}function wo(){return new eD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=W9(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,r)=>{this._resolve=i,this._reject=r,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=XL(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(s,wo,e,n);this._request=i,i.getPromise().then(r=>{this._request=void 0,this._uploadUrl=r,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const i=QL(this._ref.storage,this._ref._location,e,this._blob),r=this._ref.storage._makeRequest(i,wo,n,s);this._request=r,r.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=vb*this._chunkMultiplier,n=new Hd(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((i,r)=>{let o;try{o=ZL(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,wo,i,r);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){vb*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=zL(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(s,wo,e,n);this._request=i,i.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=YL(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(s,wo,e,n);this._request=i,i.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=U9(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=m1(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,i){const r=new JL(n||void 0,s||void 0,i||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(m1(this._state)){case vs.SUCCESS:ba(this._resolve.bind(null,this.snapshot))();break;case vs.CANCELED:case vs.ERROR:const n=this._reject;ba(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(m1(this._state)){case vs.RUNNING:case vs.PAUSED:e.next&&ba(e.next.bind(e,this.snapshot))();break;case vs.SUCCESS:e.complete&&ba(e.complete.bind(e))();break;case vs.CANCELED:case vs.ERROR:e.error&&ba(e.error.bind(e,this._error))();break;default:e.error&&ba(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n){this._service=e,n instanceof Ds?this._location=n:this._location=Ds.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ea(e,n)}get root(){const e=new Ds(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G9(this._location.path)}get storage(){return this._service}get parent(){const e=FL(this._location.path);if(e===null)return null;const n=new Ds(this._location.bucket,e);return new ea(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw pL(e)}}function nD(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new tD(t,new Rr(e),n)}function sD(t){t._throwIfRoot("getDownloadURL");const e=KL(t.storage,t._location,W9());return t.storage.makeRequestWithTokens(e,wo).then(n=>{if(n===null)throw mL();return n})}function iD(t){t._throwIfRoot("deleteObject");const e=GL(t.storage,t._location);return t.storage.makeRequestWithTokens(e,wo)}function rD(t,e){const n=BL(t._location.path,e),s=new Ds(t._location.bucket,n);return new ea(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(t){return/^[A-Za-z]+:\/\//.test(t)}function aD(t,e){return new ea(t,e)}function Z9(t,e){if(t instanceof Y_){const n=t;if(n._bucket==null)throw dL();const s=new ea(n,n._bucket);return e!=null?Z9(s,e):s}else return e!==void 0?rD(t,e):t}function lD(t,e){if(e&&oD(e)){if(t instanceof Y_)return aD(t,e);throw Q0("To use ref(service, url), the first argument must be a Storage instance.")}else return Z9(t,e)}function yb(t,e){const n=e==null?void 0:e[B9];return n==null?null:Ds.makeFromBucketSpec(n,t)}class Y_{constructor(e,n,s,i,r){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=F9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nL,this._maxUploadRetryTime=sL,this._requests=new Set,i!=null?this._bucket=Ds.makeFromBucketSpec(i,this._host):this._bucket=yb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ds.makeFromBucketSpec(this._url,e):this._bucket=yb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){_b("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){_b("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ea(this,e)}_makeRequest(e,n,s,i){if(this._deleted)return new gL(H9());{const r=CL(e,this._appId,s,i,n,this._firebaseVersion);return this._requests.add(r),r.getPromise().then(()=>this._requests.delete(r),()=>this._requests.delete(r)),r}}async makeRequestWithTokens(e,n){const[s,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,i).getPromise()}}const bb="@firebase/storage",wb="0.8.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="storage";function cD(t,e,n){return t=_n(t),nD(t,e,n)}function uD(t){return t=_n(t),sD(t)}function hD(t){return t=_n(t),iD(t)}function dD(t,e){return t=_n(t),lD(t,e)}function fD(t=ng(),e){return t=_n(t),eg(t,J9).getImmediate({identifier:e})}function mD(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Y_(n,s,i,e,tg)}function pD(){mu(new vl(J9,mD,"PUBLIC").setMultipleInstances(!0)),Di(bb,wb,""),Di(bb,wb,"esm2017")}pD();const gD=JSON.parse('{"apiKey": "AIzaSyCVy3Oc1jgvacBZe5hKBA8mV9EOqmqUG0U", "authDomain": "sandbox-public.firebaseapp.com", "databaseURL": "https://sandbox-public.firebaseio.com", "projectId": "sandbox-public", "storageBucket": "sandbox-public.appspot.com", "messagingSenderId": "694742394920", "appId": "1:694742394920:web:af0d589c7618f85ccc2d1d"}');FC(gD);const Yr=ON(),e8=Jk(),_D=fD(),ta="users",nm="chatRooms",vD="messages",X_=t=>`${nm}/${t}/${vD}`,xo="timestamp",Eb="lastUpdated",yD="typingUsers",bD="reactions",t8="users",Q_=eL,wD=tL(),Uo=t=>YN(t).then(e=>({data:sm(e),docs:e.docs})),n8=t=>WN(t).then(e=>l8(e)),Z_=(t,e)=>JN(t,e),ED=(t,e,n)=>XN(Il(Yr,t,e),n),J_=(t,e)=>QN(t,e),ev=(t,e)=>ZN(Il(Yr,t,e)),s8=P_(Yr,ta),i8=t=>Il(Yr,ta,t),TD=()=>Uo(Ls(s8)),SD=t=>n8(i8(t)),Tb=t=>Z_(s8,t),p1=(t,e)=>ED(ta,t,e),Sb=(t,e)=>J_(i8(t),e),AD=t=>ev(ta,t),Xc=P_(Yr,nm),RD=t=>Il(Yr,nm,t),CD=(t,e,n)=>n?Ls(Xc,X0(ta,"array-contains",t),Gi(Eb,"desc"),Yc(e),O9(n)):Ls(Xc,X0(ta,"array-contains",t),Gi(Eb,"desc"),Yc(e)),ID=()=>Uo(Ls(Xc)),kD=t=>Uo(t),Oa=t=>Z_(Xc,t),Qc=(t,e)=>J_(RD(t),e),r8=t=>ev(nm,t),Ab=(t,e)=>Uo(Ls(Xc,X0(ta,"==",[t,e]))),MD=(t,e)=>Qc(t,{[t8]:V_(e)}),xD=(t,e)=>Qc(t,{[t8]:q_(e)}),OD=(t,e,n)=>{const s=n==="add"?V_(e):q_(e);return Qc(t,{[yD]:s})},Wi=t=>P_(Yr,X_(t)),o8=(t,e)=>Il(Yr,X_(t),e),Z0=(t,e,n)=>Uo(n?Ls(Wi(t),Gi(xo,"desc"),Yc(e),O9(n)):e?Ls(Wi(t),Gi(xo,"desc"),Yc(e)):Wi(t)),ND=(t,e)=>n8(o8(t,e)),LD=(t,e)=>Z_(Wi(t),e),nc=(t,e,n)=>J_(o8(t,e),n),a8=(t,e)=>ev(X_(t),e),DD=(t,e)=>Q_(t,n=>{e(sm(n))}),PD=(t,e,n)=>e&&n?Ls(Wi(t),Gi(xo),db(e),fb(n)):e?Ls(Wi(t),Gi(xo),db(e)):n?Ls(Wi(t),Gi(xo),fb(n)):Ls(Wi(t),Gi(xo)),FD=(t,e,n,s)=>Q_(PD(t,e,n),i=>{s(sm(i))}),l8=t=>({...t.data(),id:t.id}),sm=t=>{const e=[];return t.forEach(n=>{e.push(l8(n))}),e},BD=t=>Ls(Wi(t),Gi(xo,"desc"),Yc(1)),UD=(t,e)=>Q_(Ls(BD(t)),n=>{e(sm(n))}),jD=(t,e,n,s,i)=>{const r=i==="add"?V_(n):q_(n);return nc(t,e,{[`${bD}.${s}`]:r})},HD="files",c8=(t,e,n)=>dD(_D,`${HD}/${t}/${e}/${n}`),J0=(t,e,n)=>hD(c8(t,e,`${n.name}.${n.extension||n.type}`)),VD=t=>uD(t),qD=(t,e,n,s)=>{const i=c8(t,e,`${n.name}.${s}`);return cD(i,n.blob,{contentType:s})},$D=(t,e,n,s,i,r,o)=>{const a=qD(t,e,n,s);a.on("state_changed",l=>{const c=Math.round(l.bytesTransferred/l.totalBytes*100);i(c)},l=>{r(l)},async()=>{const l=await VD(a.snapshot.ref);o(l)})},zD=R5,ep=t=>A5(e8,"/status/"+t),KD=t=>{const e={state:"offline",lastChanged:_y()},n={state:"online",lastChanged:_y()},s=A5(e8,".info/connected");R5(s,i=>{i.val()===!0&&$k(ep(t)).set(e).then(()=>{zk(ep(t),n)})})},_h=(t,e)=>String(t).padStart(e,"0"),GD=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),tp=(t,e="")=>{if(!t)return;const n=t.seconds?new Date(t.seconds*1e3):t;if(e==="HH:mm")return`${_h(n.getHours(),2)}:${_h(n.getMinutes(),2)}`;if(e==="DD MMMM YYYY"){const s={month:"long",year:"numeric",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",s).format(n)}`}else if(e==="DD/MM/YY"){const s={month:"numeric",year:"numeric",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",s).format(n)}`}else if(e==="DD MMMM, HH:mm"){const s={month:"long",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",s).format(n)}, ${_h(n.getHours(),2)}:${_h(n.getMinutes(),2)}`}return n},g1=(t,e)=>{const n=GD(t,new Date)?"HH:mm":"DD/MM/YY",s=tp(e,n);return n==="HH:mm"?`Today, ${s}`:s};var WD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQYAAADjCAMAAABQFUqLAAAAilBMVEX///9BuIM0SV5xyqJnd4bz+/dNvIug28FZwZPP7eDn9u9AsYE1UGC35NCJ07I2V2M3ZWc/qn4+nHo7gXHb8ujD6dis4Ml9zqo8jnXy9PWU17llxZo5c2ycprBBVGjJztQ/o3w7h3M6em44bGrm6OuFkp89lXdNYHI2XmWzusJ0gpFaa3zZ3eFrnZOT9yJ3AAAFzElEQVR42szaCVLbQBCF4e6xZOMFzGIWAbZYJIQN3P96MSSTraZcea2o532H0F/TTzIy+ChAlZjVBehjhJvIRHEPAbQWsyJglmowlfJIcU8B1IjRNoBeFHctIseKmy8CZic2VRcwp2owk72R4h4DqBaTdQA9KG4in6ZqsAyYN7FoAuheceNSvpwo7tzlK7kLmMVcccfyXTlW3GnAbCqB1QH0qLiRRJZongVQK7A3n1j+ZInmBRzNwWN5rrgT+eXSI5oFGsuNQyzHM4mM0bwZOJptAJ2ZYxmt1OA1YLphY/mkuKNS/nBLF83CI5aXEvWI5jMczQFjedMrltGVJZqL4aLZBcyrGqwk8o3mO/CY8I1lNLVEc4lGc6hYPtseE5F3NLdEsbySlJk6PC26Sv7BewBdWGIpSUT3OPjyNu/3mOgfzXs0mg1tLCOXe1zLdHlLu/OIZk0Ry1tJ4rnHNRvHy1vateJe/nM0W8/LW9os/z2u9ojlnST53uPWBDPVQflHLKeZ6qD8I1a1yRjLKP+I5ThTHbbyiGbHdHn7W/4Ra5c/lgT3ON+ZiiGaLcNM9Tuee5zv5S0t/4jlM1OVclD+Ect5pkrzv8clYpnt8hblH7GcZiqA0z2uIrq8fSEYsXxnKqpo1kSXt738I1aWmSriucfBl7deMxVdNCuCmeoHghHLd6YijGYje1vGWPre4xhmqk/5Ryyay1vOEYthpiK4x20JZiohGLEYZiqCexzV5S3biMUxUxHc4xx/EE8jGbGYLm8JDj+V88xU37i1YxuGgRgIgnAFguHMdiL1X6QaUMbj/y7ZxAGzBIwmdyzXRCxSpvKM5hGUN6THETIVwONQ8paPWAPGstvjuPL2fF/EaCYzFdfjUPK2MGKh5e35fvtHM5ip2B6HkrdFEYuaqdij2TCW3IhFyFQNHvc3y1syYs0ZS4DHVTPVjNFkjGXJ48zy1hux+JmK6HHHCzKWJY+7zPLGiVjJTCX2uDdoLGsRy5ipWKO5Xd4YEevcLm8Ej4s+iG8fzc+csaxFLGOmwowmcSxrHmeWt2DEMstbMmIZMxXB40jyFoxYxky13+NY8haMWMZM1eFxZnkLRiy1vAWfyo2ZqmM054xlKWIZM1XHaM4Zy5LHGTNVh8eZ5S0YseaMZc3jzPKWjFjGTNXgcWZ5WxexLrS8BT3OmKk6PM4sb8mIZcxUDaM5Zyzvcs0dN2IYhoKFC1kG7Go/QNykyv2PmIq7kCPTPypYcuYSA77htYjlMVM1kKbn5c0yYnnMVA32OI+ZqoU048jy2h7neXkzjFgeM1WLPc7z8ma3x/14Xt4sI5bHTNVgj3O9vBlGLI+ZqoU0PS9vhhHLY6Zqscd99oP4v0WsOLK8FrE8ZqoG0owjy2t7nOflzTJieV7eDPc4j5mqxR7neXmzi1jfHjNVA2kGkuWFiOU0U1lL0/nyZrTHBZPl2adyt5nKVJrhZHnqtAh1TGxLEyTLE3uc80xldVoEOyZ0adJkeXSPC7O8XYpYATLVEWniZHkoYoVa3k7vcUEy1U5pMmW5O2KFyVS7pEmV5Z/TAndMVKSJWt7W9ji0LIvTAnlMLKWJlqUw4Ja3YxErXKbakiZblsKIW97qzJRMpZPhshSelEylM8BlKSTa8rZrjwvxIH6GES5LoaMeEyUZLkthoi1vaxGLekyUJLYsX/S05a3OHZOpdDq2LIUbJlPpTLTlbW2PY8tSeGAylU7PlqWQscdESceWpTDglrc6CXtMLKTJlqUw4pa3OjMlU+lkuCyFJyVTbe1x8R7Ez5DYsnxHLEqm0hnhshQ66jFRknHLW52Jkqm2TgvqMVGS2LJ80dOWtzp3TKbS6diyFG645a3OFyVTbUmTLUvhgclUOj1blkLGLW91nrTlrc4Al6WQsMfEQppsWQojbnmrM1OPiZIMl6Uw0Za3tYhFyVQ6iS3Ld8SiZCqdEbe81enYshRumEylM32ALH8BfJbP09a3ElQAAAAASUVORK5CYII=";function YD(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const XD=()=>{},QD=Object.assign,ZD=Object.prototype.hasOwnProperty,im=(t,e)=>ZD.call(t,e),Or=Array.isArray,Kh=t=>u8(t)==="[object Map]",JD=t=>typeof t=="function",eP=t=>typeof t=="string",tv=t=>typeof t=="symbol",rm=t=>t!==null&&typeof t=="object",tP=Object.prototype.toString,u8=t=>tP.call(t),nP=t=>u8(t).slice(8,-1),nv=t=>eP(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,h8=(t,e)=>!Object.is(t,e),sP=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})};let Si;class iP{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Si&&(this.parent=Si,this.index=(Si.scopes||(Si.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Si;try{return Si=this,e()}finally{Si=n}}}on(){Si=this}off(){Si=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function rP(t,e=Si){e&&e.active&&e.effects.push(t)}const sv=t=>{const e=new Set(t);return e.w=0,e.n=0,e},d8=t=>(t.w&$r)>0,f8=t=>(t.n&$r)>0,oP=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=$r},aP=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const i=e[s];d8(i)&&!f8(i)?i.delete(t):e[n++]=i,i.w&=~$r,i.n&=~$r}e.length=n}},np=new WeakMap;let sc=0,$r=1;const sp=30;let ui;const jo=Symbol(""),ip=Symbol("");class iv{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,rP(this,s)}run(){if(!this.active)return this.fn();let e=ui,n=Nr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ui,ui=this,Nr=!0,$r=1<<++sc,sc<=sp?oP(this):Rb(this),this.fn()}finally{sc<=sp&&aP(this),$r=1<<--sc,ui=this.parent,Nr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ui===this?this.deferStop=!0:this.active&&(Rb(this),this.onStop&&this.onStop(),this.active=!1)}}function Rb(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Nr=!0;const m8=[];function Ml(){m8.push(Nr),Nr=!1}function xl(){const t=m8.pop();Nr=t===void 0?!0:t}function Vs(t,e,n){if(Nr&&ui){let s=np.get(t);s||np.set(t,s=new Map);let i=s.get(n);i||s.set(n,i=sv()),p8(i)}}function p8(t,e){let n=!1;sc<=sp?f8(t)||(t.n|=$r,n=!d8(t)):n=!t.has(ui),n&&(t.add(ui),ui.deps.push(t))}function or(t,e,n,s,i,r){const o=np.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&Or(t))o.forEach((l,c)=>{(c==="length"||c>=s)&&a.push(l)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":Or(t)?nv(n)&&a.push(o.get("length")):(a.push(o.get(jo)),Kh(t)&&a.push(o.get(ip)));break;case"delete":Or(t)||(a.push(o.get(jo)),Kh(t)&&a.push(o.get(ip)));break;case"set":Kh(t)&&a.push(o.get(jo));break}if(a.length===1)a[0]&&rp(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);rp(sv(l))}}function rp(t,e){const n=Or(t)?t:[...t];for(const s of n)s.computed&&Cb(s);for(const s of n)s.computed||Cb(s)}function Cb(t,e){(t!==ui||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const lP=YD("__proto__,__v_isRef,__isVue"),g8=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(tv)),cP=rv(),uP=rv(!1,!0),hP=rv(!0),Ib=dP();function dP(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=Dt(this);for(let r=0,o=this.length;r<o;r++)Vs(s,"get",r+"");const i=s[e](...n);return i===-1||i===!1?s[e](...n.map(Dt)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Ml();const s=Dt(this)[e].apply(this,n);return xl(),s}}),t}function rv(t=!1,e=!1){return function(s,i,r){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&r===(t?e?IP:w8:e?b8:y8).get(s))return s;const o=Or(s);if(!t&&o&&im(Ib,i))return Reflect.get(Ib,i,r);const a=Reflect.get(s,i,r);return(tv(i)?g8.has(i):lP(i))||(t||Vs(s,"get",i),e)?a:os(a)?o&&nv(i)?a:a.value:rm(a)?t?E8(a):lv(a):a}}const fP=_8(),mP=_8(!0);function _8(t=!1){return function(n,s,i,r){let o=n[s];if(Zc(o)&&os(o)&&!os(i))return!1;if(!t&&!Zc(i)&&(op(i)||(i=Dt(i),o=Dt(o)),!Or(n)&&os(o)&&!os(i)))return o.value=i,!0;const a=Or(n)&&nv(s)?Number(s)<n.length:im(n,s),l=Reflect.set(n,s,i,r);return n===Dt(r)&&(a?h8(i,o)&&or(n,"set",s,i):or(n,"add",s,i)),l}}function pP(t,e){const n=im(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&or(t,"delete",e,void 0),s}function gP(t,e){const n=Reflect.has(t,e);return(!tv(e)||!g8.has(e))&&Vs(t,"has",e),n}function _P(t){return Vs(t,"iterate",Or(t)?"length":jo),Reflect.ownKeys(t)}const v8={get:cP,set:fP,deleteProperty:pP,has:gP,ownKeys:_P},vP={get:hP,set(t,e){return!0},deleteProperty(t,e){return!0}},yP=QD({},v8,{get:uP,set:mP}),ov=t=>t,om=t=>Reflect.getPrototypeOf(t);function vh(t,e,n=!1,s=!1){t=t.__v_raw;const i=Dt(t),r=Dt(e);n||(e!==r&&Vs(i,"get",e),Vs(i,"get",r));const{has:o}=om(i),a=s?ov:n?hv:uv;if(o.call(i,e))return a(t.get(e));if(o.call(i,r))return a(t.get(r));t!==i&&t.get(e)}function yh(t,e=!1){const n=this.__v_raw,s=Dt(n),i=Dt(t);return e||(t!==i&&Vs(s,"has",t),Vs(s,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function bh(t,e=!1){return t=t.__v_raw,!e&&Vs(Dt(t),"iterate",jo),Reflect.get(t,"size",t)}function kb(t){t=Dt(t);const e=Dt(this);return om(e).has.call(e,t)||(e.add(t),or(e,"add",t,t)),this}function Mb(t,e){e=Dt(e);const n=Dt(this),{has:s,get:i}=om(n);let r=s.call(n,t);r||(t=Dt(t),r=s.call(n,t));const o=i.call(n,t);return n.set(t,e),r?h8(e,o)&&or(n,"set",t,e):or(n,"add",t,e),this}function xb(t){const e=Dt(this),{has:n,get:s}=om(e);let i=n.call(e,t);i||(t=Dt(t),i=n.call(e,t)),s&&s.call(e,t);const r=e.delete(t);return i&&or(e,"delete",t,void 0),r}function Ob(){const t=Dt(this),e=t.size!==0,n=t.clear();return e&&or(t,"clear",void 0,void 0),n}function wh(t,e){return function(s,i){const r=this,o=r.__v_raw,a=Dt(o),l=e?ov:t?hv:uv;return!t&&Vs(a,"iterate",jo),o.forEach((c,d)=>s.call(i,l(c),l(d),r))}}function Eh(t,e,n){return function(...s){const i=this.__v_raw,r=Dt(i),o=Kh(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=i[t](...s),d=n?ov:e?hv:uv;return!e&&Vs(r,"iterate",l?ip:jo),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[d(u[0]),d(u[1])]:d(u),done:f}},[Symbol.iterator](){return this}}}}function mr(t){return function(...e){return t==="delete"?!1:this}}function bP(){const t={get(r){return vh(this,r)},get size(){return bh(this)},has:yh,add:kb,set:Mb,delete:xb,clear:Ob,forEach:wh(!1,!1)},e={get(r){return vh(this,r,!1,!0)},get size(){return bh(this)},has:yh,add:kb,set:Mb,delete:xb,clear:Ob,forEach:wh(!1,!0)},n={get(r){return vh(this,r,!0)},get size(){return bh(this,!0)},has(r){return yh.call(this,r,!0)},add:mr("add"),set:mr("set"),delete:mr("delete"),clear:mr("clear"),forEach:wh(!0,!1)},s={get(r){return vh(this,r,!0,!0)},get size(){return bh(this,!0)},has(r){return yh.call(this,r,!0)},add:mr("add"),set:mr("set"),delete:mr("delete"),clear:mr("clear"),forEach:wh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Eh(r,!1,!1),n[r]=Eh(r,!0,!1),e[r]=Eh(r,!1,!0),s[r]=Eh(r,!0,!0)}),[t,n,e,s]}const[wP,EP,TP,SP]=bP();function av(t,e){const n=e?t?SP:TP:t?EP:wP;return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(im(n,i)&&i in s?n:s,i,r)}const AP={get:av(!1,!1)},RP={get:av(!1,!0)},CP={get:av(!0,!1)},y8=new WeakMap,b8=new WeakMap,w8=new WeakMap,IP=new WeakMap;function kP(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function MP(t){return t.__v_skip||!Object.isExtensible(t)?0:kP(nP(t))}function lv(t){return Zc(t)?t:cv(t,!1,v8,AP,y8)}function xP(t){return cv(t,!1,yP,RP,b8)}function E8(t){return cv(t,!0,vP,CP,w8)}function cv(t,e,n,s,i){if(!rm(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const o=MP(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return i.set(t,a),a}function Ha(t){return Zc(t)?Ha(t.__v_raw):!!(t&&t.__v_isReactive)}function Zc(t){return!!(t&&t.__v_isReadonly)}function op(t){return!!(t&&t.__v_isShallow)}function T8(t){return Ha(t)||Zc(t)}function Dt(t){const e=t&&t.__v_raw;return e?Dt(e):t}function S8(t){return sP(t,"__v_skip",!0),t}const uv=t=>rm(t)?lv(t):t,hv=t=>rm(t)?E8(t):t;function OP(t){Nr&&ui&&(t=Dt(t),p8(t.dep||(t.dep=sv())))}function NP(t,e){t=Dt(t),t.dep&&rp(t.dep)}function os(t){return!!(t&&t.__v_isRef===!0)}function LP(t){return os(t)?t.value:t}const DP={get:(t,e,n)=>LP(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return os(i)&&!os(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function A8(t){return Ha(t)?t:new Proxy(t,DP)}class PP{constructor(e,n,s,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new iv(e,()=>{this._dirty||(this._dirty=!0,NP(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=s}get value(){const e=Dt(this);return OP(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function FP(t,e,n=!1){let s,i;const r=JD(t);return r?(s=t,i=XD):(s=t.get,i=t.set),new PP(s,i,r||!i,n)}function BP(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}function en(t){if(At(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=ls(s)?HP(s):en(s);if(i)for(const r in i)e[r]=i[r]}return e}else{if(ls(t))return t;if(cs(t))return t}}const UP=/;(?![^(]*\))/g,jP=/:(.+)/;function HP(t){const e={};return t.split(UP).forEach(n=>{if(n){const s=n.split(jP);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function pt(t){let e="";if(ls(t))e=t;else if(At(t))for(let n=0;n<t.length;n++){const s=pt(t[n]);s&&(e+=s+" ")}else if(cs(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function qt(t){if(!t)return null;let{class:e,style:n}=t;return e&&!ls(e)&&(t.class=pt(e)),n&&(t.style=en(n)),t}const ot=t=>ls(t)?t:t==null?"":At(t)||cs(t)&&(t.toString===x8||!bt(t.toString))?JSON.stringify(t,R8,2):String(t),R8=(t,e)=>e&&e.__v_isRef?R8(t,e.value):I8(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i])=>(n[`${s} =>`]=i,n),{})}:k8(e)?{[`Set(${e.size})`]:[...e.values()]}:cs(e)&&!At(e)&&!O8(e)?String(e):e,Yt={},Va=[],er=()=>{},VP=()=>!1,qP=/^on[^a-z]/,dv=t=>qP.test(t),C8=t=>t.startsWith("onUpdate:"),qs=Object.assign,fv=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},$P=Object.prototype.hasOwnProperty,Nt=(t,e)=>$P.call(t,e),At=Array.isArray,I8=t=>mv(t)==="[object Map]",k8=t=>mv(t)==="[object Set]",bt=t=>typeof t=="function",ls=t=>typeof t=="string",cs=t=>t!==null&&typeof t=="object",M8=t=>cs(t)&&bt(t.then)&&bt(t.catch),x8=Object.prototype.toString,mv=t=>x8.call(t),O8=t=>mv(t)==="[object Object]",Gh=BP(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),am=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},zP=/-(\w)/g,Bi=am(t=>t.replace(zP,(e,n)=>n?n.toUpperCase():"")),KP=/\B([A-Z])/g,lm=am(t=>t.replace(KP,"-$1").toLowerCase()),pv=am(t=>t.charAt(0).toUpperCase()+t.slice(1)),_1=am(t=>t?`on${pv(t)}`:""),Nb=(t,e)=>!Object.is(t,e),v1=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},ap=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},GP=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Lb;const WP=()=>Lb||(Lb=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Lr(t,e,n,s){let i;try{i=s?t(...s):t()}catch(r){cm(r,e,n)}return i}function ti(t,e,n,s){if(bt(t)){const r=Lr(t,e,n,s);return r&&M8(r)&&r.catch(o=>{cm(o,e,n)}),r}const i=[];for(let r=0;r<t.length;r++)i.push(ti(t[r],e,n,s));return i}function cm(t,e,n,s=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const o=e.proxy,a=n;for(;r;){const c=r.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,o,a)===!1)return}r=r.parent}const l=e.appContext.config.errorHandler;if(l){Lr(l,null,10,[t,o,a]);return}}YP(t,n,i,s)}function YP(t,e,n,s=!0){console.error(t)}let Vd=!1,lp=!1;const Os=[];let $i=0;const bc=[];let ic=null,Ca=0;const wc=[];let Er=null,Ia=0;const N8=Promise.resolve();let gv=null,cp=null;function L8(t){const e=gv||N8;return t?e.then(this?t.bind(this):t):e}function XP(t){let e=$i+1,n=Os.length;for(;e<n;){const s=e+n>>>1;Jc(Os[s])<t?e=s+1:n=s}return e}function D8(t){(!Os.length||!Os.includes(t,Vd&&t.allowRecurse?$i+1:$i))&&t!==cp&&(t.id==null?Os.push(t):Os.splice(XP(t.id),0,t),P8())}function P8(){!Vd&&!lp&&(lp=!0,gv=N8.then(U8))}function QP(t){const e=Os.indexOf(t);e>$i&&Os.splice(e,1)}function F8(t,e,n,s){At(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),P8()}function ZP(t){F8(t,ic,bc,Ca)}function JP(t){F8(t,Er,wc,Ia)}function um(t,e=null){if(bc.length){for(cp=e,ic=[...new Set(bc)],bc.length=0,Ca=0;Ca<ic.length;Ca++)ic[Ca]();ic=null,Ca=0,cp=null,um(t,e)}}function B8(t){if(um(),wc.length){const e=[...new Set(wc)];if(wc.length=0,Er){Er.push(...e);return}for(Er=e,Er.sort((n,s)=>Jc(n)-Jc(s)),Ia=0;Ia<Er.length;Ia++)Er[Ia]();Er=null,Ia=0}}const Jc=t=>t.id==null?1/0:t.id;function U8(t){lp=!1,Vd=!0,um(t),Os.sort((e,n)=>Jc(e)-Jc(n));try{for($i=0;$i<Os.length;$i++){const e=Os[$i];e&&e.active!==!1&&Lr(e,null,14)}}finally{$i=0,Os.length=0,B8(),Vd=!1,gv=null,(Os.length||bc.length||wc.length)&&U8(t)}}function eF(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Yt;let i=n;const r=e.startsWith("update:"),o=r&&e.slice(7);if(o&&o in s){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:f}=s[d]||Yt;f&&(i=n.map(m=>m.trim())),u&&(i=n.map(GP))}let a,l=s[a=_1(e)]||s[a=_1(Bi(e))];!l&&r&&(l=s[a=_1(lm(e))]),l&&ti(l,t,6,i);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ti(c,t,6,i)}}function j8(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},a=!1;if(!bt(t)){const l=c=>{const d=j8(c,e,!0);d&&(a=!0,qs(o,d))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(s.set(t,null),null):(At(r)?r.forEach(l=>o[l]=null):qs(o,r),s.set(t,o),o)}function hm(t,e){return!t||!dv(e)?!1:(e=e.slice(2).replace(/Once$/,""),Nt(t,e[0].toLowerCase()+e.slice(1))||Nt(t,lm(e))||Nt(t,e))}let $n=null,H8=null;function qd(t){const e=$n;return $n=t,H8=t&&t.type.__scopeId||null,e}function et(t,e=$n,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&zb(-1);const r=qd(e),o=t(...i);return qd(r),s._d&&zb(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function y1(t){const{type:e,vnode:n,proxy:s,withProxy:i,props:r,propsOptions:[o],slots:a,attrs:l,emit:c,render:d,renderCache:u,data:f,setupState:m,ctx:h,inheritAttrs:M}=t;let k,L;const p=qd(t);try{if(n.shapeFlag&4){const D=i||s;k=Ci(d.call(D,D,u,r,m,f,h)),L=l}else{const D=e;k=Ci(D.length>1?D(r,{attrs:l,slots:a,emit:c}):D(r,null)),L=e.props?l:tF(l)}}catch(D){Tc.length=0,cm(D,t,1),k=He(ni)}let I=k;if(L&&M!==!1){const D=Object.keys(L),{shapeFlag:x}=I;D.length&&x&7&&(o&&D.some(C8)&&(L=nF(L,o)),I=zr(I,L))}return n.dirs&&(I=zr(I),I.dirs=I.dirs?I.dirs.concat(n.dirs):n.dirs),n.transition&&(I.transition=n.transition),k=I,qd(p),k}const tF=t=>{let e;for(const n in t)(n==="class"||n==="style"||dv(n))&&((e||(e={}))[n]=t[n]);return e},nF=(t,e)=>{const n={};for(const s in t)(!C8(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function sF(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?Db(s,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let u=0;u<d.length;u++){const f=d[u];if(o[f]!==s[f]&&!hm(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Db(s,o,c):!0:!!o;return!1}function Db(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!hm(n,r))return!0}return!1}function iF({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const rF=t=>t.__isSuspense;function oF(t,e){e&&e.pendingBranch?At(t)?e.effects.push(...t):e.effects.push(t):JP(t)}function aF(t,e){if(xn){let n=xn.provides;const s=xn.parent&&xn.parent.provides;s===n&&(n=xn.provides=Object.create(s)),n[t]=e}}function b1(t,e,n=!1){const s=xn||$n;if(s){const i=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&bt(e)?e.call(s.proxy):e}}const Pb={};function w1(t,e,n){return V8(t,e,n)}function V8(t,e,{immediate:n,deep:s,flush:i,onTrack:r,onTrigger:o}=Yt){const a=xn;let l,c=!1,d=!1;if(os(t)?(l=()=>t.value,c=op(t)):Ha(t)?(l=()=>t,s=!0):At(t)?(d=!0,c=t.some(L=>Ha(L)||op(L)),l=()=>t.map(L=>{if(os(L))return L.value;if(Ha(L))return Oo(L);if(bt(L))return Lr(L,a,2)})):bt(t)?e?l=()=>Lr(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),ti(t,a,3,[f])}:l=er,e&&s){const L=l;l=()=>Oo(L())}let u,f=L=>{u=k.onStop=()=>{Lr(L,a,4)}};if(su)return f=er,e?n&&ti(e,a,3,[l(),d?[]:void 0,f]):l(),er;let m=d?[]:Pb;const h=()=>{if(!!k.active)if(e){const L=k.run();(s||c||(d?L.some((p,I)=>Nb(p,m[I])):Nb(L,m)))&&(u&&u(),ti(e,a,3,[L,m===Pb?void 0:m,f]),m=L)}else k.run()};h.allowRecurse=!!e;let M;i==="sync"?M=h:i==="post"?M=()=>gs(h,a&&a.suspense):M=()=>ZP(h);const k=new iv(l,M);return e?n?h():m=k.run():i==="post"?gs(k.run.bind(k),a&&a.suspense):k.run(),()=>{k.stop(),a&&a.scope&&fv(a.scope.effects,k)}}function lF(t,e,n){const s=this.proxy,i=ls(t)?t.includes(".")?q8(s,t):()=>s[t]:t.bind(s,s);let r;bt(e)?r=e:(r=e.handler,n=e);const o=xn;ul(this);const a=V8(i,r.bind(s),n);return o?ul(o):Ho(),a}function q8(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}function Oo(t,e){if(!cs(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),os(t))Oo(t.value,e);else if(At(t))for(let n=0;n<t.length;n++)Oo(t[n],e);else if(k8(t)||I8(t))t.forEach(n=>{Oo(n,e)});else if(O8(t))for(const n in t)Oo(t[n],e);return t}function $8(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return W8(()=>{t.isMounted=!0}),X8(()=>{t.isUnmounting=!0}),t}const Ks=[Function,Array],cF={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ks,onEnter:Ks,onAfterEnter:Ks,onEnterCancelled:Ks,onBeforeLeave:Ks,onLeave:Ks,onAfterLeave:Ks,onLeaveCancelled:Ks,onBeforeAppear:Ks,onAppear:Ks,onAfterAppear:Ks,onAppearCancelled:Ks},setup(t,{slots:e}){const n=hT(),s=$8();let i;return()=>{const r=e.default&&_v(e.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const M of r)if(M.type!==ni){o=M;break}}const a=Dt(t),{mode:l}=a;if(s.isLeaving)return E1(o);const c=Fb(o);if(!c)return E1(o);const d=eu(c,a,s,n);tu(c,d);const u=n.subTree,f=u&&Fb(u);let m=!1;const{getTransitionKey:h}=c.type;if(h){const M=h();i===void 0?i=M:M!==i&&(i=M,m=!0)}if(f&&f.type!==ni&&(!Eo(c,f)||m)){const M=eu(f,a,s,n);if(tu(f,M),l==="out-in")return s.isLeaving=!0,M.afterLeave=()=>{s.isLeaving=!1,n.update()},E1(o);l==="in-out"&&c.type!==ni&&(M.delayLeave=(k,L,p)=>{const I=K8(s,f);I[String(f.key)]=f,k._leaveCb=()=>{L(),k._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=p})}return o}}},z8=cF;function K8(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function eu(t,e,n,s){const{appear:i,mode:r,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:f,onAfterLeave:m,onLeaveCancelled:h,onBeforeAppear:M,onAppear:k,onAfterAppear:L,onAppearCancelled:p}=e,I=String(t.key),D=K8(n,t),x=(A,T)=>{A&&ti(A,s,9,T)},B=(A,T)=>{const v=T[1];x(A,T),At(A)?A.every(w=>w.length<=1)&&v():A.length<=1&&v()},_={mode:r,persisted:o,beforeEnter(A){let T=a;if(!n.isMounted)if(i)T=M||a;else return;A._leaveCb&&A._leaveCb(!0);const v=D[I];v&&Eo(t,v)&&v.el._leaveCb&&v.el._leaveCb(),x(T,[A])},enter(A){let T=l,v=c,w=d;if(!n.isMounted)if(i)T=k||l,v=L||c,w=p||d;else return;let b=!1;const y=A._enterCb=R=>{b||(b=!0,R?x(w,[A]):x(v,[A]),_.delayedLeave&&_.delayedLeave(),A._enterCb=void 0)};T?B(T,[A,y]):y()},leave(A,T){const v=String(t.key);if(A._enterCb&&A._enterCb(!0),n.isUnmounting)return T();x(u,[A]);let w=!1;const b=A._leaveCb=y=>{w||(w=!0,T(),y?x(h,[A]):x(m,[A]),A._leaveCb=void 0,D[v]===t&&delete D[v])};D[v]=t,f?B(f,[A,b]):b()},clone(A){return eu(A,e,n,s)}};return _}function E1(t){if(dm(t))return t=zr(t),t.children=null,t}function Fb(t){return dm(t)?t.children?t.children[0]:void 0:t}function tu(t,e){t.shapeFlag&6&&t.component?tu(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function _v(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===Ct?(o.patchFlag&128&&i++,s=s.concat(_v(o.children,e,a))):(e||o.type!==ni)&&s.push(a!=null?zr(o,{key:a}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function uF(t){return bt(t)?{setup:t,name:t.name}:t}const Ec=t=>!!t.type.__asyncLoader,dm=t=>t.type.__isKeepAlive;function hF(t,e){G8(t,"a",e)}function dF(t,e){G8(t,"da",e)}function G8(t,e,n=xn){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(fm(e,s,n),n){let i=n.parent;for(;i&&i.parent;)dm(i.parent.vnode)&&fF(s,e,n,i),i=i.parent}}function fF(t,e,n,s){const i=fm(e,t,s,!0);Q8(()=>{fv(s[e],i)},n)}function fm(t,e,n=xn,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Ml(),ul(n);const a=ti(e,n,t,o);return Ho(),xl(),a});return s?i.unshift(r):i.push(r),r}}const hr=t=>(e,n=xn)=>(!su||t==="sp")&&fm(t,e,n),mF=hr("bm"),W8=hr("m"),pF=hr("bu"),Y8=hr("u"),X8=hr("bum"),Q8=hr("um"),gF=hr("sp"),_F=hr("rtg"),vF=hr("rtc");function yF(t,e=xn){fm("ec",t,e)}function ar(t,e){const n=$n;if(n===null)return t;const s=gm(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[o,a,l,c=Yt]=e[r];bt(o)&&(o={mounted:o,updated:o}),o.deep&&Oo(a),i.push({dir:o,instance:s,value:a,oldValue:void 0,arg:l,modifiers:c})}return t}function no(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(Ml(),ti(l,n,8,[t.el,a,t,e]),xl())}}const vv="components",bF="directives";function Je(t,e){return yv(vv,t,!0,e)||t}const Z8=Symbol();function wF(t){return ls(t)?yv(vv,t,!1)||t:t||Z8}function mm(t){return yv(bF,t)}function yv(t,e,n=!0,s=!1){const i=$n||xn;if(i){const r=i.type;if(t===vv){const a=WF(r,!1);if(a&&(a===e||a===Bi(e)||a===pv(Bi(e))))return r}const o=Bb(i[t]||r[t],e)||Bb(i.appContext[t],e);return!o&&s?r:o}}function Bb(t,e){return t&&(t[e]||t[Bi(e)]||t[pv(Bi(e))])}function ht(t,e,n,s){let i;const r=n&&n[s];if(At(t)||ls(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,r&&r[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,r&&r[o])}else if(cs(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,r&&r[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];i[a]=e(t[c],c,a,r&&r[a])}}else i=[];return n&&(n[s]=i),i}function $t(t,e){for(let n=0;n<e.length;n++){const s=e[n];if(At(s))for(let i=0;i<s.length;i++)t[s[i].name]=s[i].fn;else s&&(t[s.name]=s.fn)}return t}function Fe(t,e,n={},s,i){if($n.isCE||$n.parent&&Ec($n.parent)&&$n.parent.isCE)return He("slot",e==="default"?null:{name:e},s&&s());let r=t[e];r&&r._c&&(r._d=!1),re();const o=r&&J8(r(n)),a=Pt(Ct,{key:n.key||`_${e}`},o||(s?s():[]),o&&t._===1?64:-2);return!i&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function J8(t){return t.some(e=>Kd(e)?!(e.type===ni||e.type===Ct&&!J8(e.children)):!0)?t:null}const up=t=>t?dT(t)?gm(t)||t.proxy:up(t.parent):null,$d=qs(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>up(t.parent),$root:t=>up(t.root),$emit:t=>t.emit,$options:t=>tT(t),$forceUpdate:t=>t.f||(t.f=()=>D8(t.update)),$nextTick:t=>t.n||(t.n=L8.bind(t.proxy)),$watch:t=>lF.bind(t)}),EF={get({_:t},e){const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(s!==Yt&&Nt(s,e))return o[e]=1,s[e];if(i!==Yt&&Nt(i,e))return o[e]=2,i[e];if((c=t.propsOptions[0])&&Nt(c,e))return o[e]=3,r[e];if(n!==Yt&&Nt(n,e))return o[e]=4,n[e];hp&&(o[e]=0)}}const d=$d[e];let u,f;if(d)return e==="$attrs"&&Vs(t,"get",e),d(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==Yt&&Nt(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,Nt(f,e))return f[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return i!==Yt&&Nt(i,e)?(i[e]=n,!0):s!==Yt&&Nt(s,e)?(s[e]=n,!0):Nt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},o){let a;return!!n[o]||t!==Yt&&Nt(t,o)||e!==Yt&&Nt(e,o)||(a=r[0])&&Nt(a,o)||Nt(s,o)||Nt($d,o)||Nt(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Nt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let hp=!0;function TF(t){const e=tT(t),n=t.proxy,s=t.ctx;hp=!1,e.beforeCreate&&Ub(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:u,mounted:f,beforeUpdate:m,updated:h,activated:M,deactivated:k,beforeDestroy:L,beforeUnmount:p,destroyed:I,unmounted:D,render:x,renderTracked:B,renderTriggered:_,errorCaptured:A,serverPrefetch:T,expose:v,inheritAttrs:w,components:b,directives:y,filters:R}=e;if(c&&SF(c,s,null,t.appContext.config.unwrapInjectedRef),o)for(const W in o){const j=o[W];bt(j)&&(s[W]=j.bind(n))}if(i){const W=i.call(n,n);cs(W)&&(t.data=lv(W))}if(hp=!0,r)for(const W in r){const j=r[W],z=bt(j)?j.bind(n,n):bt(j.get)?j.get.bind(n,n):er,g=!bt(j)&&bt(j.set)?j.set.bind(n):er,C=XF({get:z,set:g});Object.defineProperty(s,W,{enumerable:!0,configurable:!0,get:()=>C.value,set:te=>C.value=te})}if(a)for(const W in a)eT(a[W],s,n,W);if(l){const W=bt(l)?l.call(n):l;Reflect.ownKeys(W).forEach(j=>{aF(j,W[j])})}d&&Ub(d,t,"c");function U(W,j){At(j)?j.forEach(z=>W(z.bind(n))):j&&W(j.bind(n))}if(U(mF,u),U(W8,f),U(pF,m),U(Y8,h),U(hF,M),U(dF,k),U(yF,A),U(vF,B),U(_F,_),U(X8,p),U(Q8,D),U(gF,T),At(v))if(v.length){const W=t.exposed||(t.exposed={});v.forEach(j=>{Object.defineProperty(W,j,{get:()=>n[j],set:z=>n[j]=z})})}else t.exposed||(t.exposed={});x&&t.render===er&&(t.render=x),w!=null&&(t.inheritAttrs=w),b&&(t.components=b),y&&(t.directives=y)}function SF(t,e,n=er,s=!1){At(t)&&(t=dp(t));for(const i in t){const r=t[i];let o;cs(r)?"default"in r?o=b1(r.from||i,r.default,!0):o=b1(r.from||i):o=b1(r),os(o)&&s?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function Ub(t,e,n){ti(At(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function eT(t,e,n,s){const i=s.includes(".")?q8(n,s):()=>n[s];if(ls(t)){const r=e[t];bt(r)&&w1(i,r)}else if(bt(t))w1(i,t.bind(n));else if(cs(t))if(At(t))t.forEach(r=>eT(r,e,n,s));else{const r=bt(t.handler)?t.handler.bind(n):e[t.handler];bt(r)&&w1(i,r,t)}}function tT(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!i.length&&!n&&!s?l=e:(l={},i.length&&i.forEach(c=>zd(l,c,o,!0)),zd(l,e,o)),r.set(e,l),l}function zd(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&zd(t,r,n,!0),i&&i.forEach(o=>zd(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=AF[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const AF={data:jb,props:go,emits:go,methods:go,computed:go,beforeCreate:es,created:es,beforeMount:es,mounted:es,beforeUpdate:es,updated:es,beforeDestroy:es,beforeUnmount:es,destroyed:es,unmounted:es,activated:es,deactivated:es,errorCaptured:es,serverPrefetch:es,components:go,directives:go,watch:CF,provide:jb,inject:RF};function jb(t,e){return e?t?function(){return qs(bt(t)?t.call(this,this):t,bt(e)?e.call(this,this):e)}:e:t}function RF(t,e){return go(dp(t),dp(e))}function dp(t){if(At(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function es(t,e){return t?[...new Set([].concat(t,e))]:e}function go(t,e){return t?qs(qs(Object.create(null),t),e):e}function CF(t,e){if(!t)return e;if(!e)return t;const n=qs(Object.create(null),t);for(const s in e)n[s]=es(t[s],e[s]);return n}function IF(t,e,n,s=!1){const i={},r={};ap(r,pm,1),t.propsDefaults=Object.create(null),nT(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:xP(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function kF(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,a=Dt(i),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let u=0;u<d.length;u++){let f=d[u];if(hm(t.emitsOptions,f))continue;const m=e[f];if(l)if(Nt(r,f))m!==r[f]&&(r[f]=m,c=!0);else{const h=Bi(f);i[h]=fp(l,a,h,m,t,!1)}else m!==r[f]&&(r[f]=m,c=!0)}}}else{nT(t,e,i,r)&&(c=!0);let d;for(const u in a)(!e||!Nt(e,u)&&((d=lm(u))===u||!Nt(e,d)))&&(l?n&&(n[u]!==void 0||n[d]!==void 0)&&(i[u]=fp(l,a,u,void 0,t,!0)):delete i[u]);if(r!==a)for(const u in r)(!e||!Nt(e,u)&&!0)&&(delete r[u],c=!0)}c&&or(t,"set","$attrs")}function nT(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Gh(l))continue;const c=e[l];let d;i&&Nt(i,d=Bi(l))?!r||!r.includes(d)?n[d]=c:(a||(a={}))[d]=c:hm(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Dt(n),c=a||Yt;for(let d=0;d<r.length;d++){const u=r[d];n[u]=fp(i,l,u,c[u],t,!Nt(c,u))}}return o}function fp(t,e,n,s,i,r){const o=t[n];if(o!=null){const a=Nt(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&bt(l)){const{propsDefaults:c}=i;n in c?s=c[n]:(ul(i),s=c[n]=l.call(null,e),Ho())}else s=l}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===lm(n))&&(s=!0))}return s}function sT(t,e,n=!1){const s=e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},a=[];let l=!1;if(!bt(t)){const d=u=>{l=!0;const[f,m]=sT(u,e,!0);qs(o,f),m&&a.push(...m)};!n&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!r&&!l)return s.set(t,Va),Va;if(At(r))for(let d=0;d<r.length;d++){const u=Bi(r[d]);Hb(u)&&(o[u]=Yt)}else if(r)for(const d in r){const u=Bi(d);if(Hb(u)){const f=r[d],m=o[u]=At(f)||bt(f)?{type:f}:f;if(m){const h=$b(Boolean,m.type),M=$b(String,m.type);m[0]=h>-1,m[1]=M<0||h<M,(h>-1||Nt(m,"default"))&&a.push(u)}}}const c=[o,a];return s.set(t,c),c}function Hb(t){return t[0]!=="$"}function Vb(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function qb(t,e){return Vb(t)===Vb(e)}function $b(t,e){return At(e)?e.findIndex(n=>qb(n,t)):bt(e)&&qb(e,t)?0:-1}const iT=t=>t[0]==="_"||t==="$stable",bv=t=>At(t)?t.map(Ci):[Ci(t)],MF=(t,e,n)=>{if(e._n)return e;const s=et((...i)=>bv(e(...i)),n);return s._c=!1,s},rT=(t,e,n)=>{const s=t._ctx;for(const i in t){if(iT(i))continue;const r=t[i];if(bt(r))e[i]=MF(i,r,s);else if(r!=null){const o=bv(r);e[i]=()=>o}}},oT=(t,e)=>{const n=bv(e);t.slots.default=()=>n},xF=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Dt(e),ap(e,"_",n)):rT(e,t.slots={})}else t.slots={},e&&oT(t,e);ap(t.slots,pm,1)},OF=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=Yt;if(s.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(qs(i,e),!n&&a===1&&delete i._):(r=!e.$stable,rT(e,i)),o=e}else e&&(oT(t,e),o={default:1});if(r)for(const a in i)!iT(a)&&!(a in o)&&delete i[a]};function aT(){return{app:null,config:{isNativeTag:VP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let NF=0;function LF(t,e){return function(s,i=null){bt(s)||(s=Object.assign({},s)),i!=null&&!cs(i)&&(i=null);const r=aT(),o=new Set;let a=!1;const l=r.app={_uid:NF++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:ZF,get config(){return r.config},set config(c){},use(c,...d){return o.has(c)||(c&&bt(c.install)?(o.add(c),c.install(l,...d)):bt(c)&&(o.add(c),c(l,...d))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,d){return d?(r.components[c]=d,l):r.components[c]},directive(c,d){return d?(r.directives[c]=d,l):r.directives[c]},mount(c,d,u){if(!a){const f=He(s,i);return f.appContext=r,d&&e?e(f,c):t(f,c,u),a=!0,l._container=c,c.__vue_app__=l,gm(f.component)||f.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,d){return r.provides[c]=d,l}};return l}}function mp(t,e,n,s,i=!1){if(At(t)){t.forEach((f,m)=>mp(f,e&&(At(e)?e[m]:e),n,s,i));return}if(Ec(s)&&!i)return;const r=s.shapeFlag&4?gm(s.component)||s.component.proxy:s.el,o=i?null:r,{i:a,r:l}=t,c=e&&e.r,d=a.refs===Yt?a.refs={}:a.refs,u=a.setupState;if(c!=null&&c!==l&&(ls(c)?(d[c]=null,Nt(u,c)&&(u[c]=null)):os(c)&&(c.value=null)),bt(l))Lr(l,a,12,[o,d]);else{const f=ls(l),m=os(l);if(f||m){const h=()=>{if(t.f){const M=f?d[l]:l.value;i?At(M)&&fv(M,r):At(M)?M.includes(r)||M.push(r):f?(d[l]=[r],Nt(u,l)&&(u[l]=d[l])):(l.value=[r],t.k&&(d[t.k]=l.value))}else f?(d[l]=o,Nt(u,l)&&(u[l]=o)):m&&(l.value=o,t.k&&(d[t.k]=o))};o?(h.id=-1,gs(h,n)):h()}}}const gs=oF;function DF(t){return PF(t)}function PF(t,e){const n=WP();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:f,setScopeId:m=er,cloneNode:h,insertStaticContent:M}=t,k=(E,O,V,$=null,K=null,ne=null,le=!1,Q=null,ie=!!O.dynamicChildren)=>{if(E===O)return;E&&!Eo(E,O)&&($=ze(E),se(E,K,ne,!0),E=null),O.patchFlag===-2&&(ie=!1,O.dynamicChildren=null);const{type:X,ref:ve,shapeFlag:de}=O;switch(X){case wv:L(E,O,V,$);break;case ni:p(E,O,V,$);break;case T1:E==null&&I(O,V,$,le);break;case Ct:y(E,O,V,$,K,ne,le,Q,ie);break;default:de&1?B(E,O,V,$,K,ne,le,Q,ie):de&6?R(E,O,V,$,K,ne,le,Q,ie):(de&64||de&128)&&X.process(E,O,V,$,K,ne,le,Q,ie,we)}ve!=null&&K&&mp(ve,E&&E.ref,ne,O||E,!O)},L=(E,O,V,$)=>{if(E==null)s(O.el=a(O.children),V,$);else{const K=O.el=E.el;O.children!==E.children&&c(K,O.children)}},p=(E,O,V,$)=>{E==null?s(O.el=l(O.children||""),V,$):O.el=E.el},I=(E,O,V,$)=>{[E.el,E.anchor]=M(E.children,O,V,$,E.el,E.anchor)},D=({el:E,anchor:O},V,$)=>{let K;for(;E&&E!==O;)K=f(E),s(E,V,$),E=K;s(O,V,$)},x=({el:E,anchor:O})=>{let V;for(;E&&E!==O;)V=f(E),i(E),E=V;i(O)},B=(E,O,V,$,K,ne,le,Q,ie)=>{le=le||O.type==="svg",E==null?_(O,V,$,K,ne,le,Q,ie):v(E,O,K,ne,le,Q,ie)},_=(E,O,V,$,K,ne,le,Q)=>{let ie,X;const{type:ve,props:de,shapeFlag:ye,transition:Ie,patchFlag:De,dirs:ce}=E;if(E.el&&h!==void 0&&De===-1)ie=E.el=h(E.el);else{if(ie=E.el=o(E.type,ne,de&&de.is,de),ye&8?d(ie,E.children):ye&16&&T(E.children,ie,null,$,K,ne&&ve!=="foreignObject",le,Q),ce&&no(E,null,$,"created"),de){for(const Z in de)Z!=="value"&&!Gh(Z)&&r(ie,Z,null,de[Z],ne,E.children,$,K,be);"value"in de&&r(ie,"value",null,de.value),(X=de.onVnodeBeforeMount)&&bi(X,$,E)}A(ie,E,E.scopeId,le,$)}ce&&no(E,null,$,"beforeMount");const _e=(!K||K&&!K.pendingBranch)&&Ie&&!Ie.persisted;_e&&Ie.beforeEnter(ie),s(ie,O,V),((X=de&&de.onVnodeMounted)||_e||ce)&&gs(()=>{X&&bi(X,$,E),_e&&Ie.enter(ie),ce&&no(E,null,$,"mounted")},K)},A=(E,O,V,$,K)=>{if(V&&m(E,V),$)for(let ne=0;ne<$.length;ne++)m(E,$[ne]);if(K){let ne=K.subTree;if(O===ne){const le=K.vnode;A(E,le,le.scopeId,le.slotScopeIds,K.parent)}}},T=(E,O,V,$,K,ne,le,Q,ie=0)=>{for(let X=ie;X<E.length;X++){const ve=E[X]=Q?Ar(E[X]):Ci(E[X]);k(null,ve,O,V,$,K,ne,le,Q)}},v=(E,O,V,$,K,ne,le)=>{const Q=O.el=E.el;let{patchFlag:ie,dynamicChildren:X,dirs:ve}=O;ie|=E.patchFlag&16;const de=E.props||Yt,ye=O.props||Yt;let Ie;V&&so(V,!1),(Ie=ye.onVnodeBeforeUpdate)&&bi(Ie,V,O,E),ve&&no(O,E,V,"beforeUpdate"),V&&so(V,!0);const De=K&&O.type!=="foreignObject";if(X?w(E.dynamicChildren,X,Q,V,$,De,ne):le||z(E,O,Q,null,V,$,De,ne,!1),ie>0){if(ie&16)b(Q,O,de,ye,V,$,K);else if(ie&2&&de.class!==ye.class&&r(Q,"class",null,ye.class,K),ie&4&&r(Q,"style",de.style,ye.style,K),ie&8){const ce=O.dynamicProps;for(let _e=0;_e<ce.length;_e++){const Z=ce[_e],Me=de[Z],N=ye[Z];(N!==Me||Z==="value")&&r(Q,Z,Me,N,K,E.children,V,$,be)}}ie&1&&E.children!==O.children&&d(Q,O.children)}else!le&&X==null&&b(Q,O,de,ye,V,$,K);((Ie=ye.onVnodeUpdated)||ve)&&gs(()=>{Ie&&bi(Ie,V,O,E),ve&&no(O,E,V,"updated")},$)},w=(E,O,V,$,K,ne,le)=>{for(let Q=0;Q<O.length;Q++){const ie=E[Q],X=O[Q],ve=ie.el&&(ie.type===Ct||!Eo(ie,X)||ie.shapeFlag&70)?u(ie.el):V;k(ie,X,ve,null,$,K,ne,le,!0)}},b=(E,O,V,$,K,ne,le)=>{if(V!==$){for(const Q in $){if(Gh(Q))continue;const ie=$[Q],X=V[Q];ie!==X&&Q!=="value"&&r(E,Q,X,ie,le,O.children,K,ne,be)}if(V!==Yt)for(const Q in V)!Gh(Q)&&!(Q in $)&&r(E,Q,V[Q],null,le,O.children,K,ne,be);"value"in $&&r(E,"value",V.value,$.value)}},y=(E,O,V,$,K,ne,le,Q,ie)=>{const X=O.el=E?E.el:a(""),ve=O.anchor=E?E.anchor:a("");let{patchFlag:de,dynamicChildren:ye,slotScopeIds:Ie}=O;Ie&&(Q=Q?Q.concat(Ie):Ie),E==null?(s(X,V,$),s(ve,V,$),T(O.children,V,ve,K,ne,le,Q,ie)):de>0&&de&64&&ye&&E.dynamicChildren?(w(E.dynamicChildren,ye,V,K,ne,le,Q),(O.key!=null||K&&O===K.subTree)&&lT(E,O,!0)):z(E,O,V,ve,K,ne,le,Q,ie)},R=(E,O,V,$,K,ne,le,Q,ie)=>{O.slotScopeIds=Q,E==null?O.shapeFlag&512?K.ctx.activate(O,V,$,le,ie):S(O,V,$,K,ne,le,ie):U(E,O,ie)},S=(E,O,V,$,K,ne,le)=>{const Q=E.component=qF(E,$,K);if(dm(E)&&(Q.ctx.renderer=we),$F(Q),Q.asyncDep){if(K&&K.registerDep(Q,W),!E.el){const ie=Q.subTree=He(ni);p(null,ie,O,V)}return}W(Q,E,O,V,K,ne,le)},U=(E,O,V)=>{const $=O.component=E.component;if(sF(E,O,V))if($.asyncDep&&!$.asyncResolved){j($,O,V);return}else $.next=O,QP($.update),$.update();else O.el=E.el,$.vnode=O},W=(E,O,V,$,K,ne,le)=>{const Q=()=>{if(E.isMounted){let{next:ve,bu:de,u:ye,parent:Ie,vnode:De}=E,ce=ve,_e;so(E,!1),ve?(ve.el=De.el,j(E,ve,le)):ve=De,de&&v1(de),(_e=ve.props&&ve.props.onVnodeBeforeUpdate)&&bi(_e,Ie,ve,De),so(E,!0);const Z=y1(E),Me=E.subTree;E.subTree=Z,k(Me,Z,u(Me.el),ze(Me),E,K,ne),ve.el=Z.el,ce===null&&iF(E,Z.el),ye&&gs(ye,K),(_e=ve.props&&ve.props.onVnodeUpdated)&&gs(()=>bi(_e,Ie,ve,De),K)}else{let ve;const{el:de,props:ye}=O,{bm:Ie,m:De,parent:ce}=E,_e=Ec(O);if(so(E,!1),Ie&&v1(Ie),!_e&&(ve=ye&&ye.onVnodeBeforeMount)&&bi(ve,ce,O),so(E,!0),de&&mt){const Z=()=>{E.subTree=y1(E),mt(de,E.subTree,E,K,null)};_e?O.type.__asyncLoader().then(()=>!E.isUnmounted&&Z()):Z()}else{const Z=E.subTree=y1(E);k(null,Z,V,$,E,K,ne),O.el=Z.el}if(De&&gs(De,K),!_e&&(ve=ye&&ye.onVnodeMounted)){const Z=O;gs(()=>bi(ve,ce,Z),K)}(O.shapeFlag&256||ce&&Ec(ce.vnode)&&ce.vnode.shapeFlag&256)&&E.a&&gs(E.a,K),E.isMounted=!0,O=V=$=null}},ie=E.effect=new iv(Q,()=>D8(X),E.scope),X=E.update=()=>ie.run();X.id=E.uid,so(E,!0),X()},j=(E,O,V)=>{O.component=E;const $=E.vnode.props;E.vnode=O,E.next=null,kF(E,O.props,$,V),OF(E,O.children,V),Ml(),um(void 0,E.update),xl()},z=(E,O,V,$,K,ne,le,Q,ie=!1)=>{const X=E&&E.children,ve=E?E.shapeFlag:0,de=O.children,{patchFlag:ye,shapeFlag:Ie}=O;if(ye>0){if(ye&128){C(X,de,V,$,K,ne,le,Q,ie);return}else if(ye&256){g(X,de,V,$,K,ne,le,Q,ie);return}}Ie&8?(ve&16&&be(X,K,ne),de!==X&&d(V,de)):ve&16?Ie&16?C(X,de,V,$,K,ne,le,Q,ie):be(X,K,ne,!0):(ve&8&&d(V,""),Ie&16&&T(de,V,$,K,ne,le,Q,ie))},g=(E,O,V,$,K,ne,le,Q,ie)=>{E=E||Va,O=O||Va;const X=E.length,ve=O.length,de=Math.min(X,ve);let ye;for(ye=0;ye<de;ye++){const Ie=O[ye]=ie?Ar(O[ye]):Ci(O[ye]);k(E[ye],Ie,V,null,K,ne,le,Q,ie)}X>ve?be(E,K,ne,!0,!1,de):T(O,V,$,K,ne,le,Q,ie,de)},C=(E,O,V,$,K,ne,le,Q,ie)=>{let X=0;const ve=O.length;let de=E.length-1,ye=ve-1;for(;X<=de&&X<=ye;){const Ie=E[X],De=O[X]=ie?Ar(O[X]):Ci(O[X]);if(Eo(Ie,De))k(Ie,De,V,null,K,ne,le,Q,ie);else break;X++}for(;X<=de&&X<=ye;){const Ie=E[de],De=O[ye]=ie?Ar(O[ye]):Ci(O[ye]);if(Eo(Ie,De))k(Ie,De,V,null,K,ne,le,Q,ie);else break;de--,ye--}if(X>de){if(X<=ye){const Ie=ye+1,De=Ie<ve?O[Ie].el:$;for(;X<=ye;)k(null,O[X]=ie?Ar(O[X]):Ci(O[X]),V,De,K,ne,le,Q,ie),X++}}else if(X>ye)for(;X<=de;)se(E[X],K,ne,!0),X++;else{const Ie=X,De=X,ce=new Map;for(X=De;X<=ye;X++){const Y=O[X]=ie?Ar(O[X]):Ci(O[X]);Y.key!=null&&ce.set(Y.key,X)}let _e,Z=0;const Me=ye-De+1;let N=!1,F=0;const q=new Array(Me);for(X=0;X<Me;X++)q[X]=0;for(X=Ie;X<=de;X++){const Y=E[X];if(Z>=Me){se(Y,K,ne,!0);continue}let H;if(Y.key!=null)H=ce.get(Y.key);else for(_e=De;_e<=ye;_e++)if(q[_e-De]===0&&Eo(Y,O[_e])){H=_e;break}H===void 0?se(Y,K,ne,!0):(q[H-De]=X+1,H>=F?F=H:N=!0,k(Y,O[H],V,null,K,ne,le,Q,ie),Z++)}const G=N?FF(q):Va;for(_e=G.length-1,X=Me-1;X>=0;X--){const Y=De+X,H=O[Y],ee=Y+1<ve?O[Y+1].el:$;q[X]===0?k(null,H,V,ee,K,ne,le,Q,ie):N&&(_e<0||X!==G[_e]?te(H,V,ee,2):_e--)}}},te=(E,O,V,$,K=null)=>{const{el:ne,type:le,transition:Q,children:ie,shapeFlag:X}=E;if(X&6){te(E.component.subTree,O,V,$);return}if(X&128){E.suspense.move(O,V,$);return}if(X&64){le.move(E,O,V,we);return}if(le===Ct){s(ne,O,V);for(let de=0;de<ie.length;de++)te(ie[de],O,V,$);s(E.anchor,O,V);return}if(le===T1){D(E,O,V);return}if($!==2&&X&1&&Q)if($===0)Q.beforeEnter(ne),s(ne,O,V),gs(()=>Q.enter(ne),K);else{const{leave:de,delayLeave:ye,afterLeave:Ie}=Q,De=()=>s(ne,O,V),ce=()=>{de(ne,()=>{De(),Ie&&Ie()})};ye?ye(ne,De,ce):ce()}else s(ne,O,V)},se=(E,O,V,$=!1,K=!1)=>{const{type:ne,props:le,ref:Q,children:ie,dynamicChildren:X,shapeFlag:ve,patchFlag:de,dirs:ye}=E;if(Q!=null&&mp(Q,null,V,E,!0),ve&256){O.ctx.deactivate(E);return}const Ie=ve&1&&ye,De=!Ec(E);let ce;if(De&&(ce=le&&le.onVnodeBeforeUnmount)&&bi(ce,O,E),ve&6)Oe(E.component,V,$);else{if(ve&128){E.suspense.unmount(V,$);return}Ie&&no(E,null,O,"beforeUnmount"),ve&64?E.type.remove(E,O,V,K,we,$):X&&(ne!==Ct||de>0&&de&64)?be(X,O,V,!1,!0):(ne===Ct&&de&384||!K&&ve&16)&&be(ie,O,V),$&&Te(E)}(De&&(ce=le&&le.onVnodeUnmounted)||Ie)&&gs(()=>{ce&&bi(ce,O,E),Ie&&no(E,null,O,"unmounted")},V)},Te=E=>{const{type:O,el:V,anchor:$,transition:K}=E;if(O===Ct){ke(V,$);return}if(O===T1){x(E);return}const ne=()=>{i(V),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(E.shapeFlag&1&&K&&!K.persisted){const{leave:le,delayLeave:Q}=K,ie=()=>le(V,ne);Q?Q(E.el,ne,ie):ie()}else ne()},ke=(E,O)=>{let V;for(;E!==O;)V=f(E),i(E),E=V;i(O)},Oe=(E,O,V)=>{const{bum:$,scope:K,update:ne,subTree:le,um:Q}=E;$&&v1($),K.stop(),ne&&(ne.active=!1,se(le,E,O,V)),Q&&gs(Q,O),gs(()=>{E.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},be=(E,O,V,$=!1,K=!1,ne=0)=>{for(let le=ne;le<E.length;le++)se(E[le],O,V,$,K)},ze=E=>E.shapeFlag&6?ze(E.component.subTree):E.shapeFlag&128?E.suspense.next():f(E.anchor||E.el),Be=(E,O,V)=>{E==null?O._vnode&&se(O._vnode,null,null,!0):k(O._vnode||null,E,O,null,null,null,V),B8(),O._vnode=E},we={p:k,um:se,m:te,r:Te,mt:S,mc:T,pc:z,pbc:w,n:ze,o:t};let Xe,mt;return e&&([Xe,mt]=e(we)),{render:Be,hydrate:Xe,createApp:LF(Be,Xe)}}function so({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function lT(t,e,n=!1){const s=t.children,i=e.children;if(At(s)&&At(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Ar(i[r]),a.el=o.el),n||lT(o,a))}}function FF(t){const e=t.slice(),n=[0];let s,i,r,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(i=n[n.length-1],t[i]<c){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}const BF=t=>t.__isTeleport,Ct=Symbol(void 0),wv=Symbol(void 0),ni=Symbol(void 0),T1=Symbol(void 0),Tc=[];let fi=null;function re(t=!1){Tc.push(fi=t?null:[])}function UF(){Tc.pop(),fi=Tc[Tc.length-1]||null}let nu=1;function zb(t){nu+=t}function cT(t){return t.dynamicChildren=nu>0?fi||Va:null,UF(),nu>0&&fi&&fi.push(t),t}function ge(t,e,n,s,i,r){return cT(Ce(t,e,n,s,i,r,!0))}function Pt(t,e,n,s,i){return cT(He(t,e,n,s,i,!0))}function Kd(t){return t?t.__v_isVNode===!0:!1}function Eo(t,e){return t.type===e.type&&t.key===e.key}const pm="__vInternal",uT=({key:t})=>t!=null?t:null,Wh=({ref:t,ref_key:e,ref_for:n})=>t!=null?ls(t)||os(t)||bt(t)?{i:$n,r:t,k:e,f:!!n}:t:null;function Ce(t,e=null,n=null,s=0,i=null,r=t===Ct?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&uT(e),ref:e&&Wh(e),scopeId:H8,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null};return a?(Ev(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=ls(n)?8:16),nu>0&&!o&&fi&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&fi.push(l),l}const He=jF;function jF(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===Z8)&&(t=ni),Kd(t)){const a=zr(t,e,!0);return n&&Ev(a,n),nu>0&&!r&&fi&&(a.shapeFlag&6?fi[fi.indexOf(t)]=a:fi.push(a)),a.patchFlag|=-2,a}if(YF(t)&&(t=t.__vccOpts),e){e=Bt(e);let{class:a,style:l}=e;a&&!ls(a)&&(e.class=pt(a)),cs(l)&&(T8(l)&&!At(l)&&(l=qs({},l)),e.style=en(l))}const o=ls(t)?1:rF(t)?128:BF(t)?64:cs(t)?4:bt(t)?2:0;return Ce(t,e,n,s,i,o,r,!0)}function Bt(t){return t?T8(t)||pm in t?qs({},t):t:null}function zr(t,e,n=!1){const{props:s,ref:i,patchFlag:r,children:o}=t,a=e?Tv(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&uT(a),ref:e&&e.ref?n&&i?At(i)?i.concat(Wh(e)):[i,Wh(e)]:Wh(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ct?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&zr(t.ssContent),ssFallback:t.ssFallback&&zr(t.ssFallback),el:t.el,anchor:t.anchor}}function Xr(t=" ",e=0){return He(wv,null,t,e)}function Le(t="",e=!1){return e?(re(),Pt(ni,null,t)):He(ni,null,t)}function Ci(t){return t==null||typeof t=="boolean"?He(ni):At(t)?He(Ct,null,t.slice()):typeof t=="object"?Ar(t):He(wv,null,String(t))}function Ar(t){return t.el===null||t.memo?t:zr(t)}function Ev(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(At(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Ev(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(pm in e)?e._ctx=$n:i===3&&$n&&($n.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else bt(e)?(e={default:e,_ctx:$n},n=32):(e=String(e),s&64?(n=16,e=[Xr(e)]):n=8);t.children=e,t.shapeFlag|=n}function Tv(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=pt([e.class,s.class]));else if(i==="style")e.style=en([e.style,s.style]);else if(dv(i)){const r=e[i],o=s[i];o&&r!==o&&!(At(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function bi(t,e,n,s=null){ti(t,e,7,[n,s])}const HF=aT();let VF=0;function qF(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||HF,r={uid:VF++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new iP(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sT(s,i),emitsOptions:j8(s,i),emit:null,emitted:null,propsDefaults:Yt,inheritAttrs:s.inheritAttrs,ctx:Yt,data:Yt,props:Yt,attrs:Yt,slots:Yt,refs:Yt,setupState:Yt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=eF.bind(null,r),t.ce&&t.ce(r),r}let xn=null;const hT=()=>xn||$n,ul=t=>{xn=t,t.scope.on()},Ho=()=>{xn&&xn.scope.off(),xn=null};function dT(t){return t.vnode.shapeFlag&4}let su=!1;function $F(t,e=!1){su=e;const{props:n,children:s}=t.vnode,i=dT(t);IF(t,n,i,e),xF(t,s);const r=i?zF(t,e):void 0;return su=!1,r}function zF(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=S8(new Proxy(t.ctx,EF));const{setup:s}=n;if(s){const i=t.setupContext=s.length>1?GF(t):null;ul(t),Ml();const r=Lr(s,t,0,[t.props,i]);if(xl(),Ho(),M8(r)){if(r.then(Ho,Ho),e)return r.then(o=>{Kb(t,o,e)}).catch(o=>{cm(o,t,0)});t.asyncDep=r}else Kb(t,r,e)}else fT(t,e)}function Kb(t,e,n){bt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:cs(e)&&(t.setupState=A8(e)),fT(t,n)}let Gb;function fT(t,e,n){const s=t.type;if(!t.render){if(!e&&Gb&&!s.render){const i=s.template;if(i){const{isCustomElement:r,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=s,c=qs(qs({isCustomElement:r,delimiters:a},o),l);s.render=Gb(i,c)}}t.render=s.render||er}ul(t),Ml(),TF(t),xl(),Ho()}function KF(t){return new Proxy(t.attrs,{get(e,n){return Vs(t,"get","$attrs"),e[n]}})}function GF(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=KF(t))},slots:t.slots,emit:t.emit,expose:e}}function gm(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(A8(S8(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in $d)return $d[n](t)}}))}function WF(t,e=!0){return bt(t)?t.displayName||t.name:t.name||e&&t.__name}function YF(t){return bt(t)&&"__vccOpts"in t}const XF=(t,e)=>FP(t,e,su);function QF(t,e,n){const s=arguments.length;return s===2?cs(e)&&!At(e)?Kd(e)?He(t,null,[e]):He(t,e):He(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Kd(n)&&(n=[n]),He(t,e,n))}const ZF="3.2.37";function JF(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const eB="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tB=JF(eB);function mT(t){return!!t||t===""}const nB=/^on[^a-z]/,sB=t=>nB.test(t),iB=t=>t.startsWith("onUpdate:"),ju=Object.assign,Hu=Array.isArray,rB=t=>typeof t=="function",pp=t=>typeof t=="string",oB=t=>t!==null&&typeof t=="object",Sv=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},aB=/-(\w)/g,Wb=Sv(t=>t.replace(aB,(e,n)=>n?n.toUpperCase():"")),lB=/\B([A-Z])/g,qa=Sv(t=>t.replace(lB,"-$1").toLowerCase()),cB=Sv(t=>t.charAt(0).toUpperCase()+t.slice(1)),gp=t=>{const e=parseFloat(t);return isNaN(e)?t:e},uB="http://www.w3.org/2000/svg",To=typeof document!="undefined"?document:null,Yb=To&&To.createElement("template"),hB={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e?To.createElementNS(uB,t):To.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>To.createTextNode(t),createComment:t=>To.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>To.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{Yb.innerHTML=s?`<svg>${t}</svg>`:t;const a=Yb.content;if(s){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function dB(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function fB(t,e,n){const s=t.style,i=pp(n);if(n&&!i){for(const r in n)_p(s,r,n[r]);if(e&&!pp(e))for(const r in e)n[r]==null&&_p(s,r,"")}else{const r=s.display;i?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=r)}}const Xb=/\s*!important$/;function _p(t,e,n){if(Hu(n))n.forEach(s=>_p(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=mB(t,e);Xb.test(n)?t.setProperty(qa(s),n.replace(Xb,""),"important"):t[s]=n}}const Qb=["Webkit","Moz","ms"],S1={};function mB(t,e){const n=S1[e];if(n)return n;let s=Bi(e);if(s!=="filter"&&s in t)return S1[e]=s;s=cB(s);for(let i=0;i<Qb.length;i++){const r=Qb[i]+s;if(r in t)return S1[e]=r}return e}const Zb="http://www.w3.org/1999/xlink";function pB(t,e,n,s,i){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Zb,e.slice(6,e.length)):t.setAttributeNS(Zb,e,n);else{const r=tB(e);n==null||r&&!mT(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function gB(t,e,n,s,i,r,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,i,r),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n==null?"":n;(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=mT(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[pT,_B]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let vp=0;const vB=Promise.resolve(),yB=()=>{vp=0},bB=()=>vp||(vB.then(yB),vp=pT());function wB(t,e,n,s){t.addEventListener(e,n,s)}function EB(t,e,n,s){t.removeEventListener(e,n,s)}function TB(t,e,n,s,i=null){const r=t._vei||(t._vei={}),o=r[e];if(s&&o)o.value=s;else{const[a,l]=SB(e);if(s){const c=r[e]=AB(s,i);wB(t,a,c,l)}else o&&(EB(t,a,o,l),r[e]=void 0)}}const Jb=/(?:Once|Passive|Capture)$/;function SB(t){let e;if(Jb.test(t)){e={};let n;for(;n=t.match(Jb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[qa(t.slice(2)),e]}function AB(t,e){const n=s=>{const i=s.timeStamp||pT();(_B||i>=n.attached-1)&&ti(RB(s,n.value),e,5,[s])};return n.value=t,n.attached=bB(),n}function RB(t,e){if(Hu(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const e3=/^on[a-z]/,CB=(t,e,n,s,i=!1,r,o,a,l)=>{e==="class"?dB(t,s,i):e==="style"?fB(t,n,s):sB(e)?iB(e)||TB(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):IB(t,e,s,i))?gB(t,e,s,r,o,a,l):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),pB(t,e,s,i))};function IB(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&e3.test(e)&&rB(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||e3.test(e)&&pp(n)?!1:e in t}function kB(t,e){const n=uF(t);class s extends Av{constructor(r){super(n,r,e)}}return s.def=n,s}const MB=typeof HTMLElement!="undefined"?HTMLElement:class{};class Av extends MB{constructor(e,n={},s){super(),this._def=e,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,L8(()=>{this._connected||(a3(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);new MutationObserver(s=>{for(const i of s)this._setAttr(i.attributeName)}).observe(this,{attributes:!0});const e=s=>{const{props:i,styles:r}=s,o=!Hu(i),a=i?o?Object.keys(i):i:[];let l;if(o)for(const c in this._props){const d=i[c];(d===Number||d&&d.type===Number)&&(this._props[c]=gp(this._props[c]),(l||(l=Object.create(null)))[c]=!0)}this._numberProps=l;for(const c of Object.keys(this))c[0]!=="_"&&this._setProp(c,this[c],!0,!1);for(const c of a.map(Wb))Object.defineProperty(this,c,{get(){return this._getProp(c)},set(d){this._setProp(c,d)}});this._applyStyles(r),this._update()},n=this._def.__asyncLoader;n?n().then(e):e(this._def)}_setAttr(e){let n=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(n=gp(n)),this._setProp(Wb(e),n,!1)}_getProp(e){return this._props[e]}_setProp(e,n,s=!0,i=!0){n!==this._props[e]&&(this._props[e]=n,i&&this._instance&&this._update(),s&&(n===!0?this.setAttribute(qa(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(qa(e),n+""):n||this.removeAttribute(qa(e))))}_update(){a3(this._createVNode(),this.shadowRoot)}_createVNode(){const e=He(this._def,ju({},this._props));return this._instance||(e.ce=n=>{this._instance=n,n.isCE=!0,n.emit=(i,...r)=>{this.dispatchEvent(new CustomEvent(i,{detail:r}))};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof Av){n.parent=s._instance;break}}),e}_applyStyles(e){e&&e.forEach(n=>{const s=document.createElement("style");s.textContent=n,this.shadowRoot.appendChild(s)})}}const pr="transition",$l="animation",gn=(t,{slots:e})=>QF(z8,_T(t),e);gn.displayName="Transition";const gT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},xB=gn.props=ju({},z8.props,gT),io=(t,e=[])=>{Hu(t)?t.forEach(n=>n(...e)):t&&t(...e)},t3=t=>t?Hu(t)?t.some(e=>e.length>1):t.length>1:!1;function _T(t){const e={};for(const b in t)b in gT||(e[b]=t[b]);if(t.css===!1)return e;const{name:n="v",type:s,duration:i,enterFromClass:r=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:c=o,appearToClass:d=a,leaveFromClass:u=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=t,h=OB(i),M=h&&h[0],k=h&&h[1],{onBeforeEnter:L,onEnter:p,onEnterCancelled:I,onLeave:D,onLeaveCancelled:x,onBeforeAppear:B=L,onAppear:_=p,onAppearCancelled:A=I}=e,T=(b,y,R)=>{Tr(b,y?d:a),Tr(b,y?c:o),R&&R()},v=(b,y)=>{b._isLeaving=!1,Tr(b,u),Tr(b,m),Tr(b,f),y&&y()},w=b=>(y,R)=>{const S=b?_:p,U=()=>T(y,b,R);io(S,[y,U]),n3(()=>{Tr(y,b?l:r),Hi(y,b?d:a),t3(S)||s3(y,s,M,U)})};return ju(e,{onBeforeEnter(b){io(L,[b]),Hi(b,r),Hi(b,o)},onBeforeAppear(b){io(B,[b]),Hi(b,l),Hi(b,c)},onEnter:w(!1),onAppear:w(!0),onLeave(b,y){b._isLeaving=!0;const R=()=>v(b,y);Hi(b,u),yT(),Hi(b,f),n3(()=>{!b._isLeaving||(Tr(b,u),Hi(b,m),t3(D)||s3(b,s,k,R))}),io(D,[b,R])},onEnterCancelled(b){T(b,!1),io(I,[b])},onAppearCancelled(b){T(b,!0),io(A,[b])},onLeaveCancelled(b){v(b),io(x,[b])}})}function OB(t){if(t==null)return null;if(oB(t))return[A1(t.enter),A1(t.leave)];{const e=A1(t);return[e,e]}}function A1(t){return gp(t)}function Hi(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function Tr(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function n3(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let NB=0;function s3(t,e,n,s){const i=t._endId=++NB,r=()=>{i===t._endId&&s()};if(n)return setTimeout(r,n);const{type:o,timeout:a,propCount:l}=vT(t,e);if(!o)return s();const c=o+"end";let d=0;const u=()=>{t.removeEventListener(c,f),r()},f=m=>{m.target===t&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},a+1),t.addEventListener(c,f)}function vT(t,e){const n=window.getComputedStyle(t),s=h=>(n[h]||"").split(", "),i=s(pr+"Delay"),r=s(pr+"Duration"),o=i3(i,r),a=s($l+"Delay"),l=s($l+"Duration"),c=i3(a,l);let d=null,u=0,f=0;e===pr?o>0&&(d=pr,u=o,f=r.length):e===$l?c>0&&(d=$l,u=c,f=l.length):(u=Math.max(o,c),d=u>0?o>c?pr:$l:null,f=d?d===pr?r.length:l.length:0);const m=d===pr&&/\b(transform|all)(,|$)/.test(n[pr+"Property"]);return{type:d,timeout:u,propCount:f,hasTransform:m}}function i3(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>r3(n)+r3(t[s])))}function r3(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function yT(){return document.body.offsetHeight}const bT=new WeakMap,wT=new WeakMap,LB={name:"TransitionGroup",props:ju({},xB,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=hT(),s=$8();let i,r;return Y8(()=>{if(!i.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!BB(i[0].el,n.vnode.el,o))return;i.forEach(DB),i.forEach(PB);const a=i.filter(FB);yT(),a.forEach(l=>{const c=l.el,d=c.style;Hi(c,o),d.transform=d.webkitTransform=d.transitionDuration="";const u=c._moveCb=f=>{f&&f.target!==c||(!f||/transform$/.test(f.propertyName))&&(c.removeEventListener("transitionend",u),c._moveCb=null,Tr(c,o))};c.addEventListener("transitionend",u)})}),()=>{const o=Dt(t),a=_T(o);let l=o.tag||Ct;i=r,r=e.default?_v(e.default()):[];for(let c=0;c<r.length;c++){const d=r[c];d.key!=null&&tu(d,eu(d,a,s,n))}if(i)for(let c=0;c<i.length;c++){const d=i[c];tu(d,eu(d,a,s,n)),bT.set(d,d.el.getBoundingClientRect())}return He(l,null,r)}}},Rv=LB;function DB(t){const e=t.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function PB(t){wT.set(t,t.el.getBoundingClientRect())}function FB(t){const e=bT.get(t),n=wT.get(t),s=e.left-n.left,i=e.top-n.top;if(s||i){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${i}px)`,r.transitionDuration="0s",t}}function BB(t,e,n){const s=t.cloneNode();t._vtc&&t._vtc.forEach(o=>{o.split(/\s+/).forEach(a=>a&&s.classList.remove(a))}),n.split(/\s+/).forEach(o=>o&&s.classList.add(o)),s.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(s);const{hasTransform:r}=vT(s);return i.removeChild(s),r}const UB=["ctrl","shift","alt","meta"],jB={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>UB.some(n=>t[`${n}Key`]&&!e.includes(n))},xi=(t,e)=>(n,...s)=>{for(let i=0;i<e.length;i++){const r=jB[e[i]];if(r&&r(n,e))return}return t(n,...s)},HB={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},_o=(t,e)=>n=>{if(!("key"in n))return;const s=qa(n.key);if(e.some(i=>i===s||HB[i]===s))return t(n)},_m={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):zl(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),zl(t,!0),s.enter(t)):s.leave(t,()=>{zl(t,!1)}):zl(t,e))},beforeUnmount(t,{value:e}){zl(t,e)}};function zl(t,e){t.style.display=e?t._vod:"none"}const VB=ju({patchProp:CB},hB);let o3;function qB(){return o3||(o3=DF(VB))}const a3=(...t)=>{qB().render(...t)};var Xt=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n};const $B={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},zB=Ce("div",{id:"vac-circle"},null,-1),KB=Ce("div",{id:"vac-circle"},null,-1),GB=Ce("div",{id:"vac-circle"},null,-1),WB=Ce("div",{id:"vac-circle"},null,-1),YB=Ce("div",{id:"vac-circle"},null,-1),XB=Ce("div",{id:"vac-circle"},null,-1);function QB(t,e,n,s,i,r){return re(),Pt(gn,{name:"vac-fade-spinner",appear:""},{default:et(()=>[n.show?(re(),ge("div",{key:0,class:pt(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},[n.type==="rooms"?Fe(t.$slots,"spinner-icon-rooms",{key:0},()=>[zB]):Le("",!0),n.type==="infinite-rooms"?Fe(t.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[KB]):Le("",!0),n.type==="message-file"?Fe(t.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},()=>[GB]):Le("",!0),n.type==="room-file"?Fe(t.$slots,"spinner-icon-room-file",{key:3},()=>[WB]):Le("",!0),n.type==="messages"?Fe(t.$slots,"spinner-icon-messages",{key:4},()=>[YB]):Le("",!0),n.type==="infinite-messages"?Fe(t.$slots,"spinner-icon-infinite-messages",{key:5},()=>[XB]):Le("",!0)],2)):Le("",!0)]),_:3})}var vm=Xt($B,[["render",QB]]);const ZB={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const t=this.param?"-"+this.param:"";return`vac-icon-${this.name}${t}`},size(){const t=this.svgItem[this.name];return t.size==="large"?512:t.size==="medium"?48:24}}},JB=["viewBox"],eU=["id","d"],tU=["id","d"];function nU(t,e,n,s,i,r){return re(),ge("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${r.size} ${r.size}`},[Ce("path",{id:r.svgId,d:i.svgItem[n.name].path},null,8,eU),i.svgItem[n.name].path2?(re(),ge("path",{key:0,id:r.svgId,d:i.svgItem[n.name].path2},null,8,tU)):Le("",!0)],8,JB)}var Un=Xt(ZB,[["render",nU]]);const sU={name:"RoomsSearch",components:{SvgIcon:Un},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},iU={key:0,class:"vac-icon-search"},rU=["placeholder"];function oU(t,e,n,s,i,r){const o=Je("svg-icon");return re(),ge("div",{class:pt({"vac-box-search":r.showSearchBar,"vac-box-empty":!r.showSearchBar})},[n.showSearch?(re(),ge(Ct,{key:0},[!n.loadingRooms&&n.rooms.length?(re(),ge("div",iU,[Fe(t.$slots,"search-icon",{},()=>[He(o,{name:"search"})])])):Le("",!0),!n.loadingRooms&&n.rooms.length?(re(),ge("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:e[0]||(e[0]=a=>t.$emit("search-room",a))},null,40,rU)):Le("",!0)],64)):Le("",!0),n.showAddRoom?(re(),ge("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:e[1]||(e[1]=a=>t.$emit("add-room"))},[Fe(t.$slots,"add-icon",{},()=>[He(o,{name:"add"})])])):Le("",!0)],2)}var aU=Xt(sU,[["render",oU]]),Hn={},Ol={};Ol.__esModule=!0;Ol.inherits=lU;function lU(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=Object.create(t.prototype);for(var i in n)s[i]=n[i];return s.constructor=e,e.prototype=s,e}var Vu={};Vu.__esModule=!0;var cU=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks={defaultProtocol:"http",events:null,format:l3,formatHref:l3,nl2br:!1,tagName:"a",target:hU,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};Vu.defaults=ks;Vu.Options=ET;Vu.contains=uU;function ET(t){t=t||{},this.defaultProtocol=t.hasOwnProperty("defaultProtocol")?t.defaultProtocol:ks.defaultProtocol,this.events=t.hasOwnProperty("events")?t.events:ks.events,this.format=t.hasOwnProperty("format")?t.format:ks.format,this.formatHref=t.hasOwnProperty("formatHref")?t.formatHref:ks.formatHref,this.nl2br=t.hasOwnProperty("nl2br")?t.nl2br:ks.nl2br,this.tagName=t.hasOwnProperty("tagName")?t.tagName:ks.tagName,this.target=t.hasOwnProperty("target")?t.target:ks.target,this.validate=t.hasOwnProperty("validate")?t.validate:ks.validate,this.ignoreTags=[],this.attributes=t.attributes||t.linkAttributes||ks.attributes,this.className=t.hasOwnProperty("className")?t.className:t.linkClass||ks.className;for(var e=t.hasOwnProperty("ignoreTags")?t.ignoreTags:ks.ignoreTags,n=0;n<e.length;n++)this.ignoreTags.push(e[n].toUpperCase())}ET.prototype={resolve:function(e){var n=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",n,e),tagName:this.get("tagName",n,e),className:this.get("className",n,e),target:this.get("target",n,e),events:this.getObject("events",n,e),attributes:this.getObject("attributes",n,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,n,s){var i=void 0,r=this[e];if(!r)return r;switch(typeof r=="undefined"?"undefined":cU(r)){case"function":return r(n,s.type);case"object":return i=r.hasOwnProperty(s.type)?r[s.type]:ks[e],typeof i=="function"?i(n,s.type):i}return r},getObject:function(e,n,s){var i=this[e];return typeof i=="function"?i(n,s.type):i}};function uU(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function l3(t){return t}function hU(t,e){return e==="url"?"_blank":null}var Oi={},tr={};tr.__esModule=!0;tr.stateify=tr.TokenState=tr.CharacterState=void 0;var TT=Ol;function Cv(){return function(t){this.j=[],this.T=t||null}}var Iv=Cv();Iv.prototype={defaultTransition:!1,on:function(e,n){if(e instanceof Array){for(var s=0;s<e.length;s++)this.j.push([e[s],n]);return this}return this.j.push([e,n]),this},next:function(e){for(var n=0;n<this.j.length;n++){var s=this.j[n],i=s[0],r=s[1];if(this.test(e,i))return r}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,n){return e===n},emit:function(){return this.T}};var yp=(0,TT.inherits)(Iv,Cv(),{test:function(e,n){return e===n||n instanceof RegExp&&n.test(e)}}),dU=(0,TT.inherits)(Iv,Cv(),{jump:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.next(new e(""));return s===this.defaultTransition?(s=new this.constructor(n),this.on(e,s)):n&&(s.T=n),s},test:function(e,n){return e instanceof n}});function fU(t,e,n,s){for(var i=0,r=t.length,o=e,a=[],l=void 0;i<r&&(l=o.next(t[i]));)o=l,i++;if(i>=r)return[];for(;i<r-1;)l=new yp(s),a.push(l),o.on(t[i],l),o=l,i++;return l=new yp(n),a.push(l),o.on(t[r-1],l),a}tr.CharacterState=yp;tr.TokenState=dU;tr.stateify=fU;var Ye={},ym={};ym.__esModule=!0;function mU(){return function(t){t&&(this.v=t)}}ym.createTokenClass=mU;Ye.__esModule=!0;Ye.AMPERSAND=Ye.CLOSEPAREN=Ye.CLOSEANGLEBRACKET=Ye.CLOSEBRACKET=Ye.CLOSEBRACE=Ye.OPENPAREN=Ye.OPENANGLEBRACKET=Ye.OPENBRACKET=Ye.OPENBRACE=Ye.WS=Ye.TLD=Ye.SYM=Ye.UNDERSCORE=Ye.SLASH=Ye.MAILTO=Ye.PROTOCOL=Ye.QUERY=Ye.POUND=Ye.PLUS=Ye.NUM=Ye.NL=Ye.LOCALHOST=Ye.PUNCTUATION=Ye.DOT=Ye.COLON=Ye.AT=Ye.DOMAIN=Ye.Base=void 0;var ST=ym,pU=Ol,kv=(0,ST.createTokenClass)();kv.prototype={toString:function(){return this.v+""}};function Qt(t){var e=t?{v:t}:{};return(0,pU.inherits)(kv,(0,ST.createTokenClass)(),e)}var gU=Qt(),_U=Qt("@"),vU=Qt(":"),yU=Qt("."),bU=Qt(),wU=Qt(),EU=Qt(`
`),TU=Qt(),SU=Qt("+"),AU=Qt("#"),RU=Qt(),CU=Qt("mailto:"),IU=Qt("?"),kU=Qt("/"),MU=Qt("_"),xU=Qt(),OU=Qt(),NU=Qt(),LU=Qt("{"),DU=Qt("["),PU=Qt("<"),FU=Qt("("),BU=Qt("}"),UU=Qt("]"),jU=Qt(">"),HU=Qt(")"),VU=Qt("&");Ye.Base=kv;Ye.DOMAIN=gU;Ye.AT=_U;Ye.COLON=vU;Ye.DOT=yU;Ye.PUNCTUATION=bU;Ye.LOCALHOST=wU;Ye.NL=EU;Ye.NUM=TU;Ye.PLUS=SU;Ye.POUND=AU;Ye.QUERY=IU;Ye.PROTOCOL=RU;Ye.MAILTO=CU;Ye.SLASH=kU;Ye.UNDERSCORE=MU;Ye.SYM=xU;Ye.TLD=OU;Ye.WS=NU;Ye.OPENBRACE=LU;Ye.OPENBRACKET=DU;Ye.OPENANGLEBRACKET=PU;Ye.OPENPAREN=FU;Ye.CLOSEBRACE=BU;Ye.CLOSEBRACKET=UU;Ye.CLOSEANGLEBRACKET=jU;Ye.CLOSEPAREN=HU;Ye.AMPERSAND=VU;Oi.__esModule=!0;Oi.start=Oi.run=Oi.TOKENS=Oi.State=void 0;var Qr=tr,gt=Ye,qU=$U(gt);function $U(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var c3="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),Mv="0123456789".split(""),bm="0123456789abcdefghijklmnopqrstuvwxyz".split(""),AT=[" ","\f","\r","	","\v","\xA0","\u1680","\u180E"],us=[],Vt=function(e){return new Qr.CharacterState(e)},si=Vt(),bp=Vt(gt.NUM),hl=Vt(gt.DOMAIN),iu=Vt(),wp=Vt(gt.WS);si.on("@",Vt(gt.AT)).on(".",Vt(gt.DOT)).on("+",Vt(gt.PLUS)).on("#",Vt(gt.POUND)).on("?",Vt(gt.QUERY)).on("/",Vt(gt.SLASH)).on("_",Vt(gt.UNDERSCORE)).on(":",Vt(gt.COLON)).on("{",Vt(gt.OPENBRACE)).on("[",Vt(gt.OPENBRACKET)).on("<",Vt(gt.OPENANGLEBRACKET)).on("(",Vt(gt.OPENPAREN)).on("}",Vt(gt.CLOSEBRACE)).on("]",Vt(gt.CLOSEBRACKET)).on(">",Vt(gt.CLOSEANGLEBRACKET)).on(")",Vt(gt.CLOSEPAREN)).on("&",Vt(gt.AMPERSAND)).on([",",";","!",'"',"'"],Vt(gt.PUNCTUATION));si.on(`
`,Vt(gt.NL)).on(AT,wp);wp.on(AT,wp);for(var R1=0;R1<c3.length;R1++){var zU=(0,Qr.stateify)(c3[R1],si,gt.TLD,gt.DOMAIN);us.push.apply(us,zU)}var RT=(0,Qr.stateify)("file",si,gt.DOMAIN,gt.DOMAIN),CT=(0,Qr.stateify)("ftp",si,gt.DOMAIN,gt.DOMAIN),IT=(0,Qr.stateify)("http",si,gt.DOMAIN,gt.DOMAIN),kT=(0,Qr.stateify)("mailto",si,gt.DOMAIN,gt.DOMAIN);us.push.apply(us,RT);us.push.apply(us,CT);us.push.apply(us,IT);us.push.apply(us,kT);var KU=RT.pop(),GU=CT.pop(),WU=IT.pop(),YU=kT.pop(),wm=Vt(gt.DOMAIN),Em=Vt(gt.PROTOCOL),XU=Vt(gt.MAILTO);GU.on("s",wm).on(":",Em);WU.on("s",wm).on(":",Em);us.push(wm);KU.on(":",Em);wm.on(":",Em);YU.on(":",XU);var QU=(0,Qr.stateify)("localhost",si,gt.LOCALHOST,gt.DOMAIN);us.push.apply(us,QU);si.on(Mv,bp);bp.on("-",iu).on(Mv,bp).on(bm,hl);hl.on("-",iu).on(bm,hl);for(var C1=0;C1<us.length;C1++)us[C1].on("-",iu).on(bm,hl);iu.on("-",iu).on(Mv,hl).on(bm,hl);si.defaultTransition=Vt(gt.SYM);var ZU=function(e){for(var n=e.replace(/[A-Z]/g,function(f){return f.toLowerCase()}),s=e.length,i=[],r=0;r<s;){for(var o=si,a=null,l=0,c=null,d=-1;r<s&&(a=o.next(n[r]));)o=a,o.accepts()?(d=0,c=o):d>=0&&d++,l++,r++;if(!(d<0)){r-=d,l-=d;var u=c.emit();i.push(new u(e.substr(r-l,l)))}}return i},JU=si;Oi.State=Qr.CharacterState;Oi.TOKENS=qU;Oi.run=ZU;Oi.start=JU;var Ni={},bs={};bs.__esModule=!0;bs.URL=bs.TEXT=bs.NL=bs.EMAIL=bs.MAILTOEMAIL=bs.Base=void 0;var Nl=ym,qu=Ol,Sc=Ye;function ej(t){return t instanceof Sc.DOMAIN||t instanceof Sc.TLD}var pa=(0,Nl.createTokenClass)();pa.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],n=0;n<this.v.length;n++)e.push(this.v[n].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var tj=(0,qu.inherits)(pa,(0,Nl.createTokenClass)(),{type:"email",isLink:!0}),nj=(0,qu.inherits)(pa,(0,Nl.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),sj=(0,qu.inherits)(pa,(0,Nl.createTokenClass)(),{type:"text"}),ij=(0,qu.inherits)(pa,(0,Nl.createTokenClass)(),{type:"nl"}),rj=(0,qu.inherits)(pa,(0,Nl.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",n=!1,s=!1,i=this.v,r=[],o=0;i[o]instanceof Sc.PROTOCOL;)n=!0,r.push(i[o].toString().toLowerCase()),o++;for(;i[o]instanceof Sc.SLASH;)s=!0,r.push(i[o].toString()),o++;for(;ej(i[o]);)r.push(i[o].toString().toLowerCase()),o++;for(;o<i.length;o++)r.push(i[o].toString());return r=r.join(""),n||s||(r=e+"://"+r),r},hasProtocol:function(){return this.v[0]instanceof Sc.PROTOCOL}});bs.Base=pa;bs.MAILTOEMAIL=tj;bs.EMAIL=nj;bs.NL=ij;bs.TEXT=sj;bs.URL=rj;Ni.__esModule=!0;Ni.start=Ni.run=Ni.TOKENS=Ni.State=void 0;var MT=tr,As=bs,oj=aj(As),xe=Ye;function aj(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var Et=function(e){return new MT.TokenState(e)},Tm=Et(),xT=Et(),OT=Et(),xv=Et(),NT=Et(),Dr=Et(),Sm=Et(),$u=Et(As.URL),LT=Et(),DT=Et(As.URL),un=Et(As.URL),ru=Et(),zu=Et(),Ku=Et(),Gu=Et(),Wu=Et(),na=Et(As.URL),sa=Et(As.URL),ia=Et(As.URL),ra=Et(As.URL),ou=Et(),au=Et(),lu=Et(),cu=Et(),$a=Et(),Ov=Et(),Am=Et(As.EMAIL),PT=Et(),lj=Et(As.EMAIL),No=Et(As.MAILTOEMAIL),Ep=Et(),dl=Et(),Rm=Et(),FT=Et(),cj=Et(As.NL);Tm.on(xe.NL,cj).on(xe.PROTOCOL,xT).on(xe.MAILTO,OT).on(xe.SLASH,xv);xT.on(xe.SLASH,xv);xv.on(xe.SLASH,NT);Tm.on(xe.TLD,Dr).on(xe.DOMAIN,Dr).on(xe.LOCALHOST,$u).on(xe.NUM,Dr);NT.on(xe.TLD,un).on(xe.DOMAIN,un).on(xe.NUM,un).on(xe.LOCALHOST,un);Dr.on(xe.DOT,Sm);$a.on(xe.DOT,Ov);Sm.on(xe.TLD,$u).on(xe.DOMAIN,Dr).on(xe.NUM,Dr).on(xe.LOCALHOST,Dr);Ov.on(xe.TLD,Am).on(xe.DOMAIN,$a).on(xe.NUM,$a).on(xe.LOCALHOST,$a);$u.on(xe.DOT,Sm);Am.on(xe.DOT,Ov);$u.on(xe.COLON,LT).on(xe.SLASH,un);LT.on(xe.NUM,DT);DT.on(xe.SLASH,un);Am.on(xe.COLON,PT);PT.on(xe.NUM,lj);var Xn=[xe.DOMAIN,xe.AT,xe.LOCALHOST,xe.NUM,xe.PLUS,xe.POUND,xe.PROTOCOL,xe.SLASH,xe.TLD,xe.UNDERSCORE,xe.SYM,xe.AMPERSAND],Qn=[xe.COLON,xe.DOT,xe.QUERY,xe.PUNCTUATION,xe.CLOSEBRACE,xe.CLOSEBRACKET,xe.CLOSEANGLEBRACKET,xe.CLOSEPAREN,xe.OPENBRACE,xe.OPENBRACKET,xe.OPENANGLEBRACKET,xe.OPENPAREN];un.on(xe.OPENBRACE,zu).on(xe.OPENBRACKET,Ku).on(xe.OPENANGLEBRACKET,Gu).on(xe.OPENPAREN,Wu);ru.on(xe.OPENBRACE,zu).on(xe.OPENBRACKET,Ku).on(xe.OPENANGLEBRACKET,Gu).on(xe.OPENPAREN,Wu);zu.on(xe.CLOSEBRACE,un);Ku.on(xe.CLOSEBRACKET,un);Gu.on(xe.CLOSEANGLEBRACKET,un);Wu.on(xe.CLOSEPAREN,un);na.on(xe.CLOSEBRACE,un);sa.on(xe.CLOSEBRACKET,un);ia.on(xe.CLOSEANGLEBRACKET,un);ra.on(xe.CLOSEPAREN,un);ou.on(xe.CLOSEBRACE,un);au.on(xe.CLOSEBRACKET,un);lu.on(xe.CLOSEANGLEBRACKET,un);cu.on(xe.CLOSEPAREN,un);zu.on(Xn,na);Ku.on(Xn,sa);Gu.on(Xn,ia);Wu.on(Xn,ra);zu.on(Qn,ou);Ku.on(Qn,au);Gu.on(Qn,lu);Wu.on(Qn,cu);na.on(Xn,na);sa.on(Xn,sa);ia.on(Xn,ia);ra.on(Xn,ra);na.on(Qn,na);sa.on(Qn,sa);ia.on(Qn,ia);ra.on(Qn,ra);ou.on(Xn,na);au.on(Xn,sa);lu.on(Xn,ia);cu.on(Xn,ra);ou.on(Qn,ou);au.on(Qn,au);lu.on(Qn,lu);cu.on(Qn,cu);un.on(Xn,un);ru.on(Xn,un);un.on(Qn,ru);ru.on(Qn,ru);OT.on(xe.TLD,No).on(xe.DOMAIN,No).on(xe.NUM,No).on(xe.LOCALHOST,No);No.on(Xn,No).on(Qn,Ep);Ep.on(Xn,No).on(Qn,Ep);var Yu=[xe.DOMAIN,xe.NUM,xe.PLUS,xe.POUND,xe.QUERY,xe.UNDERSCORE,xe.SYM,xe.AMPERSAND,xe.TLD];Dr.on(Yu,dl).on(xe.AT,Rm);$u.on(Yu,dl).on(xe.AT,Rm);Sm.on(Yu,dl);dl.on(Yu,dl).on(xe.AT,Rm).on(xe.DOT,FT);FT.on(Yu,dl);Rm.on(xe.TLD,$a).on(xe.DOMAIN,$a).on(xe.LOCALHOST,Am);var uj=function(e){for(var n=e.length,s=0,i=[],r=[];s<n;){for(var o=Tm,a=null,l=null,c=0,d=null,u=-1;s<n&&!(a=o.next(e[s]));)r.push(e[s++]);for(;s<n&&(l=a||o.next(e[s]));)a=null,o=l,o.accepts()?(u=0,d=o):u>=0&&u++,s++,c++;if(u<0)for(var f=s-c;f<s;f++)r.push(e[f]);else{r.length>0&&(i.push(new As.TEXT(r)),r=[]),s-=u,c-=u;var m=d.emit();i.push(new m(e.slice(s-c,s)))}}return r.length>0&&i.push(new As.TEXT(r)),i};Ni.State=MT.TokenState;Ni.TOKENS=oj;Ni.run=uj;Ni.start=Tm;Hn.__esModule=!0;Hn.tokenize=Hn.test=Hn.scanner=Hn.parser=Hn.options=Hn.inherits=Hn.find=void 0;var hj=Ol,dj=Vu,fj=Nv(dj),mj=Oi,BT=Nv(mj),pj=Ni,UT=Nv(pj);function Nv(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Array.isArray||(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"});var Lv=function(e){return UT.run(BT.run(e))},gj=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=Lv(e),i=[],r=0;r<s.length;r++){var o=s[r];o.isLink&&(!n||o.type===n)&&i.push(o.toObject())}return i},_j=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=Lv(e);return s.length===1&&s[0].isLink&&(!n||s[0].type===n)};Hn.find=gj;Hn.inherits=hj.inherits;Hn.options=fj;Hn.parser=UT;Hn.scanner=BT;Hn.test=_j;Hn.tokenize=Lv;var jT=Hn,vj=(t,e,n)=>{const s={bold:n.bold,italic:n.italic,strike:n.strike,underline:n.underline,multilineCode:n.multilineCode,inlineCode:n.inlineCode},i={[s.bold]:{end:"\\"+s.bold,allowed_chars:".",type:"bold"},[s.italic]:{end:s.italic,allowed_chars:".",type:"italic"},[s.strike]:{end:s.strike,allowed_chars:".",type:"strike"},[s.underline]:{end:s.underline,allowed_chars:".",type:"underline"},[s.multilineCode]:{end:s.multilineCode,allowed_chars:`(.|
)`,type:"multiline-code"},[s.inlineCode]:{end:s.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},r=Yh(t,i),o=yj(r,i),a=[].concat.apply([],o);return e&&wj(a),a};function Yh(t,e){let n=[],s=-1,i=null,r=jT.find(t),o=!1;if(r.length>0&&(s=t.indexOf(r[0].value),o=!0),Object.keys(e).forEach(a=>{const l=t.indexOf(a);l>=0&&(s<0||l<s)&&(s=l,i=a,o=!1)}),o&&i!==-1){let a=t.substr(0,s),l=t.substr(s,r[0].value.length),c=t.substr(s+r[0].value.length);return n.push(a),n.push(l),n=n.concat(Yh(c,e)),n}if(i){let a=t.substr(0,s);const l=i;let c=t.substr(s+l.length);if(t.replace(/\s/g,"").length===l.length*2)return[t];const d=c.match(new RegExp("^("+(e[l].allowed_chars||".")+"*"+(e[l].end?"?":"")+")"+(e[l].end?"("+e[l].end+")":""),"m"));if(!d||!d[1])a=a+l,n.push(a);else{a&&n.push(a);const u={start:l,content:Yh(d[1],e),end:d[2],type:e[l].type};n.push(u),c=c.substr(d[0].length)}return n=n.concat(Yh(c,e)),n}else return t?[t]:[]}function yj(t,e){const n=[];return t.forEach(s=>{typeof s=="string"?n.push({types:[],value:s}):e[s.start]&&n.push(bj(s))}),n}function bj(t){const e=[];return HT(t,e,[]),e}function HT(t,e,n){t.content.forEach(s=>{typeof s=="string"?e.push({types:u3(n.concat([t.type])),value:s}):HT(s,e,u3([s.type].concat([t.type]).concat(n)))})}function u3(t){return[...new Set(t)]}function wj(t){const e=[];return t.forEach(n=>{const s=jT.find(n.value);if(s.length){const i=n.value.replace(s[0].value,"");e.push({types:n.types,value:i}),n.types=["url"].concat(n.types),n.href=s[0].href,n.value=s[0].value}e.push(n)}),e}const Dv=["png","jpg","jpeg","webp","svg","gif"],VT=["mp4","video/ogg","webm","quicktime"],Ej=["mp3","audio/ogg","wav","mpeg"],Tj={name:"FormatMessage",components:{SvgIcon:Un},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const t=vj(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return t.forEach(e=>{e.url=this.checkType(e,"url"),e.bold=this.checkType(e,"bold"),e.italic=this.checkType(e,"italic"),e.strike=this.checkType(e,"strike"),e.underline=this.checkType(e,"underline"),e.inline=this.checkType(e,"inline-code"),e.multiline=this.checkType(e,"multiline-code"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e),e.value=this.replaceEmojiByElement(e.value)}),t},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType(t,e){return t.types&&t.types.indexOf(e)!==-1},checkImageType(t){let e=t.value.lastIndexOf(".");t.value.lastIndexOf("/")>e&&(e=-1);const s=t.value.substring(e+1,t.value.length),i=e>0&&Dv.some(r=>s.toLowerCase().includes(r));return i&&this.setImageSize(t),i},setImageSize(t){const e=new Image;e.src=t.value,e.addEventListener("load",n);function n(s){const i=s.path[0].width/150;t.height=Math.round(s.path[0].height/i)+"px",e.removeEventListener("load",n)}},formatTags(t){const e="<usertag>",n="</usertag>",s=[...t.matchAll(new RegExp(e,"gi"))].map(r=>r.index),i=t;return s.forEach(r=>{const o=i.substring(r+e.length,i.indexOf(n,r)),a=this.users.find(l=>l._id===o);t=t.replaceAll(o,`@${(a==null?void 0:a.username)||"unknown"}`)}),t},openTag(t){if(!this.singleLine&&this.checkType(t,"tag")){const e=this.users.find(n=>t.value.indexOf(n.username)!==-1);this.$emit("open-user-tag",e)}},replaceEmojiByElement(t){let e;return this.singleLine?e=16:e=this.containsOnlyEmojis()?28:20,t.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,n=>`<span style="font-size: ${e}px">${n}</span>`)},containsOnlyEmojis(){const t=this.content.replace(new RegExp("[\0-\u1EEFf]","g"),""),e=this.content.replace(new RegExp(`[
\rs]+|( )+`,"g"),"");return t.length===e.length}}},Sj={class:"vac-image-link-container"},Aj={class:"vac-image-link-message"},Rj=["innerHTML"],Cj=["innerHTML"];function Ij(t,e,n,s,i,r){const o=Je("svg-icon");return re(),ge("div",{class:pt(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[n.textFormatting.disabled?(re(),ge("div",{key:1,innerHTML:r.formattedContent},null,8,Cj)):(re(),ge("div",{key:0,class:pt({"vac-text-ellipsis":n.singleLine})},[(re(!0),ge(Ct,null,ht(r.linkifiedMessage,(a,l)=>(re(),ge("div",{key:l,class:"vac-format-container"},[(re(),Pt(wF(a.url?"a":"span"),{class:pt({"vac-text-ellipsis":n.singleLine,"vac-text-bold":a.bold,"vac-text-italic":n.deleted||a.italic,"vac-text-strike":a.strike,"vac-text-underline":a.underline,"vac-text-inline-code":!n.singleLine&&a.inline,"vac-text-multiline-code":!n.singleLine&&a.multiline,"vac-text-tag":!n.singleLine&&!n.reply&&a.tag}),href:a.href,target:a.href?n.linkOptions.target:null,rel:a.href?n.linkOptions.rel:null,onClick:c=>r.openTag(a)},{default:et(()=>[n.deleted?(re(),ge(Ct,{key:0},[Fe(t.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},()=>[He(o,{name:"deleted",class:pt(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])]),Xr(" "+ot(n.textMessages.MESSAGE_DELETED),1)],64)):a.url&&a.image?(re(),ge(Ct,{key:1},[Ce("div",Sj,[Ce("div",{class:"vac-image-link",style:en({"background-image":`url('${a.value}')`,height:a.height})},null,4)]),Ce("div",Aj,[Ce("span",null,ot(a.value),1)])],64)):(re(),ge("span",{key:2,innerHTML:a.value},null,8,Rj))]),_:2},1032,["class","href","target","rel","onClick"]))]))),128))],2))],2)}var Xu=Xt(Tj,[["render",Ij]]);const So="__v-click-outside",qT=typeof window!="undefined",kj=typeof navigator!="undefined",Mj=qT&&("ontouchstart"in window||kj&&navigator.msMaxTouchPoints>0),xj=Mj?["touchstart"]:["click"],Oj=t=>{const e=typeof t=="function";if(!e&&typeof t!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:e?t:t.handler,middleware:t.middleware||(n=>n),events:t.events||xj,isActive:t.isActive!==!1,detectIframe:t.detectIframe!==!1,capture:Boolean(t.capture)}},$T=({event:t,handler:e,middleware:n})=>{n(t)&&e(t)},Nj=({el:t,event:e,handler:n,middleware:s})=>{setTimeout(()=>{const{activeElement:i}=document;i&&i.tagName==="IFRAME"&&!t.contains(i)&&$T({event:e,handler:n,middleware:s})},0)},Lj=({el:t,event:e,handler:n,middleware:s})=>{const i=e.path||e.composedPath&&e.composedPath();(i?i.indexOf(t)<0:!t.contains(e.target))&&$T({event:e,handler:n,middleware:s})},zT=(t,{value:e})=>{const{events:n,handler:s,middleware:i,isActive:r,detectIframe:o,capture:a}=Oj(e);if(!!r){if(t[So]=n.map(l=>({event:l,srcTarget:document.documentElement,handler:c=>Lj({el:t,event:c,handler:s,middleware:i}),capture:a})),o){const l={event:"blur",srcTarget:window,handler:c=>Nj({el:t,event:c,handler:s,middleware:i}),capture:a};t[So]=[...t[So],l]}t[So].forEach(({event:l,srcTarget:c,handler:d})=>setTimeout(()=>{!t[So]||c.addEventListener(l,d,a)},0))}},KT=t=>{(t[So]||[]).forEach(({event:n,srcTarget:s,handler:i,capture:r})=>s.removeEventListener(n,i,r)),delete t[So]},Dj=(t,{value:e,oldValue:n})=>{JSON.stringify(e)!==JSON.stringify(n)&&(KT(t),zT(t,{value:e}))},Pj={beforeMount:zT,updated:Dj,unmounted:KT};var Cm=qT?Pj:{},GT=(t,e,n)=>{if(t.typingUsers&&t.typingUsers.length){const s=t.users.filter(i=>{if(i._id!==e&&t.typingUsers.indexOf(i._id)!==-1&&!(i.status&&i.status.state==="offline"))return!0});return s.length?t.users.length===2?n.IS_TYPING:s.map(i=>i.username).join(", ")+" "+n.IS_TYPING:void 0}};function uu(t,e){if(!(!e||!e.type))return t.some(n=>e.type.toLowerCase().includes(n))}function fl(t){return uu(Dv,t)}function Qu(t){return uu(VT,t)}function h3(t){return uu(Dv,t)||uu(VT,t)}function Im(t){return uu(Ej,t)}const Fj={name:"RoomsContent",components:{SvgIcon:Un,FormatMessage:Xu},directives:{clickOutside:Cm},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const t=this.typingUsers;if(t)return t;const e=this.room.lastMessage.content;if(this.room.users.length<=2)return e;const n=this.room.users.find(s=>s._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${e}`:!n||n._id===this.currentUserId?e:`${n.username} - ${e}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const t=this.room.users.find(e=>e._id!==this.currentUserId);return t&&t.status?t.status.state:null},typingUsers(){return GT(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var t,e;const n=(e=(t=this.room.lastMessage)==null?void 0:t.files)==null?void 0:e[0];if(n){if(!n.duration)return`${n.name}.${n.extension}`;let s=Math.floor(n.duration);return(s-(s%=60))/60+(s>9?":":":0")+s}return""},isAudio(){return this.room.lastMessage.files?Im(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(t){this.closeRoomMenu(),this.$emit("room-action-handler",{action:t,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},Bj={class:"vac-room-container"},Uj={class:"vac-name-container vac-text-ellipsis"},jj={class:"vac-title-container"},Hj={class:"vac-room-name vac-text-ellipsis"},Vj={key:1,class:"vac-text-date"},qj={key:0},$j={key:1,class:"vac-text-ellipsis"},zj={key:3,class:"vac-text-ellipsis"},Kj={class:"vac-room-options-container"},Gj={key:0,class:"vac-badge-counter vac-room-badge"},Wj={key:0,class:"vac-menu-options"},Yj={class:"vac-menu-list"},Xj=["onClick"];function Qj(t,e,n,s,i,r){const o=Je("svg-icon"),a=Je("format-message"),l=mm("click-outside");return re(),ge("div",Bj,[Fe(t.$slots,"room-list-item_"+n.room.roomId,{},()=>[Fe(t.$slots,"room-list-avatar_"+n.room.roomId,{},()=>[n.room.avatar?(re(),ge("div",{key:0,class:"vac-avatar",style:en({"background-image":`url('${n.room.avatar}')`})},null,4)):Le("",!0)]),Ce("div",Uj,[Ce("div",jj,[r.userStatus?(re(),ge("div",{key:0,class:pt(["vac-state-circle",{"vac-state-online":r.userStatus==="online"}])},null,2)):Le("",!0),Ce("div",Hj,ot(n.room.roomName),1),n.room.lastMessage?(re(),ge("div",Vj,ot(n.room.lastMessage.timestamp),1)):Le("",!0)]),Ce("div",{class:pt(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!r.typingUsers}])},[r.isMessageCheckmarkVisible?(re(),ge("span",qj,[Fe(t.$slots,"checkmark-icon_"+n.room.roomId,{},()=>[He(o,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Le("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&r.isAudio?(re(),ge("div",$j,[Fe(t.$slots,"microphone-icon_"+n.room.roomId,{},()=>[He(o,{name:"microphone",class:"vac-icon-microphone"})]),Xr(" "+ot(r.formattedDuration),1)])):n.room.lastMessage?(re(),Pt(a,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:r.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!r.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Le("",!0),!n.room.lastMessage&&r.typingUsers?(re(),ge("div",zj,ot(r.typingUsers),1)):Le("",!0),Ce("div",Kj,[n.room.unreadCount?(re(),ge("div",Gj,ot(n.room.unreadCount),1)):Le("",!0),Fe(t.$slots,"room-list-options_"+n.room.roomId,{},()=>[n.roomActions.length?(re(),ge("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:e[0]||(e[0]=xi(c=>i.roomMenuOpened=n.room.roomId,["stop"]))},[Fe(t.$slots,"room-list-options-icon_"+n.room.roomId,{},()=>[He(o,{name:"dropdown",param:"room"})])])):Le("",!0),n.roomActions.length?(re(),Pt(gn,{key:1,name:"vac-slide-left"},{default:et(()=>[i.roomMenuOpened===n.room.roomId?ar((re(),ge("div",Wj,[Ce("div",Yj,[(re(!0),ge(Ct,null,ht(n.roomActions,c=>(re(),ge("div",{key:c.name},[Ce("div",{class:"vac-menu-item",onClick:xi(d=>r.roomActionHandler(c),["stop"])},ot(c.title),9,Xj)]))),128))])])),[[l,r.closeRoomMenu]]):Le("",!0)]),_:1})):Le("",!0)])])],2)])])])}var Zj=Xt(Fj,[["render",Qj]]),Tp=(t,e,n,s=!1)=>!n||n===""?t:t.filter(i=>s?Th(i[e]).startsWith(Th(n)):Th(i[e]).includes(Th(n)));function Th(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const Jj={name:"RoomsList",components:{Loader:vm,RoomsSearch:aU,RoomContent:Zj},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(t,e){this.filteredRooms=t,(t.length!==e.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(t){t||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(t){this.$emit("loading-more-rooms",t)},roomsLoaded:{immediate:!0,handler(t){t&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(t){t&&!this.isMobile&&(this.selectedRoomId=t.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const t=this.$el.querySelector("#infinite-loader-rooms");if(t){const e={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreRooms()},e),this.observer.observe(t)}},searchRoom(t){this.customSearchRoomEnabled?this.$emit("search-room",t.target.value):this.filteredRooms=Tp(this.rooms,"roomName",t.target.value)},openRoom(t){t.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=t.roomId),this.$emit("fetch-room",{room:t}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},eH={key:0,class:"vac-rooms-empty"},tH={key:1,id:"rooms-list",class:"vac-room-list"},nH=["id","onClick"],sH={key:0,id:"infinite-loader-rooms"};function iH(t,e,n,s,i,r){const o=Je("rooms-search"),a=Je("loader"),l=Je("room-content");return ar((re(),ge("div",{class:pt(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Fe(t.$slots,"rooms-header"),Fe(t.$slots,"rooms-list-search",{},()=>[He(o,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:r.searchRoom,onAddRoom:e[0]||(e[0]=c=>t.$emit("add-room"))},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),He(a,{show:n.loadingRooms,type:"rooms"},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["show"]),!n.loadingRooms&&!n.rooms.length?(re(),ge("div",eH,[Fe(t.$slots,"rooms-empty",{},()=>[Xr(ot(n.textMessages.ROOMS_EMPTY),1)])])):Le("",!0),n.loadingRooms?Le("",!0):(re(),ge("div",tH,[(re(!0),ge(Ct,null,ht(i.filteredRooms,c=>(re(),ge("div",{id:c.roomId,key:c.roomId,class:pt(["vac-room-item",{"vac-room-selected":i.selectedRoomId===c.roomId}]),onClick:d=>r.openRoom(c)},[He(l,{"current-user-id":n.currentUserId,room:c,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:e[1]||(e[1]=d=>t.$emit("room-action-handler",d))},$t({_:2},[ht(t.$slots,(d,u)=>({name:u,fn:et(f=>[Fe(t.$slots,u,qt(Bt(f)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,nH))),128)),He(gn,{name:"vac-fade-message"},{default:et(()=>[n.rooms.length&&!n.loadingRooms?(re(),ge("div",sH,[He(a,{show:i.showLoader,infinite:!0,type:"infinite-rooms"},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["show"])])):Le("",!0)]),_:3})]))],2)),[[_m,n.showRoomsList]])}var rH=Xt(Jj,[["render",iH]]);const oH={name:"RoomHeader",components:{SvgIcon:Un},directives:{clickOutside:Cm},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return GT(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const t=this.room.users.find(n=>n._id!==this.currentUserId);if(!(t!=null&&t.status))return;let e="";return t.status.state==="online"?e=this.textMessages.IS_ONLINE:t.status.lastChanged&&(e=this.textMessages.LAST_SEEN+t.status.lastChanged),e}},watch:{messageSelectionEnabled(t){t?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(t){this.closeMenu(),this.$emit("menu-action-handler",t)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(t){this.$emit("message-selection-action-handler",t)}}},aH={class:"vac-room-header vac-app-border-b"},lH={class:"vac-room-wrapper"},cH={key:0,class:"vac-room-selection"},uH=["id"],hH=["onClick"],dH={class:"vac-selection-button-count"},fH={class:"vac-text-ellipsis"},mH={class:"vac-room-name vac-text-ellipsis"},pH={key:0,class:"vac-room-info vac-text-ellipsis"},gH={key:1,class:"vac-room-info vac-text-ellipsis"},_H={key:0,class:"vac-menu-options"},vH={class:"vac-menu-list"},yH=["onClick"];function bH(t,e,n,s,i,r){const o=Je("svg-icon"),a=mm("click-outside");return re(),ge("div",aH,[Fe(t.$slots,"room-header",{},()=>[Ce("div",lH,[He(gn,{name:"vac-slide-up"},{default:et(()=>[n.messageSelectionEnabled?(re(),ge("div",cH,[(re(!0),ge(Ct,null,ht(n.messageSelectionActions,l=>(re(),ge("div",{id:l.name,key:l.name},[Ce("div",{class:"vac-selection-button",onClick:c=>r.messageSelectionActionHandler(l)},[Xr(ot(l.title)+" ",1),Ce("span",dH,ot(n.selectedMessagesTotal),1)],8,hH)],8,uH))),128)),Ce("div",{class:"vac-selection-cancel vac-item-clickable",onClick:e[0]||(e[0]=l=>t.$emit("cancel-message-selection"))},ot(n.textMessages.CANCEL_SELECT_MESSAGE),1)])):Le("",!0)]),_:1}),!n.messageSelectionEnabled&&i.messageSelectionAnimationEnded?(re(),ge(Ct,{key:0},[n.singleRoom?Le("",!0):(re(),ge("div",{key:0,class:pt(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:e[1]||(e[1]=l=>t.$emit("toggle-rooms-list"))},[Fe(t.$slots,"toggle-icon",{},()=>[He(o,{name:"toggle"})])],2)),Ce("div",{class:pt(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:e[2]||(e[2]=l=>t.$emit("room-info"))},[Fe(t.$slots,"room-header-avatar",{},()=>[n.room.avatar?(re(),ge("div",{key:0,class:"vac-avatar",style:en({"background-image":`url('${n.room.avatar}')`})},null,4)):Le("",!0)]),Fe(t.$slots,"room-header-info",{},()=>[Ce("div",fH,[Ce("div",mH,ot(n.room.roomName),1),r.typingUsers?(re(),ge("div",pH,ot(r.typingUsers),1)):(re(),ge("div",gH,ot(r.userStatus),1))])])],2),n.room.roomId?Fe(t.$slots,"room-options",{key:1},()=>[n.menuActions.length?(re(),ge("div",{key:0,class:"vac-svg-button vac-room-options",onClick:e[3]||(e[3]=l=>i.menuOpened=!i.menuOpened)},[Fe(t.$slots,"menu-icon",{},()=>[He(o,{name:"menu"})])])):Le("",!0),n.menuActions.length?(re(),Pt(gn,{key:1,name:"vac-slide-left"},{default:et(()=>[i.menuOpened?ar((re(),ge("div",_H,[Ce("div",vH,[(re(!0),ge(Ct,null,ht(n.menuActions,l=>(re(),ge("div",{key:l.name},[Ce("div",{class:"vac-menu-item",onClick:c=>r.menuActionHandler(l)},ot(l.title),9,yH)]))),128))])])),[[a,r.closeMenu]]):Le("",!0)]),_:1})):Le("",!0)]):Le("",!0)],64)):Le("",!0)])])])}var wH=Xt(oH,[["render",bH]]);function Sh(t){if(typeof t!="string"||!t)throw new Error("expected a non-empty string, got: "+t)}function I1(t){if(typeof t!="number")throw new Error("expected a number, got: "+t)}const EH=1,TH=1,ga="emoji",ml="keyvalue",Pv="favorites",SH="tokens",WT="tokens",AH="unicode",YT="count",RH="group",CH="order",XT="group-order",Sp="eTag",Gd="url",d3="skinTone",Ll="readonly",Fv="readwrite",QT="skinUnicodes",IH="skinUnicodes",kH="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",MH="en";function xH(t,e){const n=new Set,s=[];for(const i of t){const r=e(i);n.has(r)||(n.add(r),s.push(i))}return s}function f3(t){return xH(t,e=>e.unicode)}function OH(t){function e(n,s,i){const r=s?t.createObjectStore(n,{keyPath:s}):t.createObjectStore(n);if(i)for(const[o,[a,l]]of Object.entries(i))r.createIndex(o,a,{multiEntry:l});return r}e(ml),e(ga,AH,{[WT]:[SH,!0],[XT]:[[RH,CH]],[QT]:[IH,!0]}),e(Pv,void 0,{[YT]:[""]})}const Ap={},Xh={},Wd={};function ZT(t,e,n){n.onerror=()=>e(n.error),n.onblocked=()=>e(new Error("IDB blocked")),n.onsuccess=()=>t(n.result)}async function NH(t){const e=await new Promise((n,s)=>{const i=indexedDB.open(t,EH);Ap[t]=i,i.onupgradeneeded=r=>{r.oldVersion<TH&&OH(i.result)},ZT(n,s,i)});return e.onclose=()=>Bv(t),e}function LH(t){return Xh[t]||(Xh[t]=NH(t)),Xh[t]}function dr(t,e,n,s){return new Promise((i,r)=>{const o=t.transaction(e,n,{durability:"relaxed"}),a=typeof e=="string"?o.objectStore(e):e.map(c=>o.objectStore(c));let l;s(a,o,c=>{l=c}),o.oncomplete=()=>i(l),o.onerror=()=>r(o.error)})}function Bv(t){const e=Ap[t],n=e&&e.result;if(n){n.close();const s=Wd[t];if(s)for(const i of s)i()}delete Ap[t],delete Xh[t],delete Wd[t]}function DH(t){return new Promise((e,n)=>{Bv(t);const s=indexedDB.deleteDatabase(t);ZT(e,n,s)})}function PH(t,e){let n=Wd[t];n||(n=Wd[t]=[]),n.push(e)}const FH=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function za(t){return t.split(/[\s_]+/).map(e=>!e.match(/\w/)||FH.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(//g,"'").toLowerCase()).filter(Boolean)}const BH=2;function JT(t){return t.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=BH)}function UH(t){return t.map(({annotation:n,emoticon:s,group:i,order:r,shortcodes:o,skins:a,tags:l,emoji:c,version:d})=>{const u=[...new Set(JT([...(o||[]).map(za).flat(),...l.map(za).flat(),...za(n),s]))].sort(),f={annotation:n,group:i,order:r,tags:l,tokens:u,unicode:c,version:d};if(s&&(f.emoticon=s),o&&(f.shortcodes=o),a){f.skinTones=[],f.skinUnicodes=[],f.skinVersions=[];for(const{tone:m,emoji:h,version:M}of a)f.skinTones.push(m),f.skinUnicodes.push(h),f.skinVersions.push(M)}return f})}function eS(t,e,n,s){t[e](n).onsuccess=i=>s&&s(i.target.result)}function oa(t,e,n){eS(t,"get",e,n)}function tS(t,e,n){eS(t,"getAll",e,n)}function Uv(t){t.commit&&t.commit()}function jH(t,e){let n=t[0];for(let s=1;s<t.length;s++){const i=t[s];e(n)>e(i)&&(n=i)}return n}function nS(t,e){const n=jH(t,i=>i.length),s=[];for(const i of n)t.some(r=>r.findIndex(o=>e(o)===e(i))===-1)||s.push(i);return s}async function HH(t){return!await jv(t,ml,Gd)}async function VH(t,e,n){const[s,i]=await Promise.all([Sp,Gd].map(r=>jv(t,ml,r)));return s===n&&i===e}async function qH(t,e){return dr(t,ga,Ll,(s,i,r)=>{let o;const a=()=>{s.getAll(o&&IDBKeyRange.lowerBound(o,!0),50).onsuccess=l=>{const c=l.target.result;for(const d of c)if(o=d.unicode,e(d))return r(d);if(c.length<50)return r();a()}};a()})}async function sS(t,e,n,s){try{const i=UH(e);await dr(t,[ga,ml],Fv,([r,o],a)=>{let l,c,d=0;function u(){++d===2&&f()}function f(){if(!(l===s&&c===n)){r.clear();for(const m of i)r.put(m);o.put(s,Sp),o.put(n,Gd),Uv(a)}}oa(o,Sp,m=>{l=m,u()}),oa(o,Gd,m=>{c=m,u()})})}finally{}}async function $H(t,e){return dr(t,ga,Ll,(n,s,i)=>{const r=IDBKeyRange.bound([e,0],[e+1,0],!1,!0);tS(n.index(XT),r,i)})}async function iS(t,e){const n=JT(za(e));return n.length?dr(t,ga,Ll,(s,i,r)=>{const o=[],a=()=>{o.length===n.length&&l()},l=()=>{const c=nS(o,d=>d.unicode);r(c.sort((d,u)=>d.order<u.order?-1:1))};for(let c=0;c<n.length;c++){const d=n[c],u=c===n.length-1?IDBKeyRange.bound(d,d+"\uFFFF",!1,!0):IDBKeyRange.only(d);tS(s.index(WT),u,f=>{o.push(f),a()})}}):[]}async function zH(t,e){const n=await iS(t,e);return n.length?n.filter(s=>(s.shortcodes||[]).map(r=>r.toLowerCase()).includes(e.toLowerCase()))[0]||null:await qH(t,i=>(i.shortcodes||[]).includes(e.toLowerCase()))||null}async function KH(t,e){return dr(t,ga,Ll,(n,s,i)=>oa(n,e,r=>{if(r)return i(r);oa(n.index(QT),e,o=>i(o||null))}))}function jv(t,e,n){return dr(t,e,Ll,(s,i,r)=>oa(s,n,r))}function GH(t,e,n,s){return dr(t,e,Fv,(i,r)=>{i.put(s,n),Uv(r)})}function WH(t,e){return dr(t,Pv,Fv,(n,s)=>oa(n,e,i=>{n.put((i||0)+1,e),Uv(s)}))}function YH(t,e,n){return n===0?[]:dr(t,[Pv,ga],Ll,([s,i],r,o)=>{const a=[];s.index(YT).openCursor(void 0,"prev").onsuccess=l=>{const c=l.target.result;if(!c)return o(a);function d(m){if(a.push(m),a.length===n)return o(a);c.continue()}const u=c.primaryKey,f=e.byName(u);if(f)return d(f);oa(i,u,m=>{if(m)return d(m);c.continue()})}})}const Ah="";function XH(t,e){const n=new Map;for(const i of t){const r=e(i);for(const o of r){let a=n;for(let c=0;c<o.length;c++){const d=o.charAt(c);let u=a.get(d);u||(u=new Map,a.set(d,u)),a=u}let l=a.get(Ah);l||(l=[],a.set(Ah,l)),l.push(i)}}return(i,r)=>{let o=n;for(let c=0;c<i.length;c++){const d=i.charAt(c),u=o.get(d);if(u)o=u;else return[]}if(r)return o.get(Ah)||[];const a=[],l=[o];for(;l.length;){const d=[...l.shift().entries()].sort((u,f)=>u[0]<f[0]?-1:1);for(const[u,f]of d)u===Ah?a.push(...f):l.push(f)}return a}}const QH=["name","url"];function ZH(t){const e=t&&Array.isArray(t),n=e&&t.length&&(!t[0]||QH.some(s=>!(s in t[0])));if(!e||n)throw new Error("Custom emojis are in the wrong format")}function m3(t){ZH(t);const e=(f,m)=>f.name.toLowerCase()<m.name.toLowerCase()?-1:1,n=t.sort(e),i=XH(t,f=>[...new Set((f.shortcodes||[]).map(m=>za(m)).flat())]),r=f=>i(f,!0),o=f=>i(f,!1),a=f=>{const m=za(f),h=m.map((M,k)=>(k<m.length-1?r:o)(M));return nS(h,M=>M.name).sort(e)},l=new Map,c=new Map;for(const f of t){c.set(f.name.toLowerCase(),f);for(const m of f.shortcodes||[])l.set(m.toLowerCase(),f)}return{all:n,search:a,byShortcode:f=>l.get(f.toLowerCase()),byName:f=>c.get(f.toLowerCase())}}function Kl(t){if(!t)return t;if(delete t.tokens,t.skinTones){const e=t.skinTones.length;t.skins=Array(e);for(let n=0;n<e;n++)t.skins[n]={tone:t.skinTones[n],unicode:t.skinUnicodes[n],version:t.skinVersions[n]};delete t.skinTones,delete t.skinUnicodes,delete t.skinVersions}return t}function rS(t){t||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const JH=["annotation","emoji","group","order","tags","version"];function eV(t){if(!t||!Array.isArray(t)||!t[0]||typeof t[0]!="object"||JH.some(e=>!(e in t[0])))throw new Error("Emoji data is in the wrong format")}function oS(t,e){if(Math.floor(t.status/100)!==2)throw new Error("Failed to fetch: "+e+":  "+t.status)}async function tV(t){const e=await fetch(t,{method:"HEAD"});oS(e,t);const n=e.headers.get("etag");return rS(n),n}async function Rp(t){const e=await fetch(t);oS(e,t);const n=e.headers.get("etag");rS(n);const s=await e.json();return eV(s),[n,s]}function nV(t){for(var e="",n=new Uint8Array(t),s=n.byteLength,i=-1;++i<s;)e+=String.fromCharCode(n[i]);return e}function sV(t){for(var e=t.length,n=new ArrayBuffer(e),s=new Uint8Array(n),i=-1;++i<e;)s[i]=t.charCodeAt(i);return n}async function aS(t){const e=JSON.stringify(t),n=sV(e),s=await crypto.subtle.digest("SHA-1",n),i=nV(s);return btoa(i)}async function iV(t,e){let n,s=await tV(e);if(!s){const i=await Rp(e);s=i[0],n=i[1],s||(s=await aS(n))}await VH(t,e,s)||(n||(n=(await Rp(e))[1]),await sS(t,n,e,s))}async function rV(t,e){let[n,s]=await Rp(e);n||(n=await aS(s)),await sS(t,s,e,n)}class lS{constructor({dataSource:e=kH,locale:n=MH,customEmoji:s=[]}={}){this.dataSource=e,this.locale=n,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=m3(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await LH(this._dbName);PH(this._dbName,this._clear);const n=this.dataSource;await HH(e)?await rV(e,n):this._lazyUpdate=iV(e,n)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return I1(e),await this.ready(),f3(await $H(this._db,e)).map(Kl)}async getEmojiBySearchQuery(e){Sh(e),await this.ready();const n=this._custom.search(e),s=f3(await iS(this._db,e)).map(Kl);return[...n,...s]}async getEmojiByShortcode(e){Sh(e),await this.ready();const n=this._custom.byShortcode(e);return n||Kl(await zH(this._db,e))}async getEmojiByUnicodeOrName(e){Sh(e),await this.ready();const n=this._custom.byName(e);return n||Kl(await KH(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await jv(this._db,ml,d3)||0}async setPreferredSkinTone(e){return I1(e),await this.ready(),GH(this._db,ml,d3,e)}async incrementFavoriteEmojiCount(e){return Sh(e),await this.ready(),WH(this._db,e)}async getTopFavoriteEmoji(e){return I1(e),await this.ready(),(await YH(this._db,this._custom,e)).map(Kl)}set customEmoji(e){this._custom=m3(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await Bv(this._dbName)}async delete(){await this._shutdown(),await DH(this._dbName)}}function hu(){}function cS(t){return t()}function p3(){return Object.create(null)}function Zu(t){t.forEach(cS)}function uS(t){return typeof t=="function"}function oV(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Rh;function Yd(t,e){return Rh||(Rh=document.createElement("a")),Rh.href=e,t===Rh.href}function aV(t){return Object.keys(t).length===0}function lV(t){return t&&uS(t.destroy)?t.destroy:hu}function Kt(t,e){t.appendChild(e)}function gi(t,e,n){t.insertBefore(e,n||null)}function _i(t){t.parentNode.removeChild(t)}function Ht(t){return document.createElement(t)}function Ii(t){return document.createTextNode(t)}function ai(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function ue(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ki(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g3(t,e){t.value=e==null?"":e}function gr(t,e,n,s){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let Hv;function Ac(t){Hv=t}const rc=[],Na=[],Qh=[],_3=[],hS=Promise.resolve();let Cp=!1;function dS(){Cp||(Cp=!0,hS.then(fS))}function cV(){return dS(),hS}function Ip(t){Qh.push(t)}const k1=new Set;let Ch=0;function fS(){const t=Hv;do{for(;Ch<rc.length;){const e=rc[Ch];Ch++,Ac(e),uV(e.$$)}for(Ac(null),rc.length=0,Ch=0;Na.length;)Na.pop()();for(let e=0;e<Qh.length;e+=1){const n=Qh[e];k1.has(n)||(k1.add(n),n())}Qh.length=0}while(rc.length);for(;_3.length;)_3.pop()();Cp=!1,k1.clear(),Ac(t)}function uV(t){if(t.fragment!==null){t.update(),Zu(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ip)}}const hV=new Set;function dV(t,e){t&&t.i&&(hV.delete(t),t.i(e))}const fV=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function oc(t,e){t.d(1),e.delete(t.key)}function ac(t,e,n,s,i,r,o,a,l,c,d,u){let f=t.length,m=r.length,h=f;const M={};for(;h--;)M[t[h].key]=h;const k=[],L=new Map,p=new Map;for(h=m;h--;){const B=u(i,r,h),_=n(B);let A=o.get(_);A?s&&A.p(B,e):(A=c(_,B),A.c()),L.set(_,k[h]=A),_ in M&&p.set(_,Math.abs(h-M[_]))}const I=new Set,D=new Set;function x(B){dV(B,1),B.m(a,d),o.set(B.key,B),d=B.first,m--}for(;f&&m;){const B=k[m-1],_=t[f-1],A=B.key,T=_.key;B===_?(d=B.first,f--,m--):L.has(T)?!o.has(A)||I.has(A)?x(B):D.has(T)?f--:p.get(A)>p.get(T)?(D.add(A),x(B)):(I.add(T),f--):(l(_,o),f--)}for(;f--;){const B=t[f];L.has(B.key)||l(B,o)}for(;m;)x(k[m-1]);return k}function mV(t,e,n,s){const{fragment:i,on_mount:r,on_destroy:o,after_update:a}=t.$$;i&&i.m(e,n),s||Ip(()=>{const l=r.map(cS).filter(uS);o?o.push(...l):Zu(l),t.$$.on_mount=[]}),a.forEach(Ip)}function pV(t,e){const n=t.$$;n.fragment!==null&&(Zu(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function gV(t,e){t.$$.dirty[0]===-1&&(rc.push(t),dS(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function _V(t,e,n,s,i,r,o,a=[-1]){const l=Hv;Ac(t);const c=t.$$={fragment:null,ctx:null,props:r,update:hu,not_equal:i,bound:p3(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:p3(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let d=!1;c.ctx=n?n(t,e.props||{},(u,f,...m)=>{const h=m.length?m[0]:f;return c.ctx&&i(c.ctx[u],c.ctx[u]=h)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](h),d&&gV(t,u)),f}):[],c.update(),d=!0,Zu(c.before_update),c.fragment=s?s(c.ctx):!1,e.target&&(c.fragment&&c.fragment.c(),mV(t,e.target,void 0,void 0),fS()),Ac(l)}class vV{$destroy(){pV(this,1),this.$destroy=hu}$on(e,n){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!aV(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const mS=[[-1,"\u2728","custom"],[0,"\u{1F600}","smileys-emotion"],[1,"\u{1F44B}","people-body"],[3,"\u{1F431}","animals-nature"],[4,"\u{1F34E}","food-drink"],[5,"\u{1F3E0}\uFE0F","travel-places"],[6,"\u26BD","activities"],[7,"\u{1F4DD}","objects"],[8,"\u26D4\uFE0F","symbols"],[9,"\u{1F3C1}","flags"]].map(([t,e,n])=>({id:t,emoji:e,name:n})),Ih=mS.slice(1),yV=mS[0],bV=2,v3=6,pS=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function y3(t){return t.unicode.includes("\u200D")}const wV={"\u{1FAE0}":14,"\u{1F972}":13.1,"\u{1F97B}":12.1,"\u{1F970}":11,"\u{1F929}":5,"\u{1F471}\u200D\u2640\uFE0F":4,"\u{1F923}":3,"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":2,"\u{1F600}":1,"\u{1F610}\uFE0F":.7,"\u{1F603}":.6},EV=1e3,TV="\u{1F590}\uFE0F",SV=8,AV=["\u{1F60A}","\u{1F612}","\u2665\uFE0F","\u{1F44D}\uFE0F","\u{1F60D}","\u{1F602}","\u{1F62D}","\u263A\uFE0F","\u{1F614}","\u{1F629}","\u{1F60F}","\u{1F495}","\u{1F64C}","\u{1F618}"],gS='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',RV=(t,e)=>t<e?-1:t>e?1:0,b3=(t,e)=>{const n=document.createElement("canvas");n.width=n.height=1;const s=n.getContext("2d");return s.textBaseline="top",s.font=`100px ${gS}`,s.fillStyle=e,s.scale(.01,.01),s.fillText(t,0,0),s.getImageData(0,0,1,1).data},CV=(t,e)=>{const n=[...t].join(","),s=[...e].join(",");return n===s&&!n.startsWith("0,0,0,")};function IV(t){const e=b3(t,"#000"),n=b3(t,"#fff");return e&&n&&CV(e,n)}function kV(){const t=Object.entries(wV);try{for(const[e,n]of t)if(IV(e))return n}catch{}finally{}return t[0][1]}const M1=new Promise(t=>pS(()=>t(kV()))),kp=new Map,MV="\uFE0F",xV="\uD83C",OV="\u200D",NV=127995,LV=57339;function DV(t,e){if(e===0)return t;const n=t.indexOf(OV);return n!==-1?t.substring(0,n)+String.fromCodePoint(NV+e-1)+t.substring(n):(t.endsWith(MV)&&(t=t.substring(0,t.length-1)),t+xV+String.fromCodePoint(LV+e-1))}function _r(t){t.preventDefault(),t.stopPropagation()}function x1(t,e,n){return e+=t?-1:1,e<0?e=n.length-1:e>=n.length&&(e=0),e}function _S(t,e){const n=new Set,s=[];for(const i of t){const r=e(i);n.has(r)||(n.add(r),s.push(i))}return s}function PV(t,e){const n=s=>{const i={};for(const r of s)typeof r.tone=="number"&&r.version<=e&&(i[r.tone]=r.unicode);return i};return t.map(({unicode:s,skins:i,shortcodes:r,url:o,name:a,category:l})=>({unicode:s,name:a,shortcodes:r,url:o,category:l,id:s||a,skins:i&&n(i),title:(r||[]).join(", ")}))}const Zh=requestAnimationFrame;let FV=typeof ResizeObserver=="function";function BV(t,e){let n;return FV?(n=new ResizeObserver(s=>e(s[0].contentRect.width)),n.observe(t)):Zh(()=>e(t.getBoundingClientRect().width)),{destroy(){n&&n.disconnect()}}}function w3(t){{const e=document.createRange();return e.selectNode(t.firstChild),e.getBoundingClientRect().width}}let O1;function UV(t,e,n){for(const s of t){const i=n(s),r=w3(i);typeof O1=="undefined"&&(O1=w3(e));const o=r/1.8<O1;kp.set(s.unicode,o)}}function jV(t){return _S(t,e=>e)}const{Map:lc}=fV;function E3(t,e,n){const s=t.slice();return s[63]=e[n],s[65]=n,s}function T3(t,e,n){const s=t.slice();return s[66]=e[n],s[65]=n,s}function S3(t,e,n){const s=t.slice();return s[63]=e[n],s[65]=n,s}function A3(t,e,n){const s=t.slice();return s[69]=e[n],s}function R3(t,e,n){const s=t.slice();return s[72]=e[n],s[65]=n,s}function C3(t,e){let n,s=e[72]+"",i,r,o,a,l,c;return{key:t,first:null,c(){n=Ht("div"),i=Ii(s),ue(n,"id",r="skintone-"+e[65]),ue(n,"class",o="emoji hide-focus "+(e[65]===e[20]?"active":"")),ue(n,"aria-selected",a=e[65]===e[20]),ue(n,"role","option"),ue(n,"title",l=e[0].skinTones[e[65]]),ue(n,"tabindex","-1"),ue(n,"aria-label",c=e[0].skinTones[e[65]]),this.first=n},m(d,u){gi(d,n,u),Kt(n,i)},p(d,u){e=d,u[0]&512&&s!==(s=e[72]+"")&&ki(i,s),u[0]&512&&r!==(r="skintone-"+e[65])&&ue(n,"id",r),u[0]&1049088&&o!==(o="emoji hide-focus "+(e[65]===e[20]?"active":""))&&ue(n,"class",o),u[0]&1049088&&a!==(a=e[65]===e[20])&&ue(n,"aria-selected",a),u[0]&513&&l!==(l=e[0].skinTones[e[65]])&&ue(n,"title",l),u[0]&513&&c!==(c=e[0].skinTones[e[65]])&&ue(n,"aria-label",c)},d(d){d&&_i(n)}}}function I3(t,e){let n,s,i=e[69].emoji+"",r,o,a,l,c,d,u;function f(){return e[49](e[69])}return{key:t,first:null,c(){n=Ht("button"),s=Ht("div"),r=Ii(i),ue(s,"class","nav-emoji emoji"),ue(n,"role","tab"),ue(n,"class","nav-button"),ue(n,"aria-controls",o="tab-"+e[69].id),ue(n,"aria-label",a=e[0].categories[e[69].name]),ue(n,"aria-selected",l=!e[4]&&e[13].id===e[69].id),ue(n,"title",c=e[0].categories[e[69].name]),this.first=n},m(m,h){gi(m,n,h),Kt(n,s),Kt(s,r),d||(u=ai(n,"click",f),d=!0)},p(m,h){e=m,h[0]&4096&&i!==(i=e[69].emoji+"")&&ki(r,i),h[0]&4096&&o!==(o="tab-"+e[69].id)&&ue(n,"aria-controls",o),h[0]&4097&&a!==(a=e[0].categories[e[69].name])&&ue(n,"aria-label",a),h[0]&12304&&l!==(l=!e[4]&&e[13].id===e[69].id)&&ue(n,"aria-selected",l),h[0]&4097&&c!==(c=e[0].categories[e[69].name])&&ue(n,"title",c)},d(m){m&&_i(n),d=!1,u()}}}function HV(t){let e,n;return{c(){e=Ht("img"),ue(e,"class","custom-emoji"),Yd(e.src,n=t[63].url)||ue(e,"src",n),ue(e,"alt",""),ue(e,"loading","lazy")},m(s,i){gi(s,e,i)},p(s,i){i[0]&32768&&!Yd(e.src,n=s[63].url)&&ue(e,"src",n)},d(s){s&&_i(e)}}}function VV(t){let e=t[27](t[63],t[8])+"",n;return{c(){n=Ii(e)},m(s,i){gi(s,n,i)},p(s,i){i[0]&33024&&e!==(e=s[27](s[63],s[8])+"")&&ki(n,e)},d(s){s&&_i(n)}}}function k3(t,e){let n,s,i,r,o,a,l;function c(f,m){return f[63].unicode?VV:HV}let d=c(e),u=d(e);return{key:t,first:null,c(){n=Ht("button"),u.c(),ue(n,"role",s=e[4]?"option":"menuitem"),ue(n,"aria-selected",i=e[4]?e[65]==e[5]:""),ue(n,"aria-label",r=e[28](e[63],e[8])),ue(n,"title",o=e[63].title),ue(n,"class",a="emoji "+(e[4]&&e[65]===e[5]?"active":"")),ue(n,"id",l="emo-"+e[63].id),this.first=n},m(f,m){gi(f,n,m),u.m(n,null)},p(f,m){e=f,d===(d=c(e))&&u?u.p(e,m):(u.d(1),u=d(e),u&&(u.c(),u.m(n,null))),m[0]&16&&s!==(s=e[4]?"option":"menuitem")&&ue(n,"role",s),m[0]&32816&&i!==(i=e[4]?e[65]==e[5]:"")&&ue(n,"aria-selected",i),m[0]&33024&&r!==(r=e[28](e[63],e[8]))&&ue(n,"aria-label",r),m[0]&32768&&o!==(o=e[63].title)&&ue(n,"title",o),m[0]&32816&&a!==(a="emoji "+(e[4]&&e[65]===e[5]?"active":""))&&ue(n,"class",a),m[0]&32768&&l!==(l="emo-"+e[63].id)&&ue(n,"id",l)},d(f){f&&_i(n),u.d()}}}function M3(t,e){let n,s=(e[4]?e[0].searchResultsLabel:e[66].category?e[66].category:e[15].length>1?e[0].categories.custom:e[0].categories[e[13].name])+"",i,r,o,a,l=[],c=new lc,d,u,f,m=e[66].emojis;const h=M=>M[63].id;for(let M=0;M<m.length;M+=1){let k=S3(e,m,M),L=h(k);c.set(L,l[M]=k3(L,k))}return{key:t,first:null,c(){n=Ht("div"),i=Ii(s),a=Ht("div");for(let M=0;M<l.length;M+=1)l[M].c();ue(n,"id",r="menu-label-"+e[65]),ue(n,"class",o="category "+(e[15].length===1&&e[15][0].category===""?"gone":"")),ue(n,"aria-hidden","true"),ue(a,"class","emoji-menu"),ue(a,"role",d=e[4]?"listbox":"menu"),ue(a,"aria-labelledby",u="menu-label-"+e[65]),ue(a,"id",f=e[4]?"search-results":""),this.first=n},m(M,k){gi(M,n,k),Kt(n,i),gi(M,a,k);for(let L=0;L<l.length;L+=1)l[L].m(a,null)},p(M,k){e=M,k[0]&40977&&s!==(s=(e[4]?e[0].searchResultsLabel:e[66].category?e[66].category:e[15].length>1?e[0].categories.custom:e[0].categories[e[13].name])+"")&&ki(i,s),k[0]&32768&&r!==(r="menu-label-"+e[65])&&ue(n,"id",r),k[0]&32768&&o!==(o="category "+(e[15].length===1&&e[15][0].category===""?"gone":""))&&ue(n,"class",o),k[0]&402686256&&(m=e[66].emojis,l=ac(l,k,h,1,e,m,c,a,oc,k3,null,S3)),k[0]&16&&d!==(d=e[4]?"listbox":"menu")&&ue(a,"role",d),k[0]&32768&&u!==(u="menu-label-"+e[65])&&ue(a,"aria-labelledby",u),k[0]&16&&f!==(f=e[4]?"search-results":"")&&ue(a,"id",f)},d(M){M&&_i(n),M&&_i(a);for(let k=0;k<l.length;k+=1)l[k].d()}}}function qV(t){let e,n;return{c(){e=Ht("img"),ue(e,"class","custom-emoji"),Yd(e.src,n=t[63].url)||ue(e,"src",n),ue(e,"alt",""),ue(e,"loading","lazy")},m(s,i){gi(s,e,i)},p(s,i){i[0]&1024&&!Yd(e.src,n=s[63].url)&&ue(e,"src",n)},d(s){s&&_i(e)}}}function $V(t){let e=t[27](t[63],t[8])+"",n;return{c(){n=Ii(e)},m(s,i){gi(s,n,i)},p(s,i){i[0]&1280&&e!==(e=s[27](s[63],s[8])+"")&&ki(n,e)},d(s){s&&_i(n)}}}function x3(t,e){let n,s,i,r;function o(c,d){return c[63].unicode?$V:qV}let a=o(e),l=a(e);return{key:t,first:null,c(){n=Ht("button"),l.c(),ue(n,"role","menuitem"),ue(n,"aria-label",s=e[28](e[63],e[8])),ue(n,"title",i=e[63].title),ue(n,"class","emoji"),ue(n,"id",r="fav-"+e[63].id),this.first=n},m(c,d){gi(c,n,d),l.m(n,null)},p(c,d){e=c,a===(a=o(e))&&l?l.p(e,d):(l.d(1),l=a(e),l&&(l.c(),l.m(n,null))),d[0]&1280&&s!==(s=e[28](e[63],e[8]))&&ue(n,"aria-label",s),d[0]&1024&&i!==(i=e[63].title)&&ue(n,"title",i),d[0]&1024&&r!==(r="fav-"+e[63].id)&&ue(n,"id",r)},d(c){c&&_i(n),l.d()}}}function zV(t){let e,n,s,i,r,o,a,l,c,d=t[0].searchLabel+"",u,f,m=t[0].searchDescription+"",h,M,k,L,p,I,D,x=t[0].skinToneDescription+"",B,_,A=[],T=new lc,v,w,b,y,R,S=[],U=new lc,W,j,z,g,C,te,se,Te,ke=[],Oe=new lc,be,ze,Be,we,Xe,mt=[],E=new lc,O,V,$,K,ne,le,Q=t[9];const ie=ce=>ce[72];for(let ce=0;ce<Q.length;ce+=1){let _e=R3(t,Q,ce),Z=ie(_e);T.set(Z,A[ce]=C3(Z,_e))}let X=t[12];const ve=ce=>ce[69].id;for(let ce=0;ce<X.length;ce+=1){let _e=A3(t,X,ce),Z=ve(_e);U.set(Z,S[ce]=I3(Z,_e))}let de=t[15];const ye=ce=>ce[66].category;for(let ce=0;ce<de.length;ce+=1){let _e=T3(t,de,ce),Z=ye(_e);Oe.set(Z,ke[ce]=M3(Z,_e))}let Ie=t[10];const De=ce=>ce[63].id;for(let ce=0;ce<Ie.length;ce+=1){let _e=E3(t,Ie,ce),Z=De(_e);E.set(Z,mt[ce]=x3(Z,_e))}return{c(){e=Ht("section"),n=Ht("div"),s=Ht("div"),i=Ht("div"),r=Ht("input"),c=Ht("label"),u=Ii(d),f=Ht("span"),h=Ii(m),M=Ht("div"),k=Ht("button"),L=Ii(t[21]),D=Ht("span"),B=Ii(x),_=Ht("div");for(let ce=0;ce<A.length;ce+=1)A[ce].c();R=Ht("div");for(let ce=0;ce<S.length;ce+=1)S[ce].c();j=Ht("div"),z=Ht("div"),g=Ht("div"),C=Ii(t[18]),se=Ht("div"),Te=Ht("div");for(let ce=0;ce<ke.length;ce+=1)ke[ce].c();Xe=Ht("div");for(let ce=0;ce<mt.length;ce+=1)mt[ce].c();$=Ht("button"),$.textContent="\u{1F600}",ue(n,"class","pad-top"),ue(r,"id","search"),ue(r,"class","search"),ue(r,"type","search"),ue(r,"role","combobox"),ue(r,"enterkeyhint","search"),ue(r,"placeholder",o=t[0].searchLabel),ue(r,"autocapitalize","none"),ue(r,"autocomplete","off"),ue(r,"spellcheck","true"),ue(r,"aria-expanded",a=!!(t[4]&&t[1].length)),ue(r,"aria-controls","search-results"),ue(r,"aria-describedby","search-description"),ue(r,"aria-autocomplete","list"),ue(r,"aria-activedescendant",l=t[26]?`emo-${t[26]}`:""),ue(c,"class","sr-only"),ue(c,"for","search"),ue(f,"id","search-description"),ue(f,"class","sr-only"),ue(i,"class","search-wrapper"),ue(k,"id","skintone-button"),ue(k,"class",p="emoji "+(t[6]?"hide-focus":"")),ue(k,"aria-label",t[23]),ue(k,"title",t[23]),ue(k,"aria-describedby","skintone-description"),ue(k,"aria-haspopup","listbox"),ue(k,"aria-expanded",t[6]),ue(k,"aria-controls","skintone-list"),ue(M,"class",I="skintone-button-wrapper "+(t[19]?"expanded":"")),ue(D,"id","skintone-description"),ue(D,"class","sr-only"),ue(_,"id","skintone-list"),ue(_,"class",v="skintone-list "+(t[6]?"":"hidden no-animate")),gr(_,"transform","translateY("+(t[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ue(_,"role","listbox"),ue(_,"aria-label",w=t[0].skinTonesLabel),ue(_,"aria-activedescendant",b="skintone-"+t[20]),ue(_,"aria-hidden",y=!t[6]),ue(s,"class","search-row"),ue(R,"class","nav"),ue(R,"role","tablist"),gr(R,"grid-template-columns","repeat("+t[12].length+", 1fr)"),ue(R,"aria-label",W=t[0].categoriesLabel),ue(z,"class","indicator"),gr(z,"transform","translateX("+(t[24]?-1:1)*t[11]*100+"%)"),ue(j,"class","indicator-wrapper"),ue(g,"class",te="message "+(t[18]?"":"gone")),ue(g,"role","alert"),ue(g,"aria-live","polite"),ue(se,"class",be="tabpanel "+(!t[14]||t[18]?"gone":"")),ue(se,"role",ze=t[4]?"region":"tabpanel"),ue(se,"aria-label",Be=t[4]?t[0].searchResultsLabel:t[0].categories[t[13].name]),ue(se,"id",we=t[4]?"":`tab-${t[13].id}`),ue(se,"tabindex","0"),ue(Xe,"class",O="favorites emoji-menu "+(t[18]?"gone":"")),ue(Xe,"role","menu"),ue(Xe,"aria-label",V=t[0].favoritesLabel),gr(Xe,"padding-inline-end",t[25]+"px"),ue($,"aria-hidden","true"),ue($,"tabindex","-1"),ue($,"class","abs-pos hidden emoji"),ue(e,"class","picker"),ue(e,"aria-label",K=t[0].regionLabel),ue(e,"style",t[22])},m(ce,_e){gi(ce,e,_e),Kt(e,n),Kt(e,s),Kt(s,i),Kt(i,r),g3(r,t[2]),Kt(i,c),Kt(c,u),Kt(i,f),Kt(f,h),Kt(s,M),Kt(M,k),Kt(k,L),Kt(s,D),Kt(D,B),Kt(s,_);for(let Z=0;Z<A.length;Z+=1)A[Z].m(_,null);t[48](_),Kt(e,R);for(let Z=0;Z<S.length;Z+=1)S[Z].m(R,null);Kt(e,j),Kt(j,z),Kt(e,g),Kt(g,C),Kt(e,se),Kt(se,Te);for(let Z=0;Z<ke.length;Z+=1)ke[Z].m(Te,null);t[50](se),Kt(e,Xe);for(let Z=0;Z<mt.length;Z+=1)mt[Z].m(Xe,null);Kt(e,$),t[51]($),t[52](e),ne||(le=[ai(r,"input",t[47]),ai(r,"keydown",t[30]),ai(k,"click",t[35]),ai(_,"focusout",t[38]),ai(_,"click",t[34]),ai(_,"keydown",t[36]),ai(_,"keyup",t[37]),ai(R,"keydown",t[32]),lV(t[29].call(null,Te)),ai(se,"click",t[33]),ai(Xe,"click",t[33])],ne=!0)},p(ce,_e){_e[0]&1&&o!==(o=ce[0].searchLabel)&&ue(r,"placeholder",o),_e[0]&18&&a!==(a=!!(ce[4]&&ce[1].length))&&ue(r,"aria-expanded",a),_e[0]&67108864&&l!==(l=ce[26]?`emo-${ce[26]}`:"")&&ue(r,"aria-activedescendant",l),_e[0]&4&&g3(r,ce[2]),_e[0]&1&&d!==(d=ce[0].searchLabel+"")&&ki(u,d),_e[0]&1&&m!==(m=ce[0].searchDescription+"")&&ki(h,m),_e[0]&2097152&&ki(L,ce[21]),_e[0]&64&&p!==(p="emoji "+(ce[6]?"hide-focus":""))&&ue(k,"class",p),_e[0]&8388608&&ue(k,"aria-label",ce[23]),_e[0]&8388608&&ue(k,"title",ce[23]),_e[0]&64&&ue(k,"aria-expanded",ce[6]),_e[0]&524288&&I!==(I="skintone-button-wrapper "+(ce[19]?"expanded":""))&&ue(M,"class",I),_e[0]&1&&x!==(x=ce[0].skinToneDescription+"")&&ki(B,x),_e[0]&1049089&&(Q=ce[9],A=ac(A,_e,ie,1,ce,Q,T,_,oc,C3,null,R3)),_e[0]&64&&v!==(v="skintone-list "+(ce[6]?"":"hidden no-animate"))&&ue(_,"class",v),_e[0]&64&&gr(_,"transform","translateY("+(ce[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),_e[0]&1&&w!==(w=ce[0].skinTonesLabel)&&ue(_,"aria-label",w),_e[0]&1048576&&b!==(b="skintone-"+ce[20])&&ue(_,"aria-activedescendant",b),_e[0]&64&&y!==(y=!ce[6])&&ue(_,"aria-hidden",y),_e[0]&12305|_e[1]&1&&(X=ce[12],S=ac(S,_e,ve,1,ce,X,U,R,oc,I3,null,A3)),_e[0]&4096&&gr(R,"grid-template-columns","repeat("+ce[12].length+", 1fr)"),_e[0]&1&&W!==(W=ce[0].categoriesLabel)&&ue(R,"aria-label",W),_e[0]&16779264&&gr(z,"transform","translateX("+(ce[24]?-1:1)*ce[11]*100+"%)"),_e[0]&262144&&ki(C,ce[18]),_e[0]&262144&&te!==(te="message "+(ce[18]?"":"gone"))&&ue(g,"class",te),_e[0]&402694449&&(de=ce[15],ke=ac(ke,_e,ye,1,ce,de,Oe,Te,oc,M3,null,T3)),_e[0]&278528&&be!==(be="tabpanel "+(!ce[14]||ce[18]?"gone":""))&&ue(se,"class",be),_e[0]&16&&ze!==(ze=ce[4]?"region":"tabpanel")&&ue(se,"role",ze),_e[0]&8209&&Be!==(Be=ce[4]?ce[0].searchResultsLabel:ce[0].categories[ce[13].name])&&ue(se,"aria-label",Be),_e[0]&8208&&we!==(we=ce[4]?"":`tab-${ce[13].id}`)&&ue(se,"id",we),_e[0]&402654464&&(Ie=ce[10],mt=ac(mt,_e,De,1,ce,Ie,E,Xe,oc,x3,null,E3)),_e[0]&262144&&O!==(O="favorites emoji-menu "+(ce[18]?"gone":""))&&ue(Xe,"class",O),_e[0]&1&&V!==(V=ce[0].favoritesLabel)&&ue(Xe,"aria-label",V),_e[0]&33554432&&gr(Xe,"padding-inline-end",ce[25]+"px"),_e[0]&1&&K!==(K=ce[0].regionLabel)&&ue(e,"aria-label",K),_e[0]&4194304&&ue(e,"style",ce[22])},i:hu,o:hu,d(ce){ce&&_i(e);for(let _e=0;_e<A.length;_e+=1)A[_e].d();t[48](null);for(let _e=0;_e<S.length;_e+=1)S[_e].d();for(let _e=0;_e<ke.length;_e+=1)ke[_e].d();t[50](null);for(let _e=0;_e<mt.length;_e+=1)mt[_e].d();t[51](null),t[52](null),ne=!1,Zu(le)}}}function KV(t,e,n){let{skinToneEmoji:s}=e,{i18n:i}=e,{database:r}=e,{customEmoji:o}=e,{customCategorySorting:a}=e,l=!0,c=[],d=[],u="",f="",m,h,M,k=!1,L=-1,p,I=!1,D=!1,x,B=0,_=0,A,T,v="",w=[],b=[],y,R=SV,S=!1,U=0,W=0,j=Ih,z,g=!1,C;const te=Z=>{m.getRootNode().getElementById(Z).focus()},se=(Z,Me)=>{m.dispatchEvent(new CustomEvent(Z,{detail:Me,bubbles:!0,composed:!0}))},Te=(Z,Me)=>Me&&Z.skins&&Z.skins[Me]||Z.unicode,ke=(Z,Me)=>jV([Z.name||Te(Z,Me),...Z.shortcodes||[]]).join(", "),Oe=Z=>/^skintone-/.test(Z.id);M1.then(Z=>{Z||n(18,p=i.emojiUnsupportedMessage)});function be(Z){return BV(Z,Me=>{{const N=getComputedStyle(m),F=parseInt(N.getPropertyValue("--num-columns"),10),q=N.getPropertyValue("direction")==="rtl",Y=Z.parentElement.getBoundingClientRect().width-Me;n(46,R=F),n(25,U=Y),n(24,S=q)}})}function ze(Z){const Me=m.getRootNode();UV(Z,h,F=>Me.getElementById(`emo-${F.id}`)),n(1,c=c)}function Be(Z){return!Z.unicode||!y3(Z)||kp.get(Z.unicode)}async function we(Z){const Me=await M1;return Z.filter(({version:N})=>!N||N<=Me)}async function Xe(Z){return PV(Z,await M1)}async function mt(Z){if(typeof Z=="undefined")return[];const Me=Z===-1?o:await r.getEmojiByGroup(Z);return Xe(await we(Me))}async function E(Z){return Xe(await we(await r.getEmojiBySearchQuery(Z)))}function O(Z){if(!k||!c.length)return;const Me=N=>{_r(Z),n(5,L=x1(N,L,c))};switch(Z.key){case"ArrowDown":return Me(!1);case"ArrowUp":return Me(!0);case"Enter":if(L!==-1)return _r(Z),K(c[L].id);c.length&&n(5,L=0)}}function V(Z){n(2,u=""),n(44,f=""),n(5,L=-1),n(11,W=j.findIndex(Me=>Me.id===Z.id))}function $(Z){const{target:Me,key:N}=Z,F=q=>{q&&(_r(Z),q.focus())};switch(N){case"ArrowLeft":return F(Me.previousSibling);case"ArrowRight":return F(Me.nextSibling);case"Home":return F(Me.parentElement.firstChild);case"End":return F(Me.parentElement.lastChild)}}async function K(Z){const Me=await r.getEmojiByUnicodeOrName(Z),N=[...c,...b].find(q=>q.id===Z),F=N.unicode&&Te(N,B);await r.incrementFavoriteEmojiCount(Z),se("emoji-click",{emoji:Me,skinTone:B,...F&&{unicode:F},...N.name&&{name:N.name}})}async function ne(Z){const{target:Me}=Z;if(!Me.classList.contains("emoji"))return;_r(Z);const N=Me.id.substring(4);K(N)}async function le(Z){const{target:Me}=Z;if(!Oe(Me))return;_r(Z);const N=parseInt(Me.id.slice(9),10);n(8,B=N),n(6,I=!1),te("skintone-button"),se("skin-tone-change",{skinTone:N}),r.setPreferredSkinTone(N)}async function Q(Z){n(6,I=!I),n(20,_=B),I&&(_r(Z),Zh(()=>te(`skintone-${_}`)))}function ie(Z){if(!I)return;const Me=async N=>{_r(Z),n(20,_=N),await cV(),te(`skintone-${_}`)};switch(Z.key){case"ArrowUp":return Me(x1(!0,_,w));case"ArrowDown":return Me(x1(!1,_,w));case"Home":return Me(0);case"End":return Me(w.length-1);case"Enter":return le(Z);case"Escape":return _r(Z),n(6,I=!1),te("skintone-button")}}function X(Z){if(!!I)switch(Z.key){case" ":return le(Z)}}async function ve(Z){const{relatedTarget:Me}=Z;(!Me||!Oe(Me))&&n(6,I=!1)}function de(){u=this.value,n(2,u)}function ye(Z){Na[Z?"unshift":"push"](()=>{x=Z,n(7,x)})}const Ie=Z=>V(Z);function De(Z){Na[Z?"unshift":"push"](()=>{M=Z,n(3,M)})}function ce(Z){Na[Z?"unshift":"push"](()=>{h=Z,n(17,h)})}function _e(Z){Na[Z?"unshift":"push"](()=>{m=Z,n(16,m)})}return t.$$set=Z=>{"skinToneEmoji"in Z&&n(40,s=Z.skinToneEmoji),"i18n"in Z&&n(0,i=Z.i18n),"database"in Z&&n(39,r=Z.database),"customEmoji"in Z&&n(41,o=Z.customEmoji),"customCategorySorting"in Z&&n(42,a=Z.customCategorySorting)},t.$$.update=()=>{if(t.$$.dirty[1]&1280&&o&&r&&n(39,r.customEmoji=o,r),t.$$.dirty[0]&1|t.$$.dirty[1]&256){async function Z(){let Me=!1;const N=setTimeout(()=>{Me=!0,n(18,p=i.loadingMessage)},EV);try{await r.ready(),n(14,g=!0)}catch(F){console.error(F),n(18,p=i.networkErrorMessage)}finally{clearTimeout(N),Me&&(Me=!1,n(18,p=""))}}r&&Z()}if(t.$$.dirty[0]&6144|t.$$.dirty[1]&1024&&(o&&o.length?n(12,j=[yV,...Ih]):j!==Ih&&(W&&n(11,W--,W),n(12,j=Ih))),t.$$.dirty[0]&4&&pS(()=>{n(44,f=(u||"").trim()),n(5,L=-1)}),t.$$.dirty[0]&6144&&n(13,z=j[W]),t.$$.dirty[0]&24576|t.$$.dirty[1]&8192){async function Z(){if(!g)n(1,c=[]),n(4,k=!1);else if(f.length>=bV){const Me=f,N=await E(Me);Me===f&&(n(1,c=N),n(4,k=!0))}else if(z){const Me=z.id,N=await mt(Me);Me===z.id&&(n(1,c=N),n(4,k=!1))}}Z()}if(t.$$.dirty[0]&4112&&n(22,T=`
  --font-family: ${gS};
  --num-groups: ${j.length}; 
  --indicator-opacity: ${k?0:1}; 
  --num-skintones: ${v3};`),t.$$.dirty[0]&16384|t.$$.dirty[1]&256){async function Z(){g&&n(8,B=await r.getPreferredSkinTone())}Z()}if(t.$$.dirty[1]&512&&n(9,w=Array(v3).fill().map((Z,Me)=>DV(s,Me))),t.$$.dirty[0]&768&&n(21,A=w[B]),t.$$.dirty[0]&257&&n(23,v=i.skinToneLabel.replace("{skinTone}",i.skinTones[B])),t.$$.dirty[0]&16384|t.$$.dirty[1]&256){async function Z(){n(45,y=(await Promise.all(AV.map(Me=>r.getEmojiByUnicodeOrName(Me)))).filter(Boolean))}g&&Z()}if(t.$$.dirty[0]&16384|t.$$.dirty[1]&49408){async function Z(){const Me=await r.getTopFavoriteEmoji(R),N=await Xe(_S([...Me,...y],F=>F.unicode||F.name).slice(0,R));n(10,b=N)}g&&y&&Z()}if(t.$$.dirty[0]&10){const Z=c.filter(Me=>Me.unicode).filter(Me=>y3(Me)&&!kp.has(Me.unicode));Z.length?Zh(()=>ze(Z)):(n(1,c=c.filter(Be)),Zh(()=>{(M||{}).scrollTop=0}))}t.$$.dirty[0]&1026|t.$$.dirty[1]&4096,t.$$.dirty[0]&18|t.$$.dirty[1]&2048&&n(15,d=function(){if(k)return[{category:"",emojis:c}];const Me=new Map;for(const N of c){const F=N.category||"";let q=Me.get(F);q||(q=[],Me.set(F,q)),q.push(N)}return[...Me.entries()].map(([N,F])=>({category:N,emojis:F})).sort((N,F)=>a(N.category,F.category))}()),t.$$.dirty[0]&34&&n(26,C=L!==-1&&c[L].id),t.$$.dirty[0]&192&&(I?x.addEventListener("transitionend",()=>{n(19,D=!0)},{once:!0}):n(19,D=!1))},[i,c,u,M,k,L,I,x,B,w,b,W,j,z,g,d,m,h,p,D,_,A,T,v,S,U,C,Te,ke,be,O,V,$,ne,le,Q,ie,X,ve,r,s,o,a,l,f,y,R,de,ye,Ie,De,ce,_e]}class GV extends vV{constructor(e){super(),_V(this,e,KV,zV,oV,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const WV="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",YV="en";var XV={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading\u2026",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const vS=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class yS extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const n=document.createElement("style");n.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(n),this._ctx={locale:YV,dataSource:WV,skinToneEmoji:TV,customCategorySorting:RV,customEmoji:null,i18n:XV,...e};for(const s of vS)s!=="database"&&Object.prototype.hasOwnProperty.call(this,s)&&(this._ctx[s]=this[s],delete this[s]);this._dbFlush()}connectedCallback(){this._cmp=new GV({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch(n=>console.error(n))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,n,s){this._set(e.replace(/-([a-z])/g,(i,r)=>r.toUpperCase()),s)}_set(e,n){this._ctx[e]=n,this._cmp&&this._cmp.$set({[e]:n}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:n,database:s}=this._ctx;(!s||s.locale!==e||s.dataSource!==n)&&this._set("database",new lS({locale:e,dataSource:n}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const bS={};for(const t of vS)bS[t]={get(){return t==="database"&&this._dbCreate(),this._ctx[t]},set(e){if(t==="database")throw new Error("database is read-only");this._set(t,e)}};Object.defineProperties(yS.prototype,bS);customElements.get("emoji-picker")||customElements.define("emoji-picker",yS);function wS(t,e){for(;t&&!t.querySelector(e);){t=t.parentNode;const n=t.querySelector(e);if(n)return n}return null}const QV={name:"EmojiPickerContainer",components:{SvgIcon:Un},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(t){t&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})})},0)}},methods:{addCustomStyling(){const t=`.picker {
				border: none;
			}`,e=`.nav {
				overflow-x: auto;
			}`,n=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,s=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,i=document.createElement("style");i.textContent=t+e+n+s,this.$refs.emojiPicker.shadowRoot.appendChild(i)},openEmoji(t){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(t.clientY,t.view.innerWidth,t.view.innerHeight)},setEmojiPickerPosition(t,e,n){const s=e<500||n<700,i=wS(this.$el,"#room-footer");if(!i){s&&(this.emojiPickerRight="-50px");return}s?(this.emojiPickerRight=e/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200):(i.getBoundingClientRect().top-t>this.emojiPickerHeight-50?this.emojiPickerTop=t+10:this.emojiPickerTop=t-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},ZV={class:"vac-emoji-wrapper"};function JV(t,e,n,s,i,r){const o=Je("svg-icon"),a=Je("emoji-picker");return re(),ge("div",ZV,[Ce("div",{class:pt(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:e[0]||(e[0]=(...l)=>r.openEmoji&&r.openEmoji(...l))},[Fe(t.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},()=>[He(o,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])])],2),n.emojiOpened?(re(),Pt(gn,{key:0,name:"vac-slide-up",appear:""},{default:et(()=>[Ce("div",{class:pt(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:en({height:`${i.emojiPickerHeight}px`,top:n.positionTop?i.emojiPickerHeight:`${i.emojiPickerTop}px`,right:i.emojiPickerRight,display:i.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(re(),Pt(a,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):Le("",!0)],6)]),_:1})):Le("",!0)])}var ES=Xt(QV,[["render",JV]]);const eq={name:"RoomFiles",components:{Loader:vm,SvgIcon:Un},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return fl(this.file)},isVideo(){return Qu(this.file)}}},tq={class:"vac-room-file-container"},nq=["src"],sq={class:"vac-text-ellipsis"},iq={key:0,class:"vac-text-ellipsis vac-text-extension"};function rq(t,e,n,s,i,r){const o=Je("loader"),a=Je("svg-icon");return re(),ge("div",tq,[He(o,{show:n.file.loading,type:"room-file"},$t({_:2},[ht(t.$slots,(l,c)=>({name:c,fn:et(d=>[Fe(t.$slots,c,qt(Bt(d)))])}))]),1032,["show"]),Ce("div",{class:"vac-svg-button vac-icon-remove",onClick:e[0]||(e[0]=l=>t.$emit("remove-file",n.index))},[Fe(t.$slots,"image-close-icon",{},()=>[He(a,{name:"close",param:"image"})])]),r.isImage?(re(),ge("div",{key:0,class:pt(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:en({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):r.isVideo?(re(),ge("video",{key:1,controls:"",class:pt({"vac-blur-loading":n.file.loading})},[Ce("source",{src:n.file.localUrl||n.file.url},null,8,nq)],2)):(re(),ge("div",{key:2,class:pt(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[Ce("div",null,[Fe(t.$slots,"file-icon",{},()=>[He(a,{name:"file"})])]),Ce("div",sq,ot(n.file.name),1),n.file.extension?(re(),ge("div",iq,ot(n.file.extension),1)):Le("",!0)],2))])}var oq=Xt(eq,[["render",rq]]);const aq={name:"RoomFiles",components:{SvgIcon:Un,RoomFile:oq},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},lq={key:0,class:"vac-room-files-container"},cq={class:"vac-files-box"},uq={class:"vac-icon-close"};function hq(t,e,n,s,i,r){const o=Je("room-file"),a=Je("svg-icon");return re(),Pt(gn,{name:"vac-slide-up"},{default:et(()=>[n.files.length?(re(),ge("div",lq,[Ce("div",cq,[(re(!0),ge(Ct,null,ht(n.files,(l,c)=>(re(),ge("div",{key:c},[He(o,{file:l,index:c,onRemoveFile:e[0]||(e[0]=d=>t.$emit("remove-file",d))},$t({_:2},[ht(t.$slots,(d,u)=>({name:u,fn:et(f=>[Fe(t.$slots,u,qt(Bt(f)))])}))]),1032,["file","index"])]))),128))]),Ce("div",uq,[Ce("div",{class:"vac-svg-button",onClick:e[1]||(e[1]=l=>t.$emit("reset-message"))},[Fe(t.$slots,"files-close-icon",{},()=>[He(a,{name:"close-outline"})])])])])):Le("",!0)]),_:3})}var dq=Xt(aq,[["render",hq]]);const fq={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(t){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const e=this.calculateLineHeadPosition(t,this.$refs.progress);this.$emit("change-linehead",e),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(t){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const e=this.calculateLineHeadPosition(t,this.$refs.progress);this.$emit("change-linehead",e)},onMouseMove(t){if(this.messageSelectionEnabled)return;const e=this.calculateLineHeadPosition(t,this.$refs.progress);this.$emit("change-linehead",e)},calculateLineHeadPosition(t,e){const n=e.getBoundingClientRect().width,s=e.getBoundingClientRect().left;let i=(t.clientX-s)/n;return i=i<0?0:i,i=i>1?1:i,i}}},mq={class:"vac-player-progress"},pq={class:"vac-line-container"};function gq(t,e,n,s,i,r){return re(),ge("div",{ref:"progress",class:"vac-player-bar",onMousedown:e[0]||(e[0]=(...o)=>r.onMouseDown&&r.onMouseDown(...o)),onMouseover:e[1]||(e[1]=o=>t.$emit("hover-audio-progress",!0)),onMouseout:e[2]||(e[2]=o=>t.$emit("hover-audio-progress",!1))},[Ce("div",mq,[Ce("div",pq,[Ce("div",{class:"vac-line-progress",style:en({width:`${n.percentage}%`})},null,4),Ce("div",{class:pt(["vac-line-dot",{"vac-line-dot__active":i.isMouseDown}]),style:en({left:`${n.percentage}%`})},null,6)])])],544)}var _q=Xt(fq,[["render",gq]]);const vq={name:"AudioPlayer",components:{SvgIcon:Un,AudioControl:_q},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(t){return new Date(t*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(t){t&&(this.player.currentTime=t*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},yq={class:"vac-audio-player"},bq=["id","src"];function wq(t,e,n,s,i,r){const o=Je("svg-icon"),a=Je("audio-control");return re(),ge("div",null,[Ce("div",yq,[Ce("div",{class:"vac-svg-button",onClick:e[0]||(e[0]=(...l)=>r.playback&&r.playback(...l))},[i.isPlaying?Fe(t.$slots,"audio-pause-icon_"+n.messageId,{key:0},()=>[He(o,{name:"audio-pause"})]):Fe(t.$slots,"audio-play-icon_"+n.messageId,{key:1},()=>[He(o,{name:"audio-play"})])]),He(a,{percentage:i.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:r.onUpdateProgress,onHoverAudioProgress:e[1]||(e[1]=l=>t.$emit("hover-audio-progress",l))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Ce("audio",{id:r.playerUniqId,src:r.audioSource},null,8,bq)])])}var Vv=Xt(vq,[["render",wq]]);const Eq={name:"RoomMessageReply",components:{SvgIcon:Un,FormatMessage:Xu,AudioPlayer:Vv},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var t,e;return(e=(t=this.messageReply)==null?void 0:t.files)!=null&&e.length?this.messageReply.files[0]:{}},isImage(){return fl(this.firstFile)},isVideo(){return Qu(this.firstFile)},isAudio(){return Im(this.firstFile)},isOtherFile(){var t,e;return((e=(t=this.messageReply)==null?void 0:t.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Tq={key:0,class:"vac-reply-container"},Sq={class:"vac-reply-box"},Aq={class:"vac-reply-info"},Rq={class:"vac-reply-username"},Cq={class:"vac-reply-content"},Iq=["src"],kq={key:1,controls:"",class:"vac-image-reply"},Mq=["src"],xq={key:3,class:"vac-image-reply vac-file-container"},Oq={class:"vac-text-ellipsis"},Nq={key:0,class:"vac-text-ellipsis vac-text-extension"},Lq={class:"vac-icon-reply"};function Dq(t,e,n,s,i,r){const o=Je("format-message"),a=Je("audio-player"),l=Je("svg-icon");return re(),Pt(gn,{name:"vac-slide-up"},{default:et(()=>[n.messageReply?(re(),ge("div",Tq,[Ce("div",Sq,[Ce("div",Aq,[Ce("div",Rq,ot(n.messageReply.username),1),Ce("div",Cq,[He(o,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),r.isImage?(re(),ge("img",{key:0,src:r.firstFile.url,class:"vac-image-reply"},null,8,Iq)):r.isVideo?(re(),ge("video",kq,[Ce("source",{src:r.firstFile.url},null,8,Mq)])):r.isAudio?(re(),Pt(a,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["src"])):r.isOtherFile?(re(),ge("div",xq,[Ce("div",null,[Fe(t.$slots,"file-icon",{},()=>[He(l,{name:"file"})])]),Ce("div",Oq,ot(r.firstFile.name),1),r.firstFile.extension?(re(),ge("div",Nq,ot(r.firstFile.extension),1)):Le("",!0)])):Le("",!0)]),Ce("div",Lq,[Ce("div",{class:"vac-svg-button",onClick:e[0]||(e[0]=c=>t.$emit("reset-message"))},[Fe(t.$slots,"reply-close-icon",{},()=>[He(l,{name:"close-outline"})])])])])):Le("",!0)]),_:3})}var Pq=Xt(Eq,[["render",Dq]]);const Fq={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(t,e){(!e.length||t.length!==e.length)&&(this.activeItem=0)},selectItem(t){t&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Bq={key:0,class:"vac-tags-container"},Uq=["onMouseover","onClick"],jq={class:"vac-tags-info"},Hq={class:"vac-tags-username"};function Vq(t,e,n,s,i,r){return re(),Pt(gn,{name:"vac-slide-up"},{default:et(()=>[n.filteredUsersTag.length?(re(),ge("div",Bq,[(re(!0),ge(Ct,null,ht(n.filteredUsersTag,(o,a)=>(re(),ge("div",{key:o._id,class:pt(["vac-tags-box",{"vac-tags-box-active":a===i.activeItem}]),onMouseover:l=>i.activeItem=a,onClick:l=>t.$emit("select-user-tag",o)},[Ce("div",jq,[o.avatar?(re(),ge("div",{key:0,class:"vac-avatar vac-tags-avatar",style:en({"background-image":`url('${o.avatar}')`})},null,4)):Le("",!0),Ce("div",Hq,ot(o.username),1)])],42,Uq))),128))])):Le("",!0)]),_:1})}var qq=Xt(Fq,[["render",Vq]]);const $q={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(t,e){(!e.length||t.length!==e.length)&&(this.activeItem=0)},selectItem(t){t&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},zq={key:0,class:"vac-emojis-container"},Kq=["onMouseover","onClick"];function Gq(t,e,n,s,i,r){return re(),Pt(gn,{name:"vac-slide-up"},{default:et(()=>[n.filteredEmojis.length?(re(),ge("div",zq,[(re(!0),ge(Ct,null,ht(n.filteredEmojis,(o,a)=>(re(),ge("div",{key:o,class:pt(["vac-emoji-element",{"vac-emoji-element-active":a===i.activeItem}]),onMouseover:l=>i.activeItem=a,onClick:l=>t.$emit("select-emoji",o)},ot(o),43,Kq))),128))])):Le("",!0)]),_:1})}var Wq=Xt($q,[["render",Gq]]);const Yq={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(t,e){(!e.length||t.length!==e.length)&&(this.activeItem=0)},selectItem(t){t&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Xq={key:0,class:"vac-template-container vac-app-box-shadow"},Qq=["onMouseover","onClick"],Zq={class:"vac-template-info"},Jq={class:"vac-template-tag"},e$={class:"vac-template-text"};function t$(t,e,n,s,i,r){return re(),Pt(gn,{name:"vac-slide-up"},{default:et(()=>[n.filteredTemplatesText.length?(re(),ge("div",Xq,[(re(!0),ge(Ct,null,ht(n.filteredTemplatesText,(o,a)=>(re(),ge("div",{key:a,class:pt(["vac-template-box",{"vac-template-active":a===i.activeItem}]),onMouseover:l=>i.activeItem=a,onClick:l=>t.$emit("select-template-text",o)},[Ce("div",Zq,[Ce("div",Jq," /"+ot(o.tag),1),Ce("div",e$,ot(o.text),1)])],42,Qq))),128))])):Le("",!0)]),_:1})}var n$=Xt(Yq,[["render",t$]]);function s$(t){return new Int8Array(t)}function TS(t){return new Int16Array(t)}function SS(t){return new Int32Array(t)}function AS(t){return new Float32Array(t)}function i$(t){return new Float64Array(t)}function RS(t){if(t.length==1)return AS(t[0]);var e=t[0];t=t.slice(1);for(var n=[],s=0;s<e;s++)n.push(RS(t));return n}function CS(t){if(t.length==1)return SS(t[0]);var e=t[0];t=t.slice(1);for(var n=[],s=0;s<e;s++)n.push(CS(t));return n}function IS(t){if(t.length==1)return TS(t[0]);var e=t[0];t=t.slice(1);for(var n=[],s=0;s<e;s++)n.push(IS(t));return n}function kS(t){if(t.length==1)return new Array(t[0]);var e=t[0];t=t.slice(1);for(var n=[],s=0;s<e;s++)n.push(kS(t));return n}var MS={};MS.fill=function(t,e,n,s){if(arguments.length==2)for(var i=0;i<t.length;i++)t[i]=arguments[1];else for(var i=e;i<n;i++)t[i]=s};var Ju={};Ju.arraycopy=function(t,e,n,s,i){for(var r=e+i;e<r;)n[s++]=t[e++]};Ju.out={};Ju.out.println=function(t){console.log(t)};Ju.out.printf=function(){console.log.apply(console,arguments)};var km={};km.SQRT2=1.4142135623730951;km.FAST_LOG10=function(t){return Math.log10(t)};km.FAST_LOG10_X=function(t,e){return Math.log10(t)*e};function lr(t){this.ordinal=t}lr.short_block_allowed=new lr(0);lr.short_block_coupled=new lr(1);lr.short_block_dispensed=new lr(2);lr.short_block_forced=new lr(3);var xS={};xS.MAX_VALUE=34028235e31;function $s(t){this.ordinal=t}$s.vbr_off=new $s(0);$s.vbr_mt=new $s(1);$s.vbr_rh=new $s(2);$s.vbr_abr=new $s(3);$s.vbr_mtrh=new $s(4);$s.vbr_default=$s.vbr_mtrh;var r$=function(t){},Ne={System:Ju,VbrMode:$s,Float:xS,ShortBlock:lr,Util:km,Arrays:MS,new_array_n:kS,new_byte:s$,new_double:i$,new_float:AS,new_float_n:RS,new_int:SS,new_int_n:CS,new_short:TS,new_short_n:IS,assert:r$},o$=Ne.System,hn=Ne.Util,a$=Ne.Arrays,l$=Ne.new_float;function c$(){var t=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*hn.SQRT2*.5/2384e-9,.017876148*hn.SQRT2*.5/2384e-9,.003134727*hn.SQRT2*.5/2384e-9,.002457142*hn.SQRT2*.5/2384e-9,971317e-9*hn.SQRT2*.5/2384e-9,218868e-9*hn.SQRT2*.5/2384e-9,101566e-9*hn.SQRT2*.5/2384e-9,13828e-9*hn.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],e=12,n=36,s=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],i=s[P.SHORT_TYPE],r=s[P.SHORT_TYPE],o=s[P.SHORT_TYPE],a=s[P.SHORT_TYPE],l=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(f,m,h){for(var M=10,k=m+238-14-286,L=-15;L<0;L++){var p,I,D;p=t[M+-10],I=f[k+-224]*p,D=f[m+224]*p,p=t[M+-9],I+=f[k+-160]*p,D+=f[m+160]*p,p=t[M+-8],I+=f[k+-96]*p,D+=f[m+96]*p,p=t[M+-7],I+=f[k+-32]*p,D+=f[m+32]*p,p=t[M+-6],I+=f[k+32]*p,D+=f[m+-32]*p,p=t[M+-5],I+=f[k+96]*p,D+=f[m+-96]*p,p=t[M+-4],I+=f[k+160]*p,D+=f[m+-160]*p,p=t[M+-3],I+=f[k+224]*p,D+=f[m+-224]*p,p=t[M+-2],I+=f[m+-256]*p,D-=f[k+256]*p,p=t[M+-1],I+=f[m+-192]*p,D-=f[k+192]*p,p=t[M+0],I+=f[m+-128]*p,D-=f[k+128]*p,p=t[M+1],I+=f[m+-64]*p,D-=f[k+64]*p,p=t[M+2],I+=f[m+0]*p,D-=f[k+0]*p,p=t[M+3],I+=f[m+64]*p,D-=f[k+-64]*p,p=t[M+4],I+=f[m+128]*p,D-=f[k+-128]*p,p=t[M+5],I+=f[m+192]*p,D-=f[k+-192]*p,I*=t[M+6],p=D-I,h[30+L*2]=D+I,h[31+L*2]=t[M+7]*p,M+=18,m--,k++}{var I,D,x,B;D=f[m+-16]*t[M+-10],I=f[m+-32]*t[M+-2],D+=(f[m+-48]-f[m+16])*t[M+-9],I+=f[m+-96]*t[M+-1],D+=(f[m+-80]+f[m+48])*t[M+-8],I+=f[m+-160]*t[M+0],D+=(f[m+-112]-f[m+80])*t[M+-7],I+=f[m+-224]*t[M+1],D+=(f[m+-144]+f[m+112])*t[M+-6],I-=f[m+32]*t[M+2],D+=(f[m+-176]-f[m+144])*t[M+-5],I-=f[m+96]*t[M+3],D+=(f[m+-208]+f[m+176])*t[M+-4],I-=f[m+160]*t[M+4],D+=(f[m+-240]-f[m+208])*t[M+-3],I-=f[m+224],x=I-D,B=I+D,D=h[14],I=h[15]-D,h[31]=B+D,h[30]=x+I,h[15]=x-I,h[14]=B-D}{var _;_=h[28]-h[0],h[0]+=h[28],h[28]=_*t[M+-2*18+7],_=h[29]-h[1],h[1]+=h[29],h[29]=_*t[M+-2*18+7],_=h[26]-h[2],h[2]+=h[26],h[26]=_*t[M+-4*18+7],_=h[27]-h[3],h[3]+=h[27],h[27]=_*t[M+-4*18+7],_=h[24]-h[4],h[4]+=h[24],h[24]=_*t[M+-6*18+7],_=h[25]-h[5],h[5]+=h[25],h[25]=_*t[M+-6*18+7],_=h[22]-h[6],h[6]+=h[22],h[22]=_*hn.SQRT2,_=h[23]-h[7],h[7]+=h[23],h[23]=_*hn.SQRT2-h[7],h[7]-=h[6],h[22]-=h[7],h[23]-=h[22],_=h[6],h[6]=h[31]-_,h[31]=h[31]+_,_=h[7],h[7]=h[30]-_,h[30]=h[30]+_,_=h[22],h[22]=h[15]-_,h[15]=h[15]+_,_=h[23],h[23]=h[14]-_,h[14]=h[14]+_,_=h[20]-h[8],h[8]+=h[20],h[20]=_*t[M+-10*18+7],_=h[21]-h[9],h[9]+=h[21],h[21]=_*t[M+-10*18+7],_=h[18]-h[10],h[10]+=h[18],h[18]=_*t[M+-12*18+7],_=h[19]-h[11],h[11]+=h[19],h[19]=_*t[M+-12*18+7],_=h[16]-h[12],h[12]+=h[16],h[16]=_*t[M+-14*18+7],_=h[17]-h[13],h[13]+=h[17],h[17]=_*t[M+-14*18+7],_=-h[20]+h[24],h[20]+=h[24],h[24]=_*t[M+-12*18+7],_=-h[21]+h[25],h[21]+=h[25],h[25]=_*t[M+-12*18+7],_=h[4]-h[8],h[4]+=h[8],h[8]=_*t[M+-12*18+7],_=h[5]-h[9],h[5]+=h[9],h[9]=_*t[M+-12*18+7],_=h[0]-h[12],h[0]+=h[12],h[12]=_*t[M+-4*18+7],_=h[1]-h[13],h[1]+=h[13],h[13]=_*t[M+-4*18+7],_=h[16]-h[28],h[16]+=h[28],h[28]=_*t[M+-4*18+7],_=-h[17]+h[29],h[17]+=h[29],h[29]=_*t[M+-4*18+7],_=hn.SQRT2*(h[2]-h[10]),h[2]+=h[10],h[10]=_,_=hn.SQRT2*(h[3]-h[11]),h[3]+=h[11],h[11]=_,_=hn.SQRT2*(-h[18]+h[26]),h[18]+=h[26],h[26]=_-h[18],_=hn.SQRT2*(-h[19]+h[27]),h[19]+=h[27],h[27]=_-h[19],_=h[2],h[19]-=h[3],h[3]-=_,h[2]=h[31]-_,h[31]+=_,_=h[3],h[11]-=h[19],h[18]-=_,h[3]=h[30]-_,h[30]+=_,_=h[18],h[27]-=h[11],h[19]-=_,h[18]=h[15]-_,h[15]+=_,_=h[19],h[10]-=_,h[19]=h[14]-_,h[14]+=_,_=h[10],h[11]-=_,h[10]=h[23]-_,h[23]+=_,_=h[11],h[26]-=_,h[11]=h[22]-_,h[22]+=_,_=h[26],h[27]-=_,h[26]=h[7]-_,h[7]+=_,_=h[27],h[27]=h[6]-_,h[6]+=_,_=hn.SQRT2*(h[0]-h[4]),h[0]+=h[4],h[4]=_,_=hn.SQRT2*(h[1]-h[5]),h[1]+=h[5],h[5]=_,_=hn.SQRT2*(h[16]-h[20]),h[16]+=h[20],h[20]=_,_=hn.SQRT2*(h[17]-h[21]),h[17]+=h[21],h[21]=_,_=-hn.SQRT2*(h[8]-h[12]),h[8]+=h[12],h[12]=_-h[8],_=-hn.SQRT2*(h[9]-h[13]),h[9]+=h[13],h[13]=_-h[9],_=-hn.SQRT2*(h[25]-h[29]),h[25]+=h[29],h[29]=_-h[25],_=-hn.SQRT2*(h[24]+h[28]),h[24]-=h[28],h[28]=_-h[24],_=h[24]-h[16],h[24]=_,_=h[20]-_,h[20]=_,_=h[28]-_,h[28]=_,_=h[25]-h[17],h[25]=_,_=h[21]-_,h[21]=_,_=h[29]-_,h[29]=_,_=h[17]-h[1],h[17]=_,_=h[9]-_,h[9]=_,_=h[25]-_,h[25]=_,_=h[5]-_,h[5]=_,_=h[21]-_,h[21]=_,_=h[13]-_,h[13]=_,_=h[29]-_,h[29]=_,_=h[1]-h[0],h[1]=_,_=h[16]-_,h[16]=_,_=h[17]-_,h[17]=_,_=h[8]-_,h[8]=_,_=h[9]-_,h[9]=_,_=h[24]-_,h[24]=_,_=h[25]-_,h[25]=_,_=h[4]-_,h[4]=_,_=h[5]-_,h[5]=_,_=h[20]-_,h[20]=_,_=h[21]-_,h[21]=_,_=h[12]-_,h[12]=_,_=h[13]-_,h[13]=_,_=h[28]-_,h[28]=_,_=h[29]-_,h[29]=_,_=h[0],h[0]+=h[31],h[31]-=_,_=h[1],h[1]+=h[30],h[30]-=_,_=h[16],h[16]+=h[15],h[15]-=_,_=h[17],h[17]+=h[14],h[14]-=_,_=h[8],h[8]+=h[23],h[23]-=_,_=h[9],h[9]+=h[22],h[22]-=_,_=h[24],h[24]+=h[7],h[7]-=_,_=h[25],h[25]+=h[6],h[6]-=_,_=h[4],h[4]+=h[27],h[27]-=_,_=h[5],h[5]+=h[26],h[26]-=_,_=h[20],h[20]+=h[11],h[11]-=_,_=h[21],h[21]+=h[10],h[10]-=_,_=h[12],h[12]+=h[19],h[19]-=_,_=h[13],h[13]+=h[18],h[18]-=_,_=h[28],h[28]+=h[3],h[3]-=_,_=h[29],h[29]+=h[2],h[2]-=_}}function d(f,m){for(var h=0;h<3;h++){var M,k,L,p,I,D;p=f[m+2*3]*s[P.SHORT_TYPE][0]-f[m+5*3],M=f[m+0*3]*s[P.SHORT_TYPE][2]-f[m+3*3],k=p+M,L=p-M,p=f[m+5*3]*s[P.SHORT_TYPE][0]+f[m+2*3],M=f[m+3*3]*s[P.SHORT_TYPE][2]+f[m+0*3],I=p+M,D=-p+M,M=(f[m+1*3]*s[P.SHORT_TYPE][1]-f[m+4*3])*2069978111953089e-26,p=(f[m+4*3]*s[P.SHORT_TYPE][1]+f[m+1*3])*2069978111953089e-26,f[m+3*0]=k*190752519173728e-25+M,f[m+3*5]=-I*190752519173728e-25+p,L=L*.8660254037844387*1907525191737281e-26,I=I*.5*1907525191737281e-26+p,f[m+3*1]=L-I,f[m+3*2]=L+I,k=k*.5*1907525191737281e-26-M,D=D*.8660254037844387*1907525191737281e-26,f[m+3*3]=k+D,f[m+3*4]=k-D,m++}}function u(f,m,h){var M,k;{var L,p,I,D,x,B,_,A;L=h[17]-h[9],I=h[15]-h[11],D=h[14]-h[12],x=h[0]+h[8],B=h[1]+h[7],_=h[2]+h[6],A=h[3]+h[5],f[m+17]=x+_-A-(B-h[4]),k=(x+_-A)*r[12+7]+(B-h[4]),M=(L-I-D)*r[12+6],f[m+5]=M+k,f[m+6]=M-k,p=(h[16]-h[10])*r[12+6],B=B*r[12+7]+h[4],M=L*r[12+0]+p+I*r[12+1]+D*r[12+2],k=-x*r[12+4]+B-_*r[12+5]+A*r[12+3],f[m+1]=M+k,f[m+2]=M-k,M=L*r[12+1]-p-I*r[12+2]+D*r[12+0],k=-x*r[12+5]+B-_*r[12+3]+A*r[12+4],f[m+9]=M+k,f[m+10]=M-k,M=L*r[12+2]-p+I*r[12+0]-D*r[12+1],k=x*r[12+3]-B+_*r[12+4]-A*r[12+5],f[m+13]=M+k,f[m+14]=M-k}{var T,v,w,b,y,R,S,U;T=h[8]-h[0],w=h[6]-h[2],b=h[5]-h[3],y=h[17]+h[9],R=h[16]+h[10],S=h[15]+h[11],U=h[14]+h[12],f[m+0]=y+S+U+(R+h[13]),M=(y+S+U)*r[12+7]-(R+h[13]),k=(T-w+b)*r[12+6],f[m+11]=M+k,f[m+12]=M-k,v=(h[7]-h[1])*r[12+6],R=h[13]-R*r[12+7],M=y*r[12+3]-R+S*r[12+4]+U*r[12+5],k=T*r[12+2]+v+w*r[12+0]+b*r[12+1],f[m+3]=M+k,f[m+4]=M-k,M=-y*r[12+5]+R-S*r[12+3]-U*r[12+4],k=T*r[12+1]+v-w*r[12+2]-b*r[12+0],f[m+7]=M+k,f[m+8]=M-k,M=-y*r[12+4]+R-S*r[12+5]-U*r[12+3],k=T*r[12+0]-v+w*r[12+1]-b*r[12+2],f[m+15]=M+k,f[m+16]=M-k}}this.mdct_sub48=function(f,m,h){for(var M=m,k=286,L=0;L<f.channels_out;L++){for(var p=0;p<f.mode_gr;p++){for(var I,D=f.l3_side.tt[p][L],x=D.xr,B=0,_=f.sb_sample[L][1-p],A=0,T=0;T<18/2;T++)for(c(M,k,_[A]),c(M,k+32,_[A+1]),A+=2,k+=64,I=1;I<32;I+=2)_[A-1][I]*=-1;for(I=0;I<32;I++,B+=18){var v=D.block_type,w=f.sb_sample[L][p],b=f.sb_sample[L][1-p];if(D.mixed_block_flag!=0&&I<2&&(v=0),f.amp_filter[I]<1e-12)a$.fill(x,B+0,B+18,0);else{if(f.amp_filter[I]<1)for(var T=0;T<18;T++)b[T][l[I]]*=f.amp_filter[I];if(v==P.SHORT_TYPE){for(var T=-e/4;T<0;T++){var y=s[P.SHORT_TYPE][T+3];x[B+T*3+9]=w[9+T][l[I]]*y-w[8-T][l[I]],x[B+T*3+18]=w[14-T][l[I]]*y+w[15+T][l[I]],x[B+T*3+10]=w[15+T][l[I]]*y-w[14-T][l[I]],x[B+T*3+19]=b[2-T][l[I]]*y+b[3+T][l[I]],x[B+T*3+11]=b[3+T][l[I]]*y-b[2-T][l[I]],x[B+T*3+20]=b[8-T][l[I]]*y+b[9+T][l[I]]}d(x,B)}else{for(var R=l$(18),T=-n/4;T<0;T++){var S,U;S=s[v][T+27]*b[T+9][l[I]]+s[v][T+36]*b[8-T][l[I]],U=s[v][T+9]*w[T+9][l[I]]-s[v][T+18]*w[8-T][l[I]],R[T+9]=S-U*i[3+T+9],R[T+18]=S*i[3+T+9]+U}u(x,B,R)}}if(v!=P.SHORT_TYPE&&I!=0)for(var T=7;T>=0;--T){var W,j;W=x[B+T]*o[20+T]+x[B+-1-T]*a[28+T],j=x[B+T]*a[28+T]-x[B+-1-T]*o[20+T],x[B+-1-T]=W,x[B+T]=j}}}if(M=h,k=286,f.mode_gr==1)for(var z=0;z<18;z++)o$.arraycopy(f.sb_sample[L][1][z],0,f.sb_sample[L][0][z],0,32)}}}var u$=Ne.System,h$=Ne.new_float,d$=Ne.new_float_n;function Xd(){this.l=h$(P.SBMAX_l),this.s=d$([P.SBMAX_s,3]);var t=this;this.assign=function(e){u$.arraycopy(e.l,0,t.l,0,P.SBMAX_l);for(var n=0;n<P.SBMAX_s;n++)for(var s=0;s<3;s++)t.s[n][s]=e.s[n][s]}}function vr(){this.thm=new Xd,this.en=new Xd}function Mt(t){var e=t;this.ordinal=function(){return e}}Mt.STEREO=new Mt(0);Mt.JOINT_STEREO=new Mt(1);Mt.DUAL_CHANNEL=new Mt(2);Mt.MONO=new Mt(3);Mt.NOT_SET=new Mt(4);var O3=Ne.System,kh=Ne.VbrMode,N3=Ne.new_array_n,L3=Ne.new_float,f$=Ne.new_float_n,m$=Ne.new_int,Mh=Ne.assert;P.ENCDELAY=576;P.POSTDELAY=1152;P.MDCTDELAY=48;P.FFTOFFSET=224+P.MDCTDELAY;P.DECDELAY=528;P.SBLIMIT=32;P.CBANDS=64;P.SBPSY_l=21;P.SBPSY_s=12;P.SBMAX_l=22;P.SBMAX_s=13;P.PSFB21=6;P.PSFB12=6;P.BLKSIZE=1024;P.HBLKSIZE=P.BLKSIZE/2+1;P.BLKSIZE_s=256;P.HBLKSIZE_s=P.BLKSIZE_s/2+1;P.NORM_TYPE=0;P.START_TYPE=1;P.SHORT_TYPE=2;P.STOP_TYPE=3;P.MPG_MD_LR_LR=0;P.MPG_MD_LR_I=1;P.MPG_MD_MS_LR=2;P.MPG_MD_MS_I=3;P.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function P(){var t=P.FFTOFFSET,e=P.MPG_MD_MS_LR,n=null;this.psy=null;var s=null,i=null,r=null;this.setModules=function(d,u,f,m){n=d,this.psy=u,s=u,i=m,r=f};var o=new c$;function a(d){var u,f;if(d.ATH.useAdjust==0){d.ATH.adjust=1;return}if(f=d.loudness_sq[0][0],u=d.loudness_sq[1][0],d.channels_out==2?(f+=d.loudness_sq[0][1],u+=d.loudness_sq[1][1]):(f+=f,u+=u),d.mode_gr==2&&(f=Math.max(f,u)),f*=.5,f*=d.ATH.aaSensitivityP,f>.03125)d.ATH.adjust>=1?d.ATH.adjust=1:d.ATH.adjust<d.ATH.adjustLimit&&(d.ATH.adjust=d.ATH.adjustLimit),d.ATH.adjustLimit=1;else{var m=31.98*f+625e-6;d.ATH.adjust>=m?(d.ATH.adjust*=m*.075+.925,d.ATH.adjust<m&&(d.ATH.adjust=m)):d.ATH.adjustLimit>=m?d.ATH.adjust=m:d.ATH.adjust<d.ATH.adjustLimit&&(d.ATH.adjust=d.ATH.adjustLimit),d.ATH.adjustLimit=m}}function l(d){var u,f;for(Mh(d.bitrate_index>=0&&d.bitrate_index<16),Mh(d.mode_ext>=0&&d.mode_ext<4),d.bitrate_stereoMode_Hist[d.bitrate_index][4]++,d.bitrate_stereoMode_Hist[15][4]++,d.channels_out==2&&(d.bitrate_stereoMode_Hist[d.bitrate_index][d.mode_ext]++,d.bitrate_stereoMode_Hist[15][d.mode_ext]++),u=0;u<d.mode_gr;++u)for(f=0;f<d.channels_out;++f){var m=d.l3_side.tt[u][f].block_type|0;d.l3_side.tt[u][f].mixed_block_flag!=0&&(m=4),d.bitrate_blockType_Hist[d.bitrate_index][m]++,d.bitrate_blockType_Hist[d.bitrate_index][5]++,d.bitrate_blockType_Hist[15][m]++,d.bitrate_blockType_Hist[15][5]++}}function c(d,u){var f=d.internal_flags,m,h;if(f.lame_encode_frame_init==0){var M,k,L=L3(2014),p=L3(286+1152+576);for(f.lame_encode_frame_init=1,M=0,k=0;M<286+576*(1+f.mode_gr);++M)M<576*f.mode_gr?(L[M]=0,f.channels_out==2&&(p[M]=0)):(L[M]=u[0][k],f.channels_out==2&&(p[M]=u[1][k]),++k);for(h=0;h<f.mode_gr;h++)for(m=0;m<f.channels_out;m++)f.l3_side.tt[h][m].block_type=P.SHORT_TYPE;o.mdct_sub48(f,L,p),Mh(f.mf_size>=P.BLKSIZE+d.framesize-P.FFTOFFSET),Mh(f.mf_size>=512+d.framesize-32)}}this.lame_encode_mp3_frame=function(d,u,f,m,h,M){var k,L=N3([2,2]);L[0][0]=new vr,L[0][1]=new vr,L[1][0]=new vr,L[1][1]=new vr;var p=N3([2,2]);p[0][0]=new vr,p[0][1]=new vr,p[1][0]=new vr,p[1][1]=new vr;var I,D=[null,null],x=d.internal_flags,B=f$([2,4]),_=[.5,.5],A=[[0,0],[0,0]],T=[[0,0],[0,0]],v,w,b;if(D[0]=u,D[1]=f,x.lame_encode_frame_init==0&&c(d,D),x.padding=0,(x.slot_lag-=x.frac_SpF)<0&&(x.slot_lag+=d.out_samplerate,x.padding=1),x.psymodel!=0){var y,R=[null,null],S=0,U=m$(2);for(b=0;b<x.mode_gr;b++){for(w=0;w<x.channels_out;w++)R[w]=D[w],S=576+b*576-P.FFTOFFSET;if(d.VBR==kh.vbr_mtrh||d.VBR==kh.vbr_mt?y=s.L3psycho_anal_vbr(d,R,S,b,L,p,A[b],T[b],B[b],U):y=s.L3psycho_anal_ns(d,R,S,b,L,p,A[b],T[b],B[b],U),y!=0)return-4;for(d.mode==Mt.JOINT_STEREO&&(_[b]=B[b][2]+B[b][3],_[b]>0&&(_[b]=B[b][3]/_[b])),w=0;w<x.channels_out;w++){var W=x.l3_side.tt[b][w];W.block_type=U[w],W.mixed_block_flag=0}}}else for(b=0;b<x.mode_gr;b++)for(w=0;w<x.channels_out;w++)x.l3_side.tt[b][w].block_type=P.NORM_TYPE,x.l3_side.tt[b][w].mixed_block_flag=0,T[b][w]=A[b][w]=700;if(a(x),o.mdct_sub48(x,D[0],D[1]),x.mode_ext=P.MPG_MD_LR_LR,d.force_ms)x.mode_ext=P.MPG_MD_MS_LR;else if(d.mode==Mt.JOINT_STEREO){var j=0,z=0;for(b=0;b<x.mode_gr;b++)for(w=0;w<x.channels_out;w++)j+=T[b][w],z+=A[b][w];if(j<=1*z){var g=x.l3_side.tt[0],C=x.l3_side.tt[x.mode_gr-1];g[0].block_type==g[1].block_type&&C[0].block_type==C[1].block_type&&(x.mode_ext=P.MPG_MD_MS_LR)}}if(x.mode_ext==e?(I=p,v=T):(I=L,v=A),d.analysis&&x.pinfo!=null)for(b=0;b<x.mode_gr;b++)for(w=0;w<x.channels_out;w++)x.pinfo.ms_ratio[b]=x.ms_ratio[b],x.pinfo.ms_ener_ratio[b]=_[b],x.pinfo.blocktype[b][w]=x.l3_side.tt[b][w].block_type,x.pinfo.pe[b][w]=v[b][w],O3.arraycopy(x.l3_side.tt[b][w].xr,0,x.pinfo.xr[b][w],0,576),x.mode_ext==e&&(x.pinfo.ers[b][w]=x.pinfo.ers[b][w+2],O3.arraycopy(x.pinfo.energy[b][w+2],0,x.pinfo.energy[b][w],0,x.pinfo.energy[b][w].length));if(d.VBR==kh.vbr_off||d.VBR==kh.vbr_abr){var te,se;for(te=0;te<18;te++)x.nsPsy.pefirbuf[te]=x.nsPsy.pefirbuf[te+1];for(se=0,b=0;b<x.mode_gr;b++)for(w=0;w<x.channels_out;w++)se+=v[b][w];for(x.nsPsy.pefirbuf[18]=se,se=x.nsPsy.pefirbuf[9],te=0;te<9;te++)se+=(x.nsPsy.pefirbuf[te]+x.nsPsy.pefirbuf[18-te])*P.fircoef[te];for(se=670*5*x.mode_gr*x.channels_out/se,b=0;b<x.mode_gr;b++)for(w=0;w<x.channels_out;w++)v[b][w]*=se}if(x.iteration_loop.iteration_loop(d,v,_,I),n.format_bitstream(d),k=n.copy_buffer(x,m,h,M,1),d.bWriteVbrTag&&i.addVbrFrame(d),d.analysis&&x.pinfo!=null){for(w=0;w<x.channels_out;w++){var Te;for(Te=0;Te<t;Te++)x.pinfo.pcmdata[w][Te]=x.pinfo.pcmdata[w][Te+d.framesize];for(Te=t;Te<1600;Te++)x.pinfo.pcmdata[w][Te]=D[w][Te-t]}r.set_frame_pinfo(d,I)}return l(x),k}}var D3=Ne.Util,P3=Ne.new_float;function p$(){var t=P3(P.BLKSIZE),e=P3(P.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function s(r,o,a){var l=0,c,d,u;a<<=1;var f=o+a;c=4;do{var m,h,M,k,L,p,I;I=c>>1,k=c,L=c<<1,p=L+k,c=L<<1,d=o,u=d+I;do{var D,x,B,_;x=r[d+0]-r[d+k],D=r[d+0]+r[d+k],_=r[d+L]-r[d+p],B=r[d+L]+r[d+p],r[d+L]=D-B,r[d+0]=D+B,r[d+p]=x-_,r[d+k]=x+_,x=r[u+0]-r[u+k],D=r[u+0]+r[u+k],_=D3.SQRT2*r[u+p],B=D3.SQRT2*r[u+L],r[u+L]=D-B,r[u+0]=D+B,r[u+p]=x-_,r[u+k]=x+_,u+=c,d+=c}while(d<f);for(h=n[l+0],m=n[l+1],M=1;M<I;M++){var A,T;A=1-2*m*m,T=2*m*h,d=o+M,u=o+k-M;do{var v,w,b,D,x,y,B,R,_,S;w=T*r[d+k]-A*r[u+k],v=A*r[d+k]+T*r[u+k],x=r[d+0]-v,D=r[d+0]+v,y=r[u+0]-w,b=r[u+0]+w,w=T*r[d+p]-A*r[u+p],v=A*r[d+p]+T*r[u+p],_=r[d+L]-v,B=r[d+L]+v,S=r[u+L]-w,R=r[u+L]+w,w=m*B-h*S,v=h*B+m*S,r[d+L]=D-v,r[d+0]=D+v,r[u+p]=y-w,r[u+k]=y+w,w=h*R-m*_,v=m*R+h*_,r[u+L]=b-v,r[u+0]=b+v,r[d+p]=x-w,r[d+k]=x+w,u+=c,d+=c}while(d<f);A=h,h=A*n[l+0]-m*n[l+1],m=A*n[l+1]+m*n[l+0]}l+=2}while(c<a)}var i=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(r,o,a,l,c){for(var d=0;d<3;d++){var u=P.BLKSIZE_s/2,f=65535&576/3*(d+1),m=P.BLKSIZE_s/8-1;do{var h,M,k,L,p,I=i[m<<2]&255;h=e[I]*l[a][c+I+f],p=e[127-I]*l[a][c+I+f+128],M=h-p,h=h+p,k=e[I+64]*l[a][c+I+f+64],p=e[63-I]*l[a][c+I+f+192],L=k-p,k=k+p,u-=4,o[d][u+0]=h+k,o[d][u+2]=h-k,o[d][u+1]=M+L,o[d][u+3]=M-L,h=e[I+1]*l[a][c+I+f+1],p=e[126-I]*l[a][c+I+f+129],M=h-p,h=h+p,k=e[I+65]*l[a][c+I+f+65],p=e[62-I]*l[a][c+I+f+193],L=k-p,k=k+p,o[d][u+P.BLKSIZE_s/2+0]=h+k,o[d][u+P.BLKSIZE_s/2+2]=h-k,o[d][u+P.BLKSIZE_s/2+1]=M+L,o[d][u+P.BLKSIZE_s/2+3]=M-L}while(--m>=0);s(o[d],u,P.BLKSIZE_s/2)}},this.fft_long=function(r,o,a,l,c){var d=P.BLKSIZE/8-1,u=P.BLKSIZE/2;do{var f,m,h,M,k,L=i[d]&255;f=t[L]*l[a][c+L],k=t[L+512]*l[a][c+L+512],m=f-k,f=f+k,h=t[L+256]*l[a][c+L+256],k=t[L+768]*l[a][c+L+768],M=h-k,h=h+k,u-=4,o[u+0]=f+h,o[u+2]=f-h,o[u+1]=m+M,o[u+3]=m-M,f=t[L+1]*l[a][c+L+1],k=t[L+513]*l[a][c+L+513],m=f-k,f=f+k,h=t[L+257]*l[a][c+L+257],k=t[L+769]*l[a][c+L+769],M=h-k,h=h+k,o[u+P.BLKSIZE/2+0]=f+h,o[u+P.BLKSIZE/2+2]=f-h,o[u+P.BLKSIZE/2+1]=m+M,o[u+P.BLKSIZE/2+3]=m-M}while(--d>=0);s(o,u,P.BLKSIZE/2)},this.init_fft=function(r){for(var o=0;o<P.BLKSIZE;o++)t[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/P.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/P.BLKSIZE);for(var o=0;o<P.BLKSIZE_s/2;o++)e[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/P.BLKSIZE_s))}}var wa=Ne.VbrMode,F3=Ne.Float,Ea=Ne.ShortBlock,fs=Ne.Util,g$=Ne.Arrays,vn=Ne.new_float,Gs=Ne.new_float_n,ro=Ne.new_int,ct=Ne.assert;function N1(){var t=new p$,e=2.302585092994046,n=2,s=16,i=2,r=16,o=.34,a=1/(14752*14752)/(P.BLKSIZE/2),l=.01,c=.8,d=.6,u=.3,f=3.5,m=21,h=.2302585093;function M(N){return N}function k(N,F){for(var q=0,G=0;G<P.BLKSIZE/2;++G)q+=N[G]*F.ATH.eql_w[G];return q*=a,q}function L(N,F,q,G,Y,H,ee,oe,J,me,ae){var pe=N.internal_flags;if(J<2)t.fft_long(pe,G[Y],J,me,ae),t.fft_short(pe,H[ee],J,me,ae);else if(J==2){for(var Pe=P.BLKSIZE-1;Pe>=0;--Pe){var Qe=G[Y+0][Pe],Se=G[Y+1][Pe];G[Y+0][Pe]=(Qe+Se)*fs.SQRT2*.5,G[Y+1][Pe]=(Qe-Se)*fs.SQRT2*.5}for(var We=2;We>=0;--We)for(var Pe=P.BLKSIZE_s-1;Pe>=0;--Pe){var Qe=H[ee+0][We][Pe],Se=H[ee+1][We][Pe];H[ee+0][We][Pe]=(Qe+Se)*fs.SQRT2*.5,H[ee+1][We][Pe]=(Qe-Se)*fs.SQRT2*.5}}F[0]=G[Y+0][0],F[0]*=F[0];for(var Pe=P.BLKSIZE/2-1;Pe>=0;--Pe){var he=G[Y+0][P.BLKSIZE/2-Pe],Ve=G[Y+0][P.BLKSIZE/2+Pe];F[P.BLKSIZE/2-Pe]=(he*he+Ve*Ve)*.5}for(var We=2;We>=0;--We){q[We][0]=H[ee+0][We][0],q[We][0]*=q[We][0];for(var Pe=P.BLKSIZE_s/2-1;Pe>=0;--Pe){var he=H[ee+0][We][P.BLKSIZE_s/2-Pe],Ve=H[ee+0][We][P.BLKSIZE_s/2+Pe];q[We][P.BLKSIZE_s/2-Pe]=(he*he+Ve*Ve)*.5}}{for(var lt=0,Pe=11;Pe<P.HBLKSIZE;Pe++)lt+=F[Pe];pe.tot_ener[J]=lt}if(N.analysis){for(var Pe=0;Pe<P.HBLKSIZE;Pe++)pe.pinfo.energy[oe][J][Pe]=pe.pinfo.energy_save[J][Pe],pe.pinfo.energy_save[J][Pe]=F[Pe];pe.pinfo.pe[oe][J]=pe.pe[J]}N.athaa_loudapprox==2&&J<2&&(pe.loudness_sq[oe][J]=pe.loudness_sq_save[J],pe.loudness_sq_save[J]=k(F,pe))}var p=8,I=23,D=15,x,B,_,A=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function T(){x=Math.pow(10,(p+1)/16),B=Math.pow(10,(I+1)/16),_=Math.pow(10,D/10)}var v=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],w=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],b=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function y(N,F,q,G,Y,H){var ee;if(F>N)if(F<N*B)ee=F/N;else return N+F;else{if(N>=F*B)return N+F;ee=N/F}if(N+=F,G+3<=3+3){if(ee>=x)return N;var oe=0|fs.FAST_LOG10_X(ee,16);return N*w[oe]}var oe=0|fs.FAST_LOG10_X(ee,16);if(H!=0?F=Y.ATH.cb_s[q]*Y.ATH.adjust:F=Y.ATH.cb_l[q]*Y.ATH.adjust,N<_*F){if(N>F){var J,me;return J=1,oe<=13&&(J=b[oe]),me=fs.FAST_LOG10_X(N/F,10/15),N*((v[oe]-J)*me+J)}return oe>13?N:N*b[oe]}return N*v[oe]}var R=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function S(N,F,q){var G;if(N<0&&(N=0),F<0&&(F=0),N<=0)return F;if(F<=0)return N;if(F>N?G=F/N:G=N/F,q>=-2&&q<=2){if(G>=x)return N+F;var Y=0|fs.FAST_LOG10_X(G,16);return(N+F)*R[Y]}return G<B?N+F:(N<F&&(N=F),N)}function U(N,F){var q=N.internal_flags;if(q.channels_out>1){for(var G=0;G<P.SBMAX_l;G++){var Y=q.thm[0].l[G],H=q.thm[1].l[G];q.thm[0].l[G]+=H*F,q.thm[1].l[G]+=Y*F}for(var G=0;G<P.SBMAX_s;G++)for(var ee=0;ee<3;ee++){var Y=q.thm[0].s[G][ee],H=q.thm[1].s[G][ee];q.thm[0].s[G][ee]+=H*F,q.thm[1].s[G][ee]+=Y*F}}}function W(N){for(var F=0;F<P.SBMAX_l;F++)if(!(N.thm[0].l[F]>1.58*N.thm[1].l[F]||N.thm[1].l[F]>1.58*N.thm[0].l[F])){var q=N.mld_l[F]*N.en[3].l[F],G=Math.max(N.thm[2].l[F],Math.min(N.thm[3].l[F],q));q=N.mld_l[F]*N.en[2].l[F];var Y=Math.max(N.thm[3].l[F],Math.min(N.thm[2].l[F],q));N.thm[2].l[F]=G,N.thm[3].l[F]=Y}for(var F=0;F<P.SBMAX_s;F++)for(var H=0;H<3;H++)if(!(N.thm[0].s[F][H]>1.58*N.thm[1].s[F][H]||N.thm[1].s[F][H]>1.58*N.thm[0].s[F][H])){var q=N.mld_s[F]*N.en[3].s[F][H],G=Math.max(N.thm[2].s[F][H],Math.min(N.thm[3].s[F][H],q));q=N.mld_s[F]*N.en[2].s[F][H];var Y=Math.max(N.thm[3].s[F][H],Math.min(N.thm[2].s[F][H],q));N.thm[2].s[F][H]=G,N.thm[3].s[F][H]=Y}}function j(N,F,q){var G=F,Y=Math.pow(10,q);F*=2,G*=2;for(var H=0;H<P.SBMAX_l;H++){var ee,oe,J,me;if(me=N.ATH.cb_l[N.bm_l[H]]*Y,ee=Math.min(Math.max(N.thm[0].l[H],me),Math.max(N.thm[1].l[H],me)),oe=Math.max(N.thm[2].l[H],me),J=Math.max(N.thm[3].l[H],me),ee*F<oe+J){var ae=ee*G/(oe+J);oe*=ae,J*=ae}N.thm[2].l[H]=Math.min(oe,N.thm[2].l[H]),N.thm[3].l[H]=Math.min(J,N.thm[3].l[H])}Y*=P.BLKSIZE_s/P.BLKSIZE;for(var H=0;H<P.SBMAX_s;H++)for(var pe=0;pe<3;pe++){var ee,oe,J,me;if(me=N.ATH.cb_s[N.bm_s[H]]*Y,ee=Math.min(Math.max(N.thm[0].s[H][pe],me),Math.max(N.thm[1].s[H][pe],me)),oe=Math.max(N.thm[2].s[H][pe],me),J=Math.max(N.thm[3].s[H][pe],me),ee*F<oe+J){var ae=ee*F/(oe+J);oe*=ae,J*=ae}N.thm[2].s[H][pe]=Math.min(N.thm[2].s[H][pe],oe),N.thm[3].s[H][pe]=Math.min(N.thm[3].s[H][pe],J)}}function z(N,F,q,G,Y){var H,ee,oe=0,J=0;for(H=ee=0;H<P.SBMAX_s;++ee,++H){for(var me=N.bo_s[H],ae=N.npart_s,pe=me<ae?me:ae;ee<pe;)ct(F[ee]>=0),ct(q[ee]>=0),oe+=F[ee],J+=q[ee],ee++;if(N.en[G].s[H][Y]=oe,N.thm[G].s[H][Y]=J,ee>=ae){++H;break}ct(F[ee]>=0),ct(q[ee]>=0);{var Pe=N.PSY.bo_s_weight[H],Qe=1-Pe;oe=Pe*F[ee],J=Pe*q[ee],N.en[G].s[H][Y]+=oe,N.thm[G].s[H][Y]+=J,oe=Qe*F[ee],J=Qe*q[ee]}}for(;H<P.SBMAX_s;++H)N.en[G].s[H][Y]=0,N.thm[G].s[H][Y]=0}function g(N,F,q,G){var Y,H,ee=0,oe=0;for(Y=H=0;Y<P.SBMAX_l;++H,++Y){for(var J=N.bo_l[Y],me=N.npart_l,ae=J<me?J:me;H<ae;)ct(F[H]>=0),ct(q[H]>=0),ee+=F[H],oe+=q[H],H++;if(N.en[G].l[Y]=ee,N.thm[G].l[Y]=oe,H>=me){++Y;break}ct(F[H]>=0),ct(q[H]>=0);{var pe=N.PSY.bo_l_weight[Y],Pe=1-pe;ee=pe*F[H],oe=pe*q[H],N.en[G].l[Y]+=ee,N.thm[G].l[Y]+=oe,ee=Pe*F[H],oe=Pe*q[H]}}for(;Y<P.SBMAX_l;++Y)N.en[G].l[Y]=0,N.thm[G].l[Y]=0}function C(N,F,q,G,Y,H){var ee=N.internal_flags,oe,J;for(J=oe=0;J<ee.npart_s;++J){for(var me=0,ae=ee.numlines_s[J],pe=0;pe<ae;++pe,++oe){var Pe=F[H][oe];me+=Pe}q[J]=me}for(ct(J==ee.npart_s),oe=J=0;J<ee.npart_s;J++){var Qe=ee.s3ind_s[J][0],Se=ee.s3_ss[oe++]*q[Qe];for(++Qe;Qe<=ee.s3ind_s[J][1];)Se+=ee.s3_ss[oe]*q[Qe],++oe,++Qe;{var We=i*ee.nb_s1[Y][J];G[J]=Math.min(Se,We)}if(ee.blocktype_old[Y&1]==P.SHORT_TYPE){var We=r*ee.nb_s2[Y][J],he=G[J];G[J]=Math.min(We,he)}ee.nb_s2[Y][J]=ee.nb_s1[Y][J],ee.nb_s1[Y][J]=Se,ct(G[J]>=0)}for(;J<=P.CBANDS;++J)q[J]=0,G[J]=0}function te(N,F,q,G){var Y=N.internal_flags;N.short_blocks==Ea.short_block_coupled&&!(F[0]!=0&&F[1]!=0)&&(F[0]=F[1]=0);for(var H=0;H<Y.channels_out;H++)G[H]=P.NORM_TYPE,N.short_blocks==Ea.short_block_dispensed&&(F[H]=1),N.short_blocks==Ea.short_block_forced&&(F[H]=0),F[H]!=0?(ct(Y.blocktype_old[H]!=P.START_TYPE),Y.blocktype_old[H]==P.SHORT_TYPE&&(G[H]=P.STOP_TYPE)):(G[H]=P.SHORT_TYPE,Y.blocktype_old[H]==P.NORM_TYPE&&(Y.blocktype_old[H]=P.START_TYPE),Y.blocktype_old[H]==P.STOP_TYPE&&(Y.blocktype_old[H]=P.SHORT_TYPE)),q[H]=Y.blocktype_old[H],Y.blocktype_old[H]=G[H]}function se(N,F,q){return q>=1?N:q<=0?F:F>0?Math.pow(N/F,q)*F:0}var Te=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function ke(N,F){for(var q=309.07,G=0;G<P.SBMAX_s-1;G++)for(var Y=0;Y<3;Y++){var H=N.thm.s[G][Y];if(H>0){var ee=H*F,oe=N.en.s[G][Y];oe>ee&&(oe>ee*1e10?q+=Te[G]*(10*e):q+=Te[G]*fs.FAST_LOG10(oe/ee))}}return q}var Oe=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function be(N,F){for(var q=281.0575,G=0;G<P.SBMAX_l-1;G++){var Y=N.thm.l[G];if(Y>0){var H=Y*F,ee=N.en.l[G];ee>H&&(ee>H*1e10?q+=Oe[G]*(10*e):q+=Oe[G]*fs.FAST_LOG10(ee/H))}}return q}function ze(N,F,q,G,Y){var H,ee;for(H=ee=0;H<N.npart_l;++H){var oe=0,J=0,me;for(me=0;me<N.numlines_l[H];++me,++ee){var ae=F[ee];oe+=ae,J<ae&&(J=ae)}q[H]=oe,G[H]=J,Y[H]=oe*N.rnumlines_l[H],ct(N.rnumlines_l[H]>=0),ct(q[H]>=0),ct(G[H]>=0),ct(Y[H]>=0)}}function Be(N,F,q,G){var Y=A.length-1,H=0,ee=q[H]+q[H+1];if(ee>0){var oe=F[H];oe<F[H+1]&&(oe=F[H+1]),ct(N.numlines_l[H]+N.numlines_l[H+1]-1>0),ee=20*(oe*2-ee)/(ee*(N.numlines_l[H]+N.numlines_l[H+1]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;for(H=1;H<N.npart_l-1;H++)if(ee=q[H-1]+q[H]+q[H+1],ee>0){var oe=F[H-1];oe<F[H]&&(oe=F[H]),oe<F[H+1]&&(oe=F[H+1]),ct(N.numlines_l[H-1]+N.numlines_l[H]+N.numlines_l[H+1]-1>0),ee=20*(oe*3-ee)/(ee*(N.numlines_l[H-1]+N.numlines_l[H]+N.numlines_l[H+1]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;if(ct(H==N.npart_l-1),ee=q[H-1]+q[H],ee>0){var oe=F[H-1];oe<F[H]&&(oe=F[H]),ct(N.numlines_l[H-1]+N.numlines_l[H]-1>0),ee=20*(oe*2-ee)/(ee*(N.numlines_l[H-1]+N.numlines_l[H]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;ct(H==N.npart_l-1)}var we=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(N,F,q,G,Y,H,ee,oe,J,me){var ae=N.internal_flags,pe=Gs([2,P.BLKSIZE]),Pe=Gs([2,3,P.BLKSIZE_s]),Qe=vn(P.CBANDS+1),Se=vn(P.CBANDS+1),We=vn(P.CBANDS+2),he=ro(2),Ve=ro(2),lt,Ae,$e,Re,Ze,Zt,je,st,ut=Gs([2,576]),rn,Rs=ro(P.CBANDS+2),mn=ro(P.CBANDS+2);for(g$.fill(mn,0),lt=ae.channels_out,N.mode==Mt.JOINT_STEREO&&(lt=4),N.VBR==wa.vbr_off?rn=ae.ResvMax==0?0:ae.ResvSize/ae.ResvMax*.5:N.VBR==wa.vbr_rh||N.VBR==wa.vbr_mtrh||N.VBR==wa.vbr_mt?rn=.6:rn=1,Ae=0;Ae<ae.channels_out;Ae++){var on=F[Ae],hs=q+576-350-m+192;for(Re=0;Re<576;Re++){var Cs,Is;for(Cs=on[hs+Re+10],Is=0,Ze=0;Ze<(m-1)/2-1;Ze+=2)Cs+=we[Ze]*(on[hs+Re+Ze]+on[hs+Re+m-Ze]),Is+=we[Ze+1]*(on[hs+Re+Ze+1]+on[hs+Re+m-Ze-1]);ut[Ae][Re]=Cs+Is}Y[G][Ae].en.assign(ae.en[Ae]),Y[G][Ae].thm.assign(ae.thm[Ae]),lt>2&&(H[G][Ae].en.assign(ae.en[Ae+2]),H[G][Ae].thm.assign(ae.thm[Ae+2]))}for(Ae=0;Ae<lt;Ae++){var ii,ri,jn=vn(12),vi=[0,0,0,0],_a=vn(12),xm=1,zv,Kv=vn(P.CBANDS),Gv=vn(P.CBANDS),an=[0,0,0,0],Wv=vn(P.HBLKSIZE),Yv=Gs([3,P.HBLKSIZE_s]);for(ct(ae.npart_s<=P.CBANDS),ct(ae.npart_l<=P.CBANDS),Re=0;Re<3;Re++)jn[Re]=ae.nsPsy.last_en_subshort[Ae][Re+6],ct(ae.nsPsy.last_en_subshort[Ae][Re+4]>0),_a[Re]=jn[Re]/ae.nsPsy.last_en_subshort[Ae][Re+4],vi[0]+=jn[Re];if(Ae==2)for(Re=0;Re<576;Re++){var Om,Nm;Om=ut[0][Re],Nm=ut[1][Re],ut[0][Re]=Om+Nm,ut[1][Re]=Om-Nm}{var Xv=ut[Ae&1],Dl=0;for(Re=0;Re<9;Re++){for(var DS=Dl+64,An=1;Dl<DS;Dl++)An<Math.abs(Xv[Dl])&&(An=Math.abs(Xv[Dl]));ae.nsPsy.last_en_subshort[Ae][Re]=jn[Re+3]=An,vi[1+Re/3]+=An,An>jn[Re+3-2]?(ct(jn[Re+3-2]>0),An=An/jn[Re+3-2]):jn[Re+3-2]>An*10?An=jn[Re+3-2]/(An*10):An=0,_a[Re+3]=An}}if(N.analysis){var Lm=_a[0];for(Re=1;Re<12;Re++)Lm<_a[Re]&&(Lm=_a[Re]);ae.pinfo.ers[G][Ae]=ae.pinfo.ers_save[Ae],ae.pinfo.ers_save[Ae]=Lm}for(zv=Ae==3?ae.nsPsy.attackthre_s:ae.nsPsy.attackthre,Re=0;Re<12;Re++)an[Re/3]==0&&_a[Re]>zv&&(an[Re/3]=Re%3+1);for(Re=1;Re<4;Re++){var Dm;vi[Re-1]>vi[Re]?(ct(vi[Re]>0),Dm=vi[Re-1]/vi[Re]):(ct(vi[Re-1]>0),Dm=vi[Re]/vi[Re-1]),Dm<1.7&&(an[Re]=0,Re==1&&(an[0]=0))}for(an[0]!=0&&ae.nsPsy.lastAttacks[Ae]!=0&&(an[0]=0),(ae.nsPsy.lastAttacks[Ae]==3||an[0]+an[1]+an[2]+an[3]!=0)&&(xm=0,an[1]!=0&&an[0]!=0&&(an[1]=0),an[2]!=0&&an[1]!=0&&(an[2]=0),an[3]!=0&&an[2]!=0&&(an[3]=0)),Ae<2?Ve[Ae]=xm:xm==0&&(Ve[0]=Ve[1]=0),J[Ae]=ae.tot_ener[Ae],ri=Pe,ii=pe,L(N,Wv,Yv,ii,Ae&1,ri,Ae&1,G,Ae,F,q),ze(ae,Wv,Qe,Kv,Gv),Be(ae,Kv,Gv,Rs),st=0;st<3;st++){var Pm,ds;for(C(N,Yv,Se,We,Ae,st),z(ae,Se,We,Ae,st),je=0;je<P.SBMAX_s;je++){if(ds=ae.thm[Ae].s[je][st],ds*=c,an[st]>=2||an[st+1]==1){var Pl=st!=0?st-1:2,An=se(ae.thm[Ae].s[je][Pl],ds,d*rn);ds=Math.min(ds,An)}if(an[st]==1){var Pl=st!=0?st-1:2,An=se(ae.thm[Ae].s[je][Pl],ds,u*rn);ds=Math.min(ds,An)}else if(st!=0&&an[st-1]==3||st==0&&ae.nsPsy.lastAttacks[Ae]==3){var Pl=st!=2?st+1:0,An=se(ae.thm[Ae].s[je][Pl],ds,u*rn);ds=Math.min(ds,An)}Pm=jn[st*3+3]+jn[st*3+4]+jn[st*3+5],jn[st*3+5]*6<Pm&&(ds*=.5,jn[st*3+4]*6<Pm&&(ds*=.5)),ae.thm[Ae].s[je][st]=ds}}for(ae.nsPsy.lastAttacks[Ae]=an[2],Zt=0,$e=0;$e<ae.npart_l;$e++){for(var Zr=ae.s3ind[$e][0],Fm=Qe[Zr]*A[Rs[Zr]],Jr=ae.s3_ll[Zt++]*Fm;++Zr<=ae.s3ind[$e][1];)Fm=Qe[Zr]*A[Rs[Zr]],Jr=y(Jr,ae.s3_ll[Zt++]*Fm,Zr,Zr-$e,ae,0);Jr*=.158489319246111,ae.blocktype_old[Ae&1]==P.SHORT_TYPE?We[$e]=Jr:We[$e]=se(Math.min(Jr,Math.min(n*ae.nb_1[Ae][$e],s*ae.nb_2[Ae][$e])),Jr,rn),ae.nb_2[Ae][$e]=ae.nb_1[Ae][$e],ae.nb_1[Ae][$e]=Jr}for(;$e<=P.CBANDS;++$e)Qe[$e]=0,We[$e]=0;g(ae,Qe,We,Ae)}if((N.mode==Mt.STEREO||N.mode==Mt.JOINT_STEREO)&&N.interChRatio>0&&U(N,N.interChRatio),N.mode==Mt.JOINT_STEREO){var Bm;W(ae),Bm=N.msfix,Math.abs(Bm)>0&&j(ae,Bm,N.ATHlower*ae.ATH.adjust)}for(te(N,Ve,me,he),Ae=0;Ae<lt;Ae++){var Fl,Bl=0,eh,th;Ae>1?(Fl=oe,Bl=-2,eh=P.NORM_TYPE,(me[0]==P.SHORT_TYPE||me[1]==P.SHORT_TYPE)&&(eh=P.SHORT_TYPE),th=H[G][Ae-2]):(Fl=ee,Bl=0,eh=me[Ae],th=Y[G][Ae]),eh==P.SHORT_TYPE?Fl[Bl+Ae]=ke(th,ae.masking_lower):Fl[Bl+Ae]=be(th,ae.masking_lower),N.analysis&&(ae.pinfo.pe[G][Ae]=Fl[Bl+Ae])}return 0};function Xe(N,F,q,G,Y,H,ee,oe){var J=N.internal_flags;if(G<2)t.fft_long(J,ee[oe],G,F,q);else if(G==2)for(var me=P.BLKSIZE-1;me>=0;--me){var ae=ee[oe+0][me],pe=ee[oe+1][me];ee[oe+0][me]=(ae+pe)*fs.SQRT2*.5,ee[oe+1][me]=(ae-pe)*fs.SQRT2*.5}H[0]=ee[oe+0][0],H[0]*=H[0];for(var me=P.BLKSIZE/2-1;me>=0;--me){var Pe=ee[oe+0][P.BLKSIZE/2-me],Qe=ee[oe+0][P.BLKSIZE/2+me];H[P.BLKSIZE/2-me]=(Pe*Pe+Qe*Qe)*.5}{for(var Se=0,me=11;me<P.HBLKSIZE;me++)Se+=H[me];J.tot_ener[G]=Se}if(N.analysis){for(var me=0;me<P.HBLKSIZE;me++)J.pinfo.energy[Y][G][me]=J.pinfo.energy_save[G][me],J.pinfo.energy_save[G][me]=H[me];J.pinfo.pe[Y][G]=J.pe[G]}}function mt(N,F,q,G,Y,H,ee,oe){var J=N.internal_flags;if(Y==0&&G<2&&t.fft_short(J,ee[oe],G,F,q),G==2)for(var me=P.BLKSIZE_s-1;me>=0;--me){var ae=ee[oe+0][Y][me],pe=ee[oe+1][Y][me];ee[oe+0][Y][me]=(ae+pe)*fs.SQRT2*.5,ee[oe+1][Y][me]=(ae-pe)*fs.SQRT2*.5}H[Y][0]=ee[oe+0][Y][0],H[Y][0]*=H[Y][0];for(var me=P.BLKSIZE_s/2-1;me>=0;--me){var Pe=ee[oe+0][Y][P.BLKSIZE_s/2-me],Qe=ee[oe+0][Y][P.BLKSIZE_s/2+me];H[Y][P.BLKSIZE_s/2-me]=(Pe*Pe+Qe*Qe)*.5}}function E(N,F,q,G){var Y=N.internal_flags;N.athaa_loudapprox==2&&q<2&&(Y.loudness_sq[F][q]=Y.loudness_sq_save[q],Y.loudness_sq_save[q]=k(G,Y))}var O=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function V(N,F,q,G,Y,H,ee,oe,J,me){for(var ae=Gs([2,576]),pe=N.internal_flags,Pe=pe.channels_out,Qe=N.mode==Mt.JOINT_STEREO?4:Pe,Se=0;Se<Pe;Se++){firbuf=F[Se];for(var We=q+576-350-m+192,he=0;he<576;he++){var Ve,lt;Ve=firbuf[We+he+10],lt=0;for(var Ae=0;Ae<(m-1)/2-1;Ae+=2)Ve+=O[Ae]*(firbuf[We+he+Ae]+firbuf[We+he+m-Ae]),lt+=O[Ae+1]*(firbuf[We+he+Ae+1]+firbuf[We+he+m-Ae-1]);ae[Se][he]=Ve+lt}Y[G][Se].en.assign(pe.en[Se]),Y[G][Se].thm.assign(pe.thm[Se]),Qe>2&&(H[G][Se].en.assign(pe.en[Se+2]),H[G][Se].thm.assign(pe.thm[Se+2]))}for(var Se=0;Se<Qe;Se++){var $e=vn(12),Re=vn(12),Ze=[0,0,0,0],Zt=ae[Se&1],je=0,st=Se==3?pe.nsPsy.attackthre_s:pe.nsPsy.attackthre,ut=1;if(Se==2)for(var he=0,Ae=576;Ae>0;++he,--Ae){var rn=ae[0][he],Rs=ae[1][he];ae[0][he]=rn+Rs,ae[1][he]=rn-Rs}for(var he=0;he<3;he++)Re[he]=pe.nsPsy.last_en_subshort[Se][he+6],ct(pe.nsPsy.last_en_subshort[Se][he+4]>0),$e[he]=Re[he]/pe.nsPsy.last_en_subshort[Se][he+4],Ze[0]+=Re[he];for(var he=0;he<9;he++){for(var mn=je+64,on=1;je<mn;je++)on<Math.abs(Zt[je])&&(on=Math.abs(Zt[je]));pe.nsPsy.last_en_subshort[Se][he]=Re[he+3]=on,Ze[1+he/3]+=on,on>Re[he+3-2]?(ct(Re[he+3-2]>0),on=on/Re[he+3-2]):Re[he+3-2]>on*10?on=Re[he+3-2]/(on*10):on=0,$e[he+3]=on}for(var he=0;he<3;++he){var hs=Re[he*3+3]+Re[he*3+4]+Re[he*3+5],Cs=1;Re[he*3+5]*6<hs&&(Cs*=.5,Re[he*3+4]*6<hs&&(Cs*=.5)),oe[Se][he]=Cs}if(N.analysis){for(var Is=$e[0],he=1;he<12;he++)Is<$e[he]&&(Is=$e[he]);pe.pinfo.ers[G][Se]=pe.pinfo.ers_save[Se],pe.pinfo.ers_save[Se]=Is}for(var he=0;he<12;he++)J[Se][he/3]==0&&$e[he]>st&&(J[Se][he/3]=he%3+1);for(var he=1;he<4;he++){var ii=Ze[he-1],ri=Ze[he],jn=Math.max(ii,ri);jn<4e4&&ii<1.7*ri&&ri<1.7*ii&&(he==1&&J[Se][0]<=J[Se][he]&&(J[Se][0]=0),J[Se][he]=0)}J[Se][0]<=pe.nsPsy.lastAttacks[Se]&&(J[Se][0]=0),(pe.nsPsy.lastAttacks[Se]==3||J[Se][0]+J[Se][1]+J[Se][2]+J[Se][3]!=0)&&(ut=0,J[Se][1]!=0&&J[Se][0]!=0&&(J[Se][1]=0),J[Se][2]!=0&&J[Se][1]!=0&&(J[Se][2]=0),J[Se][3]!=0&&J[Se][2]!=0&&(J[Se][3]=0)),Se<2?me[Se]=ut:ut==0&&(me[0]=me[1]=0),ee[Se]=pe.tot_ener[Se]}}function $(N,F,q){if(q==0)for(var G=0;G<N.npart_s;G++)N.nb_s2[F][G]=N.nb_s1[F][G],N.nb_s1[F][G]=0}function K(N,F){for(var q=0;q<N.npart_l;q++)N.nb_2[F][q]=N.nb_1[F][q],N.nb_1[F][q]=0}function ne(N,F,q,G){var Y=A.length-1,H=0,ee=q[H]+q[H+1];if(ee>0){var oe=F[H];oe<F[H+1]&&(oe=F[H+1]),ct(N.numlines_s[H]+N.numlines_s[H+1]-1>0),ee=20*(oe*2-ee)/(ee*(N.numlines_s[H]+N.numlines_s[H+1]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;for(H=1;H<N.npart_s-1;H++)if(ee=q[H-1]+q[H]+q[H+1],ct(H+1<N.npart_s),ee>0){var oe=F[H-1];oe<F[H]&&(oe=F[H]),oe<F[H+1]&&(oe=F[H+1]),ct(N.numlines_s[H-1]+N.numlines_s[H]+N.numlines_s[H+1]-1>0),ee=20*(oe*3-ee)/(ee*(N.numlines_s[H-1]+N.numlines_s[H]+N.numlines_s[H+1]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;if(ct(H==N.npart_s-1),ee=q[H-1]+q[H],ee>0){var oe=F[H-1];oe<F[H]&&(oe=F[H]),ct(N.numlines_s[H-1]+N.numlines_s[H]-1>0),ee=20*(oe*2-ee)/(ee*(N.numlines_s[H-1]+N.numlines_s[H]-1));var J=0|ee;J>Y&&(J=Y),G[H]=J}else G[H]=0;ct(H==N.npart_s-1)}function le(N,F,q,G,Y,H){var ee=N.internal_flags,oe=new float[P.CBANDS],J=vn(P.CBANDS),me,ae,pe,Pe=new int[P.CBANDS];for(pe=ae=0;pe<ee.npart_s;++pe){var Qe=0,Se=0,We=ee.numlines_s[pe];for(me=0;me<We;++me,++ae){var he=F[H][ae];Qe+=he,Se<he&&(Se=he)}q[pe]=Qe,oe[pe]=Se,J[pe]=Qe/We,ct(J[pe]>=0)}for(ct(pe==ee.npart_s);pe<P.CBANDS;++pe)oe[pe]=0,J[pe]=0;for(ne(ee,oe,J,Pe),ae=pe=0;pe<ee.npart_s;pe++){var Ve=ee.s3ind_s[pe][0],lt=ee.s3ind_s[pe][1],Ae,$e,Re,Ze,Zt;for(Ae=Pe[Ve],$e=1,Ze=ee.s3_ss[ae]*q[Ve]*A[Pe[Ve]],++ae,++Ve;Ve<=lt;)Ae+=Pe[Ve],$e+=1,Re=ee.s3_ss[ae]*q[Ve]*A[Pe[Ve]],Ze=S(Ze,Re,Ve-pe),++ae,++Ve;Ae=(1+2*Ae)/(2*$e),Zt=A[Ae]*.5,Ze*=Zt,G[pe]=Ze,ee.nb_s2[Y][pe]=ee.nb_s1[Y][pe],ee.nb_s1[Y][pe]=Ze,Re=oe[pe],Re*=ee.minval_s[pe],Re*=Zt,G[pe]>Re&&(G[pe]=Re),ee.masking_lower>1&&(G[pe]*=ee.masking_lower),G[pe]>q[pe]&&(G[pe]=q[pe]),ee.masking_lower<1&&(G[pe]*=ee.masking_lower),ct(G[pe]>=0)}for(;pe<P.CBANDS;++pe)q[pe]=0,G[pe]=0}function Q(N,F,q,G,Y){var H=vn(P.CBANDS),ee=vn(P.CBANDS),oe=ro(P.CBANDS+2),J;ze(N,F,q,H,ee),Be(N,H,ee,oe);var me=0;for(J=0;J<N.npart_l;J++){var ae,pe,Pe,Qe,Se=N.s3ind[J][0],We=N.s3ind[J][1],he=0,Ve=0;for(he=oe[Se],Ve+=1,pe=N.s3_ll[me]*q[Se]*A[oe[Se]],++me,++Se;Se<=We;)he+=oe[Se],Ve+=1,ae=N.s3_ll[me]*q[Se]*A[oe[Se]],Qe=S(pe,ae,Se-J),pe=Qe,++me,++Se;if(he=(1+2*he)/(2*Ve),Pe=A[he]*.5,pe*=Pe,N.blocktype_old[Y&1]==P.SHORT_TYPE){var lt=n*N.nb_1[Y][J];lt>0?G[J]=Math.min(pe,lt):G[J]=Math.min(pe,q[J]*u)}else{var Ae=s*N.nb_2[Y][J],$e=n*N.nb_1[Y][J],lt;Ae<=0&&(Ae=pe),$e<=0&&($e=pe),N.blocktype_old[Y&1]==P.NORM_TYPE?lt=Math.min($e,Ae):lt=$e,G[J]=Math.min(pe,lt)}N.nb_2[Y][J]=N.nb_1[Y][J],N.nb_1[Y][J]=pe,ae=H[J],ae*=N.minval_l[J],ae*=Pe,G[J]>ae&&(G[J]=ae),N.masking_lower>1&&(G[J]*=N.masking_lower),G[J]>q[J]&&(G[J]=q[J]),N.masking_lower<1&&(G[J]*=N.masking_lower),ct(G[J]>=0)}for(;J<P.CBANDS;++J)q[J]=0,G[J]=0}function ie(N,F){var q=N.internal_flags;N.short_blocks==Ea.short_block_coupled&&!(F[0]!=0&&F[1]!=0)&&(F[0]=F[1]=0);for(var G=0;G<q.channels_out;G++)N.short_blocks==Ea.short_block_dispensed&&(F[G]=1),N.short_blocks==Ea.short_block_forced&&(F[G]=0)}function X(N,F,q){for(var G=N.internal_flags,Y=0;Y<G.channels_out;Y++){var H=P.NORM_TYPE;F[Y]!=0?(ct(G.blocktype_old[Y]!=P.START_TYPE),G.blocktype_old[Y]==P.SHORT_TYPE&&(H=P.STOP_TYPE)):(H=P.SHORT_TYPE,G.blocktype_old[Y]==P.NORM_TYPE&&(G.blocktype_old[Y]=P.START_TYPE),G.blocktype_old[Y]==P.STOP_TYPE&&(G.blocktype_old[Y]=P.SHORT_TYPE)),q[Y]=G.blocktype_old[Y],G.blocktype_old[Y]=H}}function ve(N,F,q,G,Y,H,ee){for(var oe=H*2,J=H>0?Math.pow(10,Y):1,me,ae,pe=0;pe<ee;++pe){var Pe=N[2][pe],Qe=N[3][pe],Se=F[0][pe],We=F[1][pe],he=F[2][pe],Ve=F[3][pe];if(Se<=1.58*We&&We<=1.58*Se){var lt=q[pe]*Qe,Ae=q[pe]*Pe;ae=Math.max(he,Math.min(Ve,lt)),me=Math.max(Ve,Math.min(he,Ae))}else ae=he,me=Ve;if(H>0){var $e,Re,Ze=G[pe]*J;if($e=Math.min(Math.max(Se,Ze),Math.max(We,Ze)),he=Math.max(ae,Ze),Ve=Math.max(me,Ze),Re=he+Ve,Re>0&&$e*oe<Re){var Zt=$e*oe/Re;he*=Zt,Ve*=Zt}ae=Math.min(he,ae),me=Math.min(Ve,me)}ae>Pe&&(ae=Pe),me>Qe&&(me=Qe),F[2][pe]=ae,F[3][pe]=me}}this.L3psycho_anal_vbr=function(N,F,q,G,Y,H,ee,oe,J,me){var ae=N.internal_flags,pe,Pe,Qe=vn(P.HBLKSIZE),Se=Gs([3,P.HBLKSIZE_s]),We=Gs([2,P.BLKSIZE]),he=Gs([2,3,P.BLKSIZE_s]),Ve=Gs([4,P.CBANDS]),lt=Gs([4,P.CBANDS]),Ae=Gs([4,3]),$e=.6,Re=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Ze=ro(2),Zt=N.mode==Mt.JOINT_STEREO?4:ae.channels_out;V(N,F,q,G,Y,H,J,Ae,Re,Ze),ie(N,Ze);{for(var je=0;je<Zt;je++){var st=je&1;pe=We,Xe(N,F,q,je,G,Qe,pe,st),E(N,G,je,Qe),Ze[st]!=0?Q(ae,Qe,Ve[je],lt[je],je):K(ae,je)}Ze[0]+Ze[1]==2&&N.mode==Mt.JOINT_STEREO&&ve(Ve,lt,ae.mld_cb_l,ae.ATH.cb_l,N.ATHlower*ae.ATH.adjust,N.msfix,ae.npart_l);for(var je=0;je<Zt;je++){var st=je&1;Ze[st]!=0&&g(ae,Ve[je],lt[je],je)}}{for(var ut=0;ut<3;ut++){for(var je=0;je<Zt;++je){var st=je&1;Ze[st]!=0?$(ae,je,ut):(Pe=he,mt(N,F,q,je,ut,Se,Pe,st),le(N,Se,Ve[je],lt[je],je,ut))}Ze[0]+Ze[1]==0&&N.mode==Mt.JOINT_STEREO&&ve(Ve,lt,ae.mld_cb_s,ae.ATH.cb_s,N.ATHlower*ae.ATH.adjust,N.msfix,ae.npart_s);for(var je=0;je<Zt;++je){var st=je&1;Ze[st]==0&&z(ae,Ve[je],lt[je],je,ut)}}for(var je=0;je<Zt;je++){var st=je&1;if(Ze[st]==0)for(var rn=0;rn<P.SBMAX_s;rn++){for(var Rs=vn(3),ut=0;ut<3;ut++){var mn=ae.thm[je].s[rn][ut];if(mn*=c,Re[je][ut]>=2||Re[je][ut+1]==1){var on=ut!=0?ut-1:2,hs=se(ae.thm[je].s[rn][on],mn,d*$e);mn=Math.min(mn,hs)}else if(Re[je][ut]==1){var on=ut!=0?ut-1:2,hs=se(ae.thm[je].s[rn][on],mn,u*$e);mn=Math.min(mn,hs)}else if(ut!=0&&Re[je][ut-1]==3||ut==0&&ae.nsPsy.lastAttacks[je]==3){var on=ut!=2?ut+1:0,hs=se(ae.thm[je].s[rn][on],mn,u*$e);mn=Math.min(mn,hs)}mn*=Ae[je][ut],Rs[ut]=mn}for(var ut=0;ut<3;ut++)ae.thm[je].s[rn][ut]=Rs[ut]}}}for(var je=0;je<Zt;je++)ae.nsPsy.lastAttacks[je]=Re[je][2];X(N,Ze,me);for(var je=0;je<Zt;je++){var Cs,Is,ii,ri;je>1?(Cs=oe,Is=-2,ii=P.NORM_TYPE,(me[0]==P.SHORT_TYPE||me[1]==P.SHORT_TYPE)&&(ii=P.SHORT_TYPE),ri=H[G][je-2]):(Cs=ee,Is=0,ii=me[je],ri=Y[G][je]),ii==P.SHORT_TYPE?Cs[Is+je]=ke(ri,ae.masking_lower):Cs[Is+je]=be(ri,ae.masking_lower),N.analysis&&(ae.pinfo.pe[G][je]=Cs[Is+je])}return 0};function de(N,F){var q=N,G;return q>=0?G=-q*27:G=q*F,G<=-72?0:Math.exp(G*h)}function ye(N){var F=0,q=0;{var G=0,Y,H;for(G=0;de(G,N)>1e-20;G-=1);for(Y=G,H=0;Math.abs(H-Y)>1e-12;)G=(H+Y)/2,de(G,N)>0?H=G:Y=G;F=Y}{var G=0,Y,H;for(G=0;de(G,N)>1e-20;G+=1);for(Y=0,H=G;Math.abs(H-Y)>1e-12;)G=(H+Y)/2,de(G,N)>0?Y=G:H=G;q=H}{var ee=0,oe=1e3,J;for(J=0;J<=oe;++J){var G=F+J*(q-F)/oe,me=de(G,N);ee+=me}{var ae=(oe+1)/(ee*(q-F));return ae}}}function Ie(N){var F,q,G,Y;return F=N,F>=0?F*=3:F*=1.5,F>=.5&&F<=2.5?(Y=F-.5,q=8*(Y*Y-2*Y)):q=0,F+=.474,G=15.811389+7.5*F-17.5*Math.sqrt(1+F*F),G<=-60?0:(F=Math.exp((q+G)*h),F/=.6609193,F)}function De(N){return N<0&&(N=0),N=N*.001,13*Math.atan(.76*N)+3.5*Math.atan(N*N/(7.5*7.5))}function ce(N,F,q,G,Y,H,ee,oe,J,me,ae,pe){var Pe=vn(P.CBANDS+1),Qe=oe/(pe>15?2*576:2*192),Se=ro(P.HBLKSIZE),We;oe/=J;var he=0,Ve=0;for(We=0;We<P.CBANDS;We++){var lt,Ae;for(lt=De(oe*he),Pe[We]=oe*he,Ae=he;De(oe*Ae)-lt<o&&Ae<=J/2;Ae++);for(N[We]=Ae-he,Ve=We+1;he<Ae;)Se[he++]=We;if(he>J/2){he=J/2,++We;break}}Pe[We]=oe*he;for(var $e=0;$e<pe;$e++){var Re,Ze,Zt,je,st;Zt=me[$e],je=me[$e+1],Re=0|Math.floor(.5+ae*(Zt-.5)),Re<0&&(Re=0),Ze=0|Math.floor(.5+ae*(je-.5)),Ze>J/2&&(Ze=J/2),q[$e]=(Se[Re]+Se[Ze])/2,F[$e]=Se[Ze];var ut=Qe*je;ee[$e]=(ut-Pe[F[$e]])/(Pe[F[$e]+1]-Pe[F[$e]]),ee[$e]<0?ee[$e]=0:ee[$e]>1&&(ee[$e]=1),st=De(oe*me[$e]*ae),st=Math.min(st,15.5)/15.5,H[$e]=Math.pow(10,1.25*(1-Math.cos(Math.PI*st))-2.5)}he=0;for(var rn=0;rn<Ve;rn++){var Rs=N[rn],lt,mn;lt=De(oe*he),mn=De(oe*(he+Rs-1)),G[rn]=.5*(lt+mn),lt=De(oe*(he-.5)),mn=De(oe*(he+Rs-.5)),Y[rn]=mn-lt,he+=Rs}return Ve}function _e(N,F,q,G,Y,H){var ee=Gs([P.CBANDS,P.CBANDS]),oe,J=0;if(H)for(var me=0;me<F;me++)for(oe=0;oe<F;oe++){var ae=Ie(q[me]-q[oe])*G[oe];ee[me][oe]=ae*Y[me]}else for(oe=0;oe<F;oe++)for(var pe=15+Math.min(21/q[oe],12),Pe=ye(pe),me=0;me<F;me++){var ae=Pe*de(q[me]-q[oe],pe)*G[oe];ee[me][oe]=ae*Y[me]}for(var me=0;me<F;me++){for(oe=0;oe<F&&!(ee[me][oe]>0);oe++);for(N[me][0]=oe,oe=F-1;oe>0&&!(ee[me][oe]>0);oe--);N[me][1]=oe,J+=N[me][1]-N[me][0]+1}for(var Qe=vn(J),Se=0,me=0;me<F;me++)for(oe=N[me][0];oe<=N[me][1];oe++)Qe[Se++]=ee[me][oe];return Qe}function Z(N){var F=De(N);return F=Math.min(F,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*F))-2.5)}this.psymodel_init=function(N){var F=N.internal_flags,q,G=!0,Y=13,H=24,ee=0,oe=0,J=-8.25,me=-4.5,ae=vn(P.CBANDS),pe=vn(P.CBANDS),Pe=vn(P.CBANDS),Qe=N.out_samplerate;switch(N.experimentalZ){default:case 0:G=!0;break;case 1:G=!(N.VBR==wa.vbr_mtrh||N.VBR==wa.vbr_mt);break;case 2:G=!1;break;case 3:Y=8,ee=-1.75,oe=-.0125,J=-8.25,me=-2.25;break}for(F.ms_ener_ratio_old=.25,F.blocktype_old[0]=F.blocktype_old[1]=P.NORM_TYPE,q=0;q<4;++q){for(var he=0;he<P.CBANDS;++he)F.nb_1[q][he]=1e20,F.nb_2[q][he]=1e20,F.nb_s1[q][he]=F.nb_s2[q][he]=1;for(var Se=0;Se<P.SBMAX_l;Se++)F.en[q].l[Se]=1e20,F.thm[q].l[Se]=1e20;for(var he=0;he<3;++he){for(var Se=0;Se<P.SBMAX_s;Se++)F.en[q].s[Se][he]=1e20,F.thm[q].s[Se][he]=1e20;F.nsPsy.lastAttacks[q]=0}for(var he=0;he<9;he++)F.nsPsy.last_en_subshort[q][he]=10}for(F.loudness_sq_save[0]=F.loudness_sq_save[1]=0,F.npart_l=ce(F.numlines_l,F.bo_l,F.bm_l,ae,pe,F.mld_l,F.PSY.bo_l_weight,Qe,P.BLKSIZE,F.scalefac_band.l,P.BLKSIZE/(2*576),P.SBMAX_l),ct(F.npart_l<P.CBANDS),q=0;q<F.npart_l;q++){var We=ee;ae[q]>=Y&&(We=oe*(ae[q]-Y)/(H-Y)+ee*(H-ae[q])/(H-Y)),Pe[q]=Math.pow(10,We/10),F.numlines_l[q]>0?F.rnumlines_l[q]=1/F.numlines_l[q]:F.rnumlines_l[q]=0}F.s3_ll=_e(F.s3ind,F.npart_l,ae,pe,Pe,G);var he=0;for(q=0;q<F.npart_l;q++){var Ve;Ve=F3.MAX_VALUE;for(var lt=0;lt<F.numlines_l[q];lt++,he++){var Ae=Qe*he/(1e3*P.BLKSIZE),$e;$e=this.ATHformula(Ae*1e3,N)-20,$e=Math.pow(10,.1*$e),$e*=F.numlines_l[q],Ve>$e&&(Ve=$e)}F.ATH.cb_l[q]=Ve,Ve=-20+ae[q]*20/10,Ve>6&&(Ve=100),Ve<-15&&(Ve=-15),Ve-=8,F.minval_l[q]=Math.pow(10,Ve/10)*F.numlines_l[q]}for(F.npart_s=ce(F.numlines_s,F.bo_s,F.bm_s,ae,pe,F.mld_s,F.PSY.bo_s_weight,Qe,P.BLKSIZE_s,F.scalefac_band.s,P.BLKSIZE_s/(2*192),P.SBMAX_s),ct(F.npart_s<P.CBANDS),he=0,q=0;q<F.npart_s;q++){var Ve,We=J;ae[q]>=Y&&(We=me*(ae[q]-Y)/(H-Y)+J*(H-ae[q])/(H-Y)),Pe[q]=Math.pow(10,We/10),Ve=F3.MAX_VALUE;for(var lt=0;lt<F.numlines_s[q];lt++,he++){var Ae=Qe*he/(1e3*P.BLKSIZE_s),$e;$e=this.ATHformula(Ae*1e3,N)-20,$e=Math.pow(10,.1*$e),$e*=F.numlines_s[q],Ve>$e&&(Ve=$e)}F.ATH.cb_s[q]=Ve,Ve=-7+ae[q]*7/12,ae[q]>12&&(Ve*=1+Math.log(1+Ve)*3.1),ae[q]<12&&(Ve*=1+Math.log(1-Ve)*2.3),Ve<-15&&(Ve=-15),Ve-=8,F.minval_s[q]=Math.pow(10,Ve/10)*F.numlines_s[q]}F.s3_ss=_e(F.s3ind_s,F.npart_s,ae,pe,Pe,G),T(),t.init_fft(F),F.decay=Math.exp(-1*e/(l*Qe/192));{var Re;Re=f,(N.exp_nspsytune&2)!=0&&(Re=1),Math.abs(N.msfix)>0&&(Re=N.msfix),N.msfix=Re;for(var Ze=0;Ze<F.npart_l;Ze++)F.s3ind[Ze][1]>F.npart_l-1&&(F.s3ind[Ze][1]=F.npart_l-1)}var Zt=576*F.mode_gr/Qe;if(F.ATH.decay=Math.pow(10,-12/10*Zt),F.ATH.adjust=.01,F.ATH.adjustLimit=1,ct(F.bo_l[P.SBMAX_l-1]<=F.npart_l),ct(F.bo_s[P.SBMAX_s-1]<=F.npart_s),N.ATHtype!=-1){var Ae,je=N.out_samplerate/P.BLKSIZE,st=0;for(Ae=0,q=0;q<P.BLKSIZE/2;++q)Ae+=je,F.ATH.eql_w[q]=1/Math.pow(10,this.ATHformula(Ae,N)/10),st+=F.ATH.eql_w[q];for(st=1/st,q=P.BLKSIZE/2;--q>=0;)F.ATH.eql_w[q]*=st}{for(var Ze=he=0;Ze<F.npart_s;++Ze)for(q=0;q<F.numlines_s[Ze];++q)++he;for(var Ze=he=0;Ze<F.npart_l;++Ze)for(q=0;q<F.numlines_l[Ze];++q)++he}for(he=0,q=0;q<F.npart_l;q++){var Ae=Qe*(he+F.numlines_l[q]/2)/(1*P.BLKSIZE);F.mld_cb_l[q]=Z(Ae),he+=F.numlines_l[q]}for(;q<P.CBANDS;++q)F.mld_cb_l[q]=1;for(he=0,q=0;q<F.npart_s;q++){var Ae=Qe*(he+F.numlines_s[q]/2)/(1*P.BLKSIZE_s);F.mld_cb_s[q]=Z(Ae),he+=F.numlines_s[q]}for(;q<P.CBANDS;++q)F.mld_cb_s[q]=1;return 0};function Me(N,F){N<-.3&&(N=3410),N/=1e3,N=Math.max(.1,N);var q=3.64*Math.pow(N,-.8)-6.8*Math.exp(-.6*Math.pow(N-3.4,2))+6*Math.exp(-.15*Math.pow(N-8.7,2))+(.6+.04*F)*.001*Math.pow(N,4);return q}this.ATHformula=function(N,F){var q;switch(F.ATHtype){case 0:q=Me(N,9);break;case 1:q=Me(N,-1);break;case 2:q=Me(N,0);break;case 3:q=Me(N,1)+6;break;case 4:q=Me(N,F.ATHcurve);break;default:q=Me(N,0);break}return q}}function _$(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Mt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Pr={};Pr.SFBMAX=P.SBMAX_s*3;var v$=Ne.new_float,oo=Ne.new_int;function Qd(){this.xr=v$(576),this.l3_enc=oo(576),this.scalefac=oo(Pr.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=oo(3),this.subblock_gain=oo(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=oo(Pr.SFBMAX),this.window=oo(Pr.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=oo(4),this.max_nonzero_coeff=0;var t=this;function e(s){return new Int32Array(s)}function n(s){return new Float32Array(s)}this.assign=function(s){t.xr=n(s.xr),t.l3_enc=e(s.l3_enc),t.scalefac=e(s.scalefac),t.xrpow_max=s.xrpow_max,t.part2_3_length=s.part2_3_length,t.big_values=s.big_values,t.count1=s.count1,t.global_gain=s.global_gain,t.scalefac_compress=s.scalefac_compress,t.block_type=s.block_type,t.mixed_block_flag=s.mixed_block_flag,t.table_select=e(s.table_select),t.subblock_gain=e(s.subblock_gain),t.region0_count=s.region0_count,t.region1_count=s.region1_count,t.preflag=s.preflag,t.scalefac_scale=s.scalefac_scale,t.count1table_select=s.count1table_select,t.part2_length=s.part2_length,t.sfb_lmax=s.sfb_lmax,t.sfb_smin=s.sfb_smin,t.psy_lmax=s.psy_lmax,t.sfbmax=s.sfbmax,t.psymax=s.psymax,t.sfbdivide=s.sfbdivide,t.width=e(s.width),t.window=e(s.window),t.count1bits=s.count1bits,t.sfb_partition_table=s.sfb_partition_table.slice(0),t.slen=e(s.slen),t.max_nonzero_coeff=s.max_nonzero_coeff}}var B3=Ne.new_int;function y$(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[B3(4),B3(4)];for(var t=0;t<2;t++)for(var e=0;e<2;e++)this.tt[t][e]=new Qd}var xh=Ne.System,Oh=Ne.new_int;function Ai(t,e,n,s){this.l=Oh(1+P.SBMAX_l),this.s=Oh(1+P.SBMAX_s),this.psfb21=Oh(1+P.PSFB21),this.psfb12=Oh(1+P.PSFB12);var i=this.l,r=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],xh.arraycopy(this.arrL,0,i,0,Math.min(this.arrL.length,this.l.length)),xh.arraycopy(this.arrS,0,r,0,Math.min(this.arrS.length,this.s.length)),xh.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),xh.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var L1=Ne.new_float,b$=Ne.new_float_n,w$=Ne.new_int;function E$(){this.last_en_subshort=b$([4,9]),this.lastAttacks=w$(4),this.pefirbuf=L1(19),this.longfact=L1(P.SBMAX_l),this.shortfact=L1(P.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function T$(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var S$=Ne.new_byte,A$=Ne.new_double,Ws=Ne.new_float,ao=Ne.new_float_n,oi=Ne.new_int,Nh=Ne.new_int_n;Rt.MFSIZE=3*1152+P.ENCDELAY-P.MDCTDELAY;Rt.MAX_HEADER_BUF=256;Rt.MAX_BITS_PER_CHANNEL=4095;Rt.MAX_BITS_PER_GRANULE=7680;Rt.BPC=320;function Rt(){var t=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=ao([2,Rt.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new y$,this.ms_ratio=Ws(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=oi(2),this.CurrentStep=oi(2),this.masking_lower=0,this.bv_scf=oi(576),this.pseudohalf=oi(Pr.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Rt.BPC+1),this.itime=A$(2),this.sideinfo_len=0,this.sb_sample=ao([2,2,18,P.SBLIMIT]),this.amp_filter=Ws(32);function e(){this.write_timing=0,this.ptr=0,this.buf=S$(t)}this.header=new Array(Rt.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Ai,this.minval_l=Ws(P.CBANDS),this.minval_s=Ws(P.CBANDS),this.nb_1=ao([4,P.CBANDS]),this.nb_2=ao([4,P.CBANDS]),this.nb_s1=ao([4,P.CBANDS]),this.nb_s2=ao([4,P.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Ws(4),this.loudness_sq=ao([2,2]),this.loudness_sq_save=Ws(2),this.mld_l=Ws(P.SBMAX_l),this.mld_s=Ws(P.SBMAX_s),this.bm_l=oi(P.SBMAX_l),this.bo_l=oi(P.SBMAX_l),this.bm_s=oi(P.SBMAX_s),this.bo_s=oi(P.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Nh([P.CBANDS,2]),this.s3ind_s=Nh([P.CBANDS,2]),this.numlines_s=oi(P.CBANDS),this.numlines_l=oi(P.CBANDS),this.rnumlines_l=Ws(P.CBANDS),this.mld_cb_l=Ws(P.CBANDS),this.mld_cb_s=Ws(P.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Ws(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=oi(2),this.nsPsy=new E$,this.VBR_seek_table=new T$,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Nh([16,4+1]),this.bitrate_blockType_Hist=Nh([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new Xd;for(var n=0;n<this.thm.length;n++)this.thm[n]=new Xd;for(var n=0;n<this.header.length;n++)this.header[n]=new e}var lo=Ne.new_float;function R$(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=lo(P.SBMAX_l),this.s=lo(P.SBMAX_s),this.psfb21=lo(P.PSFB21),this.psfb12=lo(P.PSFB12),this.cb_l=lo(P.CBANDS),this.cb_s=lo(P.CBANDS),this.eql_w=lo(P.BLKSIZE/2)}var ms=Ne.System,U3=Ne.Arrays;dn.STEPS_per_dB=100;dn.MAX_dB=120;dn.GAIN_NOT_ENOUGH_SAMPLES=-24601;dn.GAIN_ANALYSIS_ERROR=0;dn.GAIN_ANALYSIS_OK=1;dn.INIT_GAIN_ANALYSIS_ERROR=0;dn.INIT_GAIN_ANALYSIS_OK=1;dn.YULE_ORDER=10;dn.MAX_ORDER=dn.YULE_ORDER;dn.MAX_SAMP_FREQ=48e3;dn.RMS_WINDOW_TIME_NUMERATOR=1;dn.RMS_WINDOW_TIME_DENOMINATOR=20;dn.MAX_SAMPLES_PER_WINDOW=dn.MAX_SAMP_FREQ*dn.RMS_WINDOW_TIME_NUMERATOR/dn.RMS_WINDOW_TIME_DENOMINATOR+1;function dn(){var t=64.82,e=.95,n=dn.RMS_WINDOW_TIME_NUMERATOR,s=dn.RMS_WINDOW_TIME_DENOMINATOR,i=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],r=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(u,f,m,h,M,k){for(;M--!=0;)m[h]=1e-10+u[f+0]*k[0]-m[h-1]*k[1]+u[f-1]*k[2]-m[h-2]*k[3]+u[f-2]*k[4]-m[h-3]*k[5]+u[f-3]*k[6]-m[h-4]*k[7]+u[f-4]*k[8]-m[h-5]*k[9]+u[f-5]*k[10]-m[h-6]*k[11]+u[f-6]*k[12]-m[h-7]*k[13]+u[f-7]*k[14]-m[h-8]*k[15]+u[f-8]*k[16]-m[h-9]*k[17]+u[f-9]*k[18]-m[h-10]*k[19]+u[f-10]*k[20],++h,++f}function a(u,f,m,h,M,k){for(;M--!=0;)m[h]=u[f+0]*k[0]-m[h-1]*k[1]+u[f-1]*k[2]-m[h-2]*k[3]+u[f-2]*k[4],++h,++f}function l(u,f){for(var m=0;m<MAX_ORDER;m++)u.linprebuf[m]=u.lstepbuf[m]=u.loutbuf[m]=u.rinprebuf[m]=u.rstepbuf[m]=u.routbuf[m]=0;switch(0|f){case 48e3:u.reqindex=0;break;case 44100:u.reqindex=1;break;case 32e3:u.reqindex=2;break;case 24e3:u.reqindex=3;break;case 22050:u.reqindex=4;break;case 16e3:u.reqindex=5;break;case 12e3:u.reqindex=6;break;case 11025:u.reqindex=7;break;case 8e3:u.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return u.sampleWindow=0|(f*n+s-1)/s,u.lsum=0,u.rsum=0,u.totsamp=0,U3.ill(u.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(u,f){return l(u,f)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(u.linpre=MAX_ORDER,u.rinpre=MAX_ORDER,u.lstep=MAX_ORDER,u.rstep=MAX_ORDER,u.lout=MAX_ORDER,u.rout=MAX_ORDER,U3.fill(u.B,0),INIT_GAIN_ANALYSIS_OK)};function c(u){return u*u}this.AnalyzeSamples=function(u,f,m,h,M,k,L){var p,I,D,x,B,_,A;if(k==0)return GAIN_ANALYSIS_OK;switch(A=0,B=k,L){case 1:h=f,M=m;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(k<MAX_ORDER?(ms.arraycopy(f,m,u.linprebuf,MAX_ORDER,k),ms.arraycopy(h,M,u.rinprebuf,MAX_ORDER,k)):(ms.arraycopy(f,m,u.linprebuf,MAX_ORDER,MAX_ORDER),ms.arraycopy(h,M,u.rinprebuf,MAX_ORDER,MAX_ORDER));B>0;){_=B>u.sampleWindow-u.totsamp?u.sampleWindow-u.totsamp:B,A<MAX_ORDER?(p=u.linpre+A,I=u.linprebuf,D=u.rinpre+A,x=u.rinprebuf,_>MAX_ORDER-A&&(_=MAX_ORDER-A)):(p=m+A,I=f,D=M+A,x=h),o(I,p,u.lstepbuf,u.lstep+u.totsamp,_,i[u.reqindex]),o(x,D,u.rstepbuf,u.rstep+u.totsamp,_,i[u.reqindex]),a(u.lstepbuf,u.lstep+u.totsamp,u.loutbuf,u.lout+u.totsamp,_,r[u.reqindex]),a(u.rstepbuf,u.rstep+u.totsamp,u.routbuf,u.rout+u.totsamp,_,r[u.reqindex]),p=u.lout+u.totsamp,I=u.loutbuf,D=u.rout+u.totsamp,x=u.routbuf;for(var T=_%8;T--!=0;)u.lsum+=c(I[p++]),u.rsum+=c(x[D++]);for(T=_/8;T--!=0;)u.lsum+=c(I[p+0])+c(I[p+1])+c(I[p+2])+c(I[p+3])+c(I[p+4])+c(I[p+5])+c(I[p+6])+c(I[p+7]),p+=8,u.rsum+=c(x[D+0])+c(x[D+1])+c(x[D+2])+c(x[D+3])+c(x[D+4])+c(x[D+5])+c(x[D+6])+c(x[D+7]),D+=8;if(B-=_,A+=_,u.totsamp+=_,u.totsamp==u.sampleWindow){var v=dn.STEPS_per_dB*10*Math.log10((u.lsum+u.rsum)/u.totsamp*.5+1e-37),w=v<=0?0:0|v;w>=u.A.length&&(w=u.A.length-1),u.A[w]++,u.lsum=u.rsum=0,ms.arraycopy(u.loutbuf,u.totsamp,u.loutbuf,0,MAX_ORDER),ms.arraycopy(u.routbuf,u.totsamp,u.routbuf,0,MAX_ORDER),ms.arraycopy(u.lstepbuf,u.totsamp,u.lstepbuf,0,MAX_ORDER),ms.arraycopy(u.rstepbuf,u.totsamp,u.rstepbuf,0,MAX_ORDER),u.totsamp=0}if(u.totsamp>u.sampleWindow)return GAIN_ANALYSIS_ERROR}return k<MAX_ORDER?(ms.arraycopy(u.linprebuf,k,u.linprebuf,0,MAX_ORDER-k),ms.arraycopy(u.rinprebuf,k,u.rinprebuf,0,MAX_ORDER-k),ms.arraycopy(f,m,u.linprebuf,MAX_ORDER-k,k),ms.arraycopy(h,M,u.rinprebuf,MAX_ORDER-k,k)):(ms.arraycopy(f,m+k-MAX_ORDER,u.linprebuf,0,MAX_ORDER),ms.arraycopy(h,M+k-MAX_ORDER,u.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function d(u,f){var m,h=0;for(m=0;m<f;m++)h+=u[m];if(h==0)return GAIN_NOT_ENOUGH_SAMPLES;var M=0|Math.ceil(h*(1-e));for(m=f;m-- >0&&!((M-=u[m])<=0););return t-m/dn.STEPS_per_dB}this.GetTitleGain=function(u){for(var f=d(u.A,u.A.length),m=0;m<u.A.length;m++)u.B[m]+=u.A[m],u.A[m]=0;for(var m=0;m<MAX_ORDER;m++)u.linprebuf[m]=u.lstepbuf[m]=u.loutbuf[m]=u.rinprebuf[m]=u.rstepbuf[m]=u.routbuf[m]=0;return u.totsamp=0,u.lsum=u.rsum=0,f}}var Ta=Ne.new_float,j3=Ne.new_int;function C$(){this.linprebuf=Ta(void 0*2),this.linpre=0,this.lstepbuf=Ta(void 0+void 0),this.lstep=0,this.loutbuf=Ta(void 0+void 0),this.lout=0,this.rinprebuf=Ta(void 0*2),this.rinpre=0,this.rstepbuf=Ta(void 0+void 0),this.rstep=0,this.routbuf=Ta(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=j3(0|void 0*void 0),this.B=j3(0|void 0*void 0)}function OS(t){this.bits=t}var H3=Ne.new_float,I$=Ne.new_int,V3=Ne.assert;function k$(t){var e=t;this.quantize=e,this.iteration_loop=function(n,s,i,r){var o=n.internal_flags,a=H3(Pr.SFBMAX),l=H3(576),c=I$(2),d=0,u,f=o.l3_side,m=new OS(d);this.quantize.rv.ResvFrameBegin(n,m),d=m.bits;for(var h=0;h<o.mode_gr;h++){u=this.quantize.qupvt.on_pe(n,s,c,d,h,h),o.mode_ext==P.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,h),this.quantize.qupvt.reduce_side(c,i[h],d,u));for(var M=0;M<o.channels_out;M++){var k,L,p=f.tt[h][M];p.block_type!=P.SHORT_TYPE?(k=0,L=o.PSY.mask_adjust-k):(k=0,L=o.PSY.mask_adjust_short-k),o.masking_lower=Math.pow(10,L*.1),this.quantize.init_outer_loop(o,p),this.quantize.init_xrpow(o,p,l)&&(this.quantize.qupvt.calc_xmin(n,r[h][M],p,a),this.quantize.outer_loop(n,p,a,l,M,c[M])),this.quantize.iteration_finish_one(o,h,M),V3(p.part2_3_length<=Rt.MAX_BITS_PER_CHANNEL),V3(p.part2_3_length<=c[M])}}this.quantize.rv.ResvFrameEnd(o,d)}}function St(t,e,n,s){this.xlen=t,this.linmax=e,this.table=n,this.hlen=s}var fe={};fe.t1HB=[1,1,1,0];fe.t2HB=[1,2,1,3,1,1,3,2,0];fe.t3HB=[3,2,1,1,1,1,3,2,0];fe.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];fe.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];fe.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];fe.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];fe.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];fe.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];fe.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];fe.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];fe.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];fe.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];fe.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];fe.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];fe.t32HB=[1<<0,5<<1,4<<1,5<<2,6<<1,5<<2,4<<2,4<<3,7<<1,3<<2,6<<2,0<<3,7<<2,2<<3,3<<3,1<<4];fe.t33HB=[15<<0,14<<1,13<<1,12<<2,11<<1,10<<2,9<<2,8<<3,7<<1,6<<2,5<<2,4<<3,3<<2,2<<3,1<<3,0<<4];fe.t1l=[1,4,3,5];fe.t2l=[1,4,7,4,5,7,6,7,8];fe.t3l=[2,3,7,4,4,7,6,7,8];fe.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];fe.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];fe.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];fe.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];fe.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];fe.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];fe.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];fe.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];fe.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];fe.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];fe.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];fe.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];fe.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];fe.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4];fe.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4];fe.ht=[new St(0,0,null,null),new St(2,0,fe.t1HB,fe.t1l),new St(3,0,fe.t2HB,fe.t2l),new St(3,0,fe.t3HB,fe.t3l),new St(0,0,null,null),new St(4,0,fe.t5HB,fe.t5l),new St(4,0,fe.t6HB,fe.t6l),new St(6,0,fe.t7HB,fe.t7l),new St(6,0,fe.t8HB,fe.t8l),new St(6,0,fe.t9HB,fe.t9l),new St(8,0,fe.t10HB,fe.t10l),new St(8,0,fe.t11HB,fe.t11l),new St(8,0,fe.t12HB,fe.t12l),new St(16,0,fe.t13HB,fe.t13l),new St(0,0,null,fe.t16_5l),new St(16,0,fe.t15HB,fe.t15l),new St(1,1,fe.t16HB,fe.t16l),new St(2,3,fe.t16HB,fe.t16l),new St(3,7,fe.t16HB,fe.t16l),new St(4,15,fe.t16HB,fe.t16l),new St(6,63,fe.t16HB,fe.t16l),new St(8,255,fe.t16HB,fe.t16l),new St(10,1023,fe.t16HB,fe.t16l),new St(13,8191,fe.t16HB,fe.t16l),new St(4,15,fe.t24HB,fe.t24l),new St(5,31,fe.t24HB,fe.t24l),new St(6,63,fe.t24HB,fe.t24l),new St(7,127,fe.t24HB,fe.t24l),new St(8,255,fe.t24HB,fe.t24l),new St(9,511,fe.t24HB,fe.t24l),new St(11,2047,fe.t24HB,fe.t24l),new St(13,8191,fe.t24HB,fe.t24l),new St(0,0,fe.t32HB,fe.t32l),new St(0,0,fe.t33HB,fe.t33l)];fe.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];fe.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];fe.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];fe.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];fe.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];fe.scfsi_band=[0,6,11,16,21];var co=Ne.VbrMode,Lh=Ne.Float,D1=Ne.Util,uo=Ne.new_float,M$=Ne.new_int,Gl=Ne.assert;Vn.Q_MAX=256+1;Vn.Q_MAX2=116;Vn.LARGE_BITS=1e5;Vn.IXMAX_VAL=8206;function Vn(){var t=null,e=null,n=null;this.setModules=function(p,I,D){t=p,e=I,n=D};function s(p){return u[p+Vn.Q_MAX2]}this.IPOW20=function(p){return f[p]};var i=2220446049250313e-31,r=Vn.IXMAX_VAL,o=r+2,a=Vn.Q_MAX,l=Vn.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new Ai([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ai([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=uo(a+l+1),f=uo(a),m=uo(o),h=uo(o);this.adj43=h;function M(p,I){var D=n.ATHformula(I,p);return D-=c,D=Math.pow(10,D/10+p.ATHlower),D}function k(p){for(var I=p.internal_flags.ATH.l,D=p.internal_flags.ATH.psfb21,x=p.internal_flags.ATH.s,B=p.internal_flags.ATH.psfb12,_=p.internal_flags,A=p.out_samplerate,T=0;T<P.SBMAX_l;T++){var v=_.scalefac_band.l[T],w=_.scalefac_band.l[T+1];I[T]=Lh.MAX_VALUE;for(var b=v;b<w;b++){var y=b*A/1152,R=M(p,y);I[T]=Math.min(I[T],R)}}for(var T=0;T<P.PSFB21;T++){var v=_.scalefac_band.psfb21[T],w=_.scalefac_band.psfb21[T+1];D[T]=Lh.MAX_VALUE;for(var b=v;b<w;b++){var y=b*A/1152,R=M(p,y);D[T]=Math.min(D[T],R)}}for(var T=0;T<P.SBMAX_s;T++){var v=_.scalefac_band.s[T],w=_.scalefac_band.s[T+1];x[T]=Lh.MAX_VALUE;for(var b=v;b<w;b++){var y=b*A/384,R=M(p,y);x[T]=Math.min(x[T],R)}x[T]*=_.scalefac_band.s[T+1]-_.scalefac_band.s[T]}for(var T=0;T<P.PSFB12;T++){var v=_.scalefac_band.psfb12[T],w=_.scalefac_band.psfb12[T+1];B[T]=Lh.MAX_VALUE;for(var b=v;b<w;b++){var y=b*A/384,R=M(p,y);B[T]=Math.min(B[T],R)}B[T]*=_.scalefac_band.s[13]-_.scalefac_band.s[12]}if(p.noATH){for(var T=0;T<P.SBMAX_l;T++)I[T]=1e-20;for(var T=0;T<P.PSFB21;T++)D[T]=1e-20;for(var T=0;T<P.SBMAX_s;T++)x[T]=1e-20;for(var T=0;T<P.PSFB12;T++)B[T]=1e-20}_.ATH.floor=10*Math.log10(M(p,-1))}this.iteration_init=function(p){var I=p.internal_flags,D=I.l3_side,x;if(I.iteration_init_init==0){for(I.iteration_init_init=1,D.main_data_begin=0,k(p),m[0]=0,x=1;x<o;x++)m[x]=Math.pow(x,4/3);for(x=0;x<o-1;x++)h[x]=x+1-Math.pow(.5*(m[x]+m[x+1]),.75);for(h[x]=.5,x=0;x<a;x++)f[x]=Math.pow(2,(x-210)*-.1875);for(x=0;x<=a+l;x++)u[x]=Math.pow(2,(x-210-l)*.25);t.huffman_init(I);{var B,_,A,T;for(x=p.exp_nspsytune>>2&63,x>=32&&(x-=64),B=Math.pow(10,x/4/10),x=p.exp_nspsytune>>8&63,x>=32&&(x-=64),_=Math.pow(10,x/4/10),x=p.exp_nspsytune>>14&63,x>=32&&(x-=64),A=Math.pow(10,x/4/10),x=p.exp_nspsytune>>20&63,x>=32&&(x-=64),T=A*Math.pow(10,x/4/10),x=0;x<P.SBMAX_l;x++){var v;x<=6?v=B:x<=13?v=_:x<=20?v=A:v=T,I.nsPsy.longfact[x]=v}for(x=0;x<P.SBMAX_s;x++){var v;x<=5?v=B:x<=10?v=_:x<=11?v=A:v=T,I.nsPsy.shortfact[x]=v}}}},this.on_pe=function(p,I,D,x,B,_){var A=p.internal_flags,T=0,v,w=M$(2),b,y=new OS(T),R=e.ResvMaxBits(p,x,y,_);T=y.bits;var S=T+R;for(S>Rt.MAX_BITS_PER_GRANULE&&(S=Rt.MAX_BITS_PER_GRANULE),v=0,b=0;b<A.channels_out;++b)D[b]=Math.min(Rt.MAX_BITS_PER_CHANNEL,T/A.channels_out),w[b]=0|D[b]*I[B][b]/700-D[b],w[b]>x*3/4&&(w[b]=x*3/4),w[b]<0&&(w[b]=0),w[b]+D[b]>Rt.MAX_BITS_PER_CHANNEL&&(w[b]=Math.max(0,Rt.MAX_BITS_PER_CHANNEL-D[b])),v+=w[b];if(v>R)for(b=0;b<A.channels_out;++b)w[b]=R*w[b]/v;for(b=0;b<A.channels_out;++b)D[b]+=w[b],R-=w[b];for(v=0,b=0;b<A.channels_out;++b)v+=D[b];if(v>Rt.MAX_BITS_PER_GRANULE){var U=0;for(b=0;b<A.channels_out;++b)D[b]*=Rt.MAX_BITS_PER_GRANULE,D[b]/=v,U+=D[b]}return S},this.reduce_side=function(p,I,D,x){Gl(p[0]+p[1]<=Rt.MAX_BITS_PER_GRANULE);var B=.33*(.5-I)/.5;B<0&&(B=0),B>.5&&(B=.5);var _=0|B*.5*(p[0]+p[1]);_>Rt.MAX_BITS_PER_CHANNEL-p[0]&&(_=Rt.MAX_BITS_PER_CHANNEL-p[0]),_<0&&(_=0),p[1]>=125&&(p[1]-_>125?(p[0]<D&&(p[0]+=_),p[1]-=_):(p[0]+=p[1]-125,p[1]=125)),_=p[0]+p[1],_>x&&(p[0]=x*p[0]/_,p[1]=x*p[1]/_),Gl(p[0]<=Rt.MAX_BITS_PER_CHANNEL),Gl(p[1]<=Rt.MAX_BITS_PER_CHANNEL),Gl(p[0]+p[1]<=Rt.MAX_BITS_PER_GRANULE)},this.athAdjust=function(p,I,D){var x=90.30873362,B=94.82444863,_=D1.FAST_LOG10_X(I,10),A=p*p,T=0;return _-=D,A>1e-20&&(T=1+D1.FAST_LOG10_X(A,10/x)),T<0&&(T=0),_*=T,_+=D+x-B,Math.pow(10,.1*_)},this.calc_xmin=function(p,I,D,x){var B=0,_=p.internal_flags,A,T=0,v=0,w=_.ATH,b=D.xr,y=p.VBR==co.vbr_mtrh?1:0,R=_.masking_lower;for((p.VBR==co.vbr_mtrh||p.VBR==co.vbr_mt)&&(R=1),A=0;A<D.psy_lmax;A++){var S,U,W,j,z,g;p.VBR==co.vbr_rh||p.VBR==co.vbr_mtrh?U=athAdjust(w.adjust,w.l[A],w.floor):U=w.adjust*w.l[A],z=D.width[A],W=U/z,j=i,g=z>>1,S=0;do{var C,te;C=b[T]*b[T],S+=C,j+=C<W?C:W,T++,te=b[T]*b[T],S+=te,j+=te<W?te:W,T++}while(--g>0);if(S>U&&v++,A==P.SBPSY_l){var se=U*_.nsPsy.longfact[A];j<se&&(j=se)}if(y!=0&&(U=j),!p.ATHonly){var Te=I.en.l[A];if(Te>0){var se;se=S*I.thm.l[A]*R/Te,y!=0&&(se*=_.nsPsy.longfact[A]),U<se&&(U=se)}}y!=0?x[B++]=U:x[B++]=U*_.nsPsy.longfact[A]}var ke=575;if(D.block_type!=P.SHORT_TYPE)for(var Oe=576;Oe--!=0&&Ys.EQ(b[Oe],0);)ke=Oe;D.max_nonzero_coeff=ke;for(var be=D.sfb_smin;A<D.psymax;be++,A+=3){var z,ze,Be;for(p.VBR==co.vbr_rh||p.VBR==co.vbr_mtrh?Be=athAdjust(w.adjust,w.s[be],w.floor):Be=w.adjust*w.s[be],z=D.width[A],ze=0;ze<3;ze++){var S=0,U,W,j,g=z>>1;W=Be/z,j=i;do{var C,te;C=b[T]*b[T],S+=C,j+=C<W?C:W,T++,te=b[T]*b[T],S+=te,j+=te<W?te:W,T++}while(--g>0);if(S>Be&&v++,be==P.SBPSY_s){var se=Be*_.nsPsy.shortfact[be];j<se&&(j=se)}if(y!=0?U=j:U=Be,!p.ATHonly&&!p.ATHshort){var Te=I.en.s[be][ze];if(Te>0){var se;se=S*I.thm.s[be][ze]*R/Te,y!=0&&(se*=_.nsPsy.shortfact[be]),U<se&&(U=se)}}y!=0?x[B++]=U:x[B++]=U*_.nsPsy.shortfact[be]}p.useTemporal&&(x[B-3]>x[B-3+1]&&(x[B-3+1]+=(x[B-3]-x[B-3+1])*_.decay),x[B-3+1]>x[B-3+2]&&(x[B-3+2]+=(x[B-3+1]-x[B-3+2])*_.decay))}return v};function L(p){this.s=p}this.calc_noise_core=function(p,I,D,x){var B=0,_=I.s,A=p.l3_enc;if(_>p.count1)for(;D--!=0;){var T;T=p.xr[_],_++,B+=T*T,T=p.xr[_],_++,B+=T*T}else if(_>p.big_values){var v=uo(2);for(v[0]=0,v[1]=x;D--!=0;){var T;T=Math.abs(p.xr[_])-v[A[_]],_++,B+=T*T,T=Math.abs(p.xr[_])-v[A[_]],_++,B+=T*T}}else for(;D--!=0;){var T;T=Math.abs(p.xr[_])-m[A[_]]*x,_++,B+=T*T,T=Math.abs(p.xr[_])-m[A[_]]*x,_++,B+=T*T}return I.s=_,B},this.calc_noise=function(p,I,D,x,B){var _=0,A=0,T,v,w=0,b=0,y=0,R=-20,S=0,U=p.scalefac,W=0;for(x.over_SSD=0,T=0;T<p.psymax;T++){var j=p.global_gain-(U[W++]+(p.preflag!=0?d[T]:0)<<p.scalefac_scale+1)-p.subblock_gain[p.window[T]]*8,z=0;if(B!=null&&B.step[T]==j)z=B.noise[T],S+=p.width[T],D[_++]=z/I[A++],z=B.noise_log[T];else{var g=s(j);if(v=p.width[T]>>1,S+p.width[T]>p.max_nonzero_coeff){var C;C=p.max_nonzero_coeff-S+1,C>0?v=C>>1:v=0}var te=new L(S);z=this.calc_noise_core(p,te,v,g),S=te.s,B!=null&&(B.step[T]=j,B.noise[T]=z),z=D[_++]=z/I[A++],z=D1.FAST_LOG10(Math.max(z,1e-20)),B!=null&&(B.noise_log[T]=z)}if(B!=null&&(B.global_gain=p.global_gain),y+=z,z>0){var se;se=Math.max(0|z*10+.5,1),x.over_SSD+=se*se,w++,b+=z}R=Math.max(R,z)}return x.over_count=w,x.tot_noise=y,x.over_noise=b,x.max_noise=R,w},this.set_pinfo=function(p,I,D,x,B){var _=p.internal_flags,A,T,v,w,b,y=I.scalefac_scale==0?.5:1,R=I.scalefac,S=uo(L3Side.SFBMAX),U=uo(L3Side.SFBMAX),W=new CalcNoiseResult;calc_xmin(p,D,I,S),calc_noise(I,S,U,W,null);var j=0;for(T=I.sfb_lmax,I.block_type!=P.SHORT_TYPE&&I.mixed_block_flag==0&&(T=22),A=0;A<T;A++){var z=_.scalefac_band.l[A],g=_.scalefac_band.l[A+1],C=g-z;for(w=0;j<g;j++)w+=I.xr[j]*I.xr[j];w/=C,b=1e15,_.pinfo.en[x][B][A]=b*w,_.pinfo.xfsf[x][B][A]=b*S[A]*U[A]/C,D.en.l[A]>0&&!p.ATHonly?w=w/D.en.l[A]:w=0,_.pinfo.thr[x][B][A]=b*Math.max(w*D.thm.l[A],_.ATH.l[A]),_.pinfo.LAMEsfb[x][B][A]=0,I.preflag!=0&&A>=11&&(_.pinfo.LAMEsfb[x][B][A]=-y*d[A]),A<P.SBPSY_l&&(Gl(R[A]>=0),_.pinfo.LAMEsfb[x][B][A]-=y*R[A])}if(I.block_type==P.SHORT_TYPE)for(T=A,A=I.sfb_smin;A<P.SBMAX_s;A++)for(var z=_.scalefac_band.s[A],g=_.scalefac_band.s[A+1],C=g-z,te=0;te<3;te++){for(w=0,v=z;v<g;v++)w+=I.xr[j]*I.xr[j],j++;w=Math.max(w/C,1e-20),b=1e15,_.pinfo.en_s[x][B][3*A+te]=b*w,_.pinfo.xfsf_s[x][B][3*A+te]=b*S[T]*U[T]/C,D.en.s[A][te]>0?w=w/D.en.s[A][te]:w=0,(p.ATHonly||p.ATHshort)&&(w=0),_.pinfo.thr_s[x][B][3*A+te]=b*Math.max(w*D.thm.s[A][te],_.ATH.s[A]),_.pinfo.LAMEsfb_s[x][B][3*A+te]=-2*I.subblock_gain[te],A<P.SBPSY_s&&(_.pinfo.LAMEsfb_s[x][B][3*A+te]-=y*R[T]),T++}_.pinfo.LAMEqss[x][B]=I.global_gain,_.pinfo.LAMEmainbits[x][B]=I.part2_3_length+I.part2_length,_.pinfo.LAMEsfbits[x][B]=I.part2_length,_.pinfo.over[x][B]=W.over_count,_.pinfo.max_noise[x][B]=W.max_noise*10,_.pinfo.over_noise[x][B]=W.over_noise*10,_.pinfo.tot_noise[x][B]=W.tot_noise*10,_.pinfo.over_SSD[x][B]=W.over_SSD}}var x$=Ne.System,O$=Ne.Arrays,Wl=Ne.new_int,P1=Ne.assert;function du(){var t=null;this.qupvt=null,this.setModules=function(v){this.qupvt=v,t=v};function e(v){this.bits=0|v}var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function s(v,w,b,y,R,S){var U=.5946/w;for(v=v>>1;v--!=0;)R[S++]=U>b[y++]?0:1,R[S++]=U>b[y++]?0:1}function i(v,w,b,y,R,S){v=v>>1;var U=v%2;for(v=v>>1;v--!=0;){var W,j,z,g,C,te,se,Te;W=b[y++]*w,j=b[y++]*w,C=0|W,z=b[y++]*w,te=0|j,g=b[y++]*w,se=0|z,W+=t.adj43[C],Te=0|g,j+=t.adj43[te],R[S++]=0|W,z+=t.adj43[se],R[S++]=0|j,g+=t.adj43[Te],R[S++]=0|z,R[S++]=0|g}if(U!=0){var W,j,C,te;W=b[y++]*w,j=b[y++]*w,C=0|W,te=0|j,W+=t.adj43[C],j+=t.adj43[te],R[S++]=0|W,R[S++]=0|j}}function r(v,w,b,y,R){var S,U,W=0,j,z=0,g=0,C=0,te=w,se=0,Te=te,ke=0,Oe=v,be=0;for(j=R!=null&&y.global_gain==R.global_gain,y.block_type==P.SHORT_TYPE?U=38:U=21,S=0;S<=U;S++){var ze=-1;if((j||y.block_type==P.NORM_TYPE)&&(ze=y.global_gain-(y.scalefac[S]+(y.preflag!=0?t.pretab[S]:0)<<y.scalefac_scale+1)-y.subblock_gain[y.window[S]]*8),P1(y.width[S]>=0),j&&R.step[S]==ze)z!=0&&(i(z,b,Oe,be,Te,ke),z=0),g!=0&&(s(g,b,Oe,be,Te,ke),g=0);else{var Be=y.width[S];if(W+y.width[S]>y.max_nonzero_coeff){var we;we=y.max_nonzero_coeff-W+1,O$.fill(w,y.max_nonzero_coeff,576,0),Be=we,Be<0&&(Be=0),S=U+1}if(z==0&&g==0&&(Te=te,ke=se,Oe=v,be=C),R!=null&&R.sfb_count1>0&&S>=R.sfb_count1&&R.step[S]>0&&ze>=R.step[S]?(z!=0&&(i(z,b,Oe,be,Te,ke),z=0,Te=te,ke=se,Oe=v,be=C),g+=Be):(g!=0&&(s(g,b,Oe,be,Te,ke),g=0,Te=te,ke=se,Oe=v,be=C),z+=Be),Be<=0){g!=0&&(s(g,b,Oe,be,Te,ke),g=0),z!=0&&(i(z,b,Oe,be,Te,ke),z=0);break}}S<=U&&(se+=y.width[S],C+=y.width[S],W+=y.width[S])}z!=0&&(i(z,b,Oe,be,Te,ke),z=0),g!=0&&(s(g,b,Oe,be,Te,ke),g=0)}function o(v,w,b){var y=0,R=0;do{var S=v[w++],U=v[w++];y<S&&(y=S),R<U&&(R=U)}while(w<b);return y<R&&(y=R),y}function a(v,w,b,y,R,S){var U=fe.ht[y].xlen*65536+fe.ht[R].xlen,W=0,j;do{var z=v[w++],g=v[w++];z!=0&&(z>14&&(z=15,W+=U),z*=16),g!=0&&(g>14&&(g=15,W+=U),z+=g),W+=fe.largetbl[z]}while(w<b);return j=W&65535,W>>=16,W>j&&(W=j,y=R),S.bits+=W,y}function l(v,w,b,y){var R=0,S=fe.ht[1].hlen;do{var U=v[w+0]*2+v[w+1];w+=2,R+=S[U]}while(w<b);return y.bits+=R,1}function c(v,w,b,y,R){var S=0,U,W=fe.ht[y].xlen,j;y==2?j=fe.table23:j=fe.table56;do{var z=v[w+0]*W+v[w+1];w+=2,S+=j[z]}while(w<b);return U=S&65535,S>>=16,S>U&&(S=U,y++),R.bits+=S,y}function d(v,w,b,y,R){var S=0,U=0,W=0,j=fe.ht[y].xlen,z=fe.ht[y].hlen,g=fe.ht[y+1].hlen,C=fe.ht[y+2].hlen;do{var te=v[w+0]*j+v[w+1];w+=2,S+=z[te],U+=g[te],W+=C[te]}while(w<b);var se=y;return S>U&&(S=U,se++),S>W&&(S=W,se=y+2),R.bits+=S,se}var u=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function f(v,w,b,y){var R=o(v,w,b);switch(R){case 0:return R;case 1:return l(v,w,b,y);case 2:case 3:return c(v,w,b,u[R-1],y);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return d(v,w,b,u[R-1],y);default:if(R>Vn.IXMAX_VAL)return y.bits=Vn.LARGE_BITS,-1;R-=15;var S;for(S=24;S<32&&!(fe.ht[S].linmax>=R);S++);var U;for(U=S-8;U<24&&!(fe.ht[U].linmax>=R);U++);return a(v,w,b,U,S,y)}}this.noquant_count_bits=function(v,w,b){var y=w.l3_enc,R=Math.min(576,w.max_nonzero_coeff+2>>1<<1);for(b!=null&&(b.sfb_count1=0);R>1&&(y[R-1]|y[R-2])==0;R-=2);w.count1=R;for(var S=0,U=0;R>3;R-=4){var W;if(((y[R-1]|y[R-2]|y[R-3]|y[R-4])&2147483647)>1)break;W=((y[R-4]*2+y[R-3])*2+y[R-2])*2+y[R-1],S+=fe.t32l[W],U+=fe.t33l[W]}var j=S;if(w.count1table_select=0,S>U&&(j=U,w.count1table_select=1),w.count1bits=j,w.big_values=R,R==0)return j;if(w.block_type==P.SHORT_TYPE)S=3*v.scalefac_band.s[3],S>w.big_values&&(S=w.big_values),U=w.big_values;else if(w.block_type==P.NORM_TYPE){if(S=w.region0_count=v.bv_scf[R-2],U=w.region1_count=v.bv_scf[R-1],U=v.scalefac_band.l[S+U+2],S=v.scalefac_band.l[S+1],U<R){var z=new e(j);w.table_select[2]=f(y,U,R,z),j=z.bits}}else w.region0_count=7,w.region1_count=P.SBMAX_l-1-7-1,S=v.scalefac_band.l[7+1],U=R,S>U&&(S=U);if(S=Math.min(S,R),U=Math.min(U,R),S>0){var z=new e(j);w.table_select[0]=f(y,0,S,z),j=z.bits}if(S<U){var z=new e(j);w.table_select[1]=f(y,S,U,z),j=z.bits}if(v.use_best_huffman==2&&(w.part2_3_length=j,best_huffman_divide(v,w),j=w.part2_3_length),b!=null&&w.block_type==P.NORM_TYPE){for(var g=0;v.scalefac_band.l[g]<w.big_values;)g++;b.sfb_count1=g}return j},this.count_bits=function(v,w,b,y){var R=b.l3_enc,S=Vn.IXMAX_VAL/t.IPOW20(b.global_gain);if(b.xrpow_max>S)return Vn.LARGE_BITS;if(r(w,R,t.IPOW20(b.global_gain),b,y),(v.substep_shaping&2)!=0)for(var U=0,W=b.global_gain+b.scalefac_scale,j=.634521682242439/t.IPOW20(W),z=0;z<b.sfbmax;z++){var g=b.width[z];if(v.pseudohalf[z]==0)U+=g;else{var C;for(C=U,U+=g;C<U;++C)R[C]=w[C]>=j?R[C]:0}}return this.noquant_count_bits(v,b,y)};function m(v,w,b,y,R,S,U){for(var W=w.big_values,j=0;j<=7+15;j++)y[j]=Vn.LARGE_BITS;for(var j=0;j<16;j++){var z=v.scalefac_band.l[j+1];if(z>=W)break;var g=0,C=new e(g),te=f(b,0,z,C);g=C.bits;for(var se=0;se<8;se++){var Te=v.scalefac_band.l[j+se+2];if(Te>=W)break;var ke=g;C=new e(ke);var Oe=f(b,z,Te,C);ke=C.bits,y[j+se]>ke&&(y[j+se]=ke,R[j+se]=j,S[j+se]=te,U[j+se]=Oe)}}}function h(v,w,b,y,R,S,U,W){for(var j=w.big_values,z=2;z<P.SBMAX_l+1;z++){var g=v.scalefac_band.l[z];if(g>=j)break;var C=R[z-2]+w.count1bits;if(b.part2_3_length<=C)break;var te=new e(C),se=f(y,g,j,te);C=te.bits,!(b.part2_3_length<=C)&&(b.assign(w),b.part2_3_length=C,b.region0_count=S[z-2],b.region1_count=z-2-S[z-2],b.table_select[0]=U[z-2],b.table_select[1]=W[z-2],b.table_select[2]=se)}}this.best_huffman_divide=function(v,w){var b=new Qd,y=w.l3_enc,R=Wl(7+15+1),S=Wl(7+15+1),U=Wl(7+15+1),W=Wl(7+15+1);if(!(w.block_type==P.SHORT_TYPE&&v.mode_gr==1)){b.assign(w),w.block_type==P.NORM_TYPE&&(m(v,w,y,R,S,U,W),h(v,b,w,y,R,S,U,W));var j=b.big_values;if(!(j==0||(y[j-2]|y[j-1])>1)&&(j=w.count1+2,!(j>576))){b.assign(w),b.count1=j;for(var z=0,g=0;j>b.big_values;j-=4){var C=((y[j-4]*2+y[j-3])*2+y[j-2])*2+y[j-1];z+=fe.t32l[C],g+=fe.t33l[C]}if(b.big_values=j,b.count1table_select=0,z>g&&(z=g,b.count1table_select=1),b.count1bits=z,b.block_type==P.NORM_TYPE)h(v,b,w,y,R,S,U,W);else{if(b.part2_3_length=z,z=v.scalefac_band.l[7+1],z>j&&(z=j),z>0){var te=new e(b.part2_3_length);b.table_select[0]=f(y,0,z,te),b.part2_3_length=te.bits}if(j>z){var te=new e(b.part2_3_length);b.table_select[1]=f(y,z,j,te),b.part2_3_length=te.bits}w.part2_3_length>b.part2_3_length&&w.assign(b)}}}};var M=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],k=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],L=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],p=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];du.slen1_tab=L,du.slen2_tab=p;function I(v,w){for(var b,y=w.tt[1][v],R=w.tt[0][v],S=0;S<fe.scfsi_band.length-1;S++){for(b=fe.scfsi_band[S];b<fe.scfsi_band[S+1]&&!(R.scalefac[b]!=y.scalefac[b]&&y.scalefac[b]>=0);b++);if(b==fe.scfsi_band[S+1]){for(b=fe.scfsi_band[S];b<fe.scfsi_band[S+1];b++)y.scalefac[b]=-1;w.scfsi[v][S]=1}}var U=0,W=0;for(b=0;b<11;b++)y.scalefac[b]!=-1&&(W++,U<y.scalefac[b]&&(U=y.scalefac[b]));for(var j=0,z=0;b<P.SBPSY_l;b++)y.scalefac[b]!=-1&&(z++,j<y.scalefac[b]&&(j=y.scalefac[b]));for(var S=0;S<16;S++)if(U<M[S]&&j<k[S]){var g=L[S]*W+p[S]*z;y.part2_length>g&&(y.part2_length=g,y.scalefac_compress=S)}}this.best_scalefac_store=function(v,w,b,y){var R=y.tt[w][b],S,U,W,j,z=0;for(W=0,S=0;S<R.sfbmax;S++){var g=R.width[S];for(W+=g,j=-g;j<0&&R.l3_enc[j+W]==0;j++);j==0&&(R.scalefac[S]=z=-2)}if(R.scalefac_scale==0&&R.preflag==0){var C=0;for(S=0;S<R.sfbmax;S++)R.scalefac[S]>0&&(C|=R.scalefac[S]);if((C&1)==0&&C!=0){for(S=0;S<R.sfbmax;S++)R.scalefac[S]>0&&(R.scalefac[S]>>=1);R.scalefac_scale=z=1}}if(R.preflag==0&&R.block_type!=P.SHORT_TYPE&&v.mode_gr==2){for(S=11;S<P.SBPSY_l&&!(R.scalefac[S]<t.pretab[S]&&R.scalefac[S]!=-2);S++);if(S==P.SBPSY_l){for(S=11;S<P.SBPSY_l;S++)R.scalefac[S]>0&&(R.scalefac[S]-=t.pretab[S]);R.preflag=z=1}}for(U=0;U<4;U++)y.scfsi[b][U]=0;for(v.mode_gr==2&&w==1&&y.tt[0][b].block_type!=P.SHORT_TYPE&&y.tt[1][b].block_type!=P.SHORT_TYPE&&(I(b,y),z=0),S=0;S<R.sfbmax;S++)R.scalefac[S]==-2&&(R.scalefac[S]=0);z!=0&&(v.mode_gr==2?this.scale_bitcount(R):this.scale_bitcount_lsf(v,R))};function D(v,w){for(var b=0;b<w;++b)if(v[b]<0)return!1;return!0}var x=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],B=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],_=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(v){var w,b,y=0,R=0,S,U=v.scalefac;if(P1(D(U,v.sfbmax)),v.block_type==P.SHORT_TYPE)S=x,v.mixed_block_flag!=0&&(S=B);else if(S=_,v.preflag==0){for(b=11;b<P.SBPSY_l&&!(U[b]<t.pretab[b]);b++);if(b==P.SBPSY_l)for(v.preflag=1,b=11;b<P.SBPSY_l;b++)U[b]-=t.pretab[b]}for(b=0;b<v.sfbdivide;b++)y<U[b]&&(y=U[b]);for(;b<v.sfbmax;b++)R<U[b]&&(R=U[b]);for(v.part2_length=Vn.LARGE_BITS,w=0;w<16;w++)y<M[w]&&R<k[w]&&v.part2_length>S[w]&&(v.part2_length=S[w],v.scalefac_compress=w);return v.part2_length==Vn.LARGE_BITS};var A=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(v,w){var b,y,R,S,U,W,j,z,g=Wl(4),C=w.scalefac;for(w.preflag!=0?b=2:b=0,j=0;j<4;j++)g[j]=0;if(w.block_type==P.SHORT_TYPE){y=1;var te=t.nr_of_sfb_block[b][y];for(z=0,R=0;R<4;R++)for(S=te[R]/3,j=0;j<S;j++,z++)for(U=0;U<3;U++)C[z*3+U]>g[R]&&(g[R]=C[z*3+U])}else{y=0;var te=t.nr_of_sfb_block[b][y];for(z=0,R=0;R<4;R++)for(S=te[R],j=0;j<S;j++,z++)C[z]>g[R]&&(g[R]=C[z])}for(W=!1,R=0;R<4;R++)g[R]>A[b][R]&&(W=!0);if(!W){var se,Te,ke,Oe;for(w.sfb_partition_table=t.nr_of_sfb_block[b][y],R=0;R<4;R++)w.slen[R]=T[g[R]];switch(se=w.slen[0],Te=w.slen[1],ke=w.slen[2],Oe=w.slen[3],b){case 0:w.scalefac_compress=(se*5+Te<<4)+(ke<<2)+Oe;break;case 1:w.scalefac_compress=400+(se*5+Te<<2)+ke;break;case 2:w.scalefac_compress=500+se*3+Te;break;default:x$.err.printf(`intensity stereo not implemented yet
`);break}}if(!W)for(P1(w.sfb_partition_table!=null),w.part2_length=0,R=0;R<4;R++)w.part2_length+=w.slen[R]*w.sfb_partition_table[R];return W};var T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(v){for(var w=2;w<=576;w+=2){for(var b=0,y;v.scalefac_band.l[++b]<w;);for(y=n[b][0];v.scalefac_band.l[y+1]>w;)y--;for(y<0&&(y=n[b][0]),v.bv_scf[w-2]=y,y=n[b][1];v.scalefac_band.l[y+v.bv_scf[w-2]+2]>w;)y--;y<0&&(y=n[b][1]),v.bv_scf[w-1]=y}}}var wi=Ne.System,N$=Ne.Arrays,L$=Ne.new_byte,D$=Ne.new_float_n,P$=Ne.new_int,yn=Ne.assert;Ys.EQ=function(t,e){return Math.abs(t)>Math.abs(e)?Math.abs(t-e)<=Math.abs(t)*1e-6:Math.abs(t-e)<=Math.abs(e)*1e-6};Ys.NEQ=function(t,e){return!Ys.EQ(t,e)};function Ys(){var t=this,e=32773,n=null,s=null,i=null,r=null;this.setModules=function(A,T,v,w){n=A,s=T,i=v,r=w};var o=null,a=0,l=0,c=0;this.getframebits=function(A){var T=A.internal_flags,v;T.bitrate_index!=0?v=fe.bitrate_table[A.version][T.bitrate_index]:v=A.brate;var w=0|(A.version+1)*72e3*v/A.out_samplerate+T.padding;return 8*w};function d(A){wi.arraycopy(A.header[A.w_ptr].buf,0,o,l,A.sideinfo_len),l+=A.sideinfo_len,a+=A.sideinfo_len*8,A.w_ptr=A.w_ptr+1&Rt.MAX_HEADER_BUF-1}function u(A,T,v){for(;v>0;){var w;c==0&&(c=8,l++,yn(A.header[A.w_ptr].write_timing>=a),A.header[A.w_ptr].write_timing==a&&d(A),o[l]=0),w=Math.min(v,c),v-=w,c-=w,o[l]|=T>>v<<c,a+=w}}function f(A,T,v){for(;v>0;){var w;c==0&&(c=8,l++,o[l]=0),w=Math.min(v,c),v-=w,c-=w,o[l]|=T>>v<<c,a+=w}}function m(A,T){var v=A.internal_flags,w;if(T>=8&&(u(v,76,8),T-=8),T>=8&&(u(v,65,8),T-=8),T>=8&&(u(v,77,8),T-=8),T>=8&&(u(v,69,8),T-=8),T>=32){var b=i.getLameShortVersion();if(T>=32)for(w=0;w<b.length&&T>=8;++w)T-=8,u(v,b.charAt(w),8)}for(;T>=1;T-=1)u(v,v.ancillary_flag,1),v.ancillary_flag^=A.disable_reservoir?0:1}function h(A,T,v){for(var w=A.header[A.h_ptr].ptr;v>0;){var b=Math.min(v,8-(w&7));v-=b,A.header[A.h_ptr].buf[w>>3]|=T>>v<<8-(w&7)-b,w+=b}A.header[A.h_ptr].ptr=w}function M(A,T){A<<=8;for(var v=0;v<8;v++)A<<=1,T<<=1,((T^A)&65536)!=0&&(T^=e);return T}this.CRC_writeheader=function(A,T){var v=65535;v=M(T[2]&255,v),v=M(T[3]&255,v);for(var w=6;w<A.sideinfo_len;w++)v=M(T[w]&255,v);T[4]=byte(v>>8),T[5]=byte(v&255)};function k(A,T){var v=A.internal_flags,w,b,y;if(w=v.l3_side,v.header[v.h_ptr].ptr=0,N$.fill(v.header[v.h_ptr].buf,0,v.sideinfo_len,0),A.out_samplerate<16e3?h(v,4094,12):h(v,4095,12),h(v,A.version,1),h(v,4-3,2),h(v,A.error_protection?0:1,1),h(v,v.bitrate_index,4),h(v,v.samplerate_index,2),h(v,v.padding,1),h(v,A.extension,1),h(v,A.mode.ordinal(),2),h(v,v.mode_ext,2),h(v,A.copyright,1),h(v,A.original,1),h(v,A.emphasis,2),A.error_protection&&h(v,0,16),A.version==1){for(yn(w.main_data_begin>=0),h(v,w.main_data_begin,9),v.channels_out==2?h(v,w.private_bits,3):h(v,w.private_bits,5),y=0;y<v.channels_out;y++){var R;for(R=0;R<4;R++)h(v,w.scfsi[y][R],1)}for(b=0;b<2;b++)for(y=0;y<v.channels_out;y++){var S=w.tt[b][y];h(v,S.part2_3_length+S.part2_length,12),h(v,S.big_values/2,9),h(v,S.global_gain,8),h(v,S.scalefac_compress,4),S.block_type!=P.NORM_TYPE?(h(v,1,1),h(v,S.block_type,2),h(v,S.mixed_block_flag,1),S.table_select[0]==14&&(S.table_select[0]=16),h(v,S.table_select[0],5),S.table_select[1]==14&&(S.table_select[1]=16),h(v,S.table_select[1],5),h(v,S.subblock_gain[0],3),h(v,S.subblock_gain[1],3),h(v,S.subblock_gain[2],3)):(h(v,0,1),S.table_select[0]==14&&(S.table_select[0]=16),h(v,S.table_select[0],5),S.table_select[1]==14&&(S.table_select[1]=16),h(v,S.table_select[1],5),S.table_select[2]==14&&(S.table_select[2]=16),h(v,S.table_select[2],5),yn(S.region0_count>=0&&S.region0_count<16),yn(S.region1_count>=0&&S.region1_count<8),h(v,S.region0_count,4),h(v,S.region1_count,3)),h(v,S.preflag,1),h(v,S.scalefac_scale,1),h(v,S.count1table_select,1)}}else for(yn(w.main_data_begin>=0),h(v,w.main_data_begin,8),h(v,w.private_bits,v.channels_out),b=0,y=0;y<v.channels_out;y++){var S=w.tt[b][y];h(v,S.part2_3_length+S.part2_length,12),h(v,S.big_values/2,9),h(v,S.global_gain,8),h(v,S.scalefac_compress,9),S.block_type!=P.NORM_TYPE?(h(v,1,1),h(v,S.block_type,2),h(v,S.mixed_block_flag,1),S.table_select[0]==14&&(S.table_select[0]=16),h(v,S.table_select[0],5),S.table_select[1]==14&&(S.table_select[1]=16),h(v,S.table_select[1],5),h(v,S.subblock_gain[0],3),h(v,S.subblock_gain[1],3),h(v,S.subblock_gain[2],3)):(h(v,0,1),S.table_select[0]==14&&(S.table_select[0]=16),h(v,S.table_select[0],5),S.table_select[1]==14&&(S.table_select[1]=16),h(v,S.table_select[1],5),S.table_select[2]==14&&(S.table_select[2]=16),h(v,S.table_select[2],5),yn(S.region0_count>=0&&S.region0_count<16),yn(S.region1_count>=0&&S.region1_count<8),h(v,S.region0_count,4),h(v,S.region1_count,3)),h(v,S.scalefac_scale,1),h(v,S.count1table_select,1)}A.error_protection&&CRC_writeheader(v,v.header[v.h_ptr].buf);{var U=v.h_ptr;yn(v.header[U].ptr==v.sideinfo_len*8),v.h_ptr=U+1&Rt.MAX_HEADER_BUF-1,v.header[v.h_ptr].write_timing=v.header[U].write_timing+T,v.h_ptr==v.w_ptr&&wi.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function L(A,T){var v=fe.ht[T.count1table_select+32],w,b=0,y=T.big_values,R=T.big_values;for(yn(T.count1table_select<2),w=(T.count1-T.big_values)/4;w>0;--w){var S=0,U=0,W;W=T.l3_enc[y+0],W!=0&&(U+=8,T.xr[R+0]<0&&S++),W=T.l3_enc[y+1],W!=0&&(U+=4,S*=2,T.xr[R+1]<0&&S++),W=T.l3_enc[y+2],W!=0&&(U+=2,S*=2,T.xr[R+2]<0&&S++),W=T.l3_enc[y+3],W!=0&&(U++,S*=2,T.xr[R+3]<0&&S++),y+=4,R+=4,u(A,S+v.table[U],v.hlen[U]),b+=v.hlen[U]}return b}function p(A,T,v,w,b){var y=fe.ht[T],R=0;if(T==0)return R;for(var S=v;S<w;S+=2){var U=0,W=0,j=y.xlen,z=y.xlen,g=0,C=b.l3_enc[S],te=b.l3_enc[S+1];if(C!=0&&(b.xr[S]<0&&g++,U--),T>15){if(C>14){var se=C-15;yn(se<=y.linmax),g|=se<<1,W=j,C=15}if(te>14){var Te=te-15;yn(Te<=y.linmax),g<<=j,g|=Te,W+=j,te=15}z=16}te!=0&&(g<<=1,b.xr[S+1]<0&&g++,U--),C=C*z+te,W-=U,U+=y.hlen[C],u(A,y.table[C],U),u(A,g,W),R+=U+W}return R}function I(A,T){var v=3*A.scalefac_band.s[3];v>T.big_values&&(v=T.big_values);var w=p(A,T.table_select[0],0,v,T);return w+=p(A,T.table_select[1],v,T.big_values,T),w}function D(A,T){var v,w,b,y;v=T.big_values;var R=T.region0_count+1;return yn(R<A.scalefac_band.l.length),b=A.scalefac_band.l[R],R+=T.region1_count+1,yn(R<A.scalefac_band.l.length),y=A.scalefac_band.l[R],b>v&&(b=v),y>v&&(y=v),w=p(A,T.table_select[0],0,b,T),w+=p(A,T.table_select[1],b,y,T),w+=p(A,T.table_select[2],y,v,T),w}function x(A){var T,v,w,b,y=0,R=A.internal_flags,S=R.l3_side;if(A.version==1)for(T=0;T<2;T++)for(v=0;v<R.channels_out;v++){var U=S.tt[T][v],W=du.slen1_tab[U.scalefac_compress],j=du.slen2_tab[U.scalefac_compress];for(b=0,w=0;w<U.sfbdivide;w++)U.scalefac[w]!=-1&&(u(R,U.scalefac[w],W),b+=W);for(;w<U.sfbmax;w++)U.scalefac[w]!=-1&&(u(R,U.scalefac[w],j),b+=j);yn(b==U.part2_length),U.block_type==P.SHORT_TYPE?b+=I(R,U):b+=D(R,U),b+=L(R,U),yn(b==U.part2_3_length+U.part2_length),y+=b}else for(T=0,v=0;v<R.channels_out;v++){var U=S.tt[T][v],z,g,C=0;if(yn(U.sfb_partition_table!=null),b=0,w=0,g=0,U.block_type==P.SHORT_TYPE){for(;g<4;g++){var te=U.sfb_partition_table[g]/3,se=U.slen[g];for(z=0;z<te;z++,w++)u(R,Math.max(U.scalefac[w*3+0],0),se),u(R,Math.max(U.scalefac[w*3+1],0),se),u(R,Math.max(U.scalefac[w*3+2],0),se),C+=3*se}b+=I(R,U)}else{for(;g<4;g++){var te=U.sfb_partition_table[g],se=U.slen[g];for(z=0;z<te;z++,w++)u(R,Math.max(U.scalefac[w],0),se),C+=se}b+=D(R,U)}b+=L(R,U),yn(b==U.part2_3_length),yn(C==U.part2_length),y+=C+b}return y}function B(){this.total=0}function _(A,T){var v=A.internal_flags,w,b,y,R,S;return S=v.w_ptr,R=v.h_ptr-1,R==-1&&(R=Rt.MAX_HEADER_BUF-1),w=v.header[R].write_timing-a,T.total=w,w>=0&&(b=1+R-S,R<S&&(b=1+R-S+Rt.MAX_HEADER_BUF),w-=b*8*v.sideinfo_len),y=t.getframebits(A),w+=y,T.total+=y,T.total%8!=0?T.total=1+T.total/8:T.total=T.total/8,T.total+=l+1,w<0&&wi.err.println(`strange error flushing buffer ... 
`),w}this.flush_bitstream=function(A){var T=A.internal_flags,v,w,b=T.h_ptr-1;if(b==-1&&(b=Rt.MAX_HEADER_BUF-1),v=T.l3_side,!((w=_(A,new B))<0)){if(m(A,w),yn(T.header[b].write_timing+this.getframebits(A)==a),T.ResvSize=0,v.main_data_begin=0,T.findReplayGain){var y=n.GetTitleGain(T.rgdata);yn(NEQ(y,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),T.RadioGain=Math.floor(y*10+.5)|0}T.findPeakSample&&(T.noclipGainChange=Math.ceil(Math.log10(T.PeakSample/32767)*20*10)|0,T.noclipGainChange>0&&(EQ(A.scale,1)||EQ(A.scale,0))?T.noclipScale=Math.floor(32767/T.PeakSample*100)/100:T.noclipScale=-1)}},this.add_dummy_byte=function(A,T,v){for(var w=A.internal_flags,b;v-- >0;)for(f(w,T,8),b=0;b<Rt.MAX_HEADER_BUF;++b)w.header[b].write_timing+=8},this.format_bitstream=function(A){var T=A.internal_flags,v;v=T.l3_side;var w=this.getframebits(A);m(A,v.resvDrain_pre),k(A,w);var b=8*T.sideinfo_len;if(b+=x(A),m(A,v.resvDrain_post),b+=v.resvDrain_post,v.main_data_begin+=(w-b)/8,_(A,new B)!=T.ResvSize&&wi.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),v.main_data_begin*8!=T.ResvSize&&(wi.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*v.main_data_begin,T.ResvSize,v.resvDrain_post,v.resvDrain_pre,8*T.sideinfo_len,b-v.resvDrain_post-8*T.sideinfo_len,b,b%8,w),wi.err.println("This is a fatal error.  It has several possible causes:"),wi.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),wi.err.println(" 9%%  Your system is overclocked"),wi.err.println(" 1%%  bug in LAME encoding library"),T.ResvSize=v.main_data_begin*8),a>1e9){var y;for(y=0;y<Rt.MAX_HEADER_BUF;++y)T.header[y].write_timing-=a;a=0}return 0},this.copy_buffer=function(A,T,v,w,b){var y=l+1;if(y<=0)return 0;if(w!=0&&y>w)return-1;if(wi.arraycopy(o,0,T,v,y),l=-1,c=0,b!=0){var R=P$(1);if(R[0]=A.nMusicCRC,r.updateMusicCRC(R,T,v,y),A.nMusicCRC=R[0],y>0&&(A.VBR_seek_table.nBytesWritten+=y),A.decode_on_the_fly){for(var S=D$([2,1152]),U=y,W=-1,j;W!=0;)if(W=s.hip_decode1_unclipped(A.hip,T,v,U,S[0],S[1]),U=0,W==-1&&(W=0),W>0){if(A.findPeakSample){for(j=0;j<W;j++)S[0][j]>A.PeakSample?A.PeakSample=S[0][j]:-S[0][j]>A.PeakSample&&(A.PeakSample=-S[0][j]);if(A.channels_out>1)for(j=0;j<W;j++)S[1][j]>A.PeakSample?A.PeakSample=S[1][j]:-S[1][j]>A.PeakSample&&(A.PeakSample=-S[1][j])}if(A.findReplayGain&&n.AnalyzeSamples(A.rgdata,S[0],0,S[1],0,W,A.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return y},this.init_bit_stream_w=function(A){o=L$(rt.LAME_MAXMP3BUFFER),A.h_ptr=A.w_ptr=0,A.header[A.h_ptr].write_timing=0,l=-1,c=0,a=0}}var F$=Ne.System,zt=Ne.VbrMode,F1=Ne.ShortBlock,ho=Ne.new_float,q3=Ne.new_int_n,B$=Ne.new_short_n,yr=Ne.assert;function rt(){var t=this,e=128*1024;rt.V9=410,rt.V8=420,rt.V7=430,rt.V6=440,rt.V5=450,rt.V4=460,rt.V3=470,rt.V2=480,rt.V1=490,rt.V0=500,rt.R3MIX=1e3,rt.STANDARD=1001,rt.EXTREME=1002,rt.INSANE=1003,rt.STANDARD_FAST=1004,rt.EXTREME_FAST=1005,rt.MEDIUM=1006,rt.MEDIUM_FAST=1007;var n=16384+e;rt.LAME_MAXMP3BUFFER=n;var s,i,r,o,a,l=new N1,c,d,u;this.enc=new P,this.setModules=function(g,C,te,se,Te,ke,Oe,be,ze){s=g,i=C,r=te,o=se,a=Te,c=ke,d=be,u=ze,this.enc.setModules(i,l,o,c)};function f(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=ho(P.SBMAX_l),this.bo_s_weight=ho(P.SBMAX_s)}function m(){this.lowerlimit=0}function h(g,C){this.lowpass=C}var M=4294479419;function k(g){var C;return g.class_id=M,C=g.internal_flags=new Rt,g.mode=Mt.NOT_SET,g.original=1,g.in_samplerate=44100,g.num_channels=2,g.num_samples=-1,g.bWriteVbrTag=!0,g.quality=-1,g.short_blocks=null,C.subblock_gain=-1,g.lowpassfreq=0,g.highpassfreq=0,g.lowpasswidth=-1,g.highpasswidth=-1,g.VBR=zt.vbr_off,g.VBR_q=4,g.ATHcurve=-1,g.VBR_mean_bitrate_kbps=128,g.VBR_min_bitrate_kbps=0,g.VBR_max_bitrate_kbps=0,g.VBR_hard_min=0,C.VBR_min_bitrate=1,C.VBR_max_bitrate=13,g.quant_comp=-1,g.quant_comp_short=-1,g.msfix=-1,C.resample_ratio=1,C.OldValue[0]=180,C.OldValue[1]=180,C.CurrentStep[0]=4,C.CurrentStep[1]=4,C.masking_lower=1,C.nsPsy.attackthre=-1,C.nsPsy.attackthre_s=-1,g.scale=-1,g.athaa_type=-1,g.ATHtype=-1,g.athaa_loudapprox=-1,g.athaa_sensitivity=0,g.useTemporal=null,g.interChRatio=-1,C.mf_samples_to_encode=P.ENCDELAY+P.POSTDELAY,g.encoder_padding=0,C.mf_size=P.ENCDELAY-P.MDCTDELAY,g.findReplayGain=!1,g.decode_on_the_fly=!1,C.decode_on_the_fly=!1,C.findReplayGain=!1,C.findPeakSample=!1,C.RadioGain=0,C.AudiophileGain=0,C.noclipGainChange=0,C.noclipScale=-1,g.preset=0,g.write_id3tag_automatic=!0,0}this.lame_init=function(){var g=new _$;return k(g),g.lame_allocated_gfp=1,g};function L(g){return g>1?0:g<=0?1:Math.cos(Math.PI/2*g)}this.nearestBitrateFullIndex=function(g){var C=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],te=0,se=0,Te=0,ke=0;ke=C[16],Te=16,se=C[16],te=16;for(var Oe=0;Oe<16;Oe++)if(Math.max(g,C[Oe+1])!=g){ke=C[Oe+1],Te=Oe+1,se=C[Oe],te=Oe;break}return ke-g>g-se?te:Te};function p(g,C){var te=44100;return C>=48e3?te=48e3:C>=44100?te=44100:C>=32e3?te=32e3:C>=24e3?te=24e3:C>=22050?te=22050:C>=16e3?te=16e3:C>=12e3?te=12e3:C>=11025?te=11025:C>=8e3&&(te=8e3),g==-1?te:(g<=15960&&(te=44100),g<=15250&&(te=32e3),g<=11220&&(te=24e3),g<=9970&&(te=22050),g<=7230&&(te=16e3),g<=5420&&(te=12e3),g<=4510&&(te=11025),g<=3970&&(te=8e3),C<te?C>44100?48e3:C>32e3?44100:C>24e3?32e3:C>22050?24e3:C>16e3?22050:C>12e3?16e3:C>11025?12e3:C>8e3?11025:8e3:te)}function I(g,C){switch(g){case 44100:return C.version=1,0;case 48e3:return C.version=1,1;case 32e3:return C.version=1,2;case 22050:return C.version=0,0;case 24e3:return C.version=0,1;case 16e3:return C.version=0,2;case 11025:return C.version=0,0;case 12e3:return C.version=0,1;case 8e3:return C.version=0,2;default:return C.version=0,-1}}function D(g,C,te){te<16e3&&(C=2);for(var se=fe.bitrate_table[C][1],Te=2;Te<=14;Te++)fe.bitrate_table[C][Te]>0&&Math.abs(fe.bitrate_table[C][Te]-g)<Math.abs(se-g)&&(se=fe.bitrate_table[C][Te]);return se}function x(g,C,te){te<16e3&&(C=2);for(var se=0;se<=14;se++)if(fe.bitrate_table[C][se]>0&&fe.bitrate_table[C][se]==g)return se;return-1}function B(g,C){var te=[new h(8,2e3),new h(16,3700),new h(24,3900),new h(32,5500),new h(40,7e3),new h(48,7500),new h(56,1e4),new h(64,11e3),new h(80,13500),new h(96,15100),new h(112,15600),new h(128,17e3),new h(160,17500),new h(192,18600),new h(224,19400),new h(256,19700),new h(320,20500)],se=t.nearestBitrateFullIndex(C);g.lowerlimit=te[se].lowpass}function _(g){var C=g.internal_flags,te=32,se=-1;if(C.lowpass1>0){for(var Te=999,ke=0;ke<=31;ke++){var Oe=ke/31;Oe>=C.lowpass2&&(te=Math.min(te,ke)),C.lowpass1<Oe&&Oe<C.lowpass2&&(Te=Math.min(Te,ke))}Te==999?C.lowpass1=(te-.75)/31:C.lowpass1=(Te-.75)/31,C.lowpass2=te/31}if(C.highpass2>0&&C.highpass2<.9*(.75/31)&&(C.highpass1=0,C.highpass2=0,F$.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),C.highpass2>0){for(var be=-1,ke=0;ke<=31;ke++){var Oe=ke/31;Oe<=C.highpass1&&(se=Math.max(se,ke)),C.highpass1<Oe&&Oe<C.highpass2&&(be=Math.max(be,ke))}C.highpass1=se/31,be==-1?C.highpass2=(se+.75)/31:C.highpass2=(be+.75)/31}for(var ke=0;ke<32;ke++){var ze,Be,Oe=ke/31;C.highpass2>C.highpass1?ze=L((C.highpass2-Oe)/(C.highpass2-C.highpass1+1e-20)):ze=1,C.lowpass2>C.lowpass1?Be=L((Oe-C.lowpass1)/(C.lowpass2-C.lowpass1+1e-20)):Be=1,C.amp_filter[ke]=ze*Be}}function A(g){var C=g.internal_flags;switch(g.quality){default:case 9:C.psymodel=0,C.noise_shaping=0,C.noise_shaping_amp=0,C.noise_shaping_stop=0,C.use_best_huffman=0,C.full_outer_loop=0;break;case 8:g.quality=7;case 7:C.psymodel=1,C.noise_shaping=0,C.noise_shaping_amp=0,C.noise_shaping_stop=0,C.use_best_huffman=0,C.full_outer_loop=0;break;case 6:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.noise_shaping_amp=0,C.noise_shaping_stop=0,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=0,C.full_outer_loop=0;break;case 5:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.noise_shaping_amp=0,C.noise_shaping_stop=0,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=0,C.full_outer_loop=0;break;case 4:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.noise_shaping_amp=0,C.noise_shaping_stop=0,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=1,C.full_outer_loop=0;break;case 3:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.noise_shaping_amp=1,C.noise_shaping_stop=1,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=1,C.full_outer_loop=0;break;case 2:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.substep_shaping==0&&(C.substep_shaping=2),C.noise_shaping_amp=1,C.noise_shaping_stop=1,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=1,C.full_outer_loop=0;break;case 1:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.substep_shaping==0&&(C.substep_shaping=2),C.noise_shaping_amp=2,C.noise_shaping_stop=1,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=1,C.full_outer_loop=0;break;case 0:C.psymodel=1,C.noise_shaping==0&&(C.noise_shaping=1),C.substep_shaping==0&&(C.substep_shaping=2),C.noise_shaping_amp=2,C.noise_shaping_stop=1,C.subblock_gain==-1&&(C.subblock_gain=1),C.use_best_huffman=1,C.full_outer_loop=0;break}}function T(g){var C=g.internal_flags;g.frameNum=0,g.write_id3tag_automatic&&d.id3tag_write_v2(g),C.bitrate_stereoMode_Hist=q3([16,4+1]),C.bitrate_blockType_Hist=q3([16,4+1+1]),C.PeakSample=0,g.bWriteVbrTag&&c.InitVbrTag(g)}this.lame_init_params=function(g){var C=g.internal_flags;if(C.Class_ID=0,C.ATH==null&&(C.ATH=new R$),C.PSY==null&&(C.PSY=new f),C.rgdata==null&&(C.rgdata=new C$),C.channels_in=g.num_channels,C.channels_in==1&&(g.mode=Mt.MONO),C.channels_out=g.mode==Mt.MONO?1:2,C.mode_ext=P.MPG_MD_MS_LR,g.mode==Mt.MONO&&(g.force_ms=!1),g.VBR==zt.vbr_off&&g.VBR_mean_bitrate_kbps!=128&&g.brate==0&&(g.brate=g.VBR_mean_bitrate_kbps),g.VBR==zt.vbr_off||g.VBR==zt.vbr_mtrh||g.VBR==zt.vbr_mt||(g.free_format=!1),g.VBR==zt.vbr_off&&g.brate==0&&Ys.EQ(g.compression_ratio,0)&&(g.compression_ratio=11.025),g.VBR==zt.vbr_off&&g.compression_ratio>0&&(g.out_samplerate==0&&(g.out_samplerate=map2MP3Frequency(int(.97*g.in_samplerate))),g.brate=0|g.out_samplerate*16*C.channels_out/(1e3*g.compression_ratio),C.samplerate_index=I(g.out_samplerate,g),g.free_format||(g.brate=D(g.brate,g.version,g.out_samplerate))),g.out_samplerate!=0&&(g.out_samplerate<16e3?(g.VBR_mean_bitrate_kbps=Math.max(g.VBR_mean_bitrate_kbps,8),g.VBR_mean_bitrate_kbps=Math.min(g.VBR_mean_bitrate_kbps,64)):g.out_samplerate<32e3?(g.VBR_mean_bitrate_kbps=Math.max(g.VBR_mean_bitrate_kbps,8),g.VBR_mean_bitrate_kbps=Math.min(g.VBR_mean_bitrate_kbps,160)):(g.VBR_mean_bitrate_kbps=Math.max(g.VBR_mean_bitrate_kbps,32),g.VBR_mean_bitrate_kbps=Math.min(g.VBR_mean_bitrate_kbps,320))),g.lowpassfreq==0){var te=16e3;switch(g.VBR){case zt.vbr_off:{var se=new m;B(se,g.brate),te=se.lowerlimit;break}case zt.vbr_abr:{var se=new m;B(se,g.VBR_mean_bitrate_kbps),te=se.lowerlimit;break}case zt.vbr_rh:{var Te=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(g.VBR_q>=0&&g.VBR_q<=9){var ke=Te[g.VBR_q],Oe=Te[g.VBR_q+1],be=g.VBR_q_frac;te=linear_int(ke,Oe,be)}else te=19500;break}default:{var Te=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(g.VBR_q>=0&&g.VBR_q<=9){var ke=Te[g.VBR_q],Oe=Te[g.VBR_q+1],be=g.VBR_q_frac;te=linear_int(ke,Oe,be)}else te=19500}}g.mode==Mt.MONO&&(g.VBR==zt.vbr_off||g.VBR==zt.vbr_abr)&&(te*=1.5),g.lowpassfreq=te|0}if(g.out_samplerate==0&&(2*g.lowpassfreq>g.in_samplerate&&(g.lowpassfreq=g.in_samplerate/2),g.out_samplerate=p(g.lowpassfreq|0,g.in_samplerate)),g.lowpassfreq=Math.min(20500,g.lowpassfreq),g.lowpassfreq=Math.min(g.out_samplerate/2,g.lowpassfreq),g.VBR==zt.vbr_off&&(g.compression_ratio=g.out_samplerate*16*C.channels_out/(1e3*g.brate)),g.VBR==zt.vbr_abr&&(g.compression_ratio=g.out_samplerate*16*C.channels_out/(1e3*g.VBR_mean_bitrate_kbps)),g.bWriteVbrTag||(g.findReplayGain=!1,g.decode_on_the_fly=!1,C.findPeakSample=!1),C.findReplayGain=g.findReplayGain,C.decode_on_the_fly=g.decode_on_the_fly,C.decode_on_the_fly&&(C.findPeakSample=!0),C.findReplayGain&&s.InitGainAnalysis(C.rgdata,g.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return g.internal_flags=null,-6;switch(C.decode_on_the_fly&&!g.decode_only&&(C.hip!=null&&u.hip_decode_exit(C.hip),C.hip=u.hip_decode_init()),C.mode_gr=g.out_samplerate<=24e3?1:2,g.framesize=576*C.mode_gr,g.encoder_delay=P.ENCDELAY,C.resample_ratio=g.in_samplerate/g.out_samplerate,g.VBR){case zt.vbr_mt:case zt.vbr_rh:case zt.vbr_mtrh:{var ze=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];g.compression_ratio=ze[g.VBR_q]}break;case zt.vbr_abr:g.compression_ratio=g.out_samplerate*16*C.channels_out/(1e3*g.VBR_mean_bitrate_kbps);break;default:g.compression_ratio=g.out_samplerate*16*C.channels_out/(1e3*g.brate);break}if(g.mode==Mt.NOT_SET&&(g.mode=Mt.JOINT_STEREO),g.highpassfreq>0?(C.highpass1=2*g.highpassfreq,g.highpasswidth>=0?C.highpass2=2*(g.highpassfreq+g.highpasswidth):C.highpass2=(1+0)*2*g.highpassfreq,C.highpass1/=g.out_samplerate,C.highpass2/=g.out_samplerate):(C.highpass1=0,C.highpass2=0),g.lowpassfreq>0?(C.lowpass2=2*g.lowpassfreq,g.lowpasswidth>=0?(C.lowpass1=2*(g.lowpassfreq-g.lowpasswidth),C.lowpass1<0&&(C.lowpass1=0)):C.lowpass1=(1-0)*2*g.lowpassfreq,C.lowpass1/=g.out_samplerate,C.lowpass2/=g.out_samplerate):(C.lowpass1=0,C.lowpass2=0),_(g),C.samplerate_index=I(g.out_samplerate,g),C.samplerate_index<0)return g.internal_flags=null,-1;if(g.VBR==zt.vbr_off){if(g.free_format)C.bitrate_index=0;else if(g.brate=D(g.brate,g.version,g.out_samplerate),C.bitrate_index=x(g.brate,g.version,g.out_samplerate),C.bitrate_index<=0)return g.internal_flags=null,-1}else C.bitrate_index=1;g.analysis&&(g.bWriteVbrTag=!1),C.pinfo!=null&&(g.bWriteVbrTag=!1),i.init_bit_stream_w(C);for(var Be=C.samplerate_index+3*g.version+6*(g.out_samplerate<16e3?1:0),we=0;we<P.SBMAX_l+1;we++)C.scalefac_band.l[we]=o.sfBandIndex[Be].l[we];for(var we=0;we<P.PSFB21+1;we++){var Xe=(C.scalefac_band.l[22]-C.scalefac_band.l[21])/P.PSFB21,mt=C.scalefac_band.l[21]+we*Xe;C.scalefac_band.psfb21[we]=mt}C.scalefac_band.psfb21[P.PSFB21]=576;for(var we=0;we<P.SBMAX_s+1;we++)C.scalefac_band.s[we]=o.sfBandIndex[Be].s[we];for(var we=0;we<P.PSFB12+1;we++){var Xe=(C.scalefac_band.s[13]-C.scalefac_band.s[12])/P.PSFB12,mt=C.scalefac_band.s[12]+we*Xe;C.scalefac_band.psfb12[we]=mt}C.scalefac_band.psfb12[P.PSFB12]=192,g.version==1?C.sideinfo_len=C.channels_out==1?4+17:4+32:C.sideinfo_len=C.channels_out==1?4+9:4+17,g.error_protection&&(C.sideinfo_len+=2),T(g),C.Class_ID=M;{var E;for(E=0;E<19;E++)C.nsPsy.pefirbuf[E]=700*C.mode_gr*C.channels_out;g.ATHtype==-1&&(g.ATHtype=4)}switch(yr(g.VBR_q<=9),yr(g.VBR_q>=0),g.VBR){case zt.vbr_mt:g.VBR=zt.vbr_mtrh;case zt.vbr_mtrh:{g.useTemporal==null&&(g.useTemporal=!1),r.apply_preset(g,500-g.VBR_q*10,0),g.quality<0&&(g.quality=LAME_DEFAULT_QUALITY),g.quality<5&&(g.quality=0),g.quality>5&&(g.quality=5),C.PSY.mask_adjust=g.maskingadjust,C.PSY.mask_adjust_short=g.maskingadjust_short,g.experimentalY?C.sfb21_extra=!1:C.sfb21_extra=g.out_samplerate>44e3,C.iteration_loop=new VBRNewIterationLoop(a);break}case zt.vbr_rh:{r.apply_preset(g,500-g.VBR_q*10,0),C.PSY.mask_adjust=g.maskingadjust,C.PSY.mask_adjust_short=g.maskingadjust_short,g.experimentalY?C.sfb21_extra=!1:C.sfb21_extra=g.out_samplerate>44e3,g.quality>6&&(g.quality=6),g.quality<0&&(g.quality=LAME_DEFAULT_QUALITY),C.iteration_loop=new VBROldIterationLoop(a);break}default:{var O;C.sfb21_extra=!1,g.quality<0&&(g.quality=LAME_DEFAULT_QUALITY),O=g.VBR,O==zt.vbr_off&&(g.VBR_mean_bitrate_kbps=g.brate),r.apply_preset(g,g.VBR_mean_bitrate_kbps,0),g.VBR=O,C.PSY.mask_adjust=g.maskingadjust,C.PSY.mask_adjust_short=g.maskingadjust_short,O==zt.vbr_off?C.iteration_loop=new k$(a):C.iteration_loop=new ABRIterationLoop(a);break}}if(yr(g.scale>=0),g.VBR!=zt.vbr_off){if(C.VBR_min_bitrate=1,C.VBR_max_bitrate=14,g.out_samplerate<16e3&&(C.VBR_max_bitrate=8),g.VBR_min_bitrate_kbps!=0&&(g.VBR_min_bitrate_kbps=D(g.VBR_min_bitrate_kbps,g.version,g.out_samplerate),C.VBR_min_bitrate=x(g.VBR_min_bitrate_kbps,g.version,g.out_samplerate),C.VBR_min_bitrate<0)||g.VBR_max_bitrate_kbps!=0&&(g.VBR_max_bitrate_kbps=D(g.VBR_max_bitrate_kbps,g.version,g.out_samplerate),C.VBR_max_bitrate=x(g.VBR_max_bitrate_kbps,g.version,g.out_samplerate),C.VBR_max_bitrate<0))return-1;g.VBR_min_bitrate_kbps=fe.bitrate_table[g.version][C.VBR_min_bitrate],g.VBR_max_bitrate_kbps=fe.bitrate_table[g.version][C.VBR_max_bitrate],g.VBR_mean_bitrate_kbps=Math.min(fe.bitrate_table[g.version][C.VBR_max_bitrate],g.VBR_mean_bitrate_kbps),g.VBR_mean_bitrate_kbps=Math.max(fe.bitrate_table[g.version][C.VBR_min_bitrate],g.VBR_mean_bitrate_kbps)}return g.tune&&(C.PSY.mask_adjust+=g.tune_value_a,C.PSY.mask_adjust_short+=g.tune_value_a),A(g),yr(g.scale>=0),g.athaa_type<0?C.ATH.useAdjust=3:C.ATH.useAdjust=g.athaa_type,C.ATH.aaSensitivityP=Math.pow(10,g.athaa_sensitivity/-10),g.short_blocks==null&&(g.short_blocks=F1.short_block_allowed),g.short_blocks==F1.short_block_allowed&&(g.mode==Mt.JOINT_STEREO||g.mode==Mt.STEREO)&&(g.short_blocks=F1.short_block_coupled),g.quant_comp<0&&(g.quant_comp=1),g.quant_comp_short<0&&(g.quant_comp_short=0),g.msfix<0&&(g.msfix=0),g.exp_nspsytune=g.exp_nspsytune|1,g.internal_flags.nsPsy.attackthre<0&&(g.internal_flags.nsPsy.attackthre=N1.NSATTACKTHRE),g.internal_flags.nsPsy.attackthre_s<0&&(g.internal_flags.nsPsy.attackthre_s=N1.NSATTACKTHRE_S),yr(g.scale>=0),g.scale<0&&(g.scale=1),g.ATHtype<0&&(g.ATHtype=4),g.ATHcurve<0&&(g.ATHcurve=4),g.athaa_loudapprox<0&&(g.athaa_loudapprox=2),g.interChRatio<0&&(g.interChRatio=0),g.useTemporal==null&&(g.useTemporal=!0),C.slot_lag=C.frac_SpF=0,g.VBR==zt.vbr_off&&(C.slot_lag=C.frac_SpF=(g.version+1)*72e3*g.brate%g.out_samplerate|0),o.iteration_init(g),l.psymodel_init(g),yr(g.scale>=0),0};function v(g,C){(g.in_buffer_0==null||g.in_buffer_nsamples<C)&&(g.in_buffer_0=ho(C),g.in_buffer_1=ho(C),g.in_buffer_nsamples=C)}this.lame_encode_flush=function(g,C,te,se){var Te=g.internal_flags,ke=B$([2,1152]),Oe=0,be,ze,Be,we,Xe=Te.mf_samples_to_encode-P.POSTDELAY,mt=w(g);if(Te.mf_samples_to_encode<1)return 0;for(be=0,g.in_samplerate!=g.out_samplerate&&(Xe+=16*g.out_samplerate/g.in_samplerate),Be=g.framesize-Xe%g.framesize,Be<576&&(Be+=g.framesize),g.encoder_padding=Be,we=(Xe+Be)/g.framesize;we>0&&Oe>=0;){var E=mt-Te.mf_size,O=g.frameNum;E*=g.in_samplerate,E/=g.out_samplerate,E>1152&&(E=1152),E<1&&(E=1),ze=se-be,se==0&&(ze=0),Oe=this.lame_encode_buffer(g,ke[0],ke[1],E,C,te,ze),te+=Oe,be+=Oe,we-=O!=g.frameNum?1:0}if(Te.mf_samples_to_encode=0,Oe<0||(ze=se-be,se==0&&(ze=0),i.flush_bitstream(g),Oe=i.copy_buffer(Te,C,te,ze,1),Oe<0))return Oe;if(te+=Oe,be+=Oe,ze=se-be,se==0&&(ze=0),g.write_id3tag_automatic){if(d.id3tag_write_v1(g),Oe=i.copy_buffer(Te,C,te,ze,0),Oe<0)return Oe;be+=Oe}return be},this.lame_encode_buffer=function(g,C,te,se,Te,ke,Oe){var be=g.internal_flags,ze=[null,null];if(be.Class_ID!=M)return-3;if(se==0)return 0;v(be,se),ze[0]=be.in_buffer_0,ze[1]=be.in_buffer_1;for(var Be=0;Be<se;Be++)ze[0][Be]=C[Be],be.channels_in>1&&(ze[1][Be]=te[Be]);return b(g,ze[0],ze[1],se,Te,ke,Oe)};function w(g){var C=P.BLKSIZE+g.framesize-P.FFTOFFSET;return C=Math.max(C,512+g.framesize-32),C}function b(g,C,te,se,Te,ke,Oe){var be=g.internal_flags,ze=0,Be,we,Xe,mt,E,O=[null,null],V=[null,null];if(be.Class_ID!=M)return-3;if(se==0)return 0;if(E=i.copy_buffer(be,Te,ke,Oe,0),E<0)return E;if(ke+=E,ze+=E,V[0]=C,V[1]=te,Ys.NEQ(g.scale,0)&&Ys.NEQ(g.scale,1))for(we=0;we<se;++we)V[0][we]*=g.scale,be.channels_out==2&&(V[1][we]*=g.scale);if(Ys.NEQ(g.scale_left,0)&&Ys.NEQ(g.scale_left,1))for(we=0;we<se;++we)V[0][we]*=g.scale_left;if(Ys.NEQ(g.scale_right,0)&&Ys.NEQ(g.scale_right,1))for(we=0;we<se;++we)V[1][we]*=g.scale_right;if(g.num_channels==2&&be.channels_out==1)for(we=0;we<se;++we)V[0][we]=.5*(V[0][we]+V[1][we]),V[1][we]=0;mt=w(g),O[0]=be.mfbuf[0],O[1]=be.mfbuf[1];for(var $=0;se>0;){var K=[null,null],ne=0,le=0;K[0]=V[0],K[1]=V[1];var Q=new R;if(z(g,O,K,$,se,Q),ne=Q.n_in,le=Q.n_out,be.findReplayGain&&!be.decode_on_the_fly&&s.AnalyzeSamples(be.rgdata,O[0],be.mf_size,O[1],be.mf_size,le,be.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(se-=ne,$+=ne,be.channels_out==2,be.mf_size+=le,yr(be.mf_size<=Rt.MFSIZE),be.mf_samples_to_encode<1&&(be.mf_samples_to_encode=P.ENCDELAY+P.POSTDELAY),be.mf_samples_to_encode+=le,be.mf_size>=mt){var ie=Oe-ze;if(Oe==0&&(ie=0),Be=y(g,O[0],O[1],Te,ke,ie),Be<0)return Be;for(ke+=Be,ze+=Be,be.mf_size-=g.framesize,be.mf_samples_to_encode-=g.framesize,Xe=0;Xe<be.channels_out;Xe++)for(we=0;we<be.mf_size;we++)O[Xe][we]=O[Xe][we+g.framesize]}}return ze}function y(g,C,te,se,Te,ke){var Oe=t.enc.lame_encode_mp3_frame(g,C,te,se,Te,ke);return g.frameNum++,Oe}function R(){this.n_in=0,this.n_out=0}function S(){this.num_used=0}function U(g,C){return C!=0?U(C,g%C):g}function W(g,C,te){var se=Math.PI*C;g/=te,g<0&&(g=0),g>1&&(g=1);var Te=g-.5,ke=.42-.5*Math.cos(2*g*Math.PI)+.08*Math.cos(4*g*Math.PI);return Math.abs(Te)<1e-9?se/Math.PI:ke*Math.sin(te*se*Te)/(Math.PI*te*Te)}function j(g,C,te,se,Te,ke,Oe,be,ze){var Be=g.internal_flags,we,Xe=0,mt,E=g.out_samplerate/U(g.out_samplerate,g.in_samplerate);E>Rt.BPC&&(E=Rt.BPC);var O=Math.abs(Be.resample_ratio-Math.floor(.5+Be.resample_ratio))<1e-4?1:0,V=1/Be.resample_ratio;V>1&&(V=1);var $=31;$%2==0&&--$,$+=O;var K=$+1;if(Be.fill_buffer_resample_init==0){for(Be.inbuf_old[0]=ho(K),Be.inbuf_old[1]=ho(K),we=0;we<=2*E;++we)Be.blackfilt[we]=ho(K);for(Be.itime[0]=0,Be.itime[1]=0,Xe=0;Xe<=2*E;Xe++){var ne=0,le=(Xe-E)/(2*E);for(we=0;we<=$;we++)ne+=Be.blackfilt[Xe][we]=W(we-le,V,$);for(we=0;we<=$;we++)Be.blackfilt[Xe][we]/=ne}Be.fill_buffer_resample_init=1}var Q=Be.inbuf_old[ze];for(mt=0;mt<se;mt++){var ie,X;if(ie=mt*Be.resample_ratio,Xe=0|Math.floor(ie-Be.itime[ze]),$+Xe-$/2>=Oe)break;var le=ie-Be.itime[ze]-(Xe+.5*($%2));X=0|Math.floor(le*2*E+E+.5);var ve=0;for(we=0;we<=$;++we){var de=0|we+Xe-$/2,ye;ye=de<0?Q[K+de]:Te[ke+de],ve+=ye*Be.blackfilt[X][we]}C[te+mt]=ve}if(be.num_used=Math.min(Oe,$+Xe-$/2),Be.itime[ze]+=be.num_used-mt*Be.resample_ratio,be.num_used>=K)for(we=0;we<K;we++)Q[we]=Te[ke+be.num_used+we-K];else{var Ie=K-be.num_used;for(we=0;we<Ie;++we)Q[we]=Q[we+be.num_used];for(Xe=0;we<K;++we,++Xe)Q[we]=Te[ke+Xe];yr(Xe==be.num_used)}return mt}function z(g,C,te,se,Te,ke){var Oe=g.internal_flags;if(Oe.resample_ratio<.9999||Oe.resample_ratio>1.0001)for(var be=0;be<Oe.channels_out;be++){var ze=new S;ke.n_out=j(g,C[be],Oe.mf_size,g.framesize,te[be],se,Te,ze,be),ke.n_in=ze.num_used}else{ke.n_out=Math.min(g.framesize,Te),ke.n_in=ke.n_out;for(var Be=0;Be<ke.n_out;++Be)C[0][Oe.mf_size+Be]=te[0][se+Be],Oe.channels_out==2&&(C[1][Oe.mf_size+Be]=te[1][se+Be])}}}var Ei=Ne.VbrMode;function U$(){function t(c,d,u,f,m,h,M,k,L,p,I,D,x,B,_){this.vbr_q=c,this.quant_comp=d,this.quant_comp_s=u,this.expY=f,this.st_lrm=m,this.st_s=h,this.masking_adj=M,this.masking_adj_short=k,this.ath_lower=L,this.ath_curve=p,this.ath_sensitivity=I,this.interch=D,this.safejoint=x,this.sfb21mod=B,this.msfix=_}function e(c,d,u,f,m,h,M,k,L,p,I,D,x,B){this.quant_comp=d,this.quant_comp_s=u,this.safejoint=f,this.nsmsfix=m,this.st_lrm=h,this.st_s=M,this.nsbass=k,this.scale=L,this.masking_adj=p,this.ath_lower=I,this.ath_curve=D,this.interch=x,this.sfscale=B}var n;this.setModules=function(c){n=c};var s=[new t(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new t(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new t(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new t(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new t(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new t(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new t(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new t(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new t(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new t(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new t(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],i=[new t(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new t(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new t(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new t(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new t(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new t(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new t(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new t(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new t(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new t(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new t(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function r(c,d,u){var f=c.VBR==Ei.vbr_rh?s:i,m=c.VBR_q_frac,h=f[d],M=f[d+1],k=h;h.st_lrm=h.st_lrm+m*(M.st_lrm-h.st_lrm),h.st_s=h.st_s+m*(M.st_s-h.st_s),h.masking_adj=h.masking_adj+m*(M.masking_adj-h.masking_adj),h.masking_adj_short=h.masking_adj_short+m*(M.masking_adj_short-h.masking_adj_short),h.ath_lower=h.ath_lower+m*(M.ath_lower-h.ath_lower),h.ath_curve=h.ath_curve+m*(M.ath_curve-h.ath_curve),h.ath_sensitivity=h.ath_sensitivity+m*(M.ath_sensitivity-h.ath_sensitivity),h.interch=h.interch+m*(M.interch-h.interch),h.msfix=h.msfix+m*(M.msfix-h.msfix),l(c,k.vbr_q),u!=0?c.quant_comp=k.quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=k.quant_comp),u!=0?c.quant_comp_short=k.quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=k.quant_comp_s),k.expY!=0&&(c.experimentalY=k.expY!=0),u!=0?c.internal_flags.nsPsy.attackthre=k.st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=k.st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=k.st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=k.st_s),u!=0?c.maskingadjust=k.masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=k.masking_adj),u!=0?c.maskingadjust_short=k.masking_adj_short:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=k.masking_adj_short),u!=0?c.ATHlower=-k.ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-k.ath_lower/10),u!=0?c.ATHcurve=k.ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=k.ath_curve),u!=0?c.athaa_sensitivity=k.ath_sensitivity:Math.abs(c.athaa_sensitivity- -1)>0||(c.athaa_sensitivity=k.ath_sensitivity),k.interch>0&&(u!=0?c.interChRatio=k.interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=k.interch)),k.safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|k.safejoint),k.sfb21mod>0&&(c.exp_nspsytune=c.exp_nspsytune|k.sfb21mod<<20),u!=0?c.msfix=k.msfix:Math.abs(c.msfix- -1)>0||(c.msfix=k.msfix),u==0&&(c.VBR_q=d,c.VBR_q_frac=m)}var o=[new e(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new e(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new e(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new e(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new e(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new e(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new e(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new e(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new e(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new e(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new e(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new e(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new e(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new e(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new e(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function a(c,d,u){var f=d,m=n.nearestBitrateFullIndex(d);if(c.VBR=Ei.vbr_abr,c.VBR_mean_bitrate_kbps=f,c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,320),c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,8),c.brate=c.VBR_mean_bitrate_kbps,c.VBR_mean_bitrate_kbps>320&&(c.disable_reservoir=!0),o[m].safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|2),o[m].sfscale>0&&(c.internal_flags.noise_shaping=2),Math.abs(o[m].nsbass)>0){var h=int(o[m].nsbass*4);h<0&&(h+=64),c.exp_nspsytune=c.exp_nspsytune|h<<2}return u!=0?c.quant_comp=o[m].quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=o[m].quant_comp),u!=0?c.quant_comp_short=o[m].quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=o[m].quant_comp_s),u!=0?c.msfix=o[m].nsmsfix:Math.abs(c.msfix- -1)>0||(c.msfix=o[m].nsmsfix),u!=0?c.internal_flags.nsPsy.attackthre=o[m].st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=o[m].st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=o[m].st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=o[m].st_s),u!=0?c.scale=o[m].scale:Math.abs(c.scale- -1)>0||(c.scale=o[m].scale),u!=0?c.maskingadjust=o[m].masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=o[m].masking_adj),o[m].masking_adj>0?u!=0?c.maskingadjust_short=o[m].masking_adj*.9:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[m].masking_adj*.9):u!=0?c.maskingadjust_short=o[m].masking_adj*1.1:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[m].masking_adj*1.1),u!=0?c.ATHlower=-o[m].ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-o[m].ath_lower/10),u!=0?c.ATHcurve=o[m].ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=o[m].ath_curve),u!=0?c.interChRatio=o[m].interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=o[m].interch),d}this.apply_preset=function(c,d,u){switch(d){case rt.R3MIX:{d=rt.V3,c.VBR=Ei.vbr_mtrh;break}case rt.MEDIUM:{d=rt.V4,c.VBR=Ei.vbr_rh;break}case rt.MEDIUM_FAST:{d=rt.V4,c.VBR=Ei.vbr_mtrh;break}case rt.STANDARD:{d=rt.V2,c.VBR=Ei.vbr_rh;break}case rt.STANDARD_FAST:{d=rt.V2,c.VBR=Ei.vbr_mtrh;break}case rt.EXTREME:{d=rt.V0,c.VBR=Ei.vbr_rh;break}case rt.EXTREME_FAST:{d=rt.V0,c.VBR=Ei.vbr_mtrh;break}case rt.INSANE:return d=320,c.preset=d,a(c,d,u),c.VBR=Ei.vbr_off,d}switch(c.preset=d,d){case rt.V9:return r(c,9,u),d;case rt.V8:return r(c,8,u),d;case rt.V7:return r(c,7,u),d;case rt.V6:return r(c,6,u),d;case rt.V5:return r(c,5,u),d;case rt.V4:return r(c,4,u),d;case rt.V3:return r(c,3,u),d;case rt.V2:return r(c,2,u),d;case rt.V1:return r(c,1,u),d;case rt.V0:return r(c,0,u),d}return d>=8&&d<=320?a(c,d,u):(c.preset=0,d)};function l(c,d){var u=0;return d<0&&(u=-1,d=0),d>9&&(u=-1,d=9),c.VBR_q=d,c.VBR_q_frac=0,u}}function j$(){this.setModules=function(t,e){}}function B1(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var $3=Ne.new_float,H$=Ne.new_int;function V$(){this.global_gain=0,this.sfb_count1=0,this.step=H$(39),this.noise=$3(39),this.noise_log=$3(39)}var br=Ne.System,z3=Ne.VbrMode,U1=Ne.Util,Sa=Ne.Arrays,Yl=Ne.new_float,Xl=Ne.assert;function q$(){var t;this.rv=null;var e;this.qupvt=null;var n,s=new j$,i;this.setModules=function(L,p,I,D){t=L,e=p,this.rv=p,n=I,this.qupvt=I,i=D,s.setModules(n,i)},this.ms_convert=function(L,p){for(var I=0;I<576;++I){var D=L.tt[p][0].xr[I],x=L.tt[p][1].xr[I];L.tt[p][0].xr[I]=(D+x)*(U1.SQRT2*.5),L.tt[p][1].xr[I]=(D-x)*(U1.SQRT2*.5)}};function r(L,p,I,D){D=0;for(var x=0;x<=I;++x){var B=Math.abs(L.xr[x]);D+=B,p[x]=Math.sqrt(B*Math.sqrt(B)),p[x]>L.xrpow_max&&(L.xrpow_max=p[x])}return D}this.init_xrpow=function(L,p,I){var D=0,x=0|p.max_nonzero_coeff;if(p.xrpow_max=0,Sa.fill(I,x,576,0),D=r(p,I,x,D),D>1e-20){var B=0;(L.substep_shaping&2)!=0&&(B=1);for(var _=0;_<p.psymax;_++)L.pseudohalf[_]=B;return!0}return Sa.fill(p.l3_enc,0,576,0),!1};function o(L,p){var I=L.ATH,D=p.xr;if(p.block_type!=P.SHORT_TYPE)for(var x=!1,B=P.PSFB21-1;B>=0&&!x;B--){var _=L.scalefac_band.psfb21[B],A=L.scalefac_band.psfb21[B+1],T=n.athAdjust(I.adjust,I.psfb21[B],I.floor);L.nsPsy.longfact[21]>1e-12&&(T*=L.nsPsy.longfact[21]);for(var v=A-1;v>=_;v--)if(Math.abs(D[v])<T)D[v]=0;else{x=!0;break}}else for(var w=0;w<3;w++)for(var x=!1,B=P.PSFB12-1;B>=0&&!x;B--){var _=L.scalefac_band.s[12]*3+(L.scalefac_band.s[13]-L.scalefac_band.s[12])*w+(L.scalefac_band.psfb12[B]-L.scalefac_band.psfb12[0]),A=_+(L.scalefac_band.psfb12[B+1]-L.scalefac_band.psfb12[B]),b=n.athAdjust(I.adjust,I.psfb12[B],I.floor);L.nsPsy.shortfact[12]>1e-12&&(b*=L.nsPsy.shortfact[12]);for(var v=A-1;v>=_;v--)if(Math.abs(D[v])<b)D[v]=0;else{x=!0;break}}}this.init_outer_loop=function(L,p){p.part2_3_length=0,p.big_values=0,p.count1=0,p.global_gain=210,p.scalefac_compress=0,p.table_select[0]=0,p.table_select[1]=0,p.table_select[2]=0,p.subblock_gain[0]=0,p.subblock_gain[1]=0,p.subblock_gain[2]=0,p.subblock_gain[3]=0,p.region0_count=0,p.region1_count=0,p.preflag=0,p.scalefac_scale=0,p.count1table_select=0,p.part2_length=0,p.sfb_lmax=P.SBPSY_l,p.sfb_smin=P.SBPSY_s,p.psy_lmax=L.sfb21_extra?P.SBMAX_l:P.SBPSY_l,p.psymax=p.psy_lmax,p.sfbmax=p.sfb_lmax,p.sfbdivide=11;for(var I=0;I<P.SBMAX_l;I++)p.width[I]=L.scalefac_band.l[I+1]-L.scalefac_band.l[I],p.window[I]=3;if(p.block_type==P.SHORT_TYPE){var D=Yl(576);p.sfb_smin=0,p.sfb_lmax=0,p.mixed_block_flag!=0&&(p.sfb_smin=3,p.sfb_lmax=L.mode_gr*2+4),p.psymax=p.sfb_lmax+3*((L.sfb21_extra?P.SBMAX_s:P.SBPSY_s)-p.sfb_smin),p.sfbmax=p.sfb_lmax+3*(P.SBPSY_s-p.sfb_smin),p.sfbdivide=p.sfbmax-18,p.psy_lmax=p.sfb_lmax;var x=L.scalefac_band.l[p.sfb_lmax];br.arraycopy(p.xr,0,D,0,576);for(var I=p.sfb_smin;I<P.SBMAX_s;I++)for(var B=L.scalefac_band.s[I],_=L.scalefac_band.s[I+1],A=0;A<3;A++)for(var T=B;T<_;T++)p.xr[x++]=D[3*T+A];for(var v=p.sfb_lmax,I=p.sfb_smin;I<P.SBMAX_s;I++)p.width[v]=p.width[v+1]=p.width[v+2]=L.scalefac_band.s[I+1]-L.scalefac_band.s[I],p.window[v]=0,p.window[v+1]=1,p.window[v+2]=2,v+=3}p.count1bits=0,p.sfb_partition_table=n.nr_of_sfb_block[0][0],p.slen[0]=0,p.slen[1]=0,p.slen[2]=0,p.slen[3]=0,p.max_nonzero_coeff=575,Sa.fill(p.scalefac,0),o(L,p)};function a(L){this.ordinal=L}a.BINSEARCH_NONE=new a(0),a.BINSEARCH_UP=new a(1),a.BINSEARCH_DOWN=new a(2);function l(L,p,I,D,x){var B,_=L.CurrentStep[D],A=!1,T=L.OldValue[D],v=a.BINSEARCH_NONE;for(p.global_gain=T,I-=p.part2_length;;){var w;if(B=i.count_bits(L,x,p,null),_==1||B==I)break;B>I?(v==a.BINSEARCH_DOWN&&(A=!0),A&&(_/=2),v=a.BINSEARCH_UP,w=_):(v==a.BINSEARCH_UP&&(A=!0),A&&(_/=2),v=a.BINSEARCH_DOWN,w=-_),p.global_gain+=w,p.global_gain<0&&(p.global_gain=0,A=!0),p.global_gain>255&&(p.global_gain=255,A=!0)}for(Xl(p.global_gain>=0),Xl(p.global_gain<256);B>I&&p.global_gain<255;)p.global_gain++,B=i.count_bits(L,x,p,null);return L.CurrentStep[D]=T-p.global_gain>=4?4:2,L.OldValue[D]=p.global_gain,p.part2_3_length=B,B}this.trancate_smallspectrums=function(L,p,I,D){var x=Yl(Pr.SFBMAX);if(!((L.substep_shaping&4)==0&&p.block_type==P.SHORT_TYPE||(L.substep_shaping&128)!=0)){n.calc_noise(p,I,x,new B1,null);for(var _=0;_<576;_++){var B=0;p.l3_enc[_]!=0&&(B=Math.abs(p.xr[_])),D[_]=B}var _=0,A=8;p.block_type==P.SHORT_TYPE&&(A=6);do{var T,v,w,b,y=p.width[A];if(_+=y,!(x[A]>=1)&&(Sa.sort(D,_-y,y),!BitStream.EQ(D[_-1],0))){T=(1-x[A])*I[A],v=0,b=0;do{var R;for(w=1;b+w<y&&!BitStream.NEQ(D[b+_-y],D[b+_+w-y]);w++);if(R=D[b+_-y]*D[b+_-y]*w,T<R){b!=0&&(v=D[b+_-y-1]);break}T-=R,b+=w}while(b<y);if(!BitStream.EQ(v,0))do Math.abs(p.xr[_-y])<=v&&(p.l3_enc[_-y]=0);while(--y>0)}}while(++A<p.psymax);p.part2_3_length=i.noquant_count_bits(L,p,null)}};function c(L){for(var p=0;p<L.sfbmax;p++)if(L.scalefac[p]+L.subblock_gain[L.window[p]]==0)return!1;return!0}function d(L){return U1.FAST_LOG10(.368+.632*L*L*L)}function u(L,p){for(var I=1e-37,D=0;D<p.psymax;D++)I+=d(L[D]);return Math.max(1e-20,I)}function f(L,p,I,D,x){var B;switch(L){default:case 9:{p.over_count>0?(B=I.over_SSD<=p.over_SSD,I.over_SSD==p.over_SSD&&(B=I.bits<p.bits)):B=I.max_noise<0&&I.max_noise*10+I.bits<=p.max_noise*10+p.bits;break}case 0:B=I.over_count<p.over_count||I.over_count==p.over_count&&I.over_noise<p.over_noise||I.over_count==p.over_count&&BitStream.EQ(I.over_noise,p.over_noise)&&I.tot_noise<p.tot_noise;break;case 8:I.max_noise=u(x,D);case 1:B=I.max_noise<p.max_noise;break;case 2:B=I.tot_noise<p.tot_noise;break;case 3:B=I.tot_noise<p.tot_noise&&I.max_noise<p.max_noise;break;case 4:B=I.max_noise<=0&&p.max_noise>.2||I.max_noise<=0&&p.max_noise<0&&p.max_noise>I.max_noise-.2&&I.tot_noise<p.tot_noise||I.max_noise<=0&&p.max_noise>0&&p.max_noise>I.max_noise-.2&&I.tot_noise<p.tot_noise+p.over_noise||I.max_noise>0&&p.max_noise>-.05&&p.max_noise>I.max_noise-.1&&I.tot_noise+I.over_noise<p.tot_noise+p.over_noise||I.max_noise>0&&p.max_noise>-.1&&p.max_noise>I.max_noise-.15&&I.tot_noise+I.over_noise+I.over_noise<p.tot_noise+p.over_noise+p.over_noise;break;case 5:B=I.over_noise<p.over_noise||BitStream.EQ(I.over_noise,p.over_noise)&&I.tot_noise<p.tot_noise;break;case 6:B=I.over_noise<p.over_noise||BitStream.EQ(I.over_noise,p.over_noise)&&(I.max_noise<p.max_noise||BitStream.EQ(I.max_noise,p.max_noise)&&I.tot_noise<=p.tot_noise);break;case 7:B=I.over_count<p.over_count||I.over_noise<p.over_noise;break}return p.over_count==0&&(B=B&&I.bits<p.bits),B}function m(L,p,I,D,x){var B=L.internal_flags,_;p.scalefac_scale==0?_=1.2968395546510096:_=1.6817928305074292;for(var A=0,T=0;T<p.sfbmax;T++)A<I[T]&&(A=I[T]);var v=B.noise_shaping_amp;switch(v==3&&(x?v=2:v=1),v){case 2:break;case 1:A>1?A=Math.pow(A,.5):A*=.95;break;case 0:default:A>1?A=1:A*=.95;break}for(var w=0,T=0;T<p.sfbmax;T++){var b=p.width[T],y;if(w+=b,!(I[T]<A)){if((B.substep_shaping&2)!=0&&(B.pseudohalf[T]=B.pseudohalf[T]==0?1:0,B.pseudohalf[T]==0&&B.noise_shaping_amp==2))return;for(p.scalefac[T]++,y=-b;y<0;y++)D[w+y]*=_,D[w+y]>p.xrpow_max&&(p.xrpow_max=D[w+y]);if(B.noise_shaping_amp==2)return}}}function h(L,p){for(var I=1.2968395546510096,D=0,x=0;x<L.sfbmax;x++){var B=L.width[x],_=L.scalefac[x];if(L.preflag!=0&&(_+=n.pretab[x]),D+=B,(_&1)!=0){_++;for(var A=-B;A<0;A++)p[D+A]*=I,p[D+A]>L.xrpow_max&&(L.xrpow_max=p[D+A])}L.scalefac[x]=_>>1}L.preflag=0,L.scalefac_scale=1}function M(L,p,I){var D,x=p.scalefac;for(D=0;D<p.sfb_lmax;D++)if(x[D]>=16)return!0;for(var B=0;B<3;B++){var _=0,A=0;for(D=p.sfb_lmax+B;D<p.sfbdivide;D+=3)_<x[D]&&(_=x[D]);for(;D<p.sfbmax;D+=3)A<x[D]&&(A=x[D]);if(!(_<16&&A<8)){if(p.subblock_gain[B]>=7)return!0;p.subblock_gain[B]++;var T=L.scalefac_band.l[p.sfb_lmax];for(D=p.sfb_lmax+B;D<p.sfbmax;D+=3){var v,w=p.width[D],b=x[D];if(b=b-(4>>p.scalefac_scale),b>=0){x[D]=b,T+=w*3;continue}x[D]=0;{var y=210+(b<<p.scalefac_scale+1);v=n.IPOW20(y)}T+=w*(B+1);for(var R=-w;R<0;R++)I[T+R]*=v,I[T+R]>p.xrpow_max&&(p.xrpow_max=I[T+R]);T+=w*(3-B-1)}{var v=n.IPOW20(202);T+=p.width[D]*(B+1);for(var R=-p.width[D];R<0;R++)I[T+R]*=v,I[T+R]>p.xrpow_max&&(p.xrpow_max=I[T+R])}}}return!1}function k(L,p,I,D,x){var B=L.internal_flags;m(L,p,I,D,x);var _=c(p);return _?!1:(B.mode_gr==2?_=i.scale_bitcount(p):_=i.scale_bitcount_lsf(B,p),_?(B.noise_shaping>1&&(Sa.fill(B.pseudohalf,0),p.scalefac_scale==0?(h(p,D),_=!1):p.block_type==P.SHORT_TYPE&&B.subblock_gain>0&&(_=M(B,p,D)||c(p))),_||(B.mode_gr==2?_=i.scale_bitcount(p):_=i.scale_bitcount_lsf(B,p)),!_):!0)}this.outer_loop=function(L,p,I,D,x,B){var _=L.internal_flags,A=new Qd,T=Yl(576),v=Yl(Pr.SFBMAX),w=new B1,b,y=new V$,R=9999999,S=!1,U=!1,W=0;if(l(_,p,B,x,D),_.noise_shaping==0)return 100;n.calc_noise(p,I,v,w,y),w.bits=p.part2_3_length,A.assign(p);var j=0;for(br.arraycopy(D,0,T,0,576);!S;){do{var z=new B1,g,C=255;if((_.substep_shaping&2)!=0?g=20:g=3,_.sfb21_extra&&(v[A.sfbmax]>1||A.block_type==P.SHORT_TYPE&&(v[A.sfbmax+1]>1||v[A.sfbmax+2]>1))||!k(L,A,v,D,U))break;A.scalefac_scale!=0&&(C=254);var te=B-A.part2_length;if(te<=0)break;for(;(A.part2_3_length=i.count_bits(_,D,A,y))>te&&A.global_gain<=C;)A.global_gain++;if(A.global_gain>C)break;if(w.over_count==0){for(;(A.part2_3_length=i.count_bits(_,D,A,y))>R&&A.global_gain<=C;)A.global_gain++;if(A.global_gain>C)break}if(n.calc_noise(A,I,v,z,y),z.bits=A.part2_3_length,p.block_type!=P.SHORT_TYPE?b=L.quant_comp:b=L.quant_comp_short,b=f(b,w,z,A,v)?1:0,b!=0)R=p.part2_3_length,w=z,p.assign(A),j=0,br.arraycopy(D,0,T,0,576);else if(_.full_outer_loop==0&&(++j>g&&w.over_count==0||_.noise_shaping_amp==3&&U&&j>30||_.noise_shaping_amp==3&&U&&A.global_gain-W>15))break}while(A.global_gain+A.scalefac_scale<255);_.noise_shaping_amp==3?U?S=!0:(A.assign(p),br.arraycopy(T,0,D,0,576),j=0,W=A.global_gain,U=!0):S=!0}return Xl(p.global_gain+p.scalefac_scale<=255),L.VBR==z3.vbr_rh||L.VBR==z3.vbr_mtrh?br.arraycopy(T,0,D,0,576):(_.substep_shaping&1)!=0&&trancate_smallspectrums(_,p,I,D),w.over_count},this.iteration_finish_one=function(L,p,I){var D=L.l3_side,x=D.tt[p][I];i.best_scalefac_store(L,p,I,D),L.use_best_huffman==1&&i.best_huffman_divide(L,x),e.ResvAdjust(L,x)},this.VBR_encode_granule=function(L,p,I,D,x,B,_){var A=L.internal_flags,T=new Qd,v=Yl(576),w=_,b=_+1,y=(_+B)/2,R,S,U=0,W=A.sfb21_extra;Xl(w<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Sa.fill(T.l3_enc,0);do y>w-42?A.sfb21_extra=!1:A.sfb21_extra=W,S=outer_loop(L,p,I,D,x,y),S<=0?(U=1,b=p.part2_3_length,T.assign(p),br.arraycopy(D,0,v,0,576),_=b-32,R=_-B,y=(_+B)/2):(B=y+32,R=_-B,y=(_+B)/2,U!=0&&(U=2,p.assign(T),br.arraycopy(v,0,D,0,576)));while(R>12);A.sfb21_extra=W,U==2&&br.arraycopy(T.l3_enc,0,p.l3_enc,0,576),Xl(p.part2_3_length<=w)},this.get_framebits=function(L,p){var I=L.internal_flags;I.bitrate_index=I.VBR_min_bitrate;var D=t.getframebits(L);I.bitrate_index=1,D=t.getframebits(L);for(var x=1;x<=I.VBR_max_bitrate;x++){I.bitrate_index=x;var B=new MeanBits(D);p[x]=e.ResvFrameBegin(L,B),D=B.bits}},this.VBR_old_prepare=function(L,p,I,D,x,B,_,A,T){var v=L.internal_flags,w,b=0,y=1,R=0;v.bitrate_index=v.VBR_max_bitrate;var S=e.ResvFrameBegin(L,new MeanBits(0))/v.mode_gr;get_framebits(L,B);for(var U=0;U<v.mode_gr;U++){var W=n.on_pe(L,p,A[U],S,U,0);v.mode_ext==P.MPG_MD_MS_LR&&(ms_convert(v.l3_side,U),n.reduce_side(A[U],I[U],S,W));for(var j=0;j<v.channels_out;++j){var z=v.l3_side.tt[U][j];z.block_type!=P.SHORT_TYPE?(b=1.28/(1+Math.exp(3.5-p[U][j]/300))-.05,w=v.PSY.mask_adjust-b):(b=2.56/(1+Math.exp(3.5-p[U][j]/300))-.14,w=v.PSY.mask_adjust_short-b),v.masking_lower=Math.pow(10,w*.1),init_outer_loop(v,z),T[U][j]=n.calc_xmin(L,D[U][j],z,x[U][j]),T[U][j]!=0&&(y=0),_[U][j]=126,R+=A[U][j]}}for(var U=0;U<v.mode_gr;U++)for(var j=0;j<v.channels_out;j++)R>B[v.VBR_max_bitrate]&&(A[U][j]*=B[v.VBR_max_bitrate],A[U][j]/=R),_[U][j]>A[U][j]&&(_[U][j]=A[U][j]);return y},this.bitpressure_strategy=function(L,p,I,D){for(var x=0;x<L.mode_gr;x++)for(var B=0;B<L.channels_out;B++){for(var _=L.l3_side.tt[x][B],A=p[x][B],T=0,v=0;v<_.psy_lmax;v++)A[T++]*=1+.029*v*v/P.SBMAX_l/P.SBMAX_l;if(_.block_type==P.SHORT_TYPE)for(var v=_.sfb_smin;v<P.SBMAX_s;v++)A[T++]*=1+.029*v*v/P.SBMAX_s/P.SBMAX_s,A[T++]*=1+.029*v*v/P.SBMAX_s/P.SBMAX_s,A[T++]*=1+.029*v*v/P.SBMAX_s/P.SBMAX_s;D[x][B]=0|Math.max(I[x][B],.9*D[x][B])}},this.VBR_new_prepare=function(L,p,I,D,x,B){var _=L.internal_flags,A=1,T=0,v=0,w;if(L.free_format){_.bitrate_index=0;var b=new MeanBits(T);w=e.ResvFrameBegin(L,b),T=b.bits,x[0]=w}else{_.bitrate_index=_.VBR_max_bitrate;var b=new MeanBits(T);e.ResvFrameBegin(L,b),T=b.bits,get_framebits(L,x),w=x[_.VBR_max_bitrate]}for(var y=0;y<_.mode_gr;y++){n.on_pe(L,p,B[y],T,y,0),_.mode_ext==P.MPG_MD_MS_LR&&ms_convert(_.l3_side,y);for(var R=0;R<_.channels_out;++R){var S=_.l3_side.tt[y][R];_.masking_lower=Math.pow(10,_.PSY.mask_adjust*.1),init_outer_loop(_,S),n.calc_xmin(L,I[y][R],S,D[y][R])!=0&&(A=0),v+=B[y][R]}}for(var y=0;y<_.mode_gr;y++)for(var R=0;R<_.channels_out;R++)v>w&&(B[y][R]*=w,B[y][R]/=v);return A},this.calc_target_bits=function(L,p,I,D,x,B){var _=L.internal_flags,A=_.l3_side,T,v,w,b,y=0;_.bitrate_index=_.VBR_max_bitrate;var R=new MeanBits(y);for(B[0]=e.ResvFrameBegin(L,R),y=R.bits,_.bitrate_index=1,y=t.getframebits(L)-_.sideinfo_len*8,x[0]=y/(_.mode_gr*_.channels_out),y=L.VBR_mean_bitrate_kbps*L.framesize*1e3,(_.substep_shaping&1)!=0&&(y*=1.09),y/=L.out_samplerate,y-=_.sideinfo_len*8,y/=_.mode_gr*_.channels_out,T=.93+.07*(11-L.compression_ratio)/(11-5.5),T<.9&&(T=.9),T>1&&(T=1),v=0;v<_.mode_gr;v++){var S=0;for(w=0;w<_.channels_out;w++){if(D[v][w]=int(T*y),p[v][w]>700){var U=int((p[v][w]-700)/1.4),W=A.tt[v][w];D[v][w]=int(T*y),W.block_type==P.SHORT_TYPE&&U<y/2&&(U=y/2),U>y*3/2?U=y*3/2:U<0&&(U=0),D[v][w]+=U}D[v][w]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(D[v][w]=LameInternalFlags.MAX_BITS_PER_CHANNEL),S+=D[v][w]}if(S>LameInternalFlags.MAX_BITS_PER_GRANULE)for(w=0;w<_.channels_out;++w)D[v][w]*=LameInternalFlags.MAX_BITS_PER_GRANULE,D[v][w]/=S}if(_.mode_ext==P.MPG_MD_MS_LR)for(v=0;v<_.mode_gr;v++)n.reduce_side(D[v],I[v],y*_.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(b=0,v=0;v<_.mode_gr;v++)for(w=0;w<_.channels_out;w++)D[v][w]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(D[v][w]=LameInternalFlags.MAX_BITS_PER_CHANNEL),b+=D[v][w];if(b>B[0])for(v=0;v<_.mode_gr;v++)for(w=0;w<_.channels_out;w++)D[v][w]*=B[0],D[v][w]/=b}}var K3=Ne.assert;function $$(){var t;this.setModules=function(e){t=e},this.ResvFrameBegin=function(e,n){var s=e.internal_flags,i,r=s.l3_side,o=t.getframebits(e);n.bits=(o-s.sideinfo_len*8)/s.mode_gr;var a=8*256*s.mode_gr-8;e.brate>320?i=8*int(e.brate*1e3/(e.out_samplerate/1152)/8+.5):(i=8*1440,e.strict_ISO&&(i=8*int(32e4/(e.out_samplerate/1152)/8+.5))),s.ResvMax=i-o,s.ResvMax>a&&(s.ResvMax=a),(s.ResvMax<0||e.disable_reservoir)&&(s.ResvMax=0);var l=n.bits*s.mode_gr+Math.min(s.ResvSize,s.ResvMax);return l>i&&(l=i),K3(s.ResvMax%8==0),K3(s.ResvMax>=0),r.resvDrain_pre=0,s.pinfo!=null&&(s.pinfo.mean_bits=n.bits/2,s.pinfo.resvsize=s.ResvSize),l},this.ResvMaxBits=function(e,n,s,i){var r=e.internal_flags,o,a=r.ResvSize,l=r.ResvMax;i!=0&&(a+=n),(r.substep_shaping&1)!=0&&(l*=.9),s.bits=n,a*10>l*9?(o=a-l*9/10,s.bits+=o,r.substep_shaping|=128):(o=0,r.substep_shaping&=127,!e.disable_reservoir&&(r.substep_shaping&1)==0&&(s.bits-=.1*n));var c=a<r.ResvMax*6/10?a:r.ResvMax*6/10;return c-=o,c<0&&(c=0),c},this.ResvAdjust=function(e,n){e.ResvSize-=n.part2_3_length+n.part2_length},this.ResvFrameEnd=function(e,n){var s,i=e.l3_side;e.ResvSize+=n*e.mode_gr;var r=0;i.resvDrain_post=0,i.resvDrain_pre=0,(s=e.ResvSize%8)!=0&&(r+=s),s=e.ResvSize-r-e.ResvMax,s>0&&(r+=s);{var o=Math.min(i.main_data_begin*8,r)/8;i.resvDrain_pre+=8*o,r-=8*o,e.ResvSize-=8*o,i.main_data_begin-=o}i.resvDrain_post+=r,e.ResvSize-=r}}function z$(){var t="http://www.mp3dev.org/",e=3,n=98,s=4,i=0,r=93;this.getLameVersion=function(){return e+"."+n+"."+s},this.getLameShortVersion=function(){return e+"."+n+"."+s},this.getLameVeryShortVersion=function(){return"LAME"+e+"."+n+"r"},this.getPsyVersion=function(){return i+"."+r},this.getLameUrl=function(){return t},this.getLameOsBitness=function(){return"32bits"}}var K$=Ne.System,j1=Ne.VbrMode,G3=Ne.ShortBlock,G$=Ne.Arrays,Dh=Ne.new_byte,W$=Ne.assert;fu.NUMTOCENTRIES=100;fu.MAXFRAMESIZE=2880;function fu(){var t,e,n;this.setModules=function(y,R,S){t=y,e=R,n=S};var s=1,i=2,r=4,o=8,a=fu.NUMTOCENTRIES,l=fu.MAXFRAMESIZE,c=a+4+4+4+4+4,d=c+9+1+1+8+1+1+3+1+1+2+4+2+2,u=128,f=64,m=32,h=null,M="Xing",k="Info",L=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function p(y,R){if(y.nVbrNumFrames++,y.sum+=R,y.seen++,!(y.seen<y.want)&&(y.pos<y.size&&(y.bag[y.pos]=y.sum,y.pos++,y.seen=0),y.pos==y.size)){for(var S=1;S<y.size;S+=2)y.bag[S/2]=y.bag[S];y.want*=2,y.pos/=2}}function I(y,R){if(!(y.pos<=0))for(var S=1;S<a;++S){var U=S/a,W,j,z=0|Math.floor(U*y.pos);z>y.pos-1&&(z=y.pos-1),W=y.bag[z],j=y.sum;var g=0|256*W/j;g>255&&(g=255),R[S]=255&g}}this.addVbrFrame=function(y){var R=y.internal_flags,S=Tables.bitrate_table[y.version][R.bitrate_index];W$(R.VBR_seek_table.bag!=null),p(R.VBR_seek_table,S)};function D(y,R){var S=y[R+0]&255;return S<<=8,S|=y[R+1]&255,S<<=8,S|=y[R+2]&255,S<<=8,S|=y[R+3]&255,S}function x(y,R,S){y[R+0]=255&(S>>24&255),y[R+1]=255&(S>>16&255),y[R+2]=255&(S>>8&255),y[R+3]=255&(S&255)}function B(y,R,S){y[R+0]=255&(S>>8&255),y[R+1]=255&(S&255)}function _(y,R){return new String(y,R,M.length(),h).equals(M)||new String(y,R,k.length(),h).equals(k)}function A(y,R,S){return 255&(y<<R|S&~(-1<<R))}function T(y,R){var S=y.internal_flags;R[0]=A(R[0],8,255),R[1]=A(R[1],3,7),R[1]=A(R[1],1,y.out_samplerate<16e3?0:1),R[1]=A(R[1],1,y.version),R[1]=A(R[1],2,4-3),R[1]=A(R[1],1,y.error_protection?0:1),R[2]=A(R[2],4,S.bitrate_index),R[2]=A(R[2],2,S.samplerate_index),R[2]=A(R[2],1,0),R[2]=A(R[2],1,y.extension),R[3]=A(R[3],2,y.mode.ordinal()),R[3]=A(R[3],2,S.mode_ext),R[3]=A(R[3],1,y.copyright),R[3]=A(R[3],1,y.original),R[3]=A(R[3],2,y.emphasis),R[0]=255;var U=255&(R[1]&241),W;y.version==1?W=u:y.out_samplerate<16e3?W=m:W=f,y.VBR==j1.vbr_off&&(W=y.brate);var j;y.free_format?j=0:j=255&16*t.BitrateIndex(W,y.version,y.out_samplerate),y.version==1?(R[1]=255&(U|10),U=255&(R[2]&13),R[2]=255&(j|U)):(R[1]=255&(U|2),U=255&(R[2]&13),R[2]=255&(j|U))}this.getVbrTag=function(y){var R=new VBRTagData,S=0;R.flags=0;var U=y[S+1]>>3&1,W=y[S+2]>>2&3,j=y[S+3]>>6&3,z=y[S+2]>>4&15;if(z=Tables.bitrate_table[U][z],y[S+1]>>4==14?R.samprate=Tables.samplerate_table[2][W]:R.samprate=Tables.samplerate_table[U][W],U!=0?j!=3?S+=32+4:S+=17+4:j!=3?S+=17+4:S+=9+4,!_(y,S))return null;S+=4,R.hId=U;var g=R.flags=D(y,S);if(S+=4,(g&s)!=0&&(R.frames=D(y,S),S+=4),(g&i)!=0&&(R.bytes=D(y,S),S+=4),(g&r)!=0){if(R.toc!=null)for(var C=0;C<a;C++)R.toc[C]=y[S+C];S+=a}R.vbrScale=-1,(g&o)!=0&&(R.vbrScale=D(y,S),S+=4),R.headersize=(U+1)*72e3*z/R.samprate,S+=21;var te=y[S+0]<<4;te+=y[S+1]>>4;var se=(y[S+1]&15)<<8;return se+=y[S+2]&255,(te<0||te>3e3)&&(te=-1),(se<0||se>3e3)&&(se=-1),R.encDelay=te,R.encPadding=se,R},this.InitVbrTag=function(y){var R=y.internal_flags,S;y.version==1?S=u:y.out_samplerate<16e3?S=m:S=f,y.VBR==j1.vbr_off&&(S=y.brate);var U=(y.version+1)*72e3*S/y.out_samplerate,W=R.sideinfo_len+d;if(R.VBR_seek_table.TotalFrameSize=U,U<W||U>l){y.bWriteVbrTag=!1;return}R.VBR_seek_table.nVbrNumFrames=0,R.VBR_seek_table.nBytesWritten=0,R.VBR_seek_table.sum=0,R.VBR_seek_table.seen=0,R.VBR_seek_table.want=1,R.VBR_seek_table.pos=0,R.VBR_seek_table.bag==null&&(R.VBR_seek_table.bag=new int[400],R.VBR_seek_table.size=400);var j=Dh(l);T(y,j);for(var z=R.VBR_seek_table.TotalFrameSize,g=0;g<z;++g)e.add_dummy_byte(y,j[g]&255,1)};function v(y,R){var S=R^y;return R=R>>8^L[S&255],R}this.updateMusicCRC=function(y,R,S,U){for(var W=0;W<U;++W)y[0]=v(R[S+W],y[0])};function w(y,R,S,U,W){var j=y.internal_flags,z=0,g=y.encoder_delay,C=y.encoder_padding,te=100-10*y.VBR_q-y.quality,se=n.getLameVeryShortVersion(),Te,ke=0,Oe,be=[1,5,3,2,4,0,3],ze=0|(y.lowpassfreq/100+.5>255?255:y.lowpassfreq/100+.5),Be=0,we=0,Xe=0,mt=y.internal_flags.noise_shaping,E=0,O=0,V=0,$=0,K=0,ne=(y.exp_nspsytune&1)!=0,le=(y.exp_nspsytune&2)!=0,Q=!1,ie=!1,X=y.internal_flags.nogap_total,ve=y.internal_flags.nogap_current,de=y.ATHtype,ye=0,Ie;switch(y.VBR){case vbr_abr:Ie=y.VBR_mean_bitrate_kbps;break;case vbr_off:Ie=y.brate;break;default:Ie=y.VBR_min_bitrate_kbps}switch(y.VBR.ordinal()<be.length?Te=be[y.VBR.ordinal()]:Te=0,Oe=16*ke+Te,j.findReplayGain&&(j.RadioGain>510&&(j.RadioGain=510),j.RadioGain<-510&&(j.RadioGain=-510),we=8192,we|=3072,j.RadioGain>=0?we|=j.RadioGain:(we|=512,we|=-j.RadioGain)),j.findPeakSample&&(Be=Math.abs(0|j.PeakSample/32767*Math.pow(2,23)+.5)),X!=-1&&(ve>0&&(ie=!0),ve<X-1&&(Q=!0)),ye=de+((ne?1:0)<<4)+((le?1:0)<<5)+((Q?1:0)<<6)+((ie?1:0)<<7),te<0&&(te=0),y.mode){case MONO:E=0;break;case STEREO:E=1;break;case DUAL_CHANNEL:E=2;break;case JOINT_STEREO:y.force_ms?E=4:E=3;break;case NOT_SET:default:E=7;break}y.in_samplerate<=32e3?V=0:y.in_samplerate==48e3?V=2:y.in_samplerate>48e3?V=3:V=1,(y.short_blocks==G3.short_block_forced||y.short_blocks==G3.short_block_dispensed||y.lowpassfreq==-1&&y.highpassfreq==-1||y.scale_left<y.scale_right||y.scale_left>y.scale_right||y.disable_reservoir&&y.brate<320||y.noATH||y.ATHonly||de==0||y.in_samplerate<=32e3)&&(O=1),$=mt+(E<<2)+(O<<5)+(V<<6),K=j.nMusicCRC,x(S,U+z,te),z+=4;for(var De=0;De<9;De++)S[U+z+De]=255&se.charAt(De);z+=9,S[U+z]=255&Oe,z++,S[U+z]=255&ze,z++,x(S,U+z,Be),z+=4,B(S,U+z,we),z+=2,B(S,U+z,Xe),z+=2,S[U+z]=255&ye,z++,Ie>=255?S[U+z]=255:S[U+z]=255&Ie,z++,S[U+z]=255&g>>4,S[U+z+1]=255&(g<<4)+(C>>8),S[U+z+2]=255&C,z+=3,S[U+z]=255&$,z++,S[U+z++]=0,B(S,U+z,y.preset),z+=2,x(S,U+z,R),z+=4,B(S,U+z,K),z+=2;for(var ce=0;ce<z;ce++)W=v(S[U+ce],W);return B(S,U+z,W),z+=2,z}function b(y){y.seek(0);var R=Dh(10);y.readFully(R);var S;return new String(R,"ISO-8859-1").startsWith("ID3")?S=0:S=((R[6]&127)<<21|(R[7]&127)<<14|(R[8]&127)<<7|R[9]&127)+R.length,S}this.getLameTagFrame=function(y,R){var S=y.internal_flags;if(!y.bWriteVbrTag||S.Class_ID!=Lame.LAME_ID||S.VBR_seek_table.pos<=0)return 0;if(R.length<S.VBR_seek_table.TotalFrameSize)return S.VBR_seek_table.TotalFrameSize;G$.fill(R,0,S.VBR_seek_table.TotalFrameSize,0),T(y,R);var U=Dh(a);if(y.free_format)for(var W=1;W<a;++W)U[W]=255&255*W/100;else I(S.VBR_seek_table,U);var j=S.sideinfo_len;y.error_protection&&(j-=2),y.VBR==j1.vbr_off?(R[j++]=255&k.charAt(0),R[j++]=255&k.charAt(1),R[j++]=255&k.charAt(2),R[j++]=255&k.charAt(3)):(R[j++]=255&M.charAt(0),R[j++]=255&M.charAt(1),R[j++]=255&M.charAt(2),R[j++]=255&M.charAt(3)),x(R,j,s+i+r+o),j+=4,x(R,j,S.VBR_seek_table.nVbrNumFrames),j+=4;var z=S.VBR_seek_table.nBytesWritten+S.VBR_seek_table.TotalFrameSize;x(R,j,0|z),j+=4,K$.arraycopy(U,0,R,j,U.length),j+=U.length,y.error_protection&&e.CRC_writeheader(S,R);for(var g=0,W=0;W<j;W++)g=v(R[W],g);return j+=w(y,z,R,j,g),S.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(y,R){var S=y.internal_flags;if(S.VBR_seek_table.pos<=0||(R.seek(R.length()),R.length()==0))return-1;var U=b(R);R.seek(U);var W=Dh(l),j=getLameTagFrame(y,W);return j>W.length?-1:(j<1||R.write(W,0,j),0)}}var W3=Ne.new_byte,Y$=Ne.assert;function X$(){this.setModules=function(t,e){}}function Q$(){this.setModules=function(t,e,n){}}function Z$(){}function J$(){this.setModules=function(t,e){}}function ez(t,e,n){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),t=1,e=44100,n=128);var s=new rt,i=new X$,r=new dn,o=new Ys,a=new U$,l=new Vn,c=new q$,d=new fu,u=new z$,f=new J$,m=new $$,h=new du,M=new Q$,k=new Z$;s.setModules(r,o,a,l,c,d,u,f,k),o.setModules(r,k,u,d),f.setModules(o,u),a.setModules(s),c.setModules(o,m,l,h),l.setModules(h,m,s.enc.psy),m.setModules(o),h.setModules(l),d.setModules(s,o,u),i.setModules(M,k),M.setModules(u,f,a);var L=s.lame_init();L.num_channels=t,L.in_samplerate=e,L.brate=n,L.mode=Mt.STEREO,L.quality=3,L.bWriteVbrTag=!1,L.disable_reservoir=!0,L.write_id3tag_automatic=!1,s.lame_init_params(L);var p=1152,I=0|1.25*p+7200,D=W3(I);this.encodeBuffer=function(x,B){t==1&&(B=x),Y$(x.length==B.length),x.length>p&&(p=x.length,I=0|1.25*p+7200,D=W3(I));var _=s.lame_encode_buffer(L,x,B,x.length,D,0,I);return new Int8Array(D.subarray(0,_))},this.flush=function(){var x=s.lame_encode_flush(L,D,0,I);return new Int8Array(D.subarray(0,x))}}function Mm(t){return t.charCodeAt(0)<<24|t.charCodeAt(1)<<16|t.charCodeAt(2)<<8|t.charCodeAt(3)}Mm("RIFF");Mm("WAVE");Mm("fmt ");Mm("data");class tz{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new ez(1,this.sampleRate,this.bitRate)}encode(e){const s=this._convertBuffer(e);let i=s.length;for(let r=0;i>=0;r+=1152){const o=s.subarray(r,r+1152),a=this.encoder.encodeBuffer(o);this.dataBuffer.push(new Int8Array(a)),i-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,n){for(let s=0;s<e.length;s++){const i=Math.max(-1,Math.min(1,e[s]));n[s]=i<0?i*32768:i*32767}}_convertBuffer(e){const n=new Float32Array(e),s=new Int16Array(e.length);return this._floatTo16BitPCM(n,s),s}}class nz{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const e={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(e).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new tz(this.encoderOptions))}stop(){this.stream.getTracks().forEach(n=>n.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=n=>{const s=n.inputBuffer.getChannelData(0);let i=0;this.lameEncoder&&this.lameEncoder.encode(s);for(let r=0;r<s.length;++r)i+=s[r]*s[r];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(i/s.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}var Y3=window.chrome,qv=window.navigator,sz=qv.vendor,iz=typeof window.opr!="undefined",rz=qv.userAgent.indexOf("Edg")>-1,oz=qv.userAgent.match("CriOS");function az(){return oz?!0:Y3!==null&&typeof Y3!="undefined"&&sz==="Google Inc."&&iz===!1&&rz===!1}function X3(){var t=lz(),e=t.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(e)}function lz(){var t=navigator.userAgent||navigator.vendor||window.opera||null;if(!t)throw new Error("Failed to look for user agent information.");return t}const cz={name:"RoomFooter",components:{SvgIcon:Un,EmojiPickerContainer:ES,RoomFiles:dq,RoomMessageReply:Pq,RoomUsersTag:qq,RoomEmojis:Wq,RoomTemplatesText:n$},directives:{clickOutside:Cm},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new lS({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(t=>t.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(t){this.getTextareaRef().value=t},roomMessage:{immediate:!0,handler(t){t&&(this.message=this.roomMessage)}},editedMessage(t){this.$emit("update-edited-message-id",t._id)},initReplyMessage(t){t&&this.replyMessage(t)},initEditMessage(t){t&&this.editMessage(t)},droppedFiles(t){t&&this.onFileChange(t)}},mounted(){const t=X3();let e=!0;this.getTextareaRef().addEventListener("keyup",n=>{n.key==="Enter"&&!n.shiftKey&&!this.fileDialog&&(t?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):e&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),e=!n.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{t&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),t&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(t){X3()&&t||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const e=az()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+e,this.cursorRangePosition+e),this.cursorRangePosition=null}))},onChangeInput(){var t,e,n;(((t=this.getTextareaRef())==null?void 0:t.value)||((e=this.getTextareaRef())==null?void 0:e.value)==="")&&(this.message=(n=this.getTextareaRef())==null?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const t=this.getTextareaRef();if(!t)return;const e=window.getComputedStyle(t,null).getPropertyValue("padding-top").replace("px","");t.style.height=0,t.style.height=t.scrollHeight-e*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(t){var e;const n=(e=t.clipboardData)==null?void 0:e.items;n&&Array.from(n).forEach(s=>{if(s.type.includes("image")){const i=s.getAsFile();this.onFileChange([i])}})},updateActiveUpOrDown(t,e){this.filteredEmojis.length?(this.activeUpOrDownEmojis=e,t.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=e,t.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=e,t.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(t){if(this.selectEmojiItem=!1,!t)return;const{position:e,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,e-1)+t+this.message.substr(n,this.message.length-1),this.cursorRangePosition=e,this.focusTextarea()},selectTemplateText(t){if(this.selectTemplatesTextItem=!1,!t)return;const{position:e,endPosition:n}=this.getCharPosition("/"),s=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,e-1)+t.text+s+this.message.substr(n,this.message.length-1),this.cursorRangePosition=e+t.text.length+s.length+1,this.focusTextarea()},addEmoji(t){this.message+=t.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(t){this.fileDialog=!0,this.focusTextarea(),Array.from(t).forEach(async e=>{const n=URL.createObjectURL(e),s=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,s),size:e.size,type:e.type,extension:e.name.substring(s+1),localUrl:n});const i=await fetch(n).then(o=>o.blob());let r=this.files.find(o=>o.localUrl===n);r&&(r.blob=i,r.loading=!1,delete r.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(t){this.files.splice(t,1),this.focusTextarea()},toggleRecorder(t){if(this.isRecording=t,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:`audio.${this.format}`,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var t;let e=this.message.trim();if(!this.files.length&&!e||this.isFileLoading)return;this.selectedUsersTag.forEach(s=>{e=e.replace(`@${s.username}`,`<usertag>${s._id}</usertag>`)});const n=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==e||((t=this.editedMessage.files)==null?void 0:t.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:e,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:e,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(t){this.resetMessage(),this.editedMessage={...t};let e=t.content;const n=e,s="<usertag>",i="</usertag>";[...e.matchAll(new RegExp(s,"gi"))].map(o=>o.index).forEach(o=>{const a=n.substring(o+s.length,n.indexOf(i,o)),l=this.room.users.find(c=>c._id===a);e=e.replace(`${s}${a}${i}`,`@${(l==null?void 0:l.username)||"unknown"}`),this.selectUserTag(l,!0)}),this.message=e,t.files&&(this.files=[...t.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(t){this.editedMessage={},this.messageReply=t,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(t){if(!this.getTextareaRef()||t===":"&&!this.emojisSuggestionEnabled||t==="@"&&(!this.userTagsEnabled||!this.room.users)||t==="/"&&!this.templatesText)return;const e=this.getTextareaRef().selectionStart;let n=e;for(;n>0&&this.message.charAt(n-1)!==t&&(this.message.charAt(n-1)!==" "||t!==":");)n--;const s=this.message.charAt(n-2),i=!s.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)===t&&(!s||s===" "||i)){const r=this.message.substring(n,e);t===":"?this.updateEmojis(r):t==="@"?this.updateShowUsersTag(r):t==="/"&&this.updateShowTemplatesText(r)}else this.resetFooterList(t)},updateShowUsersTag(t){this.filteredUsersTag=Tp(this.room.users,"username",t,!0).filter(e=>e._id!==this.currentUserId)},selectUserTag(t,e=!1){if(this.selectUsersTagItem=!1,!t)return;const{position:n,endPosition:s}=this.getCharPosition("@"),i=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,n)+t.username+i+this.message.substr(s,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...t}],e||(this.cursorRangePosition=n+t.username.length+i.length+1),this.focusTextarea()},updateShowTemplatesText(t){this.filteredTemplatesText=Tp(this.templatesText,"tag",t,!0)},getCharPosition(t){let n=this.getTextareaRef().selectionStart;for(;n>0&&this.message.charAt(n-1)!==t;)n--;const s=this.getTextareaRef().selectionEnd;return{position:n,endPosition:s}},async updateEmojis(t){if(!t)return;const e=await this.emojisDB.getEmojiBySearchQuery(t);this.filteredEmojis=e.map(n=>n.unicode)},resetFooterList(t=null){t===":"?this.filteredEmojis=[]:t==="@"?this.filteredUsersTag=[]:t==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(t=!1,e=!1){e||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!e)&&setTimeout(()=>this.focusTextarea(t))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new nz({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},uz={key:0,class:"vac-icon-textarea-left"},hz=Ce("div",{class:"vac-dot-audio-record"},null,-1),dz={class:"vac-dot-audio-record-time"},fz=["placeholder"],mz={class:"vac-icon-textarea"},pz={key:1},gz=["accept"];function _z(t,e,n,s,i,r){const o=Je("room-emojis"),a=Je("room-users-tag"),l=Je("room-templates-text"),c=Je("room-message-reply"),d=Je("room-files"),u=Je("svg-icon"),f=Je("emoji-picker-container"),m=mm("click-outside");return ar((re(),ge("div",{id:"room-footer",class:pt(["vac-room-footer",{"vac-app-box-shadow":r.shadowFooter}])},[He(o,{"filtered-emojis":i.filteredEmojis,"select-item":i.selectEmojiItem,"active-up-or-down":i.activeUpOrDownEmojis,onSelectEmoji:e[0]||(e[0]=h=>r.selectEmoji(h)),onActivateItem:e[1]||(e[1]=h=>i.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),He(a,{"filtered-users-tag":i.filteredUsersTag,"select-item":i.selectUsersTagItem,"active-up-or-down":i.activeUpOrDownUsersTag,onSelectUserTag:e[2]||(e[2]=h=>r.selectUserTag(h)),onActivateItem:e[3]||(e[3]=h=>i.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),He(l,{"filtered-templates-text":i.filteredTemplatesText,"select-item":i.selectTemplatesTextItem,"active-up-or-down":i.activeUpOrDownTemplatesText,onSelectTemplateText:e[4]||(e[4]=h=>r.selectTemplateText(h)),onActivateItem:e[5]||(e[5]=h=>i.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),He(c,{room:n.room,"message-reply":i.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:r.resetMessage},$t({_:2},[ht(t.$slots,(h,M)=>({name:M,fn:et(k=>[Fe(t.$slots,M,qt(Bt(k)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),He(d,{files:i.files,onRemoveFile:r.removeFile,onResetMessage:r.resetMessage},$t({_:2},[ht(t.$slots,(h,M)=>({name:M,fn:et(k=>[Fe(t.$slots,M,qt(Bt(k)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),Ce("div",{class:pt(["vac-box-footer",{"vac-box-footer-border":!i.files.length}])},[n.showAudio&&!i.files.length?(re(),ge("div",uz,[i.isRecording?(re(),ge(Ct,{key:0},[Ce("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:e[6]||(e[6]=(...h)=>r.stopRecorder&&r.stopRecorder(...h))},[Fe(t.$slots,"audio-stop-icon",{},()=>[He(u,{name:"close-outline"})])]),hz,Ce("div",dz,ot(r.recordedTime),1),Ce("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:e[7]||(e[7]=h=>r.toggleRecorder(!1))},[Fe(t.$slots,"audio-check-icon",{},()=>[He(u,{name:"checkmark"})])])],64)):(re(),ge("div",{key:1,class:"vac-svg-button",onClick:e[8]||(e[8]=h=>r.toggleRecorder(!0))},[Fe(t.$slots,"microphone-icon",{},()=>[He(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Le("",!0),Ce("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:pt(["vac-textarea",{"vac-textarea-outline":i.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:e[9]||(e[9]=(...h)=>r.onChangeInput&&r.onChangeInput(...h)),onKeydown:[e[10]||(e[10]=_o((...h)=>r.escapeTextarea&&r.escapeTextarea(...h),["esc"])),e[11]||(e[11]=_o(xi((...h)=>r.selectItem&&r.selectItem(...h),["exact","prevent"]),["enter"])),e[13]||(e[13]=_o(xi(()=>{},["exact","prevent"]),["tab"])),e[14]||(e[14]=_o((...h)=>r.selectItem&&r.selectItem(...h),["tab"])),e[15]||(e[15]=_o(h=>r.updateActiveUpOrDown(h,-1),["up"])),e[16]||(e[16]=_o(h=>r.updateActiveUpOrDown(h,1),["down"]))],onPaste:e[12]||(e[12]=(...h)=>r.onPasteImage&&r.onPasteImage(...h))},null,42,fz),Ce("div",mz,[i.editedMessage._id?(re(),ge("div",{key:0,class:"vac-svg-button",onClick:e[17]||(e[17]=(...h)=>r.resetMessage&&r.resetMessage(...h))},[Fe(t.$slots,"edit-close-icon",{},()=>[He(u,{name:"close-outline"})])])):Le("",!0),n.showEmojis?ar((re(),ge("div",pz,[Fe(t.$slots,"emoji-picker",Tv({emojiOpened:i.emojiOpened},{addEmoji:r.addEmoji}),()=>[He(f,{"emoji-opened":i.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:r.addEmoji,onOpenEmoji:e[18]||(e[18]=h=>i.emojiOpened=h)},{"emoji-picker-icon":et(()=>[Fe(t.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[m,()=>i.emojiOpened=!1]]):Le("",!0),n.showFiles?(re(),ge("div",{key:2,class:"vac-svg-button",onClick:e[19]||(e[19]=(...h)=>r.launchFilePicker&&r.launchFilePicker(...h))},[Fe(t.$slots,"paperclip-icon",{},()=>[He(u,{name:"paperclip"})])])):Le("",!0),n.textareaActionEnabled?(re(),ge("div",{key:3,class:"vac-svg-button",onClick:e[20]||(e[20]=(...h)=>r.textareaActionHandler&&r.textareaActionHandler(...h))},[Fe(t.$slots,"custom-action-icon",{},()=>[He(u,{name:"deleted"})])])):Le("",!0),n.showFiles?(re(),ge("input",{key:4,ref:"file",type:"file",multiple:"",accept:n.acceptedFiles,style:{display:"none"},onChange:e[21]||(e[21]=h=>r.onFileChange(h.target.files))},null,40,gz)):Le("",!0),n.showSendIcon?(re(),ge("div",{key:5,class:pt(["vac-svg-button",{"vac-send-disabled":r.isMessageEmpty}]),onClick:e[22]||(e[22]=(...h)=>r.sendMessage&&r.sendMessage(...h))},[Fe(t.$slots,"send-icon",{},()=>[He(u,{name:"send",param:r.isMessageEmpty||r.isFileLoading?"disabled":""},null,8,["param"])])],2)):Le("",!0)])],2)],2)),[[_m,Object.keys(n.room).length&&n.showFooter]])}var vz=Xt(cz,[["render",_z]]);const yz={name:"MessageReply",components:{AudioPlayer:Vv,SvgIcon:Un,FormatMessage:Xu},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:t}=this.message.replyMessage,e=this.roomUsers.find(n=>n._id===t);return e?e.username:""},firstFile(){var t,e;return(e=(t=this.message.replyMessage)==null?void 0:t.files)!=null&&e.length?this.message.replyMessage.files[0]:{}},isAudio(){return Im(this.firstFile)},isImage(){return fl(this.firstFile)},isVideo(){return Qu(this.firstFile)},isOtherFile(){var t;return((t=this.message.replyMessage.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},bz={class:"vac-reply-message"},wz={class:"vac-reply-username"},Ez={key:0,class:"vac-image-reply-container"},Tz={key:1,class:"vac-video-reply-container"},Sz={controls:""},Az=["src"],Rz={key:3,class:"vac-file-container"},Cz={class:"vac-text-ellipsis"},Iz={key:0,class:"vac-text-ellipsis vac-text-extension"},kz={class:"vac-reply-content"};function Mz(t,e,n,s,i,r){const o=Je("audio-player"),a=Je("svg-icon"),l=Je("format-message");return re(),ge("div",bz,[Ce("div",wz,ot(r.replyUsername),1),r.isImage?(re(),ge("div",Ez,[Ce("div",{class:"vac-message-image vac-message-image-reply",style:en({"background-image":`url('${r.firstFile.url}')`})},null,4)])):r.isVideo?(re(),ge("div",Tz,[Ce("video",Sz,[Ce("source",{src:r.firstFile.url},null,8,Az)])])):r.isAudio?(re(),Pt(o,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:e[0]||(e[0]=c=>t.progressTime=c),onHoverAudioProgress:e[1]||(e[1]=c=>t.hoverAudioProgress=c)},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["src"])):r.isOtherFile?(re(),ge("div",Rz,[Ce("div",null,[Fe(t.$slots,"file-icon",{},()=>[He(a,{name:"file"})])]),Ce("div",Cz,ot(r.firstFile.name),1),r.firstFile.extension?(re(),ge("div",Iz,ot(r.firstFile.extension),1)):Le("",!0)])):Le("",!0),Ce("div",kz,[He(l,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var xz=Xt(yz,[["render",Mz]]);const Oz={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const s=54*Math.PI;return{radius:35,stroke:4,normalizedRadius:27,circumference:s}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Nz={ref:"progress",class:"vac-progress-wrapper"},Lz=["height","width"],Dz=["stroke-dasharray","stroke-width","r","cx","cy"],Pz={class:"vac-progress-text"},Fz=Ce("span",{class:"vac-progress-pourcent"},"%",-1);function Bz(t,e,n,s,i,r){return re(),Pt(gn,{name:"vac-fade-spinner",appear:""},{default:et(()=>[Ce("div",Nz,[(re(),ge("svg",{height:i.radius*2,width:i.radius*2},[Ce("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":i.circumference+" "+i.circumference,style:en({strokeDashoffset:r.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":i.stroke,fill:"transparent",r:i.normalizedRadius,cx:i.radius,cy:i.radius},null,12,Dz)],8,Lz)),Ce("div",{class:"vac-progress-content",style:en({height:i.radius*2-19+"px",width:i.radius*2-19+"px"})},[Ce("div",Pz,[Xr(ot(n.progress),1),Fz])],4)],512)]),_:1})}var NS=Xt(Oz,[["render",Bz]]);const Uz={name:"MessageFile",components:{SvgIcon:Un,Loader:vm,ProgressBar:NS},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1||this.imageLoading},isImage(){return fl(this.file)},isVideo(){return Qu(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const t=this.$refs["imageRef"+this.index];t&&(this.imageResponsive={maxHeight:t.clientWidth-18,loaderTop:t.clientHeight/2-9})},methods:{checkImgLoad(){if(!fl(this.file))return;this.imageLoading=!0;const t=new Image;t.src=this.file.url,t.addEventListener("load",()=>this.imageLoading=!1)},openFile(t,e){this.messageSelectionEnabled||(t.stopPropagation(),this.$emit("open-file",{file:this.file,action:e}))}}},jz={class:"vac-message-file-container"},Hz={key:0,class:"vac-image-buttons"},Vz={controls:""},qz=["src"];function $z(t,e,n,s,i,r){const o=Je("progress-bar"),a=Je("loader"),l=Je("svg-icon");return re(),ge("div",jz,[r.isImage?(re(),ge("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:e[2]||(e[2]=c=>i.imageHover=!0),onMouseleave:e[3]||(e[3]=c=>i.imageHover=!1),onClick:e[4]||(e[4]=c=>r.openFile(c,"preview"))},[n.file.progress>=0?(re(),Pt(o,{key:0,progress:n.file.progress,style:en({top:`${i.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(re(),Pt(a,{key:1,show:r.isImageLoading,type:"message-file","message-id":n.message._id,style:en({top:`${i.imageResponsive.loaderTop}px`})},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["show","message-id","style"])),Ce("div",{class:pt(["vac-message-image",{"vac-blur-loading":r.isImageLoading&&n.message.senderId===n.currentUserId}]),style:en({"background-image":`url('${r.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${i.imageResponsive.maxHeight}px`})},[He(gn,{name:"vac-fade-image"},{default:et(()=>[!n.messageSelectionEnabled&&i.imageHover&&!r.isImageLoading?(re(),ge("div",Hz,[Ce("div",{class:"vac-svg-button vac-button-view",onClick:e[0]||(e[0]=c=>r.openFile(c,"preview"))},[Fe(t.$slots,"eye-icon_"+n.message._id,{},()=>[He(l,{name:"eye"})])]),Ce("div",{class:"vac-svg-button vac-button-download",onClick:e[1]||(e[1]=c=>r.openFile(c,"download"))},[Fe(t.$slots,"document-icon_"+n.message._id,{},()=>[He(l,{name:"document"})])])])):Le("",!0)]),_:3})],6)],544)):r.isVideo?(re(),ge("div",{key:1,class:"vac-video-container",onClick:e[5]||(e[5]=xi(c=>r.openFile(c,"preview"),["prevent"]))},[n.file.progress>=0?(re(),Pt(o,{key:0,progress:n.file.progress},null,8,["progress"])):Le("",!0),Ce("video",Vz,[Ce("source",{src:n.file.url},null,8,qz)])])):Le("",!0)])}var zz=Xt(Uz,[["render",$z]]);const Kz={name:"MessageFiles",components:{SvgIcon:Un,FormatMessage:Xu,ProgressBar:NS,MessageFile:zz},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(t=>h3(t))},otherFiles(){return this.message.files.filter(t=>!h3(t))}},methods:{openFile(t,e,n){this.messageSelectionEnabled||(t.stopPropagation(),this.$emit("open-file",{file:e,action:n}))}}},Gz={class:"vac-message-files-container"},Wz=["onClick"],Yz={class:"vac-svg-button"},Xz={class:"vac-text-ellipsis"},Qz={key:0,class:"vac-text-ellipsis vac-text-extension"};function Zz(t,e,n,s,i,r){const o=Je("message-file"),a=Je("progress-bar"),l=Je("svg-icon"),c=Je("format-message");return re(),ge("div",Gz,[(re(!0),ge(Ct,null,ht(r.imageVideoFiles,(d,u)=>(re(),ge("div",{key:u+"iv"},[He(o,{file:d,"current-user-id":n.currentUserId,message:n.message,index:u,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:e[0]||(e[0]=f=>t.$emit("open-file",f))},$t({_:2},[ht(t.$slots,(f,m)=>({name:m,fn:et(h=>[Fe(t.$slots,m,qt(Bt(h)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(re(!0),ge(Ct,null,ht(r.otherFiles,(d,u)=>(re(),ge("div",{key:u+"a",class:"vac-file-wrapper"},[d.progress>=0?(re(),Pt(a,{key:0,progress:d.progress,style:{top:"44px"}},null,8,["progress"])):Le("",!0),Ce("div",{class:pt(["vac-file-container",{"vac-file-container-progress":d.progress>=0}]),onClick:f=>r.openFile(f,d,"download")},[Ce("div",Yz,[Fe(t.$slots,"document-icon",{},()=>[He(l,{name:"document"})])]),Ce("div",Xz,ot(d.name),1),d.extension?(re(),ge("div",Qz,ot(d.extension),1)):Le("",!0)],10,Wz)]))),128)),He(c,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:e[1]||(e[1]=d=>t.$emit("open-user-tag",d))},null,8,["message-id","content","users","text-formatting","link-options"])])}var Jz=Xt(Kz,[["render",Zz]]);const eK={name:"MessageActions",components:{SvgIcon:Un,EmojiPickerContainer:ES},directives:{clickOutside:Cm},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(t=>!t.onlyMe)}},watch:{emojiOpened(t){this.$emit("update-emoji-opened",t),t&&(this.optionsOpened=!1)},optionsOpened(t){this.$emit("update-options-opened",t)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const t=wS(this.$el,"#room-footer");if(!t||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const e=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top;t.getBoundingClientRect().top-n>e+50?this.menuOptionsTop=30:this.menuOptionsTop=-e}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(t){this.closeOptions(),this.$emit("message-action-handler",t)},sendMessageReaction(t,e){this.$emit("send-message-reaction",{emoji:t,reaction:e}),this.closeEmoji()}}},tK={class:"vac-message-actions-wrapper"},nK={key:"3"},sK={class:"vac-menu-list"},iK=["onClick"];function rK(t,e,n,s,i,r){const o=Je("svg-icon"),a=Je("emoji-picker-container"),l=mm("click-outside");return re(),ge("div",tK,[Ce("div",{class:"vac-options-container",style:en({display:n.hoverAudioProgress?"none":"initial",width:r.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[He(Rv,{name:"vac-slide-left",tag:"span"},{default:et(()=>[r.isMessageActions||r.isMessageReactions?(re(),ge("div",{key:"1",class:pt(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):Le("",!0),r.isMessageActions?(re(),ge("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:e[0]||(e[0]=(...c)=>r.openOptions&&r.openOptions(...c))},[Fe(t.$slots,"dropdown-icon_"+n.message._id,{},()=>[He(o,{name:"dropdown",param:"message"})])],512)):Le("",!0),r.isMessageReactions?ar((re(),ge("div",nK,[Fe(t.$slots,"emoji-picker",Tv({emojiOpened:i.emojiOpened},{addEmoji:r.sendMessageReaction}),()=>[He(a,{class:"vac-message-emojis",style:en({right:r.isMessageActions?"30px":"5px"}),"emoji-opened":i.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:r.sendMessageReaction,onOpenEmoji:r.openEmoji},$t({_:2},[ht(t.$slots,(c,d)=>({name:d,fn:et(u=>[Fe(t.$slots,d,qt(Bt(u)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[l,r.closeEmoji]]):Le("",!0)]),_:3})],4),r.filteredMessageActions.length?(re(),Pt(gn,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:et(()=>[i.optionsOpened?ar((re(),ge("div",{key:0,ref:"menuOptions",class:pt(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:en({top:`${i.menuOptionsTop}px`})},[Ce("div",sK,[(re(!0),ge(Ct,null,ht(r.filteredMessageActions,c=>(re(),ge("div",{key:c.name},[Ce("div",{class:"vac-menu-item",onClick:d=>r.messageActionHandler(c)},ot(c.title),9,iK)]))),128))])],6)),[[l,r.closeOptions]]):Le("",!0)]),_:1},8,["name"])):Le("",!0)])}var oK=Xt(eK,[["render",rK]]);const aK={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(t,e){this.$emit("send-message-reaction",{emoji:t,reaction:e})}}},lK=["onClick"];function cK(t,e,n,s,i,r){return n.message.deleted?Le("",!0):(re(),Pt(Rv,{key:0,name:"vac-slide-left",tag:"span"},{default:et(()=>[(re(!0),ge(Ct,null,ht(n.message.reactions,(o,a)=>ar((re(),ge("button",{key:a+0,class:pt(["vac-button-reaction",{"vac-reaction-me":o.indexOf(n.currentUserId)!==-1}]),style:en({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:l=>r.sendMessageReaction({unicode:a},o)},[Xr(ot(a),1),Ce("span",null,ot(o.length),1)],14,lK)),[[_m,o.length]])),128))]),_:1}))}var uK=Xt(aK,[["render",cK]]);function hK(t){if(!((s,i)=>i.every(r=>{let o=!1;return(r.type[0]==="array"&&Array.isArray(s[r.key])||r.type.find(a=>a===typeof s[r.key]))&&(o=!0),o&&$v(s,r.key)}))(t,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function dK(t){if(!((s,i)=>i.every(r=>r.type.find(a=>a===typeof s[r.key])&&$v(s,r.key)))(t,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function fK(t){if(!((s,i)=>i.every(r=>r.type.find(a=>a===typeof s[r.key])&&$v(s,r.key)))(t,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function $v(t,e){return Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==null&&t[e]!==void 0}const mK={name:"RoomMessage",components:{SvgIcon:Un,FormatMessage:Xu,AudioPlayer:Vv,MessageReply:xz,MessageFiles:Jz,MessageActions:oK,MessageReactions:uK},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var t;return(t=this.message.files)==null?void 0:t.some(e=>Im(e))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(t=>t.senderId===this.currentUserId&&t.avatar)},hasSenderUserAvatar(){return this.messages.some(t=>t.senderId!==this.currentUserId&&t.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(t=>t._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(t){if(!t.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=t.reduce((e,n)=>n.index<e.index?n:e)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){fK(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(t){this.$emit("open-file",{message:this.message,file:t})},openUserTag(t){this.$emit("open-user-tag",{user:t})},messageActionHandler(t){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:t,message:this.message})},300)},sendMessageReaction({emoji:t,reaction:e}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:t,remove:e&&e.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},pK=["id"],gK={key:0,class:"vac-card-info vac-card-date"},_K={key:1,class:"vac-line-new"},vK={key:2,class:"vac-card-info vac-card-system"},yK={key:1,class:"vac-avatar-offset"},bK={key:0,class:"vac-progress-time"},wK={class:"vac-text-timestamp"},EK={key:0,class:"vac-icon-edited"},TK={key:1},SK=Ce("div",{class:"vac-failure-text"},"!",-1),AK=[SK],RK={key:3,class:"vac-avatar-current-offset"};function CK(t,e,n,s,i,r){const o=Je("format-message"),a=Je("message-reply"),l=Je("message-files"),c=Je("audio-player"),d=Je("svg-icon"),u=Je("message-actions"),f=Je("message-reactions");return re(),ge("div",{id:n.message._id,ref:"message",class:"vac-message-wrapper"},[r.showDate?(re(),ge("div",gK,ot(n.message.date),1)):Le("",!0),i.newMessage._id===n.message._id?(re(),ge("div",_K,ot(n.textMessages.NEW_MESSAGES),1)):Le("",!0),n.message.system?(re(),ge("div",vK,[Fe(t.$slots,"message_"+n.message._id,{},()=>[He(o,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:r.openUserTag},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(re(),ge("div",{key:3,class:pt(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}]),onClick:e[8]||(e[8]=(...m)=>r.selectMessage&&r.selectMessage(...m))},[Fe(t.$slots,"message_"+n.message._id,{},()=>[n.message.senderId!==n.currentUserId?Fe(t.$slots,"message-avatar_"+n.message._id,{key:0},()=>[n.message.avatar?(re(),ge("div",{key:0,class:"vac-avatar",style:en({"background-image":`url('${n.message.avatar}')`})},null,4)):Le("",!0)]):Le("",!0),r.hasSenderUserAvatar&&!n.message.avatar?(re(),ge("div",yK)):Le("",!0),Ce("div",{class:pt(["vac-message-container",{"vac-message-container-offset":r.messageOffset}])},[Ce("div",{class:pt(["vac-message-card",{"vac-message-highlight":r.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":r.isMessageSelected}]),onMouseover:e[5]||(e[5]=(...m)=>r.onHoverMessage&&r.onHoverMessage(...m)),onMouseleave:e[6]||(e[6]=(...m)=>r.onLeaveMessage&&r.onLeaveMessage(...m))},[r.showUsername?(re(),ge("div",{key:0,class:pt(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[Ce("span",null,ot(n.message.username),1)],2)):Le("",!0),!n.message.deleted&&n.message.replyMessage?(re(),Pt(a,{key:1,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Le("",!0),!!n.message.deleted||!n.message.files||!n.message.files.length?(re(),Pt(o,{key:2,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:r.openUserTag},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!r.isAudio||n.message.files.length>1?(re(),Pt(l,{key:3,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(re(),ge(Ct,{key:4},[He(c,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:e[0]||(e[0]=m=>i.progressTime=m),onHoverAudioProgress:e[1]||(e[1]=m=>i.hoverAudioProgress=m)},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?Le("",!0):(re(),ge("div",bK,ot(i.progressTime),1))],64)),Ce("div",wK,[n.message.edited&&!n.message.deleted?(re(),ge("div",EK,[Fe(t.$slots,"pencil-icon_"+n.message._id,{},()=>[He(d,{name:"pencil"})])])):Le("",!0),Ce("span",null,ot(n.message.timestamp),1),r.isCheckmarkVisible?(re(),ge("span",TK,[Fe(t.$slots,"checkmark-icon_"+n.message._id,{},()=>[He(d,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Le("",!0)]),He(u,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":i.messageHover,"hover-message-id":i.hoverMessageId,"hover-audio-progress":i.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:e[2]||(e[2]=m=>i.messageHover=m),onUpdateOptionsOpened:e[3]||(e[3]=m=>i.optionsOpened=m),onUpdateEmojiOpened:e[4]||(e[4]=m=>i.emojiOpened=m),onMessageActionHandler:r.messageActionHandler,onSendMessageReaction:r.sendMessageReaction},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),He(f,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:r.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Fe(t.$slots,"message-failure_"+n.message._id,{},()=>[n.message.failure&&n.message.senderId===n.currentUserId?(re(),ge("div",{key:0,class:pt(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:e[7]||(e[7]=m=>t.$emit("open-failed-message",{message:n.message}))},AK,2)):Le("",!0)]),n.message.senderId===n.currentUserId?Fe(t.$slots,"message-avatar_"+n.message._id,{key:2},()=>[n.message.avatar?(re(),ge("div",{key:0,class:"vac-avatar vac-avatar-current",style:en({"background-image":`url('${n.message.avatar}')`})},null,4)):Le("",!0)]):Le("",!0),r.hasCurrentUserAvatar&&!n.message.avatar?(re(),ge("div",RK)):Le("",!0)])],2))],8,pK)}var IK=Xt(mK,[["render",CK]]);const kK={name:"ChatRoom",components:{Loader:vm,SvgIcon:Un,RoomHeader:wH,RoomFooter:vz,RoomMessage:IK},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(t=>t.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const t=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return t&&this.updateLoadingMessages(!1),t},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(t,e){t.forEach((n,s)=>{this.showNewMessagesDivider&&!n.seen&&n.senderId!==this.currentUserId&&this.newMessages.push({_id:n._id,index:s})}),(e==null?void 0:e.length)===(t==null?void 0:t.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(t){t&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(t){this.loadingMessages=t,t||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const t=this.$el.querySelector("#infinite-loader-messages");if(t){const e={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreMessages()},e),this.observer.observe(t)}},preventTopScroll(){const t=this.$refs.scrollContainer,e=t.scrollHeight,n=new ResizeObserver(i=>{t.scrollHeight!==e&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:t.scrollHeight-e}),n.disconnect())});for(var s=0;s<t.children.length;s++)n.observe(t.children[s])},touchStart(t){if(!this.singleRoom&&t.changedTouches.length===1){const e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;addEventListener("touchend",s=>this.touchEnd(s,e,n),{once:!0})}},touchEnd(t,e,n){if(t.changedTouches.length===1){const s=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY,r=s-e>100,o=Math.abs(i-n)>50;r&&!o&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const t=this.$watch(()=>this.messages,e=>{if(!e||!e.length)return;const n=this.$refs.scrollContainer;!n||(t(),setTimeout(()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(t){this.selectedMessages.push(t)},unselectMessage(t){this.selectedMessages=this.selectedMessages.filter(e=>e._id!==t)},onMessageAdded({message:t,index:e,ref:n}){if(e!==this.messages.length-1)return;const s=n.offsetHeight+60;setTimeout(()=>{const i=this.getBottomScroll(this.$refs.scrollContainer)>s;t.senderId===this.currentUserId?i?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():i?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(t){if(!t.target)return;const e=this.getBottomScroll(t.target);e<60&&(this.scrollMessagesCount=0),this.scrollIcon=e>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:t,message:e}){switch(t.name){case"replyMessage":this.initReplyMessage=e,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=e,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",e);case"selectMessages":this.selectedMessages=[e],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:t,message:e})}},messageSelectionActionHandler(t){this.$emit("message-selection-action-handler",{action:t,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(t){this.$emit("send-message-reaction",t)},getBottomScroll(t){const{scrollHeight:e,clientHeight:n,scrollTop:s}=t;return e-n-s},scrollToBottom(){setTimeout(()=>{const t=this.$refs.scrollContainer;t.classList.add("vac-scroll-smooth"),t.scrollTo({top:t.scrollHeight,behavior:"smooth"}),setTimeout(()=>t.classList.remove("vac-scroll-smooth"))},50)},openFile({message:t,file:e}){this.$emit("open-file",{message:t,file:e})},openUserTag(t){this.$emit("open-user-tag",t)},onDropFiles(t){this.showFiles&&(this.droppedFiles=t.dataTransfer.files)}}},MK={class:"vac-container-center vac-room-empty"},xK={class:"vac-messages-container"},OK={key:0,class:"vac-text-started"},NK={key:1,class:"vac-text-started"},LK={key:0,id:"infinite-loader-messages"},DK={key:2},PK={key:0,class:"vac-badge-counter vac-messages-count"};function FK(t,e,n,s,i,r){const o=Je("room-header"),a=Je("loader"),l=Je("room-message"),c=Je("svg-icon"),d=Je("room-footer");return ar((re(),ge("div",{class:"vac-col-messages",onDrop:e[12]||(e[12]=xi((...u)=>r.onDropFiles&&r.onDropFiles(...u),["prevent"])),onDragenter:e[13]||(e[13]=xi(()=>{},["prevent"])),onDragover:e[14]||(e[14]=xi(()=>{},["prevent"])),onDragleave:e[15]||(e[15]=xi(()=>{},["prevent"])),onTouchstart:e[16]||(e[16]=(...u)=>r.touchStart&&r.touchStart(...u))},[r.showNoRoom?Fe(t.$slots,"no-room-selected",{key:0},()=>[Ce("div",MK,[Ce("div",null,ot(n.textMessages.ROOM_EMPTY),1)])]):(re(),Pt(o,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:r.room,"message-selection-enabled":i.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":i.selectedMessages.length,onToggleRoomsList:e[0]||(e[0]=u=>t.$emit("toggle-rooms-list")),onRoomInfo:e[1]||(e[1]=u=>t.$emit("room-info")),onMenuActionHandler:e[2]||(e[2]=u=>t.$emit("menu-action-handler",u)),onMessageSelectionActionHandler:r.messageSelectionActionHandler,onCancelMessageSelection:e[3]||(e[3]=u=>i.messageSelectionEnabled=!1)},$t({_:2},[ht(t.$slots,(u,f)=>({name:f,fn:et(m=>[Fe(t.$slots,f,qt(Bt(m)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Ce("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:e[5]||(e[5]=(...u)=>r.onContainerScroll&&r.onContainerScroll(...u))},[He(a,{show:i.loadingMessages,type:"messages"},$t({_:2},[ht(t.$slots,(u,f)=>({name:f,fn:et(m=>[Fe(t.$slots,f,qt(Bt(m)))])}))]),1032,["show"]),Ce("div",xK,[Ce("div",{class:pt({"vac-messages-hidden":i.loadingMessages})},[He(gn,{name:"vac-fade-message"},{default:et(()=>[Ce("div",null,[r.showNoMessages?(re(),ge("div",OK,[Fe(t.$slots,"messages-empty",{},()=>[Xr(ot(n.textMessages.MESSAGES_EMPTY),1)])])):Le("",!0),r.showMessagesStarted?(re(),ge("div",NK,ot(n.textMessages.CONVERSATION_STARTED)+" "+ot(n.messages[0].date),1)):Le("",!0)])]),_:3}),n.messages.length&&!n.messagesLoaded?(re(),ge("div",LK,[He(a,{show:!0,infinite:!0,type:"infinite-messages"},$t({_:2},[ht(t.$slots,(u,f)=>({name:f,fn:et(m=>[Fe(t.$slots,f,qt(Bt(m)))])}))]),1024)])):Le("",!0),(re(),Pt(Rv,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:et(()=>[(re(!0),ge(Ct,null,ht(n.messages,(u,f)=>(re(),ge("div",{key:u.indexId||u._id},[He(l,{"current-user-id":n.currentUserId,message:u,index:f,messages:n.messages,"edited-message-id":i.editedMessageId,"message-actions":n.messageActions,"room-users":r.room.users,"text-messages":n.textMessages,"new-messages":i.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":i.messageSelectionEnabled,"selected-messages":i.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:r.onMessageAdded,onMessageActionHandler:r.messageActionHandler,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:e[4]||(e[4]=m=>t.$emit("open-failed-message",m)),onSendMessageReaction:r.sendMessageReaction,onSelectMessage:r.selectMessage,onUnselectMessage:r.unselectMessage},$t({_:2},[ht(t.$slots,(m,h)=>({name:h,fn:et(M=>[Fe(t.$slots,h,qt(Bt(M)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),i.loadingMessages?Le("",!0):(re(),ge("div",DK,[He(gn,{name:"vac-bounce"},{default:et(()=>[i.scrollIcon?(re(),ge("div",{key:0,class:"vac-icon-scroll",onClick:e[6]||(e[6]=(...u)=>r.scrollToBottom&&r.scrollToBottom(...u))},[He(gn,{name:"vac-bounce"},{default:et(()=>[i.scrollMessagesCount?(re(),ge("div",PK,ot(i.scrollMessagesCount),1)):Le("",!0)]),_:1}),Fe(t.$slots,"scroll-icon",{},()=>[He(c,{name:"dropdown",param:"scroll"})])])):Le("",!0)]),_:3})])),He(d,{room:r.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":i.initReplyMessage,"init-edit-message":i.initEditMessage,"dropped-files":i.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:e[7]||(e[7]=u=>i.editedMessageId=u),onEditMessage:e[8]||(e[8]=u=>t.$emit("edit-message",u)),onSendMessage:e[9]||(e[9]=u=>t.$emit("send-message",u)),onTypingMessage:e[10]||(e[10]=u=>t.$emit("typing-message",u)),onTextareaActionHandler:e[11]||(e[11]=u=>t.$emit("textarea-action-handler",u))},$t({_:2},[ht(t.$slots,(u,f)=>({name:f,fn:et(m=>[Fe(t.$slots,f,qt(Bt(m)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[_m,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}var BK=Xt(kK,[["render",FK]]);const UK={name:"MediaPreview",components:{SvgIcon:Un},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return fl(this.file)},isVideo(){return Qu(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},jK={key:0,class:"vac-media-preview-container"},HK={key:1,class:"vac-media-preview-container"},VK={controls:"",autoplay:""},qK=["src"],$K={class:"vac-svg-button"};function zK(t,e,n,s,i,r){const o=Je("svg-icon");return re(),ge("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:e[0]||(e[0]=xi((...a)=>r.closeModal&&r.closeModal(...a),["stop"])),onKeydown:e[1]||(e[1]=_o((...a)=>r.closeModal&&r.closeModal(...a),["esc"]))},[He(gn,{name:"vac-bounce-preview",appear:""},{default:et(()=>[r.isImage?(re(),ge("div",jK,[Ce("div",{class:"vac-image-preview",style:en({"background-image":`url('${n.file.url}')`})},null,4)])):r.isVideo?(re(),ge("div",HK,[Ce("video",VK,[Ce("source",{src:n.file.url},null,8,qK)])])):Le("",!0)]),_:1}),Ce("div",$K,[Fe(t.$slots,"preview-close-icon",{},()=>[He(o,{name:"close-outline",param:"preview"})])])],544)}var KK=Xt(UK,[["render",zK]]),GK={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const WK={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},YK=({general:t,container:e,header:n,footer:s,sidemenu:i,content:r,dropdown:o,message:a,markdown:l,room:c,emoji:d,icons:u})=>({"--chat-color":t.color,"--chat-color-button-clear":t.colorButtonClear,"--chat-color-button":t.colorButton,"--chat-bg-color-button":t.backgroundColorButton,"--chat-bg-color-input":t.backgroundInput,"--chat-color-spinner":t.colorSpinner,"--chat-color-placeholder":t.colorPlaceholder,"--chat-color-caret":t.colorCaret,"--chat-border-style":t.borderStyle,"--chat-bg-scroll-icon":t.backgroundScrollIcon,"--chat-container-border":e.border,"--chat-container-border-radius":e.borderRadius,"--chat-container-box-shadow":e.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-footer-bg-color":s.background,"--chat-border-style-input":s.borderStyleInput,"--chat-border-color-input-selected":s.borderInputSelected,"--chat-footer-bg-color-reply":s.backgroundReply,"--chat-footer-bg-color-tag-active":s.backgroundTagActive,"--chat-footer-bg-color-tag":s.backgroundTag,"--chat-content-bg-color":r.background,"--chat-sidemenu-bg-color":i.background,"--chat-sidemenu-bg-color-hover":i.backgroundHover,"--chat-sidemenu-bg-color-active":i.backgroundActive,"--chat-sidemenu-color-active":i.colorActive,"--chat-sidemenu-border-color-search":i.borderColorSearch,"--chat-dropdown-bg-color":o.background,"--chat-dropdown-bg-color-hover":o.backgroundHover,"--chat-message-bg-color":a.background,"--chat-message-bg-color-me":a.backgroundMe,"--chat-message-color-started":a.colorStarted,"--chat-message-bg-color-deleted":a.backgroundDeleted,"--chat-message-bg-color-selected":a.backgroundSelected,"--chat-message-color-deleted":a.colorDeleted,"--chat-message-color-username":a.colorUsername,"--chat-message-color-timestamp":a.colorTimestamp,"--chat-message-bg-color-date":a.backgroundDate,"--chat-message-color-date":a.colorDate,"--chat-message-bg-color-system":a.backgroundSystem,"--chat-message-color-system":a.colorSystem,"--chat-message-color":a.color,"--chat-message-bg-color-media":a.backgroundMedia,"--chat-message-bg-color-reply":a.backgroundReply,"--chat-message-color-reply-username":a.colorReplyUsername,"--chat-message-color-reply-content":a.colorReply,"--chat-message-color-tag":a.colorTag,"--chat-message-bg-color-image":a.backgroundImage,"--chat-message-color-new-messages":a.colorNewMessages,"--chat-message-bg-color-scroll-counter":a.backgroundScrollCounter,"--chat-message-color-scroll-counter":a.colorScrollCounter,"--chat-message-bg-color-reaction":a.backgroundReaction,"--chat-message-border-style-reaction":a.borderStyleReaction,"--chat-message-bg-color-reaction-hover":a.backgroundReactionHover,"--chat-message-border-style-reaction-hover":a.borderStyleReactionHover,"--chat-message-color-reaction-counter":a.colorReactionCounter,"--chat-message-bg-color-reaction-me":a.backgroundReactionMe,"--chat-message-border-style-reaction-me":a.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":a.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":a.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":a.colorReactionCounterMe,"--chat-message-bg-color-audio-record":a.backgroundAudioRecord,"--chat-message-bg-color-audio-line":a.backgroundAudioLine,"--chat-message-bg-color-audio-progress":a.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":a.backgroundAudioProgressSelector,"--chat-message-color-file-extension":a.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm});var XK=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const QK={name:"ChatContainer",components:{RoomsList:rH,Room:BK,MediaPreview:KK},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"\xB0",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...GK,...this.textMessagesCasted}},cssVars(){const t=WK[this.theme],e={};return Object.keys(t).map(n=>{e[n]={...t[n],...this.stylesCasted[n]||{}}}),YK(e)},orderedRooms(){return this.roomsCasted.slice().sort((t,e)=>{const n=t.index||0,s=e.index||0;return this.roomsOrder==="asc"?n<s?-1:s<n?1:0:n>s?-1:s>n?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(t,e){if((!t[0]||!t.find(n=>n.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&t[0]&&(!e||t.length!==e.length))if(this.roomId){const n=t.find(s=>s.roomId===this.roomId)||{};this.fetchRoom({room:n})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(t){t&&(this.room={})},roomId:{immediate:!0,handler(t,e){if(t&&!this.loadingRoomsCasted&&this.roomsCasted.length){const n=this.roomsCasted.find(s=>s.roomId===t);this.fetchRoom({room:n})}else e&&!t&&(this.room={})}},room(t){!t||Object.entries(t).length===0||(hK(t),t.users.forEach(e=>{dK(e)}))},roomsListOpenedCasted:{immediate:!0,handler(t){this.showRoomsList=t}}},created(){this.updateResponsive(),window.addEventListener("resize",t=>{t.isTrusted&&this.updateResponsive()})},updated(){const t=document.querySelectorAll("[slot]");this.slots.length!==t.length&&(this.slots=t)},methods:{castBoolean(t){return t==="true"||t===!0},castArray(t){return t?Array.isArray(t)?t:JSON.parse(t):[]},castObject(t){return t?typeof t=="object"?t:JSON.parse(t):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:t}){this.room=t,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(t){this.$emit("search-room",{value:t,roomId:this.room.roomId})},fetchMessages(t){this.$emit("fetch-messages",{room:this.room,options:t})},sendMessage(t){this.$emit("send-message",{...t,roomId:this.room.roomId})},editMessage(t){this.$emit("edit-message",{...t,roomId:this.room.roomId})},deleteMessage(t){this.$emit("delete-message",{message:t,roomId:this.room.roomId})},openFile({message:t,file:e}){this.mediaPreviewEnabledCasted&&e.action==="preview"?(this.previewFile=e.file,this.showMediaPreview=!0):this.$emit("open-file",{message:t,file:e})},openUserTag({user:t}){this.$emit("open-user-tag",{user:t})},openFailedMessage({message:t}){this.$emit("open-failed-message",{message:t,roomId:this.room.roomId})},menuActionHandler(t){this.$emit("menu-action-handler",{action:t,roomId:this.room.roomId})},roomActionHandler({action:t,roomId:e}){this.$emit("room-action-handler",{action:t,roomId:e})},messageActionHandler(t){this.$emit("message-action-handler",{...t,roomId:this.room.roomId})},messageSelectionActionHandler(t){this.$emit("message-selection-action-handler",{...t,roomId:this.room.roomId})},sendMessageReaction(t){this.$emit("send-message-reaction",{...t,roomId:this.room.roomId})},typingMessage(t){this.$emit("typing-message",{message:t,roomId:this.room.roomId})},textareaActionHandler(t){this.$emit("textarea-action-handler",{message:t,roomId:this.room.roomId})}}},ZK={class:"vac-chat-container"};function JK(t,e,n,s,i,r){const o=Je("rooms-list"),a=Je("room"),l=Je("media-preview");return re(),ge("div",{class:"vac-card-window",style:en([{height:n.height},r.cssVars])},[Ce("div",ZK,[r.singleRoomCasted?Le("",!0):(re(),Pt(o,{key:0,"current-user-id":n.currentUserId,rooms:r.orderedRooms,"loading-rooms":r.loadingRoomsCasted,"rooms-loaded":r.roomsLoadedCasted,room:i.room,"room-actions":r.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":r.t,"show-search":r.showSearchCasted,"show-add-room":r.showAddRoomCasted,"show-rooms-list":i.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":i.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:r.fetchRoom,onFetchMoreRooms:r.fetchMoreRooms,onLoadingMoreRooms:e[0]||(e[0]=c=>i.loadingMoreRooms=c),onAddRoom:r.addRoom,onSearchRoom:r.searchRoom,onRoomActionHandler:r.roomActionHandler},$t({_:2},[ht(i.slots,c=>({name:c.slot,fn:et(d=>[Fe(t.$slots,c.slot,qt(Bt(d)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),He(a,{"current-user-id":n.currentUserId,rooms:r.roomsCasted,"room-id":i.room.roomId||"","load-first-room":r.loadFirstRoomCasted,messages:r.messagesCasted,"room-message":n.roomMessage,"messages-loaded":r.messagesLoadedCasted,"menu-actions":r.menuActionsCasted,"message-actions":r.messageActionsCasted,"message-selection-actions":r.messageSelectionActionsCasted,"auto-scroll":r.autoScrollCasted,"show-send-icon":r.showSendIconCasted,"show-files":r.showFilesCasted,"show-audio":r.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":r.showEmojisCasted,"show-reaction-emojis":r.showReactionEmojisCasted,"show-new-messages-divider":r.showNewMessagesDividerCasted,"show-footer":r.showFooterCasted,"text-messages":r.t,"single-room":r.singleRoomCasted,"show-rooms-list":i.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":i.isMobile,"loading-rooms":r.loadingRoomsCasted,"room-info-enabled":r.roomInfoEnabledCasted,"textarea-action-enabled":r.textareaActionEnabledCasted,"textarea-auto-focus":r.textareaAutoFocusCasted,"user-tags-enabled":r.userTagsEnabledCasted,"emojis-suggestion-enabled":r.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"templates-text":r.templatesTextCasted,"username-options":r.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:r.toggleRoomsList,onRoomInfo:r.roomInfo,onFetchMessages:r.fetchMessages,onSendMessage:r.sendMessage,onEditMessage:r.editMessage,onDeleteMessage:r.deleteMessage,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:r.openFailedMessage,onMenuActionHandler:r.menuActionHandler,onMessageActionHandler:r.messageActionHandler,onMessageSelectionActionHandler:r.messageSelectionActionHandler,onSendMessageReaction:r.sendMessageReaction,onTypingMessage:r.typingMessage,onTextareaActionHandler:r.textareaActionHandler},$t({_:2},[ht(i.slots,c=>({name:c.slot,fn:et(d=>[Fe(t.$slots,c.slot,qt(Bt(d)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),He(gn,{name:"vac-fade-preview",appear:""},{default:et(()=>[i.showMediaPreview?(re(),Pt(l,{key:0,file:i.previewFile,onCloseMediaPreview:e[1]||(e[1]=c=>i.showMediaPreview=!1)},$t({_:2},[ht(i.slots,c=>({name:c.slot,fn:et(d=>[Fe(t.$slots,c.slot,qt(Bt(d)))])}))]),1032,["file"])):Le("",!0)]),_:3})],4)}var eG=Xt(QK,[["render",JK],["styles",[XK]]]);const tG=kB(eG),Q3="vue-advanced-chat";function nG(){customElements.get(Q3)||customElements.define(Q3,tG)}var LS=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n};nG();const sG={props:{currentUserId:{type:String,required:!0},theme:{type:String,required:!0},isDevice:{type:Boolean,required:!0}},emits:["show-demo-options"],data(){return{roomsPerPage:15,rooms:[],roomId:"",startRooms:null,endRooms:null,roomsLoaded:!1,loadingRooms:!0,allUsers:[],loadingLastMessageByRoom:0,roomsLoadedCount:0,selectedRoom:null,messagesPerPage:20,messages:[],messagesLoaded:!1,roomMessage:"",lastLoadedMessage:null,previousLastLoadedMessage:null,roomsListeners:[],listeners:[],typingMessageCache:"",disableForm:!1,addNewRoom:null,addRoomUsername:"",inviteRoomId:null,invitedUsername:"",removeRoomId:null,removeUserId:"",removeUsers:[],roomActions:[{name:"inviteUser",title:"Invite User"},{name:"removeUser",title:"Remove User"},{name:"deleteRoom",title:"Delete Room"}],menuActions:[{name:"inviteUser",title:"Invite User"},{name:"removeUser",title:"Remove User"},{name:"deleteRoom",title:"Delete Room"}],messageSelectionActions:[{name:"deleteMessages",title:"Delete"}],styles:{container:{borderRadius:"4px"}},templatesText:[{tag:"help",text:"This is the help"},{tag:"action",text:"This is the action"},{tag:"action 2",text:"This is the second action"}]}},computed:{loadedRooms(){return this.rooms.slice(0,this.roomsLoadedCount)},screenHeight(){return this.isDevice?window.innerHeight+"px":"calc(100vh - 80px)"}},mounted(){this.addCss(),this.fetchRooms(),KD(this.currentUserId)},methods:{async addCss(){},resetRooms(){this.loadingRooms=!0,this.loadingLastMessageByRoom=0,this.roomsLoadedCount=0,this.rooms=[],this.roomsLoaded=!0,this.startRooms=null,this.endRooms=null,this.roomsListeners.forEach(t=>t()),this.roomsListeners=[],this.resetMessages()},resetMessages(){this.messages=[],this.messagesLoaded=!1,this.lastLoadedMessage=null,this.previousLastLoadedMessage=null,this.listeners.forEach(t=>t()),this.listeners=[]},fetchRooms(){this.resetRooms(),this.fetchMoreRooms()},async fetchMoreRooms(){if(this.endRooms&&!this.startRooms){this.roomsLoaded=!0;return}const t=CD(this.currentUserId,this.roomsPerPage,this.startRooms),{data:e,docs:n}=await kD(t);this.roomsLoaded=e.length===0||e.length<this.roomsPerPage,this.startRooms&&(this.endRooms=this.startRooms),this.startRooms=n[n.length-1];const s=[];e.forEach(a=>{a.users.forEach(l=>{!this.allUsers.find(d=>(d==null?void 0:d._id)===l)&&s.indexOf(l)===-1&&s.push(l)})});const i=[];s.forEach(a=>{const l=SD(a);i.push(l)}),this.allUsers=[...this.allUsers,...await Promise.all(i)];const r={};e.forEach(a=>{r[a.id]={...a,users:[]},a.users.forEach(l=>{const c=this.allUsers.find(d=>(d==null?void 0:d._id)===l);c&&r[a.id].users.push(c)})});const o=[];Object.keys(r).forEach(a=>{const l=r[a],c=l.users.filter(u=>u._id!==this.currentUserId);l.roomName=c.map(u=>u.username).join(", ")||"Myself";const d=c.length===1&&c[0].avatar?c[0].avatar:WD;o.push({...l,roomId:a,avatar:d,index:l.lastUpdated.seconds,lastMessage:{content:"Room created",timestamp:g1(new Date(l.lastUpdated.seconds),l.lastUpdated)}})}),this.rooms=this.rooms.concat(o),o.forEach(a=>this.listenLastMessage(a)),this.rooms.length||(this.loadingRooms=!1,this.roomsLoadedCount=0),this.listenUsersOnlineStatus(o),this.listenRooms(t)},listenLastMessage(t){const e=UD(t.roomId,n=>{n.forEach(s=>{const i=this.formatLastMessage(s,t),r=this.rooms.findIndex(o=>t.roomId===o.roomId);this.rooms[r].lastMessage=i,this.rooms=[...this.rooms]}),this.loadingLastMessageByRoom<this.rooms.length&&(this.loadingLastMessageByRoom++,this.loadingLastMessageByRoom===this.rooms.length&&(this.loadingRooms=!1,this.roomsLoadedCount=this.rooms.length))});this.roomsListeners.push(e)},formatLastMessage(t,e){var i,r;if(!t.timestamp)return;let n=t.content;if((i=t.files)!=null&&i.length){const o=t.files[0];n=`${o.name}.${o.extension||o.type}`}const s=t.sender_id!==this.currentUserId?(r=e.users.find(o=>t.sender_id===o._id))==null?void 0:r.username:"";return{...t,_id:t.id,content:n,senderId:t.sender_id,timestamp:g1(new Date(t.timestamp.seconds*1e3),t.timestamp),username:s,distributed:!0,seen:t.sender_id===this.currentUserId?t.seen:null,new:t.sender_id!==this.currentUserId&&(!t.seen||!t.seen[this.currentUserId])}},fetchMessages({room:t,options:e={}}){if(this.$emit("show-demo-options",!1),e.reset&&this.resetMessages(),this.previousLastLoadedMessage&&!this.lastLoadedMessage){this.messagesLoaded=!0;return}this.selectedRoom=t.roomId,Z0(t.roomId,this.messagesPerPage,this.lastLoadedMessage).then(({data:n,docs:s})=>{this.selectedRoom===t.roomId&&((n.length===0||n.length<this.messagesPerPage)&&setTimeout(()=>{this.messagesLoaded=!0},0),e.reset&&(this.messages=[]),n.forEach(i=>{const r=this.formatMessage(t,i);this.messages.unshift(r)}),this.lastLoadedMessage&&(this.previousLastLoadedMessage=this.lastLoadedMessage),this.lastLoadedMessage=s[s.length-1],this.listenMessages(t))})},listenMessages(t){const e=FD(t.roomId,this.lastLoadedMessage,this.previousLastLoadedMessage,n=>{n.forEach(s=>{const i=this.formatMessage(t,s),r=this.messages.findIndex(o=>o._id===s.id);r===-1?this.messages=this.messages.concat([i]):(this.messages[r]=i,this.messages=[...this.messages]),this.markMessagesSeen(t,s)})});this.listeners.push(e)},markMessagesSeen(t,e){e.sender_id!==this.currentUserId&&(!e.seen||!e.seen[this.currentUserId])&&nc(t.roomId,e.id,{[`seen.${this.currentUserId}`]:new Date})},formatMessage(t,e){var s;const n={...e,senderId:e.sender_id,_id:e.id,seconds:e.timestamp.seconds,timestamp:tp(e.timestamp,"HH:mm"),date:tp(e.timestamp,"DD MMMM YYYY"),username:(s=t.users.find(i=>e.sender_id===i._id))==null?void 0:s.username,distributed:!0};return e.replyMessage&&(n.replyMessage={...e.replyMessage,senderId:e.replyMessage.sender_id}),n},async sendMessage({content:t,roomId:e,files:n,replyMessage:s}){const i={sender_id:this.currentUserId,content:t,timestamp:new Date};n&&(i.files=this.formattedFiles(n)),s&&(i.replyMessage={_id:s._id,content:s.content,sender_id:s.senderId},s.files&&(i.replyMessage.files=s.files));const{id:r}=await LD(e,i);if(n)for(let o=0;o<n.length;o++)await this.uploadFile({file:n[o],messageId:r,roomId:e});Qc(e,{lastUpdated:new Date})},async editMessage({messageId:t,newContent:e,roomId:n,files:s}){var r;const i={edited:new Date};if(i.content=e,s?i.files=this.formattedFiles(s):i.files=wD,await nc(n,t,i),s)for(let o=0;o<s.length;o++)(r=s[o])!=null&&r.blob&&await this.uploadFile({file:s[o],messageId:t,roomId:n})},async deleteMessage({message:t,roomId:e}){await nc(e,t._id,{deleted:new Date});const{files:n}=t;n&&n.forEach(s=>{J0(this.currentUserId,t._id,s)})},async uploadFile({file:t,messageId:e,roomId:n}){return new Promise(s=>{let i=t.extension||t.type;(i==="svg"||i==="pdf")&&(i=t.type),$D(this.currentUserId,e,t,i,r=>{this.updateFileProgress(e,t.localUrl,r)},r=>{s(!1)},async r=>{const o=await ND(n,e);o.files.forEach(a=>{a.url===t.localUrl&&(a.url=r)}),await nc(n,e,{files:o.files}),s(!0)})})},updateFileProgress(t,e,n){const s=this.messages.find(i=>i._id===t);!s||!s.files||(s.files.find(i=>i.url===e).progress=n,this.messages=[...this.messages])},formattedFiles(t){const e=[];return t.forEach(n=>{const s={name:n.name,size:n.size,type:n.type,extension:n.extension||n.type,url:n.url||n.localUrl};n.audio&&(s.audio=!0,s.duration=n.duration),e.push(s)}),e},openFile({file:t}){window.open(t.file.url,"_blank")},async openUserTag({user:t}){let e;if(this.rooms.forEach(o=>{if(o.users.length===2){const a=o.users[0]._id,l=o.users[1]._id;(a===t._id||a===this.currentUserId)&&(l===t._id||l===this.currentUserId)&&(e=o.roomId)}}),e){this.roomId=e;return}const n=await Ab(this.currentUserId,t._id);if(n.data.length)return this.loadRoom(n);const s=await Ab(t._id,this.currentUserId);if(s.data.length)return this.loadRoom(s);const i=t._id===this.currentUserId?[this.currentUserId]:[t._id,this.currentUserId],r=await Oa({users:i,lastUpdated:new Date});this.roomId=r.id,this.fetchRooms()},async loadRoom(t){t.forEach(async e=>{this.loadingRooms||(await Qc(e.id,{lastUpdated:new Date}),this.roomId=e.id,this.fetchRooms())})},menuActionHandler({action:t,roomId:e}){switch(t.name){case"inviteUser":return this.inviteUser(e);case"removeUser":return this.removeUser(e);case"deleteRoom":return this.deleteRoom(e)}},messageSelectionActionHandler({action:t,messages:e,roomId:n}){switch(t.name){case"deleteMessages":e.forEach(s=>{this.deleteMessage({message:s,roomId:n})})}},async sendMessageReaction({reaction:t,remove:e,messageId:n,roomId:s}){jD(s,n,this.currentUserId,t.unicode,e?"remove":"add")},typingMessage({message:t,roomId:e}){if(e){if((t==null?void 0:t.length)>1){this.typingMessageCache=t;return}if((t==null?void 0:t.length)===1&&this.typingMessageCache){this.typingMessageCache=t;return}this.typingMessageCache=t,OD(e,this.currentUserId,t?"add":"remove")}},async listenRooms(t){const e=DD(t,n=>{n.forEach(s=>{const i=this.rooms.find(r=>r.roomId===s.id);i&&(i.typingUsers=s.typingUsers,i.index=s.lastUpdated.seconds)})});this.roomsListeners.push(e)},listenUsersOnlineStatus(t){t.forEach(e=>{e.users.forEach(n=>{const s=zD(ep(n._id),i=>{if(!i||!i.val())return;const r=g1(new Date(i.val().lastChanged),new Date(i.val().lastChanged));n.status={...i.val(),lastChanged:r};const o=this.rooms.findIndex(a=>e.roomId===a.roomId);this.rooms[o]=e,this.rooms=[...this.rooms]});this.roomsListeners.push(s)})})},addRoom(){this.resetForms(),this.addNewRoom=!0},async createRoom(){this.disableForm=!0;const{id:t}=await Tb({username:this.addRoomUsername});await Sb(t,{_id:t}),await Oa({users:[t,this.currentUserId],lastUpdated:new Date}),this.addNewRoom=!1,this.addRoomUsername="",this.fetchRooms()},inviteUser(t){this.resetForms(),this.inviteRoomId=t},async addRoomUser(){this.disableForm=!0;const{id:t}=await Tb({username:this.invitedUsername});await Sb(t,{_id:t}),await MD(this.inviteRoomId,t),this.inviteRoomId=null,this.invitedUsername="",this.fetchRooms()},removeUser(t){this.resetForms(),this.removeRoomId=t,this.removeUsers=this.rooms.find(e=>e.roomId===t).users},async deleteRoomUser(){this.disableForm=!0,await xD(this.removeRoomId,this.removeUserId),this.removeRoomId=null,this.removeUserId="",this.fetchRooms()},async deleteRoom(t){const e=this.rooms.find(n=>n.roomId===t);if(e.users.find(n=>n._id==="SGmFnBZB4xxMv9V4CVlW")||e.users.find(n=>n._id==="6jMsIXUrBHBj7o2cRlau"))return alert("Nope, for demo purposes you cannot delete this room");Z0(t).then(({data:n})=>{n.forEach(s=>{a8(t,s.id),s.files&&s.files.forEach(i=>{J0(this.currentUserId,s.id,i)})})}),await r8(t),this.fetchRooms()},resetForms(){this.disableForm=!1,this.addNewRoom=null,this.addRoomUsername="",this.inviteRoomId=null,this.invitedUsername="",this.removeRoomId=null,this.removeUserId=""}}},iG=t=>($6("data-v-05b6fd62"),t=t(),z6(),t),rG=["disabled"],oG=["disabled"],aG=iG(()=>Sn("option",{default:"",value:""},"Select User",-1)),lG=["value"],cG=["disabled"],uG=["height","theme","styles","current-user-id","room-id","rooms","loading-rooms","rooms-loaded","messages","messages-loaded","room-message","room-actions","menu-actions","message-selection-actions","templates-text"];function hG(t,e,n,s,i,r){return ys(),Qs("div",{class:Ka(["window-container",{"window-mobile":n.isDevice}])},[i.addNewRoom?(ys(),Qs("form",{key:0,onSubmit:e[2]||(e[2]=Gm((...o)=>r.createRoom&&r.createRoom(...o),["prevent"]))},[Uh(Sn("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.addRoomUsername=o),type:"text",placeholder:"Add username"},null,512),[[k2,i.addRoomUsername]]),Sn("button",{type:"submit",disabled:i.disableForm||!i.addRoomUsername}," Create Room ",8,rG),Sn("button",{class:"button-cancel",onClick:e[1]||(e[1]=o=>i.addNewRoom=!1)},"Cancel")],32)):Ro("",!0),i.inviteRoomId?(ys(),Qs("form",{key:1,onSubmit:e[5]||(e[5]=Gm((...o)=>r.addRoomUser&&r.addRoomUser(...o),["prevent"]))},[Uh(Sn("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.invitedUsername=o),type:"text",placeholder:"Add username"},null,512),[[k2,i.invitedUsername]]),Sn("button",{type:"submit",disabled:i.disableForm||!i.invitedUsername}," Add User ",8,oG),Sn("button",{class:"button-cancel",onClick:e[4]||(e[4]=o=>i.inviteRoomId=null)},"Cancel")],32)):Ro("",!0),i.removeRoomId?(ys(),Qs("form",{key:2,onSubmit:e[8]||(e[8]=Gm((...o)=>r.deleteRoomUser&&r.deleteRoomUser(...o),["prevent"]))},[Uh(Sn("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>i.removeUserId=o)},[aG,(ys(!0),Qs(Xs,null,Bw(i.removeUsers,o=>(ys(),Qs("option",{key:o._id,value:o._id},mw(o.username),9,lG))),128))],512),[[a4,i.removeUserId]]),Sn("button",{type:"submit",disabled:i.disableForm||!i.removeUserId}," Remove User ",8,cG),Sn("button",{class:"button-cancel",onClick:e[7]||(e[7]=o=>i.removeRoomId=null)},"Cancel")],32)):Ro("",!0),Sn("vue-advanced-chat",{ref:"chatWindow",height:r.screenHeight,theme:n.theme,styles:JSON.stringify(i.styles),"current-user-id":n.currentUserId,"room-id":i.roomId,rooms:JSON.stringify(r.loadedRooms),"loading-rooms":i.loadingRooms,"rooms-loaded":i.roomsLoaded,messages:JSON.stringify(i.messages),"messages-loaded":i.messagesLoaded,"room-message":i.roomMessage,"room-actions":JSON.stringify(i.roomActions),"menu-actions":JSON.stringify(i.menuActions),"message-selection-actions":JSON.stringify(i.messageSelectionActions),"templates-text":JSON.stringify(i.templatesText),onFetchMoreRooms:e[9]||(e[9]=(...o)=>r.fetchMoreRooms&&r.fetchMoreRooms(...o)),onFetchMessages:e[10]||(e[10]=o=>r.fetchMessages(o.detail[0])),onSendMessage:e[11]||(e[11]=o=>r.sendMessage(o.detail[0])),onEditMessage:e[12]||(e[12]=o=>r.editMessage(o.detail[0])),onDeleteMessage:e[13]||(e[13]=o=>r.deleteMessage(o.detail[0])),onOpenFile:e[14]||(e[14]=o=>r.openFile(o.detail[0])),onOpenUserTag:e[15]||(e[15]=o=>r.openUserTag(o.detail[0])),onAddRoom:e[16]||(e[16]=o=>r.addRoom(o.detail[0])),onRoomActionHandler:e[17]||(e[17]=o=>r.menuActionHandler(o.detail[0])),onMenuActionHandler:e[18]||(e[18]=o=>r.menuActionHandler(o.detail[0])),onMessageSelectionActionHandler:e[19]||(e[19]=o=>r.messageSelectionActionHandler(o.detail[0])),onSendMessageReaction:e[20]||(e[20]=o=>r.sendMessageReaction(o.detail[0])),onTypingMessage:e[21]||(e[21]=o=>r.typingMessage(o.detail[0])),onToggleRoomsList:e[22]||(e[22]=o=>t.$emit("show-demo-options",o.detail[0].opened))},null,40,uG)],2)}var dG=LS(sG,[["render",hG],["__scopeId","data-v-05b6fd62"]]),fG="/vue-advanced-chat/assets/github.12794390.svg";const mG={components:{ChatContainer:dG},data(){return{theme:"light",showChat:!0,users:[{_id:"6R0MijpK6M4AIrwaaCY2",username:"Luke",avatar:"https://66.media.tumblr.com/avatar_c6a8eae4303e_512.pnj"},{_id:"SGmFnBZB4xxMv9V4CVlW",username:"Leia",avatar:"https://avatarfiles.alphacoders.com/184/thumb-184913.jpg"},{_id:"6jMsIXUrBHBj7o2cRlau",username:"Yoda",avatar:"https://vignette.wikia.nocookie.net/teamavatarone/images/4/45/Yoda.jpg/revision/latest?cb=20130224160049"}],currentUserId:"6R0MijpK6M4AIrwaaCY2",isDevice:!1,showDemoOptions:!0,updatingData:!1}},computed:{showOptions(){return!this.isDevice||this.showDemoOptions}},watch:{currentUserId(){this.showChat=!1,setTimeout(()=>this.showChat=!0,150)}},mounted(){this.isDevice=window.innerWidth<500,window.addEventListener("resize",t=>{t.isTrusted&&(this.isDevice=window.innerWidth<500)})},methods:{resetData(){ID().then(({data:t})=>{t.forEach(async e=>{await Z0(e.id).then(({data:n})=>{n.forEach(s=>{a8(e.id,s.id),s.files&&s.files.forEach(i=>{J0(this.currentUserId,s.id,i)})})}),r8(e.id)})}),TD().then(({data:t})=>{t.forEach(e=>{AD(e.id)})})},async addData(){this.updatingData=!0;const t=this.users[0];await p1(t._id,t);const e=this.users[1];await p1(e._id,e);const n=this.users[2];await p1(n._id,n),await Oa({users:[t._id,e._id],lastUpdated:new Date}),await Oa({users:[t._id,n._id],lastUpdated:new Date}),await Oa({users:[e._id,n._id],lastUpdated:new Date}),await Oa({users:[t._id,e._id,n._id],lastUpdated:new Date}),this.updatingData=!1,location.reload()}}},pG=["value"],gG={key:2,class:"button-theme"},_G=Sn("button",{class:"button-github"},[Sn("a",{href:"https://github.com/antoine92190/vue-advanced-chat"},[Sn("img",{src:fG})])],-1);function vG(t,e,n,s,i,r){const o=mA("chat-container");return ys(),Qs("div",null,[Sn("div",{class:Ka(["app-container",{"app-mobile":i.isDevice,"app-mobile-dark":i.theme==="dark"}])},[r.showOptions?(ys(),Qs("span",{key:0,class:Ka(["user-logged",{"user-logged-dark":i.theme==="dark"}])}," Logged as ",2)):Ro("",!0),r.showOptions?Uh((ys(),Qs("select",{key:1,"onUpdate:modelValue":e[0]||(e[0]=a=>i.currentUserId=a)},[(ys(!0),Qs(Xs,null,Bw(i.users,a=>(ys(),Qs("option",{key:a._id,value:a._id},mw(a.username),9,pG))),128))],512)),[[a4,i.currentUserId]]):Ro("",!0),r.showOptions?(ys(),Qs("div",gG,[Sn("button",{class:"button-light",onClick:e[1]||(e[1]=a=>i.theme="light")}," Light "),Sn("button",{class:"button-dark",onClick:e[2]||(e[2]=a=>i.theme="dark")}," Dark "),_G])):Ro("",!0),i.showChat?(ys(),Yw(o,{key:3,"current-user-id":i.currentUserId,theme:i.theme,"is-device":i.isDevice,onShowDemoOptions:e[3]||(e[3]=a=>i.showDemoOptions=a)},null,8,["current-user-id","theme","is-device"])):Ro("",!0)],2)])}var yG=LS(mG,[["render",vG]]);const bG=LR({render:()=>XA(yG)});bG.mount("#app");
